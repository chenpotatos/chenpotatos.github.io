import{_ as e}from"./d-dialog.04f0d663.js";import{as as a,aa as t,at as o,N as l,aq as s,g as i,c as n,aK as r,P as d,o as u,t as c,J as p,h as m,i as f,e as g,n as v,k as y,b as h,K as b,L as j,S as x,C as _,x as k,ao as w,p as $,q as S,ay as L,R as C,a9 as I,a as q,z as A,V as E,ax as P,m as K,j as V,s as F,A as R,B as W}from"./el-select.b78411e2.js";import{j as B,a as z,b as O,c as T,g as U}from"./jingtuitui.0a6a1952.js";import{E as D}from"./el-skeleton-item.ad47a992.js";/* empty css                        *//* empty css                *//* empty css                  */import N from"./wallpaperDb.b72701e6.js";import{l as H}from"./index.389214ec.js";import{E as J}from"./index.c7cdc822.js";import{E as M}from"./index.9bab3cd4.js";import{u as G,g as Q,E as X}from"./index.007a0b27.js";import{b as Y,d as Z,E as ee,_ as ae,w as te}from"./index.c511a369.js";import{U as oe,I as le,C as se}from"./focus-trap.37f37187.js";import{u as ie}from"./index.34bbf0a0.js";import{d as ne}from"./index.e2562b21.js";import{u as re}from"./index.48a3615c.js";import{t as de}from"./error.7e8331f1.js";import{d as ue}from"./debounce.abbfdaeb.js";import{S as ce}from"./Search.4134401a.js";import{a as pe,E as me}from"./index.f8fe0371.js";import{ElImage as fe}from"./index.6ce3651f.js";import{ElButton as ge}from"./index.4a61e9ca.js";import"./el-dialog.64bc625d.js";import"./icon.e5ddc463.js";import"./index.d2069d58.js";import"./style.7be20351.js";import"./index.9a99ea33.js";import"./index.502472ff.js";import"./scroll.64fda821.js";/* empty css                   */import"./main.4e240c16.js";import"./Close.c8424ab4.js";import"./baseRequest.da51274f.js";import"./axios.91e25212.js";import"./version.8d34b113.js";import"./localforage.60f13183.js";import"./_commonjs-dynamic-modules.30ae7933.js";import"./typescript.72bf8adc.js";import"./index.d0852ddf.js";import"./aria.66f3f71c.js";import"./isObject.a01dee34.js";import"./strings.71c48fcd.js";import"./throttle.0dfde511.js";import"./position.9519b900.js";const ve=Y({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:Z(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:Z([Function,Array]),default:a},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:G.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1}}),ye={[oe]:e=>t(e),[le]:e=>t(e),[se]:e=>t(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>o(e)},he=["aria-expanded","aria-owns"],be={key:0},je=["id","aria-selected","onClick"],xe=l({name:"ElAutocomplete",inheritAttrs:!1});const _e=te(ae(l({...xe,props:ve,emits:ye,setup(e,{expose:a,emit:t}){const o=e,l=ie(),q=s(),A=ne(),E=re("autocomplete"),P=i(),K=i(),V=i(),F=i();let R=!1,W=!1;const B=i([]),z=i(-1),O=i(""),T=i(!1),U=i(!1),D=i(!1),N=n((()=>E.b(String(Q())))),G=n((()=>q.style)),Y=n((()=>(B.value.length>0||D.value)&&T.value)),Z=n((()=>!o.hideLoading&&D.value)),ae=n((()=>P.value?Array.from(P.value.$el.querySelectorAll("input")):[])),te=async()=>{await C(),Y.value&&(O.value=`${P.value.$el.offsetWidth}px`)},ce=()=>{W=!0},pe=()=>{W=!1,z.value=-1},me=ue((async e=>{if(U.value)return;const a=e=>{D.value=!1,U.value||(I(e)?(B.value=e,z.value=o.highlightFirstItem?0:-1):de("ElAutocomplete","autocomplete suggestions must be an array"))};if(D.value=!0,I(o.fetchSuggestions))a(o.fetchSuggestions);else{const t=await o.fetchSuggestions(e,a);I(t)&&a(t)}}),o.debounce),fe=e=>{const a=!!e;if(t(le,e),t(oe,e),U.value=!1,T.value||(T.value=a),!o.triggerOnFocus&&!e)return U.value=!0,void(B.value=[]);me(e)},ge=e=>{var a;A.value||("INPUT"!==(null==(a=e.target)?void 0:a.tagName)||ae.value.includes(document.activeElement))&&(T.value=!0)},ve=e=>{t(se,e)},ye=e=>{W||(T.value=!0,t("focus",e),o.triggerOnFocus&&!R&&me(String(o.modelValue)))},xe=e=>{W||t("blur",e)},_e=()=>{T.value=!1,t(oe,""),t("clear")},ke=async()=>{Y.value&&z.value>=0&&z.value<B.value.length?Se(B.value[z.value]):o.selectWhenUnmatched&&(t("select",{value:o.modelValue}),B.value=[],z.value=-1)},we=e=>{Y.value&&(e.preventDefault(),e.stopPropagation(),$e())},$e=()=>{T.value=!1},Se=async e=>{t(le,e[o.valueKey]),t(oe,e[o.valueKey]),t("select",e),B.value=[],z.value=-1},Le=e=>{if(!Y.value||D.value)return;if(e<0)return void(z.value=-1);e>=B.value.length&&(e=B.value.length-1);const a=K.value.querySelector(`.${E.be("suggestion","wrap")}`),t=a.querySelectorAll(`.${E.be("suggestion","list")} li`)[e],o=a.scrollTop,{offsetTop:l,scrollHeight:s}=t;l+s>o+a.clientHeight&&(a.scrollTop+=s),l<o&&(a.scrollTop-=s),z.value=e,P.value.ref.setAttribute("aria-activedescendant",`${N.value}-item-${z.value}`)};return r(F,(()=>{Y.value&&$e()})),d((()=>{P.value.ref.setAttribute("role","textbox"),P.value.ref.setAttribute("aria-autocomplete","list"),P.value.ref.setAttribute("aria-controls","id"),P.value.ref.setAttribute("aria-activedescendant",`${N.value}-item-${z.value}`),R=P.value.ref.hasAttribute("readonly")})),a({highlightedIndex:z,activated:T,loading:D,inputRef:P,popperRef:V,suggestions:B,handleSelect:Se,handleKeyEnter:ke,focus:()=>{var e;null==(e=P.value)||e.focus()},blur:()=>{var e;null==(e=P.value)||e.blur()},close:$e,highlight:Le}),(e,a)=>(u(),c(g(X),{ref_key:"popperRef",ref:V,visible:g(Y),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[g(E).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${g(E).namespace.value}-zoom-in-top`,persistent:"",onBeforeShow:te,onShow:ce,onHide:pe},{content:p((()=>[m("div",{ref_key:"regionRef",ref:K,class:f([g(E).b("suggestion"),g(E).is("loading",g(Z))]),style:v({[e.fitInputWidth?"width":"minWidth"]:O.value,outline:"none"}),role:"region"},[y(g(M),{id:g(N),tag:"ul","wrap-class":g(E).be("suggestion","wrap"),"view-class":g(E).be("suggestion","list"),role:"listbox"},{default:p((()=>[g(Z)?(u(),h("li",be,[y(g(ee),{class:f(g(E).is("loading"))},{default:p((()=>[y(g(H))])),_:1},8,["class"])])):(u(!0),h(b,{key:1},j(B.value,((a,t)=>(u(),h("li",{id:`${g(N)}-item-${t}`,key:t,class:f({highlighted:z.value===t}),role:"option","aria-selected":z.value===t,onClick:e=>Se(a)},[x(e.$slots,"default",{item:a},(()=>[_(k(a[e.valueKey]),1)]))],10,je)))),128))])),_:3},8,["id","wrap-class","view-class"])],6)])),default:p((()=>[m("div",{ref_key:"listboxRef",ref:F,class:f([g(E).b(),e.$attrs.class]),style:v(g(G)),role:"combobox","aria-haspopup":"listbox","aria-expanded":g(Y),"aria-owns":g(N)},[y(g(J),w({ref_key:"inputRef",ref:P},g(l),{"model-value":e.modelValue,onInput:fe,onChange:ve,onFocus:ye,onBlur:xe,onClear:_e,onKeydown:[a[0]||(a[0]=$(S((e=>Le(z.value-1)),["prevent"]),["up"])),a[1]||(a[1]=$(S((e=>Le(z.value+1)),["prevent"]),["down"])),$(ke,["enter"]),$($e,["tab"]),$(we,["esc"])],onMousedown:ge}),L({_:2},[e.$slots.prepend?{name:"prepend",fn:p((()=>[x(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:p((()=>[x(e.$slots,"append")]))}:void 0,e.$slots.prefix?{name:"prefix",fn:p((()=>[x(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:p((()=>[x(e.$slots,"suffix")]))}:void 0]),1040,["model-value","onKeydown"])],14,he)])),_:3},8,["visible","placement","popper-class","teleported","transition"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/autocomplete/src/autocomplete.vue"]])),ke={class:"remai-content hfull"},we={style:{"background-color":"var(--bg-card)"}},$e={class:"ac pt10 d-flex-between remai-search"},Se={class:"remai-search",style:{"margin-top":"4px",height:"16px",overflow:"hidden"}},Le=["onClick"],Ce={class:"pl20 pr20"},Ie={class:"d-layout hfull bt",style:{height:"calc(100% - 60px)","margin-top":"0px"}},qe={class:"d-layout-content mt10 d-auto-y ml10",style:{height:"calc(100% - 60px)"},"infinite-scroll-delay":"500","infinite-scroll-immediate":!1},Ae={key:0,class:"mb10"},Ee={style:{color:"#e74737"}},Pe={style:{color:"#e74737"}},Ke={class:"remai-body d-flex"},Ve=["onClick"],Fe={style:{padding:"16px"}},Re=["title"],We={class:"price"},Be=(e=>(R("data-v-e51cf4ff"),e=e(),W(),e))((()=>m("em",{class:"f12",style:{"vertical-align":"-2px"}},"券后￥",-1))),ze={class:"f16 b",style:{"vertical-align":"-2px"}},Oe={class:"fr couponlink"},Te={class:"ac"},Ue={name:"appRemai"};const De=q({name:"remai",components:{Content:q(Object.assign(Ue,{setup(e){const a=A({category:"jd_today_top",categoryList:[{name:"热卖",api:"jd_today_top"},{name:"好货",api:"jd_goods"},{name:"9块9",api:"jd_nine"},{name:"排行",api:"jd_subsidy_goods"},{name:"京东拼购",api:"jd_collage"},{name:"京东自营",api:"jd_self"}],hotSearch:[],total_count:0,goodsOptions:[],goodList:[],loading:!1,moreLoading:!1,rowData:{},queryParams:{pageIndex:1,pageSize:24}});function t(){l(1)}const o=async e=>{a.keyword="",1==e?(a.queryParams.pageIndex++,a.moreLoading=!0):(a.loading=!0,a.queryParams.pageIndex=1);let t=`remai_${a.category}_${a.queryParams.eliteId}_${a.queryParams.pageIndex}`,o=await N.get(t);if(o)return a.goodList=1==e?[...a.goodList,...o]:o,a.moreLoading=!1,void(a.loading=!1);z[a.category]({...a.queryParams,v:"v2"}).then((o=>{let l=o.data||o.brand_list||[];N.set(t,l,72e5),a.goodList=1==e?[...a.goodList,...l]:l})).finally((()=>{a.loading=!1,a.moreLoading=!1}))};function l(e){a.keyword?i(e):o(e)}o(),B({v:"v1"}).then((e=>{a.hotSearch=e.hotWords||[]}));const s=(e,t)=>{e||!a.hotWords?T({word:e,v:"v1"}).then((e=>{t((e||[]).map((e=>({value:e.kw}))))})):cd(a.hotWords)};function i(e){1==e?(a.queryParams.pageIndex++,a.moreLoading=!0):(a.loading=!0,a.queryParams.pageIndex--),U({...a.queryParams,keyword:a.keyword,v:"v2"}).then((t=>{let o=t.data||[];a.goodList=1==e?[...a.goodList,...o]:o,a.total_count=t.total_count||0})).finally((()=>{a.loading=!1,a.moreLoading=!1}))}return(e,n)=>{const r=E("el-icon"),d=P("infinite-scroll");return u(),h("div",ke,[m("div",we,[m("div",$e,[y(g(_e),{size:"default",style:{width:"100%"},modelValue:a.keyword,"onUpdate:modelValue":n[0]||(n[0]=e=>a.keyword=e),filterable:"",remote:"",onKeyup:$(i,["enter"]),onChange:i,"reserve-keyword":"",placeholder:"粘贴商品标题，先领取再购物","fetch-suggestions":s},null,8,["modelValue","onKeyup"]),m("button",{class:"d-button",onClick:i},[y(r,{size:16},{default:p((()=>[y(g(ce))])),_:1})])]),m("p",Se,[(u(!0),h(b,null,j(a.hotSearch,(e=>(u(),h("span",{onClick:t=>{return o=e,a.keyword=o,void i();var o},class:"f12 hot d-sub",key:e},k(e),9,Le)))),128))]),m("div",Ce,[y(g(me),{onTabClick:o,modelValue:a.category,"onUpdate:modelValue":n[1]||(n[1]=e=>a.category=e)},{default:p((()=>[(u(!0),h(b,null,j(a.categoryList,(e=>(u(),c(g(pe),{label:e.name,name:e.api,key:e.api},null,8,["label","name"])))),128))])),_:1},8,["modelValue"])])]),m("div",Ie,[K((u(),h("div",qe,[a.keyword?(u(),h("p",Ae,[_(" 为您找到 "),m("span",Ee,k(a.keyword),1),_(" 相关的结果 "),m("span",Pe,k(a.total_count),1),_("个 ")])):V("",!0),m("ul",Ke,[y(g(D),{loading:a.loading,rows:3,count:1,animated:""},{default:p((()=>[(u(!0),h(b,null,j(a.goodList,(e=>(u(),h("li",{onClick:a=>function(e){let a={gid:e.goods_link,unionid:1000360070,positionid:3004143482};O(a).then((e=>{window.open(e.link,"_blank")}))}(e),class:"remai-item",key:e.goods_id,target:"_blank"},[y(g(fe),{fit:"cover",lazy:"",style:{height:"204px"},class:"hfull wfull",src:e.goods_img},null,8,["src"]),m("div",Fe,[m("p",{class:"title",title:e.short_name||e.jd_title},k(e.short_name),9,Re),m("p",We,[Be,m("em",ze,k(e.final_price),1),m("a",Oe,"领"+k(e.discount_price)+"元券",1)])])],8,Ve)))),128))])),_:1},8,["loading"])]),m("div",Te,[K(y(g(ge),{onClick:n[2]||(n[2]=e=>l(1)),loading:a.moreLoading,style:{width:"120px"},size:"small"},{default:p((()=>[_("加载更多")])),_:1},8,["loading"]),[[F,!a.loading]])])])),[[d,t]])])])}}}),[["__scopeId","data-v-e51cf4ff"]]),DDialog:e},setup:(e,a)=>({})},[["render",function(e,a,t,o,l,s){const i=E("content"),n=E("d-dialog");return u(),c(n,{height:"640px",destroyOnClose:!0},{default:p((()=>[y(i)])),_:1})}]]);export{De as default};
