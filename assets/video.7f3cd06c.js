import{cn as Fe,co as Pe,u as qe,o as Te,ar as et,bC as Ne,cp as Ke,aw as tt,as as rt,f as be,Y as it,aP as nt,bg as at,v as st,aq as ot,a1 as lt,bG as ut,ae as ft,W as dt}from"./index.4aab0c79.js";import{a as ct}from"./useUtil.ec3d8b67.js";import{O as ht}from"./icon.88a540be.js";import{c as pt}from"./Layout.d1307ad6.js";import"./api.e13390dc.js";import"./index.0ee9a21c.js";import"./useTitle.3846e0cb.js";import"./Markdown.0bbea584.js";import"./index.7e5fe956.js";import"./FolderTree.360c66b9.js";function we(xe){throw new Error('Could not dynamically require "'+xe+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var We={exports:{}};/*!
 * artplayer.js v4.5.4
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(xe,Re){(function(M,C,y,T,p){var m=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof Pe<"u"?Pe:{},A=typeof m.parcelRequireb749=="function"&&m.parcelRequireb749,_=A.cache||{},g=typeof we=="function"&&we.bind(xe);function s(a,d){if(!_[a]){if(!M[a]){var c=typeof m.parcelRequireb749=="function"&&m.parcelRequireb749;if(!d&&c)return c(a,!0);if(A)return A(a,!0);if(g&&typeof a=="string")return g(a);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}e.resolve=function(n){var i=M[a][1][n];return i!=null?i:n},e.cache={};var t=_[a]=new s.Module(a);M[a][0].call(t.exports,e,t,t.exports,this)}return _[a].exports;function e(n){var i=e.resolve(n);return i===!1?{}:s(i)}}s.isParcelRequire=!0,s.Module=function(a){this.id=a,this.bundle=s,this.exports={}},s.modules=M,s.cache=_,s.parent=A,s.register=function(a,d){M[a]=[function(c,h){h.exports=d},{}]},Object.defineProperty(s,"root",{get:function(){return m.parcelRequireb749}}),m.parcelRequireb749=s;for(var r=0;r<C.length;r++)s(C[r]);var u=s(y);xe.exports=u})({E13ST:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("bundle-text:./style/index.less"),m=T.interopDefault(p),A=M("option-validator"),_=T.interopDefault(A),g=M("./utils/emitter"),s=T.interopDefault(g),r=M("./utils"),u=M("./scheme"),a=T.interopDefault(u),d=M("./config"),c=T.interopDefault(d),h=M("./whitelist"),t=T.interopDefault(h),e=M("./template"),n=T.interopDefault(e),i=M("./i18n"),f=T.interopDefault(i),l=M("./player"),o=T.interopDefault(l),v=M("./control"),D=T.interopDefault(v),S=M("./contextmenu"),E=T.interopDefault(S),L=M("./info"),x=T.interopDefault(L),b=M("./subtitle"),O=T.interopDefault(b),R=M("./events"),I=T.interopDefault(R),P=M("./hotkey"),F=T.interopDefault(P),w=M("./layer"),k=T.interopDefault(w),B=M("./loading"),U=T.interopDefault(B),j=M("./notice"),N=T.interopDefault(j),K=M("./mask"),H=T.interopDefault(K),$=M("./icons"),G=T.interopDefault($),ee=M("./setting"),X=T.interopDefault(ee),V=M("./storage"),J=T.interopDefault(V),Q=M("./plugins"),ie=T.interopDefault(Q),ae=M("./mobile"),se=T.interopDefault(ae);let le=0;const ue=[];class q extends s.default{constructor(de,ce){super(),this.id=++le;const pe=r.mergeDeep(q.option,de);this.option=(0,_.default)(pe,a.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new t.default(this),this.template=new n.default(this),this.events=new I.default(this),this.whitelist.state?(this.storage=new J.default(this),this.icons=new G.default(this),this.i18n=new f.default(this),this.notice=new N.default(this),this.player=new o.default(this),this.layers=new k.default(this),this.controls=new D.default(this),this.contextmenu=new E.default(this),this.subtitle=new O.default(this),this.info=new x.default(this),this.loading=new U.default(this),this.hotkey=new F.default(this),this.mask=new H.default(this),this.setting=new X.default(this),this.plugins=new ie.default(this)):this.mobile=new se.default(this),typeof ce=="function"&&this.on("ready",()=>ce.call(this)),ue.push(this)}static get instances(){return ue}static get version(){return"4.5.4"}static get env(){return"production"}static get build(){return"1659362361789"}static get config(){return c.default}static get utils(){return r}static get scheme(){return a.default}static get Emitter(){return s.default}static get validator(){return _.default}static get kindOf(){return _.default.kindOf}static get html(){return n.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10,width:0,height:0},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:r.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(de=!0){this.events.destroy(),this.template.destroy(de),ue.splice(ue.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(y.default=q,q.NOTICE_TIME=2e3,q.SETTING_WIDTH=250,q.SETTING_ITEM_WIDTH=200,q.SETTING_ITEM_HEIGHT=35,q.INDICATOR_SIZE=14,q.INDICATOR_SIZE_ICON=16,q.INDICATOR_SIZE_MOBILE=18,q.INDICATOR_SIZE_MOBILE_ICON=20,q.VOLUME_PANEL_WIDTH=60,q.VOLUME_HANDLE_WIDTH=12,q.RESIZE_TIME=500,q.SCROLL_TIME=200,q.SCROLL_GAP=50,q.AUTO_PLAYBACK_MAX=10,q.AUTO_PLAYBACK_MIN=5,q.AUTO_PLAYBACK_TIMEOUT=3e3,q.RECONNECT_TIME_MAX=5,q.RECONNECT_SLEEP_TIME=1e3,q.CONTROL_HIDE_TIME=3e3,q.DB_CLICE_TIME=300,q.MOBILE_AUTO_PLAYBACKRATE=3,q.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,q.MOBILE_AUTO_ORIENTATION_TIME=200,q.INFO_LOOP_TIME=1e3,q.FAST_FORWARD_VALUE=3,q.FAST_FORWARD_TIME=1e3,q.TOUCH_MOVE_RATIO=.5,typeof document<"u"&&!document.getElementById("artplayer-style")){const oe=document.createElement("style");oe.id="artplayer-style",oe.textContent=m.default,document.head.appendChild(oe)}typeof window<"u"&&(window.Artplayer=q),console.log(`%c ArtPlayer %c ${q.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"6U764","option-validator":"eaJBf","./utils/emitter":"1SgiG","./utils":"5yYFo","./scheme":"3izFE","./config":"ej4fZ","./whitelist":"7CkCt","./template":"8iGAh","./i18n":"3mM4M","./player":"bCaa0","./control":"3qXcr","./contextmenu":"hTnNz","./info":"bfwuE","./subtitle":"bWZ2U","./events":"9oLaG","./hotkey":"cKO4X","./layer":"kZD92","./loading":"c9b9e","./notice":"SxQeL","./mask":"aJ0dF","./icons":"jx1Wu","./setting":"hdF39","./storage":"bCcu0","./plugins":"1v13t","./mobile":"eD5Ch","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"6U764":[function(M,C,y){C.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:none}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player .art-layer-autoPlayback{background-color:#000c;border-radius:3px;align-items:center;padding:10px;line-height:1;display:none;position:absolute;bottom:60px;left:20px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close{cursor:pointer;align-items:center;margin-right:10px;display:flex}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close svg{width:15px;height:15px;fill:#00c9ff}.art-video-player .art-layer-autoPlayback .art-autoPlayback-last{margin-right:10px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-jump{color:#00c9ff;cursor:pointer}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],eaJBf:[function(M,C,y){C.exports=function(){function T(r){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(r)}var p=Object.prototype.toString,m=function(r){if(r===void 0)return"undefined";if(r===null)return"null";var u=T(r);if(u==="boolean")return"boolean";if(u==="string")return"string";if(u==="number")return"number";if(u==="symbol")return"symbol";if(u==="function")return function(a){return A(a)==="GeneratorFunction"}(r)?"generatorfunction":"function";if(function(a){return Array.isArray?Array.isArray(a):a instanceof Array}(r))return"array";if(function(a){return!(!a.constructor||typeof a.constructor.isBuffer!="function")&&a.constructor.isBuffer(a)}(r))return"buffer";if(function(a){try{if(typeof a.length=="number"&&typeof a.callee=="function")return!0}catch(d){if(d.message.indexOf("callee")!==-1)return!0}return!1}(r))return"arguments";if(function(a){return a instanceof Date||typeof a.toDateString=="function"&&typeof a.getDate=="function"&&typeof a.setDate=="function"}(r))return"date";if(function(a){return a instanceof Error||typeof a.message=="string"&&a.constructor&&typeof a.constructor.stackTraceLimit=="number"}(r))return"error";if(function(a){return a instanceof RegExp||typeof a.flags=="string"&&typeof a.ignoreCase=="boolean"&&typeof a.multiline=="boolean"&&typeof a.global=="boolean"}(r))return"regexp";switch(A(r)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(a){return typeof a.throw=="function"&&typeof a.return=="function"&&typeof a.next=="function"}(r))return"generator";switch(u=p.call(r)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return u.slice(8,-1).toLowerCase().replace(/\s/g,"")};function A(r){return r.constructor?r.constructor.name:null}function _(r,u){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return g(r,u,a),s(r,u,a),function(d,c,h){var t=m(c),e=m(d);if(t==="object"){if(e!=="object")throw new Error("[Type Error]: '".concat(h.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(c).forEach(function(n){var i=d[n],f=c[n],l=h.slice();l.push(n),g(i,f,l),s(i,f,l),_(i,f,l)})}if(t==="array"){if(e!=="array")throw new Error("[Type Error]: '".concat(h.join("."),"' require 'array' type, but got '").concat(e,"'"));d.forEach(function(n,i){var f=d[i],l=c[i]||c[0],o=h.slice();o.push(i),g(f,l,o),s(f,l,o),_(f,l,o)})}}(r,u,a),r}function g(r,u,a){if(m(u)==="string"){var d=m(r);if(u[0]==="?"&&(u=u.slice(1)+"|undefined"),!(-1<u.indexOf("|")?u.split("|").map(function(c){return c.toLowerCase().trim()}).filter(Boolean).some(function(c){return d===c}):u.toLowerCase().trim()===d))throw new Error("[Type Error]: '".concat(a.join("."),"' require '").concat(u,"' type, but got '").concat(d,"'"))}}function s(r,u,a){if(m(u)==="function"){var d=u(r,m(r),a);if(d!==!0){var c=m(d);throw c==="string"?new Error(d):c==="error"?d:new Error("[Validator Error]: The scheme for '".concat(a.join("."),"' validator require return true, but got '").concat(d,"'"))}}}return _.kindOf=m,_}()},{}],"1SgiG":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=class{on(T,p,m){const A=this.e||(this.e={});return(A[T]||(A[T]=[])).push({fn:p,ctx:m}),this}once(T,p,m){const A=this;function _(...g){A.off(T,_),p.apply(m,g)}return _._=p,this.on(T,_,m)}emit(T,...p){const m=((this.e||(this.e={}))[T]||[]).slice();for(let A=0;A<m.length;A+=1)m[A].fn.apply(m[A].ctx,p);return this}off(T,p){const m=this.e||(this.e={}),A=m[T],_=[];if(A&&p)for(let g=0,s=A.length;g<s;g+=1)A[g].fn!==p&&A[g].fn._!==p&&_.push(A[g]);return _.length?m[T]=_:delete m[T],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],b7MJY:[function(M,C,y){y.interopDefault=function(T){return T&&T.__esModule?T:{default:T}},y.defineInteropFlag=function(T){Object.defineProperty(T,"__esModule",{value:!0})},y.exportAll=function(T,p){return Object.keys(T).forEach(function(m){m==="default"||m==="__esModule"||p.hasOwnProperty(m)||Object.defineProperty(p,m,{enumerable:!0,get:function(){return T[m]}})}),p},y.export=function(T,p,m){Object.defineProperty(T,p,{enumerable:!0,get:m})}},{}],"5yYFo":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./dom");T.exportAll(p,y);var m=M("./error");T.exportAll(m,y);var A=M("./subtitle");T.exportAll(A,y);var _=M("./file");T.exportAll(_,y);var g=M("./property");T.exportAll(g,y);var s=M("./time");T.exportAll(s,y);var r=M("./format");T.exportAll(r,y);var u=M("./compatibility");T.exportAll(u,y)},{"./dom":"fqaW9","./error":"kNZvP","./subtitle":"eZUgm","./file":"dYeSt","./property":"5ynPA","./time":"kXYeR","./format":"anS7L","./compatibility":"e9wVp","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],fqaW9:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"query",()=>m),T.export(y,"queryAll",()=>A),T.export(y,"addClass",()=>_),T.export(y,"removeClass",()=>g),T.export(y,"hasClass",()=>s),T.export(y,"append",()=>r),T.export(y,"remove",()=>u),T.export(y,"setStyle",()=>a),T.export(y,"setStyles",()=>d),T.export(y,"getStyle",()=>c),T.export(y,"sublings",()=>h),T.export(y,"inverseClass",()=>t),T.export(y,"tooltip",()=>e),T.export(y,"isInViewport",()=>n),T.export(y,"includeFromEvent",()=>i),T.export(y,"replaceElement",()=>f);var p=M("./compatibility");function m(l,o=document){return o.querySelector(l)}function A(l,o=document){return Array.from(o.querySelectorAll(l))}function _(l,o){return l.classList.add(o)}function g(l,o){return l.classList.remove(o)}function s(l,o){return l.classList.contains(o)}function r(l,o){return o instanceof Element?l.appendChild(o):l.insertAdjacentHTML("beforeend",String(o)),l.lastElementChild||l.lastChild}function u(l){return l.parentNode.removeChild(l)}function a(l,o,v){return l.style[o]=v,l}function d(l,o){return Object.keys(o).forEach(v=>{a(l,v,o[v])}),l}function c(l,o,v=!0){const D=window.getComputedStyle(l,null).getPropertyValue(o);return v?parseFloat(D):D}function h(l){return Array.from(l.parentElement.children).filter(o=>o!==l)}function t(l,o){h(l).forEach(v=>g(v,o)),_(l,o)}function e(l,o,v="top"){p.isMobile||(l.setAttribute("aria-label",o),_(l,"hint--rounded"),_(l,`hint--${v}`))}function n(l,o=0){const v=l.getBoundingClientRect(),D=window.innerHeight||document.documentElement.clientHeight,S=window.innerWidth||document.documentElement.clientWidth,E=v.top-o<=D&&v.top+v.height+o>=0,L=v.left-o<=S+o&&v.left+v.width+o>=0;return E&&L}function i(l,o){return l.composedPath&&l.composedPath().indexOf(o)>-1}function f(l,o){return o.parentNode.replaceChild(l,o),l}},{"./compatibility":"e9wVp","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],e9wVp:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"userAgent",()=>p),T.export(y,"isMobile",()=>m),T.export(y,"isSafari",()=>A),T.export(y,"isWechat",()=>_),T.export(y,"isIE",()=>g),T.export(y,"isAndroid",()=>s),T.export(y,"isIOS",()=>r);const p=typeof window<"u"?window.navigator.userAgent:"",m=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(p),A=/^((?!chrome|android).)*safari/i.test(p),_=/MicroMessenger/i.test(p),g=/MSIE|Trident/i.test(p),s=/android/i.test(p),r=/iPad|iPhone|iPod/i.test(p)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kNZvP:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"ArtPlayerError",()=>p),T.export(y,"errorHandle",()=>m);class p extends Error{constructor(_,g){super(_),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,g||this.constructor),this.name="ArtPlayerError"}}function m(A,_){if(!A)throw new p(_);return A}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eZUgm:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");function p(_){return`WEBVTT \r
\r
`.concat((g=_,g.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(s,r,u)=>{let a=u.slice(0,3);return u.length===1&&(a=u+"00"),u.length===2&&(a=u+"0"),`${r},${a}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var g}function m(_){return URL.createObjectURL(new Blob([_],{type:"text/vtt"}))}function A(_){const g=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function s(r=""){return r.split(/[:.]/).map((u,a,d)=>{if(a===d.length-1){if(u.length===1)return`.${u}00`;if(u.length===2)return`.${u}0`}else if(u.length===1)return(a===0?"0":":0")+u;return a===0?u:a===d.length-1?`.${u}`:`:${u}`}).join("")}return`WEBVTT

${_.split(/\r?\n/).map(r=>{const u=r.match(g);return u?{start:s(u[1].trim()),end:s(u[2].trim()),text:u[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(a=>a.trim()).join(`
`)}:null}).filter(r=>r).map((r,u)=>r?`${u+1}
${r.start} --> ${r.end}
${r.text}`:"").filter(r=>r.trim()).join(`

`)}`}T.defineInteropFlag(y),T.export(y,"srtToVtt",()=>p),T.export(y,"vttToBlob",()=>m),T.export(y,"assToVtt",()=>A)},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],dYeSt:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");function p(A){return A.includes("?")?p(A.split("?")[0]):A.includes("#")?p(A.split("#")[0]):A.trim().toLowerCase().split(".").pop()}function m(A,_){const g=document.createElement("a");g.style.display="none",g.href=A,g.download=_,document.body.appendChild(g),g.click(),document.body.removeChild(g)}T.defineInteropFlag(y),T.export(y,"getExt",()=>p),T.export(y,"download",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"5ynPA":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"def",()=>p),T.export(y,"has",()=>A),T.export(y,"get",()=>_),T.export(y,"mergeDeep",()=>g);const p=Object.defineProperty,{hasOwnProperty:m}=Object.prototype;function A(s,r){return m.call(s,r)}function _(s,r){return Object.getOwnPropertyDescriptor(s,r)}function g(...s){const r=u=>u&&typeof u=="object"&&!Array.isArray(u);return s.reduce((u,a)=>(Object.keys(a).forEach(d=>{const c=u[d],h=a[d];Array.isArray(c)&&Array.isArray(h)?u[d]=c.concat(...h):!r(c)||!r(h)||h instanceof Element?u[d]=h:u[d]=g(c,h)}),u),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kXYeR:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");function p(_=0){return new Promise(g=>setTimeout(g,_))}function m(_,g,s){let r;function u(...a){clearTimeout(r),r=setTimeout(function(){r=null,_.apply(s,a)},g)}return u.clearTimeout=function(){clearTimeout(r)},u}function A(_,g){let s,r,u=!1;return function a(...d){if(u)return s=d,void(r=this);u=!0,_.apply(this,d),setTimeout(()=>{u=!1,s&&(a.apply(r,s),s=null,r=null)},g)}}T.defineInteropFlag(y),T.export(y,"sleep",()=>p),T.export(y,"debounce",()=>m),T.export(y,"throttle",()=>A)},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],anS7L:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");function p(_,g,s){return Math.max(Math.min(_,Math.max(g,s)),Math.min(g,s))}function m(_){const g=Math.floor(_/3600),s=Math.floor((_-3600*g)/60),r=Math.floor(_-3600*g-60*s);return(g>0?[g,s,r]:[s,r]).map(u=>u<10?`0${u}`:String(u)).join(":")}function A(_){return _.replace(/[&<>'"]/g,g=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[g]||g)}T.defineInteropFlag(y),T.export(y,"clamp",()=>p),T.export(y,"secondToTime",()=>m),T.export(y,"escape",()=>A)},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"3izFE":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"ComponentOption",()=>a);var p=M("../utils");const m="array",A="boolean",_="string",g="number",s="object",r="function";function u(d,c,h){return(0,p.errorHandle)(c===_||c===g||d instanceof Element,`${h.join(".")} require '${_}' or 'Element' type`)}const a={html:u,disable:`?${A}`,name:`?${_}`,index:`?${g}`,style:`?${s}`,click:`?${r}`,mounted:`?${r}`,tooltip:`?${_}|${g}`,width:`?${g}`,selector:`?${m}`,onSelect:`?${r}`,switch:`?${A}`,onSwitch:`?${r}`,range:`?${m}`,onRange:`?${r}`};y.default={id:_,container:u,url:_,poster:_,title:_,type:_,theme:_,lang:_,volume:g,isLive:A,muted:A,autoplay:A,autoSize:A,autoMini:A,loop:A,flip:A,playbackRate:A,aspectRatio:A,screenshot:A,setting:A,hotkey:A,pip:A,mutex:A,backdrop:A,fullscreen:A,fullscreenWeb:A,subtitleOffset:A,miniProgressBar:A,useSSR:A,playsInline:A,lock:A,fastForward:A,autoPlayback:A,autoOrientation:A,airplay:A,plugins:[r],whitelist:[`${_}|${r}|regexp`],layers:[a],contextmenu:[a],settings:[a],controls:[{...a,position:(d,c,h)=>{const t=["top","left","right"];return(0,p.errorHandle)(t.includes(d),`${h.join(".")} only accept ${t.toString()} as parameters`)}}],quality:[{default:`?${A}`,html:_,url:_}],highlight:[{time:g,text:_}],thumbnails:{url:_,number:g,column:g,width:g,height:g},subtitle:{url:_,type:_,style:s,encoding:_},moreVideoAttr:s,icons:s,customType:s}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ej4fZ:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"7CkCt":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("./utils");y.default=class{constructor(p){this.art=p}get state(){const{option:p,constructor:{kindOf:m}}=this.art;return!T.isMobile||p.whitelist.some(A=>{switch(m(A)){case"string":return A==="*"||T.userAgent.indexOf(A)>-1;case"function":return A(T.userAgent);case"regexp":return A.test(T.userAgent);default:return!1}})}}},{"./utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"8iGAh":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("./utils");class p{constructor(A){this.art=A;const{option:_,constructor:g,whitelist:s}=A;_.container instanceof Element?this.$container=_.container:(this.$container=(0,T.query)(_.container),(0,T.errorHandle)(this.$container,`No container element found by ${_.container}`));const r=this.$container.tagName.toLowerCase();(0,T.errorHandle)(r==="div",`Unsupported container element type, only support 'div' but got '${r}'`),(0,T.errorHandle)(g.instances.every(u=>u.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=A.id,this.$original=this.$container.cloneNode(!0),s.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.5.4</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(A){return(0,T.query)(A,this.$container)}desktop(){const{option:A}=this.art;A.useSSR||(this.$container.innerHTML=p.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),A.backdrop&&((0,T.addClass)(this.$setting,"art-backdrop-filter"),(0,T.addClass)(this.$contextmenu,"art-backdrop-filter"),(0,T.addClass)(this.$info,"art-backdrop-filter")),T.isMobile&&(0,T.addClass)(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(A){A?(0,T.replaceElement)(this.$original,this.$container):(0,T.addClass)(this.$player,"art-destroy")}}y.default=p},{"./utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"3mM4M":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils"),m=M("./zh-cn.json"),A=T.interopDefault(m),_=M("./zh-tw.json"),g=T.interopDefault(_),s=M("./pl.json"),r=T.interopDefault(s),u=M("./cs.json"),a=T.interopDefault(u);y.default=class{constructor(d){this.art=d,this.languages={"zh-cn":A.default,"zh-tw":g.default,pl:r.default,cs:a.default},this.init()}init(){const d=this.art.option.lang.toLowerCase();this.language=this.languages[d]||{}}get(d){return this.language[d]||d}update(d){this.languages=(0,p.mergeDeep)(this.languages,d),this.init()}}},{"../utils":"5yYFo","./zh-cn.json":"1f1tr","./zh-tw.json":"3hy9S","./pl.json":"aFOXc","./cs.json":"aNfUP","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"1f1tr":[function(M,C,y){C.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F6C\u64AD\u653E","AirPlay":"\u9694\u7A7A\u64AD\u653E","AirPlay Not Available":"\u9694\u7A7A\u64AD\u653E\u4E0D\u53EF\u7528"}')},{}],"3hy9S":[function(M,C,y){C.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F49\u64AD\u653E","AirPlay":"\u9694\u7A7A\u64AD\u653E","AirPlay Not Available":"\u9694\u7A7A\u64AD\u653E\u4E0D\u53EF\u7528"}')},{}],aFOXc:[function(M,C,y){C.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Last Seen":"Ostatnio widziany","Jump Play":"Skocz do gry","AirPlay":"AirPlay","AirPlay Not Available":"AirPlay nie jest dost\u0119pny"}')},{}],aNfUP:[function(M,C,y){C.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Last Seen":"Naposledy vid\u011Bn","Jump Play":"Hra na skok","AirPlay":"AirPlay","AirPlay Not Available":"AirPlay nen\xED k dispozici"}')},{}],bCaa0:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./urlMix"),m=T.interopDefault(p),A=M("./attrMix"),_=T.interopDefault(A),g=M("./playMix"),s=T.interopDefault(g),r=M("./pauseMix"),u=T.interopDefault(r),a=M("./toggleMix"),d=T.interopDefault(a),c=M("./seekMix"),h=T.interopDefault(c),t=M("./volumeMix"),e=T.interopDefault(t),n=M("./currentTimeMix"),i=T.interopDefault(n),f=M("./durationMix"),l=T.interopDefault(f),o=M("./switchMix"),v=T.interopDefault(o),D=M("./playbackRateMix"),S=T.interopDefault(D),E=M("./aspectRatioMix"),L=T.interopDefault(E),x=M("./screenshotMix"),b=T.interopDefault(x),O=M("./fullscreenMix"),R=T.interopDefault(O),I=M("./fullscreenWebMix"),P=T.interopDefault(I),F=M("./pipMix"),w=T.interopDefault(F),k=M("./loadedMix"),B=T.interopDefault(k),U=M("./playedMix"),j=T.interopDefault(U),N=M("./playingMix"),K=T.interopDefault(N),H=M("./autoSizeMix"),$=T.interopDefault(H),G=M("./rectMix"),ee=T.interopDefault(G),X=M("./flipMix"),V=T.interopDefault(X),J=M("./miniMix"),Q=T.interopDefault(J),ie=M("./loopMix"),ae=T.interopDefault(ie),se=M("./posterMix"),le=T.interopDefault(se),ue=M("./autoHeightMix"),q=T.interopDefault(ue),oe=M("./themeMix"),de=T.interopDefault(oe),ce=M("./titleMix"),pe=T.interopDefault(ce),he=M("./normalSizeMix"),ye=T.interopDefault(he),fe=M("./subtitleOffsetMix"),me=T.interopDefault(fe),W=M("./airplayMix"),z=T.interopDefault(W),Y=M("./optionInit"),Z=T.interopDefault(Y),re=M("./eventInit"),ne=T.interopDefault(re);y.default=class{constructor(te){(0,m.default)(te),(0,_.default)(te),(0,s.default)(te),(0,u.default)(te),(0,d.default)(te),(0,h.default)(te),(0,e.default)(te),(0,i.default)(te),(0,l.default)(te),(0,v.default)(te),(0,S.default)(te),(0,L.default)(te),(0,b.default)(te),(0,R.default)(te),(0,P.default)(te),(0,w.default)(te),(0,B.default)(te),(0,j.default)(te),(0,K.default)(te),(0,$.default)(te),(0,ee.default)(te),(0,V.default)(te),(0,Q.default)(te),(0,ae.default)(te),(0,le.default)(te),(0,q.default)(te),(0,de.default)(te),(0,pe.default)(te),(0,ye.default)(te),(0,me.default)(te),(0,z.default)(te),(0,ne.default)(te),(0,Z.default)(te)}}},{"./urlMix":"9mMBB","./attrMix":"ghisN","./playMix":"l5N6R","./pauseMix":"fVR5i","./toggleMix":"cZiBO","./seekMix":"bsO1Q","./volumeMix":"ivSmC","./currentTimeMix":"8LbXb","./durationMix":"f7tNT","./switchMix":"ejQWi","./playbackRateMix":"kNcxE","./aspectRatioMix":"8v5yt","./screenshotMix":"eLUEv","./fullscreenMix":"ifvhR","./fullscreenWebMix":"dsFtO","./pipMix":"gYMLD","./loadedMix":"fMSRd","./playedMix":"iRHNE","./playingMix":"dQ40z","./autoSizeMix":"iF844","./rectMix":"1hAm8","./flipMix":"dhi4g","./miniMix":"eQPx9","./loopMix":"gQaVE","./posterMix":"7n9Pt","./autoHeightMix":"8Az1F","./themeMix":"kXlsI","./titleMix":"b8f4Q","./normalSizeMix":"4fP62","./subtitleOffsetMix":"gdNfa","./airplayMix":"bDxGv","./optionInit":"luxZi","./eventInit":"b25aJ","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"9mMBB":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,template:{$video:A}}=p;(0,T.def)(p,"url",{get:()=>A.currentSrc,async set(_){if(_){const g=m.type||(0,T.getExt)(_),s=m.customType[g];g&&s?(await(0,T.sleep)(),p.loading.show=!0,s.call(p,A,_,p)):(p.url&&p.url!==_&&p.once("video:canplay",()=>{p.isReady&&p.emit("restart")}),A.src=_,p.option.url=_,p.emit("url",_))}else await(0,T.sleep)(),p.loading.show=!0}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ghisN:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$video:m}}=p;(0,T.def)(p,"attr",{value(A,_){if(_===void 0)return m[A];m[A]=_}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],l5N6R:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,notice:A,option:_,constructor:{instances:g},template:{$video:s}}=p;(0,T.def)(p,"play",{value:async function(){const r=await s.play();if(A.show=m.get("Play"),p.emit("play"),_.mutex)for(let u=0;u<g.length;u++){const a=g[u];a!==p&&a.pause()}return r}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],fVR5i:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$video:m},i18n:A,notice:_}=p;(0,T.def)(p,"pause",{value(){const g=m.pause();return _.show=A.get("Pause"),p.emit("pause"),g}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],cZiBO:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){(0,T.def)(p,"toggle",{value:()=>p.playing?p.pause():p.play()})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bsO1Q:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{notice:m}=p;(0,T.def)(p,"seek",{set(A){p.currentTime=A,p.emit("seek",p.currentTime),p.duration&&(m.show=`${(0,T.secondToTime)(p.currentTime)} / ${(0,T.secondToTime)(p.duration)}`)}}),(0,T.def)(p,"forward",{set(A){p.seek=p.currentTime+A}}),(0,T.def)(p,"backward",{set(A){p.seek=p.currentTime-A}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ivSmC:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$video:m},i18n:A,notice:_,storage:g}=p;(0,T.def)(p,"volume",{get:()=>m.volume||0,set:s=>{m.volume=(0,T.clamp)(s,0,1),_.show=`${A.get("Volume")}: ${parseInt(100*m.volume,10)}`,m.volume!==0&&g.set("volume",m.volume),p.emit("volume",m.volume)}}),(0,T.def)(p,"muted",{get:()=>m.muted,set:s=>{m.muted=s,p.emit("volume",m.volume)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"8LbXb":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{$video:m}=p.template;(0,T.def)(p,"currentTime",{get:()=>m.currentTime||0,set:A=>{A=parseFloat(A),Number.isNaN(A)||(m.currentTime=(0,T.clamp)(A,0,p.duration))}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],f7tNT:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){(0,T.def)(p,"duration",{get:()=>{const{duration:m}=p.template.$video;return m===1/0?0:m||0}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ejQWi:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,option:A,notice:_}=p;function g(s,r,u){return new Promise(a=>{if(s===p.url)return a(s);const{playing:d}=p;p.pause(),URL.revokeObjectURL(p.url),p.url=s,p.once("video:canplay",()=>{p.playbackRate=!1,p.aspectRatio=!1,p.flip="normal",p.autoSize=A.autoSize,p.currentTime=u,p.notice.show="",d&&p.play(),r&&(_.show=`${m.get("Switch Video")}: ${r}`),p.emit("switch",s),a(s)})})}(0,T.def)(p,"switchQuality",{value:(s,r)=>g(s,r,p.currentTime)}),(0,T.def)(p,"switchUrl",{value:(s,r)=>g(s,r,0)})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kNcxE:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$video:m},i18n:A,notice:_}=p;(0,T.def)(p,"playbackRate",{get:()=>m.playbackRate,set(g){if(g){if(g===m.playbackRate)return;const s=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];(0,T.errorHandle)(s.includes(g),`'playbackRate' only accept ${s.toString()} as parameters`),m.playbackRate=g,_.show=`${A.get("Rate")}: ${g===1?A.get("Normal"):`${g}x`}`,p.emit("playbackRate",g)}else p.playbackRate=1,p.emit("playbackRate")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"8v5yt":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$video:m,$player:A},i18n:_,notice:g}=p;(0,T.def)(p,"aspectRatio",{get:()=>A.dataset.aspectRatio||"default",set(s){s||(s="default");const r=["default","4:3","16:9"];if((0,T.errorHandle)(r.includes(s),`'aspectRatio' only accept ${r.toString()} as parameters`),s==="default")(0,T.setStyle)(m,"width",null),(0,T.setStyle)(m,"height",null),(0,T.setStyle)(m,"padding",null),delete A.dataset.aspectRatio;else{const u=s.split(":").map(Number),{videoWidth:a,videoHeight:d}=m,{clientWidth:c,clientHeight:h}=A,t=a/d,e=u[0]/u[1];if(t>e){const n=e*d/a;(0,T.setStyle)(m,"width",100*n+"%"),(0,T.setStyle)(m,"height","100%"),(0,T.setStyle)(m,"padding",`0 ${(c-c*n)/2}px`)}else{const n=a/e/d;(0,T.setStyle)(m,"width","100%"),(0,T.setStyle)(m,"height",100*n+"%"),(0,T.setStyle)(m,"padding",(h-h*n)/2+"px 0")}A.dataset.aspectRatio=s}g.show=`${_.get("Aspect Ratio")}: ${s==="default"?_.get("Default"):s}`,p.emit("aspectRatio",s)}}),(0,T.def)(p,"aspectRatioReset",{set(s){if(s){const{aspectRatio:r}=p;p.aspectRatio=r}}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eLUEv:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,notice:A,template:{$video:_}}=p,g=document.createElement("canvas");(0,T.def)(p,"getDataURL",{value:()=>new Promise((s,r)=>{try{g.width=_.videoWidth,g.height=_.videoHeight,g.getContext("2d").drawImage(_,0,0),s(g.toDataURL("image/png"))}catch(u){A.show=u,r(u)}})}),(0,T.def)(p,"getBlobUrl",{value:()=>new Promise((s,r)=>{try{g.width=_.videoWidth,g.height=_.videoHeight,g.getContext("2d").drawImage(_,0,0),g.toBlob(u=>{s(URL.createObjectURL(u))})}catch(u){A.show=u,r(u)}})}),(0,T.def)(p,"screenshot",{value:async()=>{const s=await p.getDataURL();return(0,T.download)(s,`${m.title||"artplayer"}_${(0,T.secondToTime)(_.currentTime)}.png`),p.emit("screenshot",s),s}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ifvhR:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../libs/screenfull"),m=T.interopDefault(p),A=M("../utils");y.default=function(_){const{i18n:g,notice:s,template:{$video:r,$player:u}}=_;_.once("video:loadedmetadata",()=>{var a;m.default.isEnabled?(a=_,m.default.on("change",()=>a.emit("fullscreen",m.default.isFullscreen)),(0,A.def)(a,"fullscreen",{get:()=>m.default.isFullscreen,async set(d){d?(a.normalSize="fullscreen",a.aspectRatioReset=!0,a.autoSize=!1,await m.default.request(u),(0,A.addClass)(u,"art-fullscreen"),a.emit("resize"),a.emit("fullscreen",!0),s.show=""):(a.aspectRatioReset=!0,a.autoSize=a.option.autoSize,await m.default.exit(),(0,A.removeClass)(u,"art-fullscreen"),a.emit("resize"),a.emit("fullscreen"),s.show="")}})):document.fullscreenEnabled||r.webkitSupportsFullscreen?(d=>{(0,A.def)(d,"fullscreen",{get:()=>r.webkitDisplayingFullscreen,set(c){c?(d.normalSize="fullscreen",r.webkitEnterFullscreen(),d.emit("fullscreen",!0),s.show=""):(r.webkitExitFullscreen(),d.emit("fullscreen"),s.show="")}})})(_):(0,A.def)(_,"fullscreen",{get:()=>!1,set(){s.show=g.get("Fullscreen Not Supported")}}),(0,A.def)(_,"fullscreen",(0,A.get)(_,"fullscreen"))})}},{"../libs/screenfull":"dXDKn","../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],dXDKn:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);const T=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],p=(()=>{if(typeof document>"u")return!1;const _=T[0],g={};for(const s of T)if(s[1]in document){for(const[r,u]of s.entries())g[_[r]]=u;return g}return!1})(),m={change:p.fullscreenchange,error:p.fullscreenerror};let A={request:(_=document.documentElement,g)=>new Promise((s,r)=>{const u=()=>{A.off("change",u),s()};A.on("change",u);const a=_[p.requestFullscreen](g);a instanceof Promise&&a.then(u).catch(r)}),exit:()=>new Promise((_,g)=>{if(!A.isFullscreen)return void _();const s=()=>{A.off("change",s),_()};A.on("change",s);const r=document[p.exitFullscreen]();r instanceof Promise&&r.then(s).catch(g)}),toggle:(_,g)=>A.isFullscreen?A.exit():A.request(_,g),onchange(_){A.on("change",_)},onerror(_){A.on("error",_)},on(_,g){const s=m[_];s&&document.addEventListener(s,g,!1)},off(_,g){const s=m[_];s&&document.removeEventListener(s,g,!1)},raw:p};Object.defineProperties(A,{isFullscreen:{get:()=>Boolean(document[p.fullscreenElement])},element:{enumerable:!0,get:()=>document[p.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[p.fullscreenEnabled])}}),p||(A={isEnabled:!1}),y.default=A},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],dsFtO:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{notice:m,template:{$player:A}}=p;(0,T.def)(p,"fullscreenWeb",{get:()=>(0,T.hasClass)(A,"art-fullscreen-web"),set(_){_?(p.normalSize="fullscreenWeb",(0,T.addClass)(A,"art-fullscreen-web"),p.aspectRatioReset=!0,p.autoSize=!1,p.emit("resize"),p.emit("fullscreenWeb",!0),m.show=""):((0,T.removeClass)(A,"art-fullscreen-web"),p.aspectRatioReset=!0,p.autoSize=p.option.autoSize,p.emit("resize"),p.emit("fullscreenWeb"),m.show="")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],gYMLD:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,notice:A,template:{$video:_}}=p;document.pictureInPictureEnabled?function(g){const{template:{$video:s},events:{proxy:r},notice:u}=g;s.disablePictureInPicture=!1,(0,T.def)(g,"pip",{get:()=>document.pictureInPictureElement,set(a){a?(g.normalSize="pip",s.requestPictureInPicture().catch(d=>{throw u.show=d,d})):document.exitPictureInPicture().catch(d=>{throw u.show=d,d})}}),r(s,"enterpictureinpicture",()=>{g.emit("pip",!0)}),r(s,"leavepictureinpicture",()=>{g.emit("pip")})}(p):_.webkitSupportsPresentationMode?function(g){const{$video:s}=g.template;s.webkitSetPresentationMode("inline"),(0,T.def)(g,"pip",{get:()=>s.webkitPresentationMode==="picture-in-picture",set(r){r?(g.normalSize="pip",s.webkitSetPresentationMode("picture-in-picture"),g.emit("pip",!0)):(s.webkitSetPresentationMode("inline"),g.emit("pip"))}})}(p):(0,T.def)(p,"pip",{get:()=>!1,set(){A.show=m.get("PIP Not Supported")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],fMSRd:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{$video:m}=p.template;(0,T.def)(p,"loaded",{get:()=>p.loadedTime/m.duration}),(0,T.def)(p,"loadedTime",{get:()=>m.buffered.length?m.buffered.end(m.buffered.length-1):0})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],iRHNE:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){(0,T.def)(p,"played",{get:()=>p.currentTime/p.duration})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],dQ40z:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{$video:m}=p.template;(0,T.def)(p,"playing",{get:()=>m.currentTime>0&&!m.paused&&!m.ended&&m.readyState>2})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],iF844:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{$container:m,$player:A,$video:_}=p.template;(0,T.def)(p,"autoSize",{get:()=>(0,T.hasClass)(m,"art-auto-size"),set(g){if(g){const{videoWidth:s,videoHeight:r}=_,{width:u,height:a}=m.getBoundingClientRect(),d=s/r,c=u/a;if((0,T.addClass)(m,"art-auto-size"),c>d){const h=a*d/u*100;(0,T.setStyle)(A,"width",`${h}%`),(0,T.setStyle)(A,"height","100%")}else{const h=u/d/a*100;(0,T.setStyle)(A,"width","100%"),(0,T.setStyle)(A,"height",`${h}%`)}p.emit("autoSize",{width:p.width,height:p.height})}else(0,T.removeClass)(m,"art-auto-size"),(0,T.setStyle)(A,"width",null),(0,T.setStyle)(A,"height",null),p.emit("autoSize")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"1hAm8":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){(0,T.def)(p,"rect",{get:()=>p.template.$player.getBoundingClientRect()});const m=["bottom","height","left","right","top","width"];for(let A=0;A<m.length;A++){const _=m[A];(0,T.def)(p,_,{get:()=>p.rect[_]})}(0,T.def)(p,"x",{get:()=>p.left+window.pageXOffset}),(0,T.def)(p,"y",{get:()=>p.top+window.pageYOffset})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],dhi4g:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{template:{$player:m},i18n:A,notice:_}=p;(0,T.def)(p,"flip",{get:()=>m.dataset.flip||"normal",set(g){g||(g="normal");const s=["normal","horizontal","vertical"];(0,T.errorHandle)(s.includes(g),`'flip' only accept ${s.toString()} as parameters`),g==="normal"?delete m.dataset.flip:m.dataset.flip=g;const r=g.replace(g[0],g[0].toUpperCase());_.show=`${A.get("Video Flip")}: ${A.get(r)}`,p.emit("flip",g)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eQPx9:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,option:A,storage:_,events:{proxy:g},template:{$player:s,$miniClose:r,$miniTitle:u,$miniHeader:a}}=p;let d=!1,c=0,h=0,t=0,e=0;g(a,"mousedown",n=>{d=!0,c=n.pageX,h=n.pageY,t=p.left,e=p.top}),g(document,"mousemove",n=>{if(d){(0,T.addClass)(s,"art-is-dragging");const i=e+n.pageY-h,f=t+n.pageX-c;(0,T.setStyle)(s,"top",`${i}px`),(0,T.setStyle)(s,"left",`${f}px`),_.set("top",i),_.set("left",f)}}),g(document,"mouseup",()=>{d=!1,(0,T.removeClass)(s,"art-is-dragging")}),g(r,"click",()=>{p.mini=!1,d=!1,(0,T.removeClass)(s,"art-is-dragging")}),(0,T.append)(u,A.title||m.get("Mini Player")),(0,T.def)(p,"mini",{get:()=>(0,T.hasClass)(s,"art-mini"),set(n){if(n){p.normalSize="mini",p.autoSize=!1,(0,T.addClass)(s,"art-mini");const i=_.get("top"),f=_.get("left");if(i&&f)(0,T.setStyle)(s,"top",`${i}px`),(0,T.setStyle)(s,"left",`${f}px`),(0,T.isInViewport)(a)||(_.del("top"),_.del("left"),p.mini=!0);else{const l=window.innerHeight-p.height-50,o=window.innerWidth-p.width-50;_.set("top",l),_.set("left",o),(0,T.setStyle)(s,"top",`${l}px`),(0,T.setStyle)(s,"left",`${o}px`)}p.aspectRatio=!1,p.playbackRate=!1,p.notice.show="",p.emit("mini",!0)}else(0,T.removeClass)(s,"art-mini"),(0,T.setStyle)(s,"top",null),(0,T.setStyle)(s,"left",null),p.aspectRatio=!1,p.playbackRate=!1,p.autoSize=A.autoSize,p.notice.show="",p.emit("mini")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],gQaVE:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){let m=[];(0,T.def)(p,"loop",{get:()=>m,set:A=>{if(Array.isArray(A)&&typeof A[0]=="number"&&typeof A[1]=="number"){const _=(0,T.clamp)(A[0],0,Math.min(A[1],p.duration)),g=(0,T.clamp)(A[1],_,p.duration);g-_>=1?(m=[_,g],p.emit("loop",m)):(m=[],p.emit("loop"))}else m=[],p.emit("loop")}}),p.on("video:timeupdate",()=>{m.length&&(p.currentTime<m[0]||p.currentTime>m[1])&&(p.seek=m[0])})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"7n9Pt":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,template:{$poster:A}}=p;(0,T.def)(p,"poster",{get:()=>m.poster,set(_){m.poster=_,(0,T.setStyle)(A,"backgroundImage",`url(${_})`)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"8Az1F":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,template:{$container:A,$video:_}}=p,g=A.style.height;(0,T.def)(p,"autoHeight",{get:()=>(0,T.hasClass)(A,"art-auto-height"),set(s){if(s){const{clientWidth:r}=A,{videoHeight:u,videoWidth:a}=_,d=u*(r/a);(0,T.setStyle)(A,"height",d+"px"),(0,T.addClass)(A,"art-auto-height"),p.autoSize=m.autoSize,p.emit("autoHeight",d)}else(0,T.setStyle)(A,"height",g),(0,T.removeClass)(A,"art-auto-height"),p.autoSize=m.autoSize,p.emit("autoHeight")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kXlsI:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,template:{$player:A}}=p;(0,T.def)(p,"theme",{get:()=>getComputedStyle(A).getPropertyValue("--theme"),set(_){m.theme=_,A.style.setProperty("--theme",_)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],b8f4Q:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){(0,T.def)(p,"title",{get:()=>p.option.title,set(m){p.option.title=m}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"4fP62":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const m=["mini","pip","fullscreen","fullscreenWeb"];(0,T.def)(p,"normalSize",{get:()=>m.every(A=>!p[A]),set(A){m.filter(_=>_!==A).forEach(_=>{p[_]&&(p[_]=!1)})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],gdNfa:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{clamp:m}=p.constructor.utils,{notice:A,template:_,i18n:g}=p;let s=0,r=[];p.on("subtitle:switch",()=>{r=[]}),(0,T.def)(p,"subtitleOffset",{get:()=>s,set(u){if(_.$track&&_.$track.track){const a=Array.from(_.$track.track.cues);s=m(u,-5,5);for(let d=0;d<a.length;d++){const c=a[d];r[d]||(r[d]={startTime:c.startTime,endTime:c.endTime}),c.startTime=m(r[d].startTime+s,0,p.duration),c.endTime=m(r[d].endTime+s,0,p.duration)}p.subtitle.update(),A.show=`${g.get("Subtitle Offset")}: ${u}s`,p.emit("subtitleOffset",u)}else p.emit("subtitleOffset",0)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bDxGv:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,notice:A,events:{proxy:_},template:{$video:g}}=p;let s=!0;window.WebKitPlaybackTargetAvailabilityEvent&&g.webkitShowPlaybackTargetPicker?_(g,"webkitplaybacktargetavailabilitychanged",r=>{switch(r.availability){case"available":s=!0;break;case"not-available":s=!1}}):s=!1,(0,T.def)(p,"airplay",{value(){s?(g.webkitShowPlaybackTargetPicker(),p.emit("airplay")):A.show=m.get("AirPlay Not Available")}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],luxZi:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,storage:A,template:{$video:_,$poster:g}}=p;Object.keys(m.moreVideoAttr).forEach(r=>{p.attr(r,m.moreVideoAttr[r])}),m.muted&&(p.muted=m.muted),m.volume&&(_.volume=(0,T.clamp)(m.volume,0,1));const s=A.get("volume");typeof s=="number"&&(_.volume=(0,T.clamp)(s,0,1)),m.poster&&(0,T.setStyle)(g,"backgroundImage",`url(${m.poster})`),m.autoplay&&(_.autoplay=m.autoplay),m.playsInline&&(_.playsInline=!0,_["webkit-playsinline"]=!0),m.theme&&(p.theme=m.theme),p.url=m.url}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],b25aJ:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../config"),m=T.interopDefault(p),A=M("../utils");y.default=function(_){const{i18n:g,notice:s,option:r,constructor:u,events:{proxy:a},template:{$player:d,$video:c,$poster:h}}=_;let t=0;for(let e=0;e<m.default.events.length;e++)a(c,m.default.events[e],n=>{_.emit(`video:${n.type}`,n)});_.on("video:canplay",()=>{t=0,_.loading.show=!1}),_.once("video:canplay",()=>{_.loading.show=!1,_.controls.show=!0,_.mask.show=!0,_.isReady=!0,_.emit("ready")}),_.on("video:ended",()=>{r.loop?(_.seek=0,_.play(),_.controls.show=!1,_.mask.show=!1):(_.controls.show=!0,_.mask.show=!0)}),_.on("video:error",async()=>{t<u.RECONNECT_TIME_MAX?(await(0,A.sleep)(u.RECONNECT_SLEEP_TIME),t+=1,_.url=r.url,s.show=`${g.get("Reconnect")}: ${t}`,_.emit("error",t)):(_.mask.show=!0,_.loading.show=!1,_.controls.show=!0,(0,A.addClass)(d,"art-error"),await(0,A.sleep)(u.RECONNECT_SLEEP_TIME),s.show=g.get("Video Load Failed"),_.destroy(!1))}),_.on("video:loadedmetadata",()=>{_.autoSize=r.autoSize,A.isMobile&&(_.loading.show=!1,_.controls.show=!0,_.mask.show=!0)}),_.on("video:loadstart",()=>{_.loading.show=!0,_.mask.show=!1,_.controls.show=!0}),_.on("video:pause",()=>{_.controls.show=!0,_.mask.show=!0}),_.on("video:play",()=>{_.mask.show=!1,(0,A.setStyle)(h,"display","none")}),_.on("video:playing",()=>{_.mask.show=!1}),_.on("video:seeked",()=>{_.loading.show=!1}),_.on("video:seeking",()=>{_.loading.show=!0,_.mask.show=!1}),_.on("video:timeupdate",()=>{_.mask.show=!1}),_.on("video:waiting",()=>{_.loading.show=!0,_.mask.show=!1})}},{"../config":"ej4fZ","../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"3qXcr":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils"),m=M("../utils/component"),A=T.interopDefault(m),_=M("./fullscreen"),g=T.interopDefault(_),s=M("./fullscreenWeb"),r=T.interopDefault(s),u=M("./pip"),a=T.interopDefault(u),d=M("./playAndPause"),c=T.interopDefault(d),h=M("./progress"),t=T.interopDefault(h),e=M("./time"),n=T.interopDefault(e),i=M("./volume"),f=T.interopDefault(i),l=M("./setting"),o=T.interopDefault(l),v=M("./thumbnails"),D=T.interopDefault(v),S=M("./screenshot"),E=T.interopDefault(S),L=M("./quality"),x=T.interopDefault(L),b=M("./loop"),O=T.interopDefault(b),R=M("./airplay"),I=T.interopDefault(R);class P extends A.default{constructor(w){super(w),this.name="control";const{constructor:k,events:{proxy:B},template:{$player:U}}=w;let j=Date.now();B(U,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,(0,p.removeClass)(U,"art-hide-cursor"),(0,p.addClass)(U,"art-hover"),j=Date.now()}),w.on("video:timeupdate",()=>{!w.isInput&&w.playing&&this.show&&Date.now()-j>=k.CONTROL_HIDE_TIME&&(this.show=!1,(0,p.addClass)(U,"art-hide-cursor"),(0,p.removeClass)(U,"art-hover"))}),this.init()}init(){const{option:w}=this.art;w.isLive||this.add((0,t.default)({name:"progress",position:"top",index:10})),!w.thumbnails.url||w.isLive||p.isMobile||this.add((0,D.default)({name:"thumbnails",position:"top",index:20})),this.add((0,O.default)({name:"loop",position:"top",index:30})),this.add((0,c.default)({name:"playAndPause",position:"left",index:10})),this.add((0,f.default)({name:"volume",position:"left",index:20})),w.isLive||this.add((0,n.default)({name:"time",position:"left",index:30})),w.quality.length&&this.add((0,x.default)({name:"quality",position:"right",index:10})),w.screenshot&&!p.isMobile&&this.add((0,E.default)({name:"screenshot",position:"right",index:20})),w.setting&&this.add((0,o.default)({name:"setting",position:"right",index:30})),w.pip&&this.add((0,a.default)({name:"pip",position:"right",index:40})),w.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,I.default)({name:"airplay",position:"right",index:50})),w.fullscreenWeb&&this.add((0,r.default)({name:"fullscreenWeb",position:"right",index:60})),w.fullscreen&&this.add((0,g.default)({name:"fullscreen",position:"right",index:70}));for(let k=0;k<w.controls.length;k++)this.add(w.controls[k])}add(w){const k=typeof w=="function"?w(this.art):w,{$progress:B,$controlsLeft:U,$controlsRight:j}=this.art.template;switch(k.position){case"top":this.$parent=B;break;case"left":this.$parent=U;break;case"right":this.$parent=j;break;default:(0,p.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(k)}}y.default=P},{"../utils":"5yYFo","../utils/component":"5MLcx","./fullscreen":"43BKT","./fullscreenWeb":"kQJHz","./pip":"aWne0","./playAndPause":"4z78f","./progress":"19nwD","./time":"lh90q","./volume":"hsA6A","./setting":"4rv3i","./thumbnails":"lTgvI","./screenshot":"71GuX","./quality":"f9VNW","./loop":"d1O2Q","./airplay":"aIzPt","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"5MLcx":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./dom"),m=M("option-validator"),A=T.interopDefault(m),_=M("../scheme"),g=M("./property"),s=M("./error");y.default=class{constructor(r){this.id=0,this.art=r,this.add=this.add.bind(this)}get show(){return(0,p.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(r){const{$player:u}=this.art.template,a=`art-${this.name}-show`;r?(0,p.addClass)(u,a):(0,p.removeClass)(u,a),this.art.emit(this.name,r)}set toggle(r){r&&(this.show=!this.show)}add(r){const u=typeof r=="function"?r(this.art):r;if(u.html=u.html||"",(0,A.default)(u,_.ComponentOption),!this.$parent||!this.name||u.disable)return;const a=u.name||`${this.name}${this.id}`;(0,s.errorHandle)(!(0,g.has)(this,a),`Cannot add an existing name [${a}] to the [${this.name}]`),this.id+=1;const d=document.createElement("div");(0,p.addClass)(d,`art-${this.name}`),(0,p.addClass)(d,`art-${this.name}-${a}`);const c=Array.from(this.$parent.children);d.dataset.index=u.index||this.id;const h=c.find(t=>Number(t.dataset.index)>=Number(d.dataset.index));return h?h.insertAdjacentElement("beforebegin",d):(0,p.append)(this.$parent,d),u.html&&(0,p.append)(d,u.html),u.style&&(0,p.setStyles)(d,u.style),u.tooltip&&(0,p.tooltip)(d,u.tooltip),u.click&&this.art.events.proxy(d,"click",t=>{t.preventDefault(),u.click.call(this.art,this,t)}),u.selector&&["left","right"].includes(u.position)&&this.selector(u,d),u.mounted&&u.mounted.call(this.art,d),d.childNodes.length===1&&d.childNodes[0].nodeType===3&&(0,p.addClass)(d,"art-control-onlyText"),(0,g.def)(this,a,{value:d}),d}selector(r,u){const{hover:a,proxy:d}=this.art.events;(0,p.addClass)(u,"art-control-selector");const c=document.createElement("div");(0,p.addClass)(c,"art-selector-value"),(0,p.append)(c,r.html),u.innerText="",(0,p.append)(u,c);const h=r.selector.map((n,i)=>`<div class="art-selector-item ${n.default?"art-current":""}" data-index="${i}">${n.html}</div>`).join(""),t=document.createElement("div");(0,p.addClass)(t,"art-selector-list"),(0,p.append)(t,h),(0,p.append)(u,t);const e=()=>{const n=(0,p.getStyle)(u,"width")/2-(0,p.getStyle)(t,"width")/2;t.style.left=`${n}px`};a(u,e),d(t,"click",async n=>{const i=(n.composedPath()||[]).find(o=>(0,p.hasClass)(o,"art-selector-item"));if(!i)return;(0,p.inverseClass)(i,"art-current");const f=Number(i.dataset.index),l=r.selector[f]||{};if(c.innerText=i.innerText,r.onSelect){const o=await r.onSelect.call(this.art,l,i,n);typeof o!="string"&&typeof o!="number"||(c.innerHTML=o)}e(),this.art.emit("selector",l,i)})}}},{"./dom":"fqaW9","option-validator":"eaJBf","../scheme":"3izFE","./property":"5ynPA","./error":"kNZvP","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"43BKT":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("Fullscreen"),mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m,r=(0,T.append)(A,g.fullscreenOn),u=(0,T.append)(A,g.fullscreenOff);(0,T.setStyle)(u,"display","none"),_(A,"click",()=>{m.fullscreen=!m.fullscreen}),m.on("fullscreen",a=>{a?((0,T.tooltip)(A,s.get("Exit Fullscreen")),(0,T.setStyle)(r,"display","none"),(0,T.setStyle)(u,"display","inline-flex")):((0,T.tooltip)(A,s.get("Fullscreen")),(0,T.setStyle)(r,"display","inline-flex"),(0,T.setStyle)(u,"display","none"))})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kQJHz:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("Web Fullscreen"),mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m,r=(0,T.append)(A,g.fullscreenWebOn),u=(0,T.append)(A,g.fullscreenWebOff);(0,T.setStyle)(u,"display","none"),_(A,"click",()=>{m.fullscreenWeb=!m.fullscreenWeb}),m.on("fullscreenWeb",a=>{a?((0,T.tooltip)(A,s.get("Exit Web Fullscreen")),(0,T.setStyle)(r,"display","none"),(0,T.setStyle)(u,"display","inline-flex")):((0,T.tooltip)(A,s.get("Web Fullscreen")),(0,T.setStyle)(r,"display","inline-flex"),(0,T.setStyle)(u,"display","none"))})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],aWne0:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("PIP Mode"),mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m;(0,T.append)(A,g.pip),_(A,"click",()=>{m.pip=!m.pip}),m.on("pip",r=>{(0,T.tooltip)(A,s.get(r?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"4z78f":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m,r=(0,T.append)(A,g.play),u=(0,T.append)(A,g.pause);function a(){(0,T.setStyle)(r,"display","flex"),(0,T.setStyle)(u,"display","none")}function d(){(0,T.setStyle)(r,"display","none"),(0,T.setStyle)(u,"display","flex")}(0,T.tooltip)(r,s.get("Play")),(0,T.tooltip)(u,s.get("Pause")),_(r,"click",()=>{m.play()}),_(u,"click",()=>{m.pause()}),m.playing?d():a(),m.on("video:playing",()=>{d()}),m.on("video:pause",()=>{a()})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"19nwD":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y),T.export(y,"getPosFromEvent",()=>m);var p=M("../utils");function m(A,_){const{$progress:g}=A.template,{left:s}=g.getBoundingClientRect(),r=_.pageX,u=(0,p.clamp)(r-s,0,g.clientWidth),a=u/g.clientWidth*A.duration;return{second:a,time:(0,p.secondToTime)(a),width:u,percentage:(0,p.clamp)(u/g.clientWidth,0,1)}}y.default=function(A){return _=>{const{icons:g,option:s,events:{proxy:r}}=_;return{...A,html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:u=>{let a=!1;const d=(0,p.query)(".art-progress-loaded",u),c=(0,p.query)(".art-progress-played",u),h=(0,p.query)(".art-progress-highlight",u),t=(0,p.query)(".art-progress-indicator",u),e=(0,p.query)(".art-progress-tip",u);(0,p.setStyle)(c,"backgroundColor","var(--theme)");let n=_.constructor.INDICATOR_SIZE;function i(f,l){f==="loaded"&&(0,p.setStyle)(d,"width",100*l+"%"),f==="played"&&((0,p.setStyle)(c,"width",100*l+"%"),(0,p.setStyle)(t,"left",`calc(${100*l}% - ${n/2}px)`))}g.indicator?(n=_.constructor.INDICATOR_SIZE_ICON,(0,p.append)(t,g.indicator)):(0,p.setStyles)(t,{backgroundColor:"var(--theme)"}),p.isMobile&&(n=_.constructor.INDICATOR_SIZE_MOBILE,g.indicator&&(n=_.constructor.INDICATOR_SIZE_MOBILE_ICON)),(0,p.setStyles)(t,{left:`-${n/2}px`,width:`${n}px`,height:`${n}px`}),_.on("video:loadedmetadata",()=>{for(let f=0;f<s.highlight.length;f++){const l=s.highlight[f],o=(0,p.clamp)(l.time,0,_.duration)/_.duration*100;(0,p.append)(h,`<span data-text="${l.text}" data-time="${l.time}" style="left: ${o}%"></span>`)}}),i("loaded",_.loaded),_.on("setBar",(f,l)=>{i(f,l)}),_.on("video:progress",()=>{i("loaded",_.loaded)}),_.on("video:timeupdate",()=>{i("played",_.played)}),_.on("video:ended",()=>{i("played",1)}),p.isMobile||(r(u,"click",f=>{if(f.target!==t){const{second:l,percentage:o}=m(_,f);i("played",o),_.seek=l}}),r(u,"mousemove",f=>{(0,p.setStyle)(e,"display","block"),(0,p.includeFromEvent)(f,h)?function(l){const{width:o}=m(_,l),{text:v}=l.target.dataset;e.innerHTML=v;const D=e.clientWidth;o<=D/2?(0,p.setStyle)(e,"left",0):o>u.clientWidth-D/2?(0,p.setStyle)(e,"left",u.clientWidth-D+"px"):(0,p.setStyle)(e,"left",o-D/2+"px")}(f):function(l){const{width:o,time:v}=m(_,l);e.innerHTML=v;const D=e.clientWidth;o<=D/2?(0,p.setStyle)(e,"left",0):o>u.clientWidth-D/2?(0,p.setStyle)(e,"left",u.clientWidth-D+"px"):(0,p.setStyle)(e,"left",o-D/2+"px")}(f)}),r(u,"mouseout",()=>{(0,p.setStyle)(e,"display","none")}),r(t,"mousedown",()=>{a=!0}),r(document,"mousemove",f=>{if(a){const{second:l,percentage:o}=m(_,f);i("played",o),_.seek=l}}),r(document,"mouseup",()=>{a&&(a=!1)}))}}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],lh90q:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,style:{cursor:"auto"},mounted:A=>{function _(){const s=`${(0,T.secondToTime)(m.currentTime)} / ${(0,T.secondToTime)(m.duration)}`;s!==A.innerText&&(A.innerText=s)}_();const g=["video:loadedmetadata","video:timeupdate","video:progress"];for(let s=0;s<g.length;s++)m.on(g[s],_)}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],hsA6A:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m;let r=!1;const u=m.constructor.VOLUME_PANEL_WIDTH,a=m.constructor.VOLUME_HANDLE_WIDTH,d=(0,T.append)(A,g.volume),c=(0,T.append)(A,g.volumeClose),h=(0,T.append)(A,'<div class="art-volume-panel"></div>'),t=(0,T.append)(h,'<div class="art-volume-slider-handle"></div>');function e(i){const{left:f}=h.getBoundingClientRect();return(0,T.clamp)(i.pageX-f-a/2,0,u-a/2)/(u-a)}function n(i=.7){if(m.muted||i===0)(0,T.setStyle)(d,"display","none"),(0,T.setStyle)(c,"display","flex"),(0,T.setStyle)(t,"left","0");else{const f=(u-a)*i;(0,T.setStyle)(d,"display","flex"),(0,T.setStyle)(c,"display","none"),(0,T.setStyle)(t,"left",`${f}px`)}}(0,T.tooltip)(d,s.get("Mute")),(0,T.setStyle)(c,"display","none"),T.isMobile&&(0,T.setStyle)(h,"display","none"),n(m.volume),m.on("video:volumechange",()=>{n(m.volume)}),_(d,"click",()=>{m.muted=!0}),_(c,"click",()=>{m.muted=!1}),_(h,"click",i=>{m.muted=!1,m.volume=e(i)}),_(t,"mousedown",()=>{r=!0}),_(A,"mousemove",i=>{r&&(m.muted=!1,m.volume=e(i))}),_(document,"mouseup",()=>{r&&(r=!1)})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"4rv3i":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("Show Setting"),mounted:A=>{const{events:{proxy:_},icons:g,i18n:s}=m;(0,T.append)(A,g.setting),_(A,"click",()=>{m.setting.toggle=!0}),m.on("setting",r=>{(0,T.tooltip)(A,s.get(r?"Hide Setting":"Show Setting"))})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],lTgvI:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils"),p=M("./progress");y.default=function(m){return A=>({...m,mounted:_=>{const{option:g,template:{$progress:s,$video:r},events:{proxy:u,loadImg:a}}=A;let d=null,c=!1,h=!1;u(s,"mousemove",async t=>{c||(c=!0,d=await a(g.thumbnails.url),h=!0),h&&((0,T.setStyle)(_,"display","block"),function(e){const{width:n}=(0,p.getPosFromEvent)(A,e),{url:i,number:f,column:l,width:o,height:v}=g.thumbnails,D=o||d.naturalWidth/l,S=v||D/(r.videoWidth/r.videoHeight),E=s.clientWidth/f,L=Math.floor(n/E),x=Math.ceil(L/l)-1,b=L%l||l-1;(0,T.setStyle)(_,"backgroundImage",`url(${i})`),(0,T.setStyle)(_,"height",`${S}px`),(0,T.setStyle)(_,"width",`${D}px`),(0,T.setStyle)(_,"backgroundPosition",`-${b*D}px -${x*S}px`),n<=D/2?(0,T.setStyle)(_,"left",0):n>s.clientWidth-D/2?(0,T.setStyle)(_,"left",s.clientWidth-D+"px"):(0,T.setStyle)(_,"left",n-D/2+"px")}(t))}),u(s,"mouseout",()=>{(0,T.setStyle)(_,"display","none")})}})}},{"../utils":"5yYFo","./progress":"19nwD","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"71GuX":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("Screenshot"),mounted:A=>{const{events:{proxy:_},icons:g}=m;(0,T.append)(A,g.screenshot),_(A,"click",()=>{m.screenshot()})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],f9VNW:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T){return p=>{const m=p.option.quality,A=m.find(_=>_.default)||m[0];return{...T,html:A?A.html:"",selector:m,onSelect(_){p.switchQuality(_.url,_.html)}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],d1O2Q:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,mounted:A=>{const _=(0,T.append)(A,'<span class="art-loop-point"></span>'),g=(0,T.append)(A,'<span class="art-loop-point"></span>');m.on("loop",s=>{s?((0,T.setStyle)(A,"display","block"),(0,T.setStyle)(_,"left",`calc(${s[0]/m.duration*100}% - ${_.clientWidth}px)`),(0,T.setStyle)(g,"left",s[1]/m.duration*100+"%")):(0,T.setStyle)(A,"display","none")})}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],aIzPt:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>({...p,tooltip:m.i18n.get("AirPlay"),mounted:A=>{const{events:{proxy:_},icons:g}=m;(0,T.append)(A,g.airplay),_(A,"click",()=>m.airplay())}})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],hTnNz:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils"),m=M("../utils/component"),A=T.interopDefault(m),_=M("./playbackRate"),g=T.interopDefault(_),s=M("./aspectRatio"),r=T.interopDefault(s),u=M("./flip"),a=T.interopDefault(u),d=M("./info"),c=T.interopDefault(d),h=M("./version"),t=T.interopDefault(h),e=M("./close"),n=T.interopDefault(e);class i extends A.default{constructor(l){super(l),this.name="contextmenu",this.$parent=l.template.$contextmenu,p.isMobile||this.init()}init(){const{option:l,template:{$player:o,$contextmenu:v},events:{proxy:D}}=this.art;l.playbackRate&&this.add((0,g.default)({name:"playbackRate",index:10})),l.aspectRatio&&this.add((0,r.default)({name:"aspectRatio",index:20})),l.flip&&this.add((0,a.default)({name:"flip",index:30})),this.add((0,c.default)({name:"info",index:40})),this.add((0,t.default)({name:"version",index:50})),this.add((0,n.default)({name:"close",index:60}));for(let S=0;S<l.contextmenu.length;S++)this.add(l.contextmenu[S]);D(o,"contextmenu",S=>{S.preventDefault(),this.show=!0;const E=S.clientX,L=S.clientY,{height:x,width:b,left:O,top:R}=o.getBoundingClientRect(),{height:I,width:P}=v.getBoundingClientRect();let F=E-O,w=L-R;E+P>O+b&&(F=b-P),L+I>R+x&&(w=x-I),(0,p.setStyles)(v,{top:`${w}px`,left:`${F}px`})}),D(o,"click",S=>{(0,p.includeFromEvent)(S,v)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}y.default=i},{"../utils":"5yYFo","../utils/component":"5MLcx","./playbackRate":"1uTBJ","./aspectRatio":"cFKj0","./flip":"l7S3g","./info":"ihHBb","./version":"3q8wK","./close":"sLP7j","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"1uTBJ":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>{const{i18n:A}=m;return{...p,html:`${A.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${A.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(_,g)=>{const{value:s}=g.target.dataset;s&&(m.playbackRate=Number(s),_.show=!1)},mounted:_=>{m.on("playbackRate",g=>{const s=(0,T.queryAll)("span",_).find(r=>Number(r.dataset.value)===g);s&&(0,T.inverseClass)(s,"art-current")})}}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],cFKj0:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>{const{i18n:A}=m;return{...p,html:`${A.get("Aspect Ratio")}:<span data-value="default" class="art-current">${A.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(_,g)=>{const{value:s}=g.target.dataset;s&&(m.aspectRatio=s,_.show=!1)},mounted:_=>{m.on("aspectRatio",g=>{const s=(0,T.queryAll)("span",_).find(r=>r.dataset.value===g);s&&(0,T.inverseClass)(s,"art-current")})}}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],l7S3g:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){return m=>{const{i18n:A}=m;return{...p,html:`${A.get("Video Flip")}:<span data-value="normal" class="art-current">${A.get("Normal")}</span><span data-value="horizontal">${A.get("Horizontal")}</span><span data-value="vertical">${A.get("Vertical")}</span>`,click:(_,g)=>{const{value:s}=g.target.dataset;s&&(m.flip=s,_.show=!1)},mounted:_=>{m.on("flip",g=>{const s=(0,T.queryAll)("span",_).find(r=>r.dataset.value===g);s&&(0,T.inverseClass)(s,"art-current")})}}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ihHBb:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T){return p=>({...T,html:p.i18n.get("Video Info"),click:m=>{p.info.show=!0,m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"3q8wK":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T){return{...T,html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.5.4</a>'}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],sLP7j:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T){return p=>({...T,html:p.i18n.get("Close"),click:m=>{m.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bfwuE:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./utils"),m=M("./utils/component"),A=T.interopDefault(m);class _ extends A.default{constructor(s){super(s),this.name="info",p.isMobile||this.init()}init(){const{constructor:s,events:{proxy:r},template:{$infoPanel:u,$infoClose:a,$video:d}}=this.art;r(a,"click",()=>{this.show=!1});let c=null;const h=(0,p.queryAll)("[data-video]",u)||[];this.art.on("destroy",()=>{clearTimeout(c)}),function t(){for(let e=0;e<h.length;e++){const n=h[e],i=d[n.dataset.video],f=typeof i=="number"?i.toFixed(2):i;n.innerText!==f&&(n.innerText=f)}c=setTimeout(t,s.INFO_LOOP_TIME)}()}}y.default=_},{"./utils":"5yYFo","./utils/component":"5MLcx","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bWZ2U:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./utils"),m=M("./utils/component"),A=T.interopDefault(m),_=M("option-validator"),g=T.interopDefault(_),s=M("./scheme"),r=T.interopDefault(s);class u extends A.default{constructor(d){super(d),this.name="subtitle",this.init(d.option.subtitle)}get url(){return this.art.template.$track.src}set url(d){this.switch(d)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(d,c){const{$subtitle:h}=this.art.template;return typeof d=="object"?(0,p.setStyles)(h,d):(0,p.setStyle)(h,d,c)}update(){const{$subtitle:d}=this.art.template;d.innerHTML="",this.activeCue&&(d.innerHTML=this.activeCue.text.split(/\r?\n/).map(c=>`<p>${(0,p.escape)(c)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}async switch(d,c={}){const{i18n:h,notice:t,option:e}=this.art,n={...e.subtitle,...c,url:d},i=await this.init(n);return c.name&&(t.show=`${h.get("Switch Subtitle")}: ${c.name}`),i}init(d){if((0,g.default)(d,r.default.subtitle),!d.url)return;const{notice:c,events:{proxy:h},template:{$subtitle:t,$video:e,$track:n}}=this.art;if(!n){const i=document.createElement("track");i.default=!0,i.kind="metadata",e.appendChild(i),this.art.template.$track=i,h(this.textTrack,"cuechange",this.update.bind(this))}return this.style(d.style),(0,p.errorHandle)(window.fetch,"fetch not support"),fetch(d.url).then(i=>i.arrayBuffer()).then(i=>{(0,p.errorHandle)(window.TextDecoder,"TextDecoder not support");const f=new TextDecoder(d.encoding).decode(i);switch(this.art.emit("subtitleLoad",d.url),d.type||(0,p.getExt)(d.url)){case"srt":return(0,p.vttToBlob)((0,p.srtToVtt)(f));case"ass":return(0,p.vttToBlob)((0,p.assToVtt)(f));case"vtt":return(0,p.vttToBlob)(f);default:return d.url}}).then(i=>(t.innerHTML="",this.url===i||(URL.revokeObjectURL(this.url),this.art.template.$track.src=i,this.art.emit("subtitleSwitch",i)),i)).catch(i=>{throw c.show=i,i})}}y.default=u},{"./utils":"5yYFo","./utils/component":"5MLcx","option-validator":"eaJBf","./scheme":"3izFE","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"9oLaG":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils/error"),m=M("./clickInit"),A=T.interopDefault(m),_=M("./hoverInit"),g=T.interopDefault(_),s=M("./mousemoveInit"),r=T.interopDefault(s),u=M("./resizeInit"),a=T.interopDefault(u),d=M("./gestureInit"),c=T.interopDefault(d),h=M("./viewInit"),t=T.interopDefault(h);y.default=class{constructor(e){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),e.whitelist.state&&((0,A.default)(e,this),(0,g.default)(e,this),(0,r.default)(e,this),(0,a.default)(e,this),(0,c.default)(e,this),(0,t.default)(e,this))}proxy(e,n,i,f={}){if(Array.isArray(n))return n.map(o=>this.proxy(e,o,i,f));e.addEventListener(n,i,f);const l=()=>e.removeEventListener(n,i,f);return this.destroyEvents.push(l),l}hover(e,n,i){n&&this.proxy(e,"mouseenter",n),i&&this.proxy(e,"mouseleave",i)}loadImg(e){return new Promise((n,i)=>{let f;if(e instanceof HTMLImageElement)f=e;else{if(typeof e!="string")return i(new p.ArtPlayerError("Unable to get Image"));f=new Image,f.src=e}if(f.complete)return n(f);this.proxy(f,"load",()=>n(f)),this.proxy(f,"error",()=>i(new p.ArtPlayerError(`Failed to load Image: ${f.src}`)))})}destroy(){for(let e=0;e<this.destroyEvents.length;e++)this.destroyEvents[e]()}}},{"../utils/error":"kNZvP","./clickInit":"hrnqi","./hoverInit":"eIqcL","./mousemoveInit":"hEy8X","./resizeInit":"9c8lQ","./gestureInit":"gzHdo","./viewInit":"cJlT5","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],hrnqi:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p,m){const{constructor:A,template:{$player:_,$video:g}}=p;m.proxy(document,["click","contextmenu"],r=>{(0,T.includeFromEvent)(r,_)?(p.isInput=r.target.tagName==="INPUT",p.isFocus=!0,p.emit("focus")):(p.isInput=!1,p.isFocus=!1,p.emit("blur"))});let s=0;m.proxy(g,"click",()=>{const r=Date.now();r-s<=A.DB_CLICE_TIME?(p.emit("dblclick"),T.isMobile?p.isLock||p.toggle():p.fullscreen=!p.fullscreen):(p.emit("click"),T.isMobile||p.toggle()),s=r})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eIqcL:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p,m){const{$player:A}=p.template;m.hover(A,()=>{(0,T.addClass)(A,"art-hover"),p.emit("hover",!0)},()=>{(0,T.removeClass)(A,"art-hover"),p.emit("hover")})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],hEy8X:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T,p){const{$player:m}=T.template;p.proxy(m,"mousemove",A=>{T.emit("mousemove",A)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"9c8lQ":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p,m){const{option:A}=p,_=(0,T.throttle)(()=>{p.normalSize&&(p.autoSize=A.autoSize),p.aspectRatioReset=!0,p.notice.show="",p.emit("resize")},p.constructor.RESIZE_TIME);m.proxy(window,["orientationchange","resize"],()=>{_()}),screen&&screen.orientation&&screen.orientation.onchange&&m.proxy(screen.orientation,"change",()=>{_()})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],gzHdo:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p,m){if(T.isMobile&&!p.option.isLive){const{$video:A,$bottom:_,$controls:g}=p.template;let s=!1,r=0,u=0,a=0;const d=t=>{if(t.touches.length===1&&!p.isLock){s=!0;const{clientX:e,clientY:n}=t.touches[0];r=e,u=n,a=p.currentTime}},c=t=>{if(t.touches.length===1&&s&&p.duration){const e=p.plugins.autoOrientation&&p.plugins.autoOrientation.state,{clientX:n,clientY:i}=t.touches[0],f=(0,T.clamp)((n-r)/p.width,-1,1),l=(0,T.clamp)((i-u)/p.height,-1,1),o=e?l:f,v=(0,T.clamp)(a+p.duration*o*p.constructor.TOUCH_MOVE_RATIO,0,p.duration);p.seek=v,p.emit("setBar","played",(0,T.clamp)(v/p.duration,0,1)),p.notice.show=`${(0,T.secondToTime)(v)} / ${(0,T.secondToTime)(p.duration)}`}},h=()=>{s&&(r=0,u=0,a=0,s=!1)};m.proxy(_,"touchstart",t=>{(0,T.includeFromEvent)(t,g)||d(t)}),m.proxy(_,"touchmove",c),m.proxy(A,"touchstart",d),m.proxy(A,"touchmove",c),m.proxy(document,"touchend",h)}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],cJlT5:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p,m){const{option:A,constructor:_,template:{$container:g}}=p,s=(0,T.throttle)(()=>{p.emit("view",(0,T.isInViewport)(g,_.SCROLL_GAP))},_.SCROLL_TIME);m.proxy(window,"scroll",()=>{s()}),p.on("view",r=>{A.autoMini&&(p.mini=!r)})}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],cKO4X:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("./utils");y.default=class{constructor(p){this.art=p,this.keys={},p.option.hotkey&&!T.isMobile&&this.init()}init(){const{proxy:p}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),p(window,"keydown",m=>{if(this.art.isFocus){const A=document.activeElement.tagName.toUpperCase(),_=document.activeElement.getAttribute("contenteditable");if(A!=="INPUT"&&A!=="TEXTAREA"&&_!==""&&_!=="true"){const g=this.keys[m.keyCode];if(g){m.preventDefault();for(let s=0;s<g.length;s++)g[s].call(this.art,m);this.art.emit("hotkey",m)}}}})}add(p,m){return this.keys[p]?this.keys[p].push(m):this.keys[p]=[m],this}remove(p,m){if(this.keys[p]){const A=this.keys[p].indexOf(m);A!==-1&&this.keys[p].splice(A,1)}return this}}},{"./utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],kZD92:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./utils/component"),m=T.interopDefault(p);class A extends m.default{constructor(g){super(g);const{option:s,template:{$layer:r}}=g;this.name="layer",this.$parent=r;for(let u=0;u<s.layers.length;u++)this.add(s.layers[u])}}y.default=A},{"./utils/component":"5MLcx","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],c9b9e:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./utils"),m=M("./utils/component"),A=T.interopDefault(m);class _ extends A.default{constructor(s){super(s),this.name="loading",(0,p.append)(s.template.$loading,s.icons.loading)}}y.default=_},{"./utils":"5yYFo","./utils/component":"5MLcx","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],SxQeL:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("./utils");y.default=class{constructor(p){this.art=p,this.timer=null}set show(p){const{constructor:m,template:{$player:A,$noticeInner:_}}=this.art;p?(_.innerText=p instanceof Error?p.message.trim():p,(0,T.addClass)(A,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{_.innerText="",(0,T.removeClass)(A,"art-notice-show")},m.NOTICE_TIME)):(0,T.removeClass)(A,"art-notice-show")}}},{"./utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],aJ0dF:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./utils"),m=M("./utils/component"),A=T.interopDefault(m);class _ extends A.default{constructor(s){super(s),this.name="mask";const{template:r,icons:u,events:a}=s,d=(0,p.append)(r.$state,u.state),c=(0,p.append)(r.$state,u.error);(0,p.setStyle)(c,"display","none"),s.on("destroy",()=>{(0,p.setStyle)(d,"display","none"),(0,p.setStyle)(c,"display",null)}),a.proxy(r.$state,"click",()=>s.play())}}y.default=_},{"./utils":"5yYFo","./utils/component":"5MLcx","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],jx1Wu:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils"),m=M("bundle-text:./loading.svg"),A=T.interopDefault(m),_=M("bundle-text:./state.svg"),g=T.interopDefault(_),s=M("bundle-text:./check.svg"),r=T.interopDefault(s),u=M("bundle-text:./play.svg"),a=T.interopDefault(u),d=M("bundle-text:./pause.svg"),c=T.interopDefault(d),h=M("bundle-text:./volume.svg"),t=T.interopDefault(h),e=M("bundle-text:./volume-close.svg"),n=T.interopDefault(e),i=M("bundle-text:./screenshot.svg"),f=T.interopDefault(i),l=M("bundle-text:./setting.svg"),o=T.interopDefault(l),v=M("bundle-text:./arrow-left.svg"),D=T.interopDefault(v),S=M("bundle-text:./arrow-right.svg"),E=T.interopDefault(S),L=M("bundle-text:./playback-rate.svg"),x=T.interopDefault(L),b=M("bundle-text:./aspect-ratio.svg"),O=T.interopDefault(b),R=M("bundle-text:./config.svg"),I=T.interopDefault(R),P=M("bundle-text:./pip.svg"),F=T.interopDefault(P),w=M("bundle-text:./lock.svg"),k=T.interopDefault(w),B=M("bundle-text:./unlock.svg"),U=T.interopDefault(B),j=M("bundle-text:./fullscreen-off.svg"),N=T.interopDefault(j),K=M("bundle-text:./fullscreen-on.svg"),H=T.interopDefault(K),$=M("bundle-text:./fullscreen-web-off.svg"),G=T.interopDefault($),ee=M("bundle-text:./fullscreen-web-on.svg"),X=T.interopDefault(ee),V=M("bundle-text:./switch-on.svg"),J=T.interopDefault(V),Q=M("bundle-text:./switch-off.svg"),ie=T.interopDefault(Q),ae=M("bundle-text:./flip.svg"),se=T.interopDefault(ae),le=M("bundle-text:./error.svg"),ue=T.interopDefault(le),q=M("bundle-text:./close.svg"),oe=T.interopDefault(q),de=M("bundle-text:./airplay.svg"),ce=T.interopDefault(de);y.default=class{constructor(pe){const he={loading:A.default,state:g.default,play:a.default,pause:c.default,check:r.default,volume:t.default,volumeClose:n.default,screenshot:f.default,setting:o.default,pip:F.default,arrowLeft:D.default,arrowRight:E.default,playbackRate:x.default,aspectRatio:O.default,config:I.default,lock:k.default,flip:se.default,unlock:U.default,fullscreenOff:N.default,fullscreenOn:H.default,fullscreenWebOff:G.default,fullscreenWebOn:X.default,switchOn:J.default,switchOff:ie.default,error:ue.default,close:oe.default,airplay:ce.default,...pe.option.icons};Object.keys(he).forEach(ye=>{(0,p.def)(this,ye,{get:()=>{const fe=document.createElement("i");return(0,p.addClass)(fe,"art-icon"),(0,p.addClass)(fe,`art-icon-${ye}`),(0,p.append)(fe,he[ye]),fe}})})}}},{"../utils":"5yYFo","bundle-text:./loading.svg":"gFMCI","bundle-text:./state.svg":"iYMJD","bundle-text:./check.svg":"hyrDV","bundle-text:./play.svg":"eZys6","bundle-text:./pause.svg":"hITjK","bundle-text:./volume.svg":"hNNiX","bundle-text:./volume-close.svg":"dC2M2","bundle-text:./screenshot.svg":"9hKk0","bundle-text:./setting.svg":"47p50","bundle-text:./arrow-left.svg":"5je49","bundle-text:./arrow-right.svg":"2HKZ5","bundle-text:./playback-rate.svg":"hdBpQ","bundle-text:./aspect-ratio.svg":"alUG1","bundle-text:./config.svg":"6B4Bn","bundle-text:./pip.svg":"2Ya1d","bundle-text:./lock.svg":"5Bna4","bundle-text:./unlock.svg":"daCyz","bundle-text:./fullscreen-off.svg":"bx7Yh","bundle-text:./fullscreen-on.svg":"fxY8n","bundle-text:./fullscreen-web-off.svg":"96euD","bundle-text:./fullscreen-web-on.svg":"ccnBB","bundle-text:./switch-on.svg":"26OlL","bundle-text:./switch-off.svg":"i0DjT","bundle-text:./flip.svg":"hdfqR","bundle-text:./error.svg":"9sWnY","bundle-text:./close.svg":"hxSqS","bundle-text:./airplay.svg":"52Tr6","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],gFMCI:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],iYMJD:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],hyrDV:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],eZys6:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],hITjK:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],hNNiX:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],dC2M2:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],"9hKk0":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],"47p50":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],"5je49":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],"2HKZ5":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],hdBpQ:[function(M,C,y){C.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],alUG1:[function(M,C,y){C.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],"6B4Bn":[function(M,C,y){C.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"2Ya1d":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],"5Bna4":[function(M,C,y){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],daCyz:[function(M,C,y){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],bx7Yh:[function(M,C,y){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],fxY8n:[function(M,C,y){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],"96euD":[function(M,C,y){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],ccnBB:[function(M,C,y){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"26OlL":[function(M,C,y){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],i0DjT:[function(M,C,y){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],hdfqR:[function(M,C,y){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],"9sWnY":[function(M,C,y){C.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],hxSqS:[function(M,C,y){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733L571.733 512z"/></svg>'},{}],"52Tr6":[function(M,C,y){C.exports='<svg width="18" height="18" xmlns="http://www.w3.org/2000/svg"><g fill="#fff"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1Z"/><path d="M4 17h10l-5-6z"/></g></svg>'},{}],hdF39:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./flip"),m=T.interopDefault(p),A=M("./aspectRatio"),_=T.interopDefault(A),g=M("./playbackRate"),s=T.interopDefault(g),r=M("./subtitleOffset"),u=T.interopDefault(r),a=M("../utils/component"),d=T.interopDefault(a),c=M("../utils");function h(n,i,f){for(let l=0;l<n.length;l++){const o=n[l];o.$parentItem=i,o.$parentList=f,o.selector&&h(o.selector,o,n)}return n}function t(n){return["string","number"].includes(typeof n)}class e extends d.default{constructor(i){super(i);const{option:f,events:{proxy:l},template:{$setting:o,$player:v}}=i;if(this.name="setting",this.$parent=o,this.option=[],this.events=[],this.cache=new Map,f.setting){f.playbackRate&&this.option.push((0,s.default)(i)),f.aspectRatio&&this.option.push((0,_.default)(i)),f.flip&&this.option.push((0,m.default)(i)),f.subtitleOffset&&this.option.push((0,u.default)(i));for(let D=0;D<f.settings.length;D++)this.option.push(f.settings[D]);this.option=h(this.option),this.init(this.option),i.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),l(v,"click",D=>{!this.show||(0,c.includeFromEvent)(D,i.controls.setting)||(0,c.includeFromEvent)(D,this.$parent)||(this.show=!1,this.init(this.option))})}}add(i){typeof i=="function"?this.option.push(i(this.art)):this.option.push(i),this.cache=new Map,this.events.forEach(f=>f()),this.events=[],this.$parent.innerHTML="",this.option=h(this.option),this.init(this.option)}creatHeader(i){const{icons:f,events:{proxy:l}}=this.art,o=document.createElement("div");(0,c.addClass)(o,"art-setting-item"),(0,c.addClass)(o,"art-setting-item-back");const v=(0,c.append)(o,'<div class="art-setting-item-left"></div>'),D=document.createElement("div");(0,c.addClass)(D,"art-setting-item-left-icon"),(0,c.append)(D,f.arrowLeft),(0,c.append)(v,D),(0,c.append)(v,i.$parentItem.html);const S=l(o,"click",()=>{this.init(i.$parentList)});return this.events.push(S),o}creatItem(i,f){const{icons:l,events:{proxy:o}}=this.art,v=document.createElement("div");(0,c.addClass)(v,"art-setting-item"),t(f.name)&&(v.dataset.name=f.name),t(f.value)&&(v.dataset.value=f.value);const D=(0,c.append)(v,'<div class="art-setting-item-left"></div>'),S=(0,c.append)(v,'<div class="art-setting-item-right"></div>'),E=document.createElement("div");switch((0,c.addClass)(E,"art-setting-item-left-icon"),i){case"switch":case"range":(0,c.append)(E,t(f.icon)||f.icon instanceof Element?f.icon:l.config);break;case"selector":f.selector&&f.selector.length?(0,c.append)(E,t(f.icon)||f.icon instanceof Element?f.icon:l.config):(0,c.append)(E,l.check)}(0,c.append)(D,E),f.$icon=E,(0,c.def)(f,"icon",{configurable:!0,get:()=>E.innerHTML,set(b){t(b)&&(E.innerHTML=b)}});const L=document.createElement("div");(0,c.addClass)(L,"art-setting-item-left-text"),(0,c.append)(L,f.html||""),(0,c.append)(D,L),f.$html=L,(0,c.def)(f,"html",{configurable:!0,get:()=>L.innerHTML,set(b){t(b)&&(L.innerHTML=b)}});const x=document.createElement("div");switch((0,c.addClass)(x,"art-setting-item-right-tooltip"),(0,c.append)(x,f.tooltip||""),(0,c.append)(S,x),f.$tooltip=x,(0,c.def)(f,"tooltip",{configurable:!0,get:()=>x.innerHTML,set(b){t(b)&&(x.innerHTML=b)}}),i){case"switch":{const b=document.createElement("div");(0,c.addClass)(b,"art-setting-item-right-icon");const O=(0,c.append)(b,l.switchOn),R=(0,c.append)(b,l.switchOff);(0,c.setStyle)(f.switch?R:O,"display","none"),(0,c.append)(S,b),f.$switch=f.switch,(0,c.def)(f,"switch",{configurable:!0,get:()=>f.$switch,set(I){f.$switch=I,I?((0,c.setStyle)(R,"display","none"),(0,c.setStyle)(O,"display",null)):((0,c.setStyle)(R,"display",null),(0,c.setStyle)(O,"display","none"))}});break}case"range":{const b=document.createElement("div");(0,c.addClass)(b,"art-setting-item-right-icon");const O=(0,c.append)(b,'<input type="range">');O.value=f.range[0]||0,O.min=f.range[1]||0,O.max=f.range[2]||10,O.step=f.range[3]||1,(0,c.addClass)(O,"art-setting-range"),(0,c.append)(S,b),f.$range=O,(0,c.def)(f,"range",{configurable:!0,get:()=>O.valueAsNumber,set(R){O.value=Number(R)}})}break;case"selector":if(f.selector&&f.selector.length){const b=document.createElement("div");(0,c.addClass)(b,"art-setting-item-right-icon"),(0,c.append)(b,l.arrowRight),(0,c.append)(S,b)}}switch(i){case"switch":if(f.onSwitch){const b=o(v,"click",async O=>{f.switch=await f.onSwitch.call(this.art,f,v,O)});this.events.push(b)}break;case"range":if(f.onRange&&f.$range){const b=o(f.$range,"change",async O=>{f.tooltip=await f.onRange.call(this.art,f,v,O)});this.events.push(b)}break;case"selector":{const b=o(v,"click",async O=>{if(f.selector&&f.selector.length)this.init(f.selector,f.width);else if((0,c.inverseClass)(v,"art-current"),f.$parentList&&this.init(f.$parentList),f.$parentItem&&f.$parentItem.onSelect){const R=await f.$parentItem.onSelect.call(this.art,f,v,O);f.$parentItem.$tooltip&&t(R)&&(f.$parentItem.$tooltip.innerHTML=R)}});this.events.push(b),f.default&&(0,c.addClass)(v,"art-current")}}return v}init(i,f){const{constructor:l}=this.art;if(this.cache.has(i)){const o=this.cache.get(i);(0,c.inverseClass)(o,"art-current"),(0,c.setStyle)(this.$parent,"width",`${o.dataset.width}px`),(0,c.setStyle)(this.$parent,"height",`${o.dataset.height}px`)}else{const o=document.createElement("div");(0,c.addClass)(o,"art-setting-panel"),o.dataset.width=f||l.SETTING_WIDTH,o.dataset.height=i.length*l.SETTING_ITEM_HEIGHT,i[0]&&i[0].$parentItem&&((0,c.append)(o,this.creatHeader(i[0])),o.dataset.height=Number(o.dataset.height)+l.SETTING_ITEM_HEIGHT);for(let v=0;v<i.length;v++){const D=i[v];(0,c.has)(D,"switch")?(0,c.append)(o,this.creatItem("switch",D)):(0,c.has)(D,"range")?(0,c.append)(o,this.creatItem("range",D)):(0,c.append)(o,this.creatItem("selector",D))}(0,c.append)(this.$parent,o),this.cache.set(i,o),(0,c.inverseClass)(o,"art-current"),(0,c.setStyle)(this.$parent,"width",`${o.dataset.width}px`),(0,c.setStyle)(this.$parent,"height",`${o.dataset.height}px`),i[0]&&i[0].$parentItem&&i[0].$parentItem.mounted&&i[0].$parentItem.mounted.call(this.art,o,i[0].$parentItem)}}}y.default=e},{"./flip":"eyzeE","./aspectRatio":"jTfLi","./playbackRate":"aowja","./subtitleOffset":"aPjJK","../utils/component":"5MLcx","../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eyzeE:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,icons:A,constructor:_}=p,g={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function s(r,u,a){u&&(u.innerText=m.get(g[a]));const d=(0,T.queryAll)(".art-setting-item",r).find(c=>c.dataset.value===a);d&&(0,T.inverseClass)(d,"art-current")}return{width:_.SETTING_ITEM_WIDTH,html:m.get("Video Flip"),tooltip:m.get(g[p.flip]),icon:A.flip,selector:Object.keys(g).map(r=>({value:r,default:r===p.flip,html:m.get(g[r])})),onSelect(r){p.flip=r.value},mounted:(r,u)=>{s(r,u.$tooltip,p.flip),p.on("flip",()=>{s(r,u.$tooltip,p.flip)})}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],jTfLi:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,icons:A,constructor:_}=p;function g(r){return r==="default"?m.get("Default"):r}function s(r,u,a){u&&(u.innerText=g(a));const d=(0,T.queryAll)(".art-setting-item",r).find(c=>c.dataset.value===a);d&&(0,T.inverseClass)(d,"art-current")}return{width:_.SETTING_ITEM_WIDTH,html:m.get("Aspect Ratio"),icon:A.aspectRatio,tooltip:g(p.aspectRatio),selector:["default","4:3","16:9"].map(r=>({value:r,default:r===p.aspectRatio,html:g(r)})),onSelect(r){p.aspectRatio=r.value},mounted:(r,u)=>{s(r,u.$tooltip,p.aspectRatio),p.on("aspectRatio",()=>{s(r,u.$tooltip,p.aspectRatio)})}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],aowja:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,icons:A,constructor:_}=p;function g(r){return r===1?m.get("Normal"):r}function s(r,u,a){u&&(u.innerText=g(a));const d=(0,T.queryAll)(".art-setting-item",r).find(c=>Number(c.dataset.value)===a);d&&(0,T.inverseClass)(d,"art-current")}return{width:_.SETTING_ITEM_WIDTH,html:m.get("Play Speed"),tooltip:g(p.playbackRate),icon:A.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(r=>({value:r,default:r===p.playbackRate,html:g(r)})),onSelect(r){p.playbackRate=r.value},mounted:(r,u)=>{s(r,u.$tooltip,p.playbackRate),p.on("playbackRate",()=>{s(r,u.$tooltip,p.playbackRate)})}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],aPjJK:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,icons:A,constructor:_}=p;function g(r){return r===0?m.get("Normal"):r}function s(r,u,a){u&&(u.innerText=g(a));const d=(0,T.queryAll)(".art-setting-item",r).find(c=>Number(c.dataset.value)===a);d&&(0,T.inverseClass)(d,"art-current")}return{width:_.SETTING_ITEM_WIDTH,html:m.get("Subtitle Offset"),tooltip:g(p.subtitleOffset),icon:A.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(r=>({value:r,default:r===p.subtitleOffset,html:g(r)})),onSelect(r){p.subtitleOffset=r.value},mounted:(r,u)=>{s(r,u.$tooltip,p.subtitleOffset),p.on("subtitleOffset",()=>{s(r,u.$tooltip,p.subtitleOffset)})}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bCcu0:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(T){try{const p=JSON.parse(window.localStorage.getItem(this.name))||{};return T?p[T]:p}catch{return T?this.settings[T]:this.settings}}set(T,p){try{const m=Object.assign({},this.get(),{[T]:p});window.localStorage.setItem(this.name,JSON.stringify(m))}catch{this.settings[T]=p}}del(T){try{const p=this.get();delete p[T],window.localStorage.setItem(this.name,JSON.stringify(p))}catch{delete this.settings[T]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"1v13t":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("../utils"),m=M("./miniProgressBar"),A=T.interopDefault(m),_=M("./autoOrientation"),g=T.interopDefault(_),s=M("./autoPlayback"),r=T.interopDefault(s),u=M("./fastForward"),a=T.interopDefault(u),d=M("./lock"),c=T.interopDefault(d);y.default=class{constructor(h){this.art=h,this.id=0;const{option:t}=h;t.miniProgressBar&&!t.isLive&&this.add(A.default),t.lock&&p.isMobile&&this.add(c.default),t.autoPlayback&&!t.isLive&&this.add(r.default),t.autoOrientation&&p.isMobile&&this.add(g.default),t.fastForward&&p.isMobile&&!t.isLive&&this.add(a.default);for(let e=0;e<t.plugins.length;e++)this.add(t.plugins[e])}add(h){this.id+=1;const t=h.call(this,this.art),e=t&&t.name||h.name||`plugin${this.id}`;return(0,p.errorHandle)(!(0,p.has)(this,e),`Cannot add a plugin that already has the same name: ${e}`),(0,p.def)(this,e,{value:t}),this}}},{"../utils":"5yYFo","./miniProgressBar":"2h4YZ","./autoOrientation":"bcdCk","./autoPlayback":"1nHHC","./fastForward":"4gkmX","./lock":"ij5nM","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"2h4YZ":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function(T){return T.on("ready",()=>{T.layers.add({name:"miniProgressBar",mounted(p){T.on("destroy",()=>{p.style.display="none"}),T.on("video:timeupdate",()=>{p.style.width=100*T.played+"%"}),T.on("setBar",(m,A)=>{m==="played"&&(p.style.width=100*A+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],bcdCk:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{option:m,constructor:A,template:{$player:_,$video:g}}=p;return p.on("fullscreenWeb",s=>{if(s){const{videoWidth:r,videoHeight:u}=g,{clientWidth:a,clientHeight:d}=document.documentElement;(r>u&&a<d||r<u&&a>d)&&setTimeout(()=>{(0,T.setStyle)(_,"width",`${d}px`),(0,T.setStyle)(_,"height",`${a}px`),(0,T.setStyle)(_,"transform-origin","0 0"),(0,T.setStyle)(_,"transform",`rotate(90deg) translate(0, -${a}px)`),(0,T.addClass)(_,"art-auto-orientation"),p.emit("resize")},A.MOBILE_AUTO_ORIENTATION_TIME)}else(0,T.hasClass)(_,"art-auto-orientation")&&((0,T.setStyle)(_,"width",null),(0,T.setStyle)(_,"height",null),(0,T.setStyle)(_,"transform",null),(0,T.setStyle)(_,"transform-origin",null),(0,T.removeClass)(_,"art-auto-orientation"),p.aspectRatioReset=!0,p.autoSize=m.autoSize,p.notice.show="",p.emit("resize"))}),p.on("fullscreen",async s=>{const r=screen.orientation.type;if(s){const{videoWidth:u,videoHeight:a}=g,{clientWidth:d,clientHeight:c}=document.documentElement;if(u>a&&d<c||u<a&&d>c){const h=r.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(h),(0,T.addClass)(_,"art-auto-orientation-fullscreen")}}else(0,T.hasClass)(_,"art-auto-orientation-fullscreen")&&(await screen.orientation.lock(r),(0,T.removeClass)(_,"art-auto-orientation-fullscreen"))}),{name:"autoOrientation",get state(){return(0,T.hasClass)(_,"art-auto-orientation")}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"1nHHC":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{i18n:m,icons:A,storage:_,constructor:g,events:{proxy:s},template:{$poster:r}}=p,u=p.layers.add({name:"autoPlayback",html:'<div class="art-autoPlayback-close"></div><div class="art-autoPlayback-last"></div><div class="art-autoPlayback-jump"></div>'}),a=(0,T.query)(".art-autoPlayback-last",u),d=(0,T.query)(".art-autoPlayback-jump",u),c=(0,T.query)(".art-autoPlayback-close",u);return p.on("video:timeupdate",()=>{const h=_.get("times")||{},t=Object.keys(h);t.length>g.AUTO_PLAYBACK_MAX&&delete h[t[0]],h[p.option.id||p.option.url]=p.currentTime,_.set("times",h)}),p.on("ready",()=>{const h=(_.get("times")||{})[p.option.id||p.option.url];h&&h>=g.AUTO_PLAYBACK_MIN&&((0,T.append)(c,A.close),(0,T.setStyle)(u,"display","flex"),a.innerText=`${m.get("Last Seen")} ${(0,T.secondToTime)(h)}`,d.innerText=m.get("Jump Play"),s(c,"click",()=>{(0,T.setStyle)(u,"display","none")}),s(d,"click",()=>{p.seek=h,p.play(),(0,T.setStyle)(r,"display","none"),(0,T.setStyle)(u,"display","none")}),p.once("video:timeupdate",()=>{setTimeout(()=>{(0,T.setStyle)(u,"display","none")},g.AUTO_PLAYBACK_TIMEOUT)}))}),{name:"autoPlayback",get times(){return _.get("times")||{}},clear:()=>_.del("times"),delete(h){const t=_.get("times")||{};return delete t[h],_.set("times",t),t}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],"4gkmX":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{constructor:m,events:{proxy:A},template:{$player:_,$video:g}}=p;let s=null,r=!1;const u=()=>{clearTimeout(s),r&&(r=!1,p.playbackRate=1,(0,T.removeClass)(_,"art-fast-forward"))};return A(g,"touchstart",a=>{a.touches.length===1&&p.playing&&!p.isLock&&(s=setTimeout(()=>{r=!0,p.playbackRate=m.FAST_FORWARD_VALUE,(0,T.addClass)(_,"art-fast-forward")},m.FAST_FORWARD_TIME))}),A(document,"touchmove",u),A(document,"touchend",u),{name:"fastForward",get state(){return(0,T.hasClass)(_,"art-fast-forward")}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],ij5nM:[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y);var T=M("../utils");y.default=function(p){const{layers:m,icons:A,template:{$player:_}}=p;return m.add({name:"lock",mounted(g){const s=(0,T.append)(g,A.lock),r=(0,T.append)(g,A.unlock);(0,T.setStyle)(s,"display","none"),p.on("lock",u=>{u?((0,T.setStyle)(s,"display","inline-flex"),(0,T.setStyle)(r,"display","none")):((0,T.setStyle)(s,"display","none"),(0,T.setStyle)(r,"display","inline-flex"))})},click(){(0,T.hasClass)(_,"art-lock")?((0,T.removeClass)(_,"art-lock"),this.isLock=!1,p.emit("lock",!1)):((0,T.addClass)(_,"art-lock"),this.isLock=!0,p.emit("lock",!0))}}),{name:"lock",get state(){return(0,T.hasClass)(_,"art-lock")}}}},{"../utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}],eD5Ch:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./config"),m=T.interopDefault(p),A=M("./utils");y.default=class{constructor(_){const{option:g,events:{proxy:s},template:{$video:r}}=_;for(let d=0;d<m.default.events.length;d++)s(r,m.default.events[d],c=>{_.emit(`video:${c.type}`,c)});Object.keys(g.moreVideoAttr).forEach(d=>{r[d]=g.moreVideoAttr[d]}),g.muted&&(r.muted=g.muted),g.volume&&(r.volume=(0,A.clamp)(g.volume,0,1)),g.poster&&(r.poster=g.poster),g.autoplay&&(r.autoplay=g.autoplay),g.playsInline&&(r.playsInline=!0,r["webkit-playsinline"]=!0);const u=g.type||(0,A.getExt)(g.url),a=g.customType[u];u&&a?(a(r,g.url,_),_.emit("customType",u)):(r.src=g.url,_.emit("url",r.src))}}},{"./config":"ej4fZ","./utils":"5yYFo","@parcel/transformer-js/src/esmodule-helpers.js":"b7MJY"}]},["E13ST"],"E13ST")})(We);const vt=Fe(We.exports);var Ge={exports:{}};/*!
 * artplayer-plugin-danmuku.js v4.4.8
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(xe,Re){(function(M,C,y,T,p){var m=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof Pe<"u"?Pe:{},A=typeof m.parcelRequire93cf=="function"&&m.parcelRequire93cf,_=A.cache||{},g=typeof we=="function"&&we.bind(xe);function s(a,d){if(!_[a]){if(!M[a]){var c=typeof m.parcelRequire93cf=="function"&&m.parcelRequire93cf;if(!d&&c)return c(a,!0);if(A)return A(a,!0);if(g&&typeof a=="string")return g(a);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}e.resolve=function(n){var i=M[a][1][n];return i!=null?i:n},e.cache={};var t=_[a]=new s.Module(a);M[a][0].call(t.exports,e,t,t.exports,this)}return _[a].exports;function e(n){var i=e.resolve(n);return i===!1?{}:s(i)}}s.isParcelRequire=!0,s.Module=function(a){this.id=a,this.bundle=s,this.exports={}},s.modules=M,s.cache=_,s.parent=A,s.register=function(a,d){M[a]=[function(c,h){h.exports=d},{}]},Object.defineProperty(s,"root",{get:function(){return m.parcelRequire93cf}}),m.parcelRequire93cf=s;for(var r=0;r<C.length;r++)s(C[r]);var u=s(y);xe.exports=u})({E13ST:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./danmuku"),m=T.interopDefault(p),A=M("./setting"),_=T.interopDefault(A);function g(s){return r=>{(function(a){const{version:d,utils:{errorHandle:c}}=a.constructor,h=d.split(".").map(Number);c(h[0]+h[1]/100>=4.04,`Artplayer.js@${d} \u4E0D\u517C\u5BB9\u8BE5\u5F39\u5E55\u5E93\uFF0C\u8BF7\u66F4\u65B0\u5230 4.4.x \u7248\u672C\u4EE5\u4E0A`)})(r);const u=new m.default(r,s);return(0,_.default)(r,u),{name:"artplayerPluginDanmuku",emit:u.emit.bind(u),load:u.load.bind(u),config:u.config.bind(u),hide:u.hide.bind(u),show:u.show.bind(u),get isHide(){return u.isHide},get isStop(){return u.isStop}}}}y.default=g,g.env="production",g.version="4.4.8",g.build="1655097987373",typeof window<"u"&&(window.artplayerPluginDanmuku=g)},{"./danmuku":"8Gtnh","./setting":"jAkJm","@parcel/transformer-js/src/esmodule-helpers.js":"9v6Cv"}],"8Gtnh":[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("./bilibili"),m=M("./getDanmuTop"),A=T.interopDefault(m);class _{constructor(s,r){const{constructor:u,template:a}=s;if(this.utils=u.utils,this.validator=u.validator,this.$danmuku=a.$danmuku,this.$player=a.$player,this.art=s,this.queue=[],this.option={},this.$refs=[],this.isStop=!1,this.isHide=!1,this.timer=null,this.config(r),this.option.useWorker)try{this.worker=new Worker(M("27c3930ee158179a"))}catch{}this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.reset=this.reset.bind(this),this.destroy=this.destroy.bind(this),s.on("video:play",this.start),s.on("video:playing",this.start),s.on("video:pause",this.stop),s.on("video:waiting",this.stop),s.on("fullscreen",this.reset),s.on("fullscreenWeb",this.reset),s.on("destroy",this.destroy),this.load()}static get option(){return{danmuku:[],speed:5,margin:["2%","25%"],opacity:1,color:"#FFFFFF",mode:0,fontSize:25,filter:()=>!0,antiOverlap:!0,useWorker:!0,synchronousPlayback:!1,lockTime:5,maxLength:100,minWidth:200,maxWidth:400,mount:void 0,theme:"dark",beforeEmit:()=>!0}}static get scheme(){return{danmuku:"array|function|string",speed:"number",margin:"array",opacity:"number",color:"string",mode:"number",fontSize:"number|string",filter:"function",antiOverlap:"boolean",useWorker:"boolean",synchronousPlayback:"boolean",lockTime:"number",maxLength:"number",minWidth:"number",maxWidth:"number",mount:"undefined|htmldivelement",theme:"string",beforeEmit:"function"}}get isRotate(){return this.art.plugins.autoOrientation&&this.art.plugins.autoOrientation.state}get marginTop(){const{clamp:s}=this.utils,r=this.option.margin[0],{clientHeight:u}=this.$player;return typeof r=="number"?s(r,0,u):typeof r=="string"&&r.endsWith("%")?s(u*(parseFloat(r)/100),0,u):_.option.margin[0]}get marginBottom(){const{clamp:s}=this.utils,r=this.option.margin[1],{clientHeight:u}=this.$player;return typeof r=="number"?s(r,0,u):typeof r=="string"&&r.endsWith("%")?s(u*(parseFloat(r)/100),0,u):_.option.margin[1]}filter(s,r){return this.queue.filter(u=>u.$state===s).map(r)}getLeft(s){const r=s.getBoundingClientRect();return this.isRotate?r.top:r.left}getRef(){const s=this.$refs.pop();if(s)return s;const r=document.createElement("div");return r.style.cssText=`
            user-select: none;
            position: absolute;
            white-space: pre;
            pointer-events: none;
            perspective: 500px;
            display: inline-block;
            will-change: transform;
            font-weight: normal;
            line-height: 1.125;
            visibility: hidden;
            font-family: SimHei, "Microsoft JhengHei", Arial, Helvetica, sans-serif;
            text-shadow: rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px;
        `,r}getReady(){const{currentTime:s}=this.art;return this.queue.filter(r=>r.$state==="ready"||r.$state==="wait"&&s+.1>=r.time&&r.time>=s-.1)}getEmits(){const s=[],{clientWidth:r}=this.$player,u=this.getLeft(this.$player);return this.filter("emit",a=>{const d=a.$ref.offsetTop,c=this.getLeft(a.$ref)-u,h=a.$ref.clientHeight,t=a.$ref.clientWidth,e=c+t,n=r-e,i=e/a.$restTime,f={};f.top=d,f.left=c,f.height=h,f.width=t,f.right=n,f.speed=i,f.distance=e,f.time=a.$restTime,f.mode=a.mode,s.push(f)}),s}getFontSize(s){const{clamp:r}=this.utils,{clientHeight:u}=this.$player;return typeof s=="number"?r(s,12,u):typeof s=="string"&&s.endsWith("%")?r(u*(parseFloat(s)/100),12,u):_.option.fontSize}postMessage(s={}){return new Promise(r=>{if(this.option.useWorker&&this.worker&&this.worker.postMessage)s.id=Date.now(),this.worker.postMessage(s),this.worker.onmessage=u=>{const{data:a}=u;a.id===s.id&&r(a)};else{const u=(0,A.default)(s);r({top:u})}})}async load(){try{let s=[];s=typeof this.option.danmuku=="function"?await this.option.danmuku():typeof this.option.danmuku.then=="function"?await this.option.danmuku:typeof this.option.danmuku=="string"?await(0,p.bilibiliDanmuParseFromUrl)(this.option.danmuku):this.option.danmuku,this.utils.errorHandle(Array.isArray(s),"Danmuku need return an array as result"),this.art.emit("artplayerPluginDanmuku:loaded",s),this.queue=[],this.$danmuku.innerText="",s.forEach(r=>this.emit(r))}catch(s){throw this.art.emit("artplayerPluginDanmuku:error",s),s}return this}config(s){const{clamp:r}=this.utils;return this.option=Object.assign({},_.option,this.option,s),this.validator(this.option,_.scheme),this.option.speed=r(this.option.speed,1,10),this.option.opacity=r(this.option.opacity,0,1),this.option.lockTime=r(Math.floor(this.option.lockTime),0,60),this.option.maxLength=r(this.option.maxLength,0,500),this.option.minWidth=r(this.option.minWidth,0,500),this.option.maxWidth=r(this.option.maxWidth,0,1/0),s.fontSize&&(this.option.fontSize=this.getFontSize(this.option.fontSize),this.reset()),this.art.emit("artplayerPluginDanmuku:config",this.option),this}makeWait(s){s.$state="wait",s.$ref&&(s.$ref.style.visibility="hidden",s.$ref.style.marginLeft="0px",s.$ref.style.transform="translateX(0px)",s.$ref.style.transition="transform 0s linear 0s",this.$refs.push(s.$ref),s.$ref=null)}continue(){const{clientWidth:s}=this.$player;return this.filter("stop",r=>{switch(r.$state="emit",r.$lastStartTime=Date.now(),r.mode){case 0:{const u=s+r.$ref.clientWidth;r.$ref.style.transform=`translateX(${-u}px)`,r.$ref.style.transition=`transform ${r.$restTime}s linear 0s`;break}}}),this}suspend(){const{clientWidth:s}=this.$player;return this.filter("emit",r=>{switch(r.$state="stop",r.mode){case 0:{const u=s-(this.getLeft(r.$ref)-this.getLeft(this.$player));r.$ref.style.transform=`translateX(${-u}px)`,r.$ref.style.transition="transform 0s linear 0s";break}}}),this}reset(){return this.queue.forEach(s=>this.makeWait(s)),this}update(){return this.timer=window.requestAnimationFrame(async()=>{if(this.art.playing&&!this.isHide){this.filter("emit",a=>{const d=(Date.now()-a.$lastStartTime)/1e3;a.$restTime-=d,a.$lastStartTime=Date.now(),a.$restTime<=0&&this.makeWait(a)});const s=this.getReady(),{clientWidth:r,clientHeight:u}=this.$player;for(let a=0;a<s.length;a++){const d=s[a];d.$ref=this.getRef(),d.$ref.innerText=d.text,this.$danmuku.appendChild(d.$ref),d.$ref.style.left=`${r}px`,d.$ref.style.opacity=this.option.opacity,d.$ref.style.fontSize=`${this.option.fontSize}px`,d.$ref.style.color=d.color,d.$ref.style.border=d.border?`1px solid ${d.color}`:null,d.$ref.style.backgroundColor=d.border?"rgb(0 0 0 / 50%)":null,d.$ref.style.marginLeft="0px",d.$lastStartTime=Date.now(),d.$restTime=this.option.synchronousPlayback&&this.art.playbackRate?this.option.speed/Number(this.art.playbackRate):this.option.speed;const c={mode:d.mode,height:d.$ref.clientHeight,speed:(r+d.$ref.clientWidth)/d.$restTime},{top:h}=await this.postMessage({target:c,emits:this.getEmits(),antiOverlap:this.option.antiOverlap,clientWidth:r,clientHeight:u,marginBottom:this.marginBottom,marginTop:this.marginTop});if(d.$ref)if(this.isStop||h===void 0)d.$state="ready",this.$refs.push(d.$ref),d.$ref=null;else switch(d.$state="emit",d.$ref.style.visibility="visible",d.mode){case 0:{d.$ref.style.top=`${h}px`;const t=r+d.$ref.clientWidth;d.$ref.style.transform=`translateX(${-t}px)`,d.$ref.style.transition=`transform ${d.$restTime}s linear 0s`;break}case 1:d.$ref.style.left="50%",d.$ref.style.top=`${h}px`,d.$ref.style.marginLeft=`-${d.$ref.clientWidth/2}px`}}}this.isStop||this.update()}),this}stop(){return this.isStop=!0,this.suspend(),window.cancelAnimationFrame(this.timer),this.art.emit("artplayerPluginDanmuku:stop"),this}start(){return this.isStop=!1,this.continue(),this.update(),this.art.emit("artplayerPluginDanmuku:start"),this}show(){return this.isHide=!1,this.start(),this.$danmuku.style.display="block",this.art.emit("artplayerPluginDanmuku:show"),this}hide(){return this.isHide=!0,this.stop(),this.queue.forEach(s=>this.makeWait(s)),this.$danmuku.style.display="none",this.art.emit("artplayerPluginDanmuku:hide"),this}emit(s){return this.validator(s,{text:"string",mode:"number|undefined",color:"string|undefined",time:"number|undefined",border:"boolean|undefined"}),s.text.trim()&&this.option.filter(s)?(s.time?s.time=this.utils.clamp(s.time,0,1/0):s.time=this.art.currentTime+.5,s.mode===void 0&&(s.mode=this.option.mode),s.color===void 0&&(s.color=this.option.color),this.queue.push({...s,$state:"wait",$ref:null,$restTime:0,$lastStartTime:0}),this):this}destroy(){this.stop(),this.worker&&this.worker.terminate&&this.worker.terminate(),this.art.off("video:play",this.start),this.art.off("video:playing",this.start),this.art.off("video:pause",this.stop),this.art.off("video:waiting",this.stop),this.art.off("fullscreen",this.reset),this.art.off("fullscreenWeb",this.reset),this.art.off("destroy",this.destroy),this.art.emit("artplayerPluginDanmuku:destroy")}}y.default=_},{"./bilibili":"KnwDr","./getDanmuTop":"2Abxf","27c3930ee158179a":"anHwN","@parcel/transformer-js/src/esmodule-helpers.js":"9v6Cv"}],KnwDr:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");function p(_){switch(_){case 1:case 2:case 3:default:return 0;case 4:case 5:return 1}}function m(_){if(typeof _!="string")return[];const g=_.matchAll(/<d (?:.*? )??p="(?<p>.+?)"(?: .*?)?>(?<text>.+?)<\/d>/gs);return Array.from(g).map(s=>{const r=s.groups.p.split(",");return r.length>=8?{text:s.groups.text.trim().replaceAll("&quot;",'"').replaceAll("&apos;","'").replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),time:Number(r[0]),mode:p(Number(r[1])),fontSize:Number(r[2]),color:`#${Number(r[3]).toString(16)}`,timestamp:Number(r[4]),pool:Number(r[5]),userID:r[6],rowID:Number(r[7])}:null}).filter(Boolean)}function A(_){return fetch(_).then(g=>g.text()).then(g=>m(g))}T.defineInteropFlag(y),T.export(y,"getMode",()=>p),T.export(y,"bilibiliDanmuParseFromXml",()=>m),T.export(y,"bilibiliDanmuParseFromUrl",()=>A)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9v6Cv"}],"9v6Cv":[function(M,C,y){y.interopDefault=function(T){return T&&T.__esModule?T:{default:T}},y.defineInteropFlag=function(T){Object.defineProperty(T,"__esModule",{value:!0})},y.exportAll=function(T,p){return Object.keys(T).forEach(function(m){m==="default"||m==="__esModule"||p.hasOwnProperty(m)||Object.defineProperty(p,m,{enumerable:!0,get:function(){return T[m]}})}),p},y.export=function(T,p,m){Object.defineProperty(T,p,{enumerable:!0,get:m})}},{}],"2Abxf":[function(M,C,y){M("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(y),y.default=function({target:T,emits:p,clientWidth:m,clientHeight:A,marginBottom:_,marginTop:g,antiOverlap:s}){const r=p.filter(a=>a.mode===T.mode&&a.top<=A-_).sort((a,d)=>a.top-d.top);if(r.length===0)return g;r.unshift({top:0,left:0,right:0,height:g,width:m,speed:0,distance:m}),r.push({top:A-_,left:0,right:0,height:_,width:m,speed:0,distance:m});for(let a=1;a<r.length;a+=1){const d=r[a],c=r[a-1],h=c.top+c.height;if(d.top-h>=T.height)return h}const u=[];for(let a=1;a<r.length-1;a+=1){const d=r[a];if(u.length){const c=u[u.length-1];c[0].top===d.top?c.push(d):u.push([d])}else u.push([d])}if(!s){switch(T.mode){case 0:u.sort((a,d)=>{const c=Math.min(...d.map(t=>t.right)),h=Math.min(...a.map(t=>t.right));return c*d.length-h*a.length});break;case 1:u.sort((a,d)=>{const c=Math.max(...d.map(h=>h.width));return Math.max(...a.map(h=>h.width))*a.length-c*d.length})}return u[0][0].top}switch(T.mode){case 0:{const a=u.find(d=>d.every(c=>m<c.distance?!1:T.speed<c.speed?!0:c.right/(T.speed-c.speed)>c.time));return a&&a[0]?a[0].top:void 0}case 1:return}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9v6Cv"}],anHwN:[function(M,C,y){C.exports="data:application/javascript,function%20getDanmuTop%28%7Btarget%3At%2Cemits%3Ae%2CclientWidth%3An%2CclientHeight%3Ai%2CmarginBottom%3As%2CmarginTop%3Ah%2CantiOverlap%3Ao%7D%29%7Bconst%20r%3De.filter%28%28e%3D%3Ee.mode%3D%3D%3Dt.mode%26%26e.top%3C%3Di-s%29%29.sort%28%28%28t%2Ce%29%3D%3Et.top-e.top%29%29%3Bif%280%3D%3D%3Dr.length%29return%20h%3Br.unshift%28%7Btop%3A0%2Cleft%3A0%2Cright%3A0%2Cheight%3Ah%2Cwidth%3An%2Cspeed%3A0%2Cdistance%3An%7D%29%2Cr.push%28%7Btop%3Ai-s%2Cleft%3A0%2Cright%3A0%2Cheight%3As%2Cwidth%3An%2Cspeed%3A0%2Cdistance%3An%7D%29%3Bfor%28let%20e%3D1%3Be%3Cr.length%3Be%2B%3D1%29%7Bconst%20n%3Dr%5Be%5D%2Ci%3Dr%5Be-1%5D%2Cs%3Di.top%2Bi.height%3Bif%28n.top-s%3E%3Dt.height%29return%20s%7Dconst%20p%3D%5B%5D%3Bfor%28let%20t%3D1%3Bt%3Cr.length-1%3Bt%2B%3D1%29%7Bconst%20e%3Dr%5Bt%5D%3Bif%28p.length%29%7Bconst%20t%3Dp%5Bp.length-1%5D%3Bt%5B0%5D.top%3D%3D%3De.top%3Ft.push%28e%29%3Ap.push%28%5Be%5D%29%7Delse%20p.push%28%5Be%5D%29%7Dif%28%21o%29%7Bswitch%28t.mode%29%7Bcase%200%3Ap.sort%28%28%28t%2Ce%29%3D%3E%7Bconst%20n%3DMath.min%28...e.map%28%28t%3D%3Et.right%29%29%29%2Ci%3DMath.min%28...t.map%28%28t%3D%3Et.right%29%29%29%3Breturn%20n%2ae.length-i%2at.length%7D%29%29%3Bbreak%3Bcase%201%3Ap.sort%28%28%28t%2Ce%29%3D%3E%7Bconst%20n%3DMath.max%28...e.map%28%28t%3D%3Et.width%29%29%29%3Breturn%20Math.max%28...t.map%28%28t%3D%3Et.width%29%29%29%2at.length-n%2ae.length%7D%29%29%7Dreturn%20p%5B0%5D%5B0%5D.top%7Dswitch%28t.mode%29%7Bcase%200%3A%7Bconst%20e%3Dp.find%28%28e%3D%3Ee.every%28%28e%3D%3E%7Bif%28n%3Ce.distance%29return%211%3Bif%28t.speed%3Ce.speed%29return%210%3Breturn%20e.right%2F%28t.speed-e.speed%29%3Ee.time%7D%29%29%29%29%3Breturn%20e%26%26e%5B0%5D%3Fe%5B0%5D.top%3Avoid%200%7Dcase%201%3Areturn%7D%7Donmessage%3Dt%3D%3E%7Bconst%7Bdata%3Ae%7D%3Dt%2Cn%3DgetDanmuTop%28e%29%3Bself.postMessage%28%7Btop%3An%2Cid%3Ae.id%7D%29%7D%3B"},{}],jAkJm:[function(M,C,y){var T=M("@parcel/transformer-js/src/esmodule-helpers.js");T.defineInteropFlag(y);var p=M("bundle-text:./style.less"),m=T.interopDefault(p),A=M("bundle-text:./img/danmu-on.svg"),_=T.interopDefault(A),g=M("bundle-text:./img/danmu-off.svg"),s=T.interopDefault(g),r=M("bundle-text:./img/danmu-config.svg"),u=T.interopDefault(r),a=M("bundle-text:./img/danmu-style.svg"),d=T.interopDefault(a);if(y.default=function(c,h){const{option:t}=h,{template:{$controlsCenter:e,$player:n},constructor:{utils:{removeClass:i,addClass:f,append:l,setStyle:o,tooltip:v,query:D,inverseClass:S}}}=c;function E(R,I){const P=document.createElement("i");return l(P,R),f(P,"art-icon"),f(P,`art-icon-${I}`),P}const L=E(_.default,"danmu-on"),x=E(s.default,"danmu-off"),b=E(u.default,"danmu-config"),O=E(d.default,"danmu-style");(function(){const R=["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"].map(X=>`<div class="art-danmuku-style-panel-color${t.color===X?" art-current":""}" data-color="${X}" style="background-color:${X}"></div>`),I=l(e,`<div class="art-danmuku-emitter" style="max-width: ${t.maxWidth?`${t.maxWidth}px`:"100%"}"><div class="art-danmuku-left"><div class="art-danmuku-style"><div class="art-danmuku-style-panel"><div class="art-danmuku-style-panel-inner"><div class="art-danmuku-style-panel-title">\u6A21\u5F0F</div><div class="art-danmuku-style-panel-modes"><div class="art-danmuku-style-panel-mode art-current" data-mode="0">\u6EDA\u52A8</div><div class="art-danmuku-style-panel-mode" data-mode="1">\u9759\u6B62</div></div><div class="art-danmuku-style-panel-title">\u989C\u8272</div><div class="art-danmuku-style-panel-colors">${R.join("")}</div></div></div></div><input class="art-danmuku-input" maxlength="${t.maxLength}" placeholder="\u53D1\u4E2A\u5F39\u5E55\u89C1\u8BC1\u5F53\u4E0B" /></div><div class="art-danmuku-send">\u53D1\u9001</div></div>`),P=D(".art-danmuku-style",I),F=D(".art-danmuku-input",I),w=D(".art-danmuku-send",I),k=D(".art-danmuku-style-panel-inner",I),B=D(".art-danmuku-style-panel-modes",I),U=D(".art-danmuku-style-panel-colors",I),j=t.mount||l(n,'<div class="art-layer-danmuku-emitter"></div>');c.option.backdrop&&f(k,"art-backdrop-filter"),t.theme&&f(I,`art-danmuku-theme-${t.theme}`);let N=null,K=t.mode,H=t.color;function $(X){X<=0?(N=null,w.innerText="\u53D1\u9001",i(w,"art-disabled")):(w.innerText=X,N=setTimeout(()=>$(X-1),1e3))}function G(){const X={mode:K,color:H,border:!0,text:F.value.trim()};N===null&&t.beforeEmit(X)&&(F.value="",h.emit(X),f(w,"art-disabled"),$(t.lockTime),c.emit("artplayerPluginDanmuku:emit",X))}function ee(){e.clientWidth<t.minWidth?(l(j,I),o(j,"display","flex"),f(I,"art-danmuku-mount"),t.mount||o(n,"marginBottom","40px")):(l(e,I),o(j,"display","none"),i(I,"art-danmuku-mount"),t.mount||o(n,"marginBottom",null))}l(P,O),c.proxy(w,"click",G),c.proxy(F,"keypress",X=>{X.key==="Enter"&&(X.preventDefault(),G())}),c.proxy(B,"click",X=>{const{dataset:V}=X.target;V.mode&&(K=Number(V.mode),S(X.target,"art-current"))}),c.proxy(U,"click",X=>{const{dataset:V}=X.target;V.color&&(H=V.color,S(X.target,"art-current"))}),ee(),c.on("resize",ee),c.on("destroy",()=>{t.mount&&I.parentElement===t.mount&&t.mount.removeChild(I)})})(),c.controls.add({position:"right",name:"danmuku",click:function(){h.isHide?(h.show(),c.notice.show="\u5F39\u5E55\u663E\u793A",o(L,"display",null),o(x,"display","none")):(h.hide(),c.notice.show="\u5F39\u5E55\u9690\u85CF",o(L,"display","none"),o(x,"display",null))},mounted(R){l(R,L),l(R,x),v(R,"\u5F39\u5E55\u5F00\u5173"),o(x,"display","none")}}),c.setting.add({name:"danmuku",html:"\u5F39\u5E55\u8BBE\u7F6E",tooltip:"\u66F4\u591A",icon:b,selector:[{width:200,html:"\u64AD\u653E\u901F\u5EA6",icon:"",tooltip:"\u9002\u4E2D",selector:[{html:"\u6781\u6162",time:10},{html:"\u8F83\u6162",time:7.5},{default:!0,html:"\u9002\u4E2D",time:5},{html:"\u8F83\u5FEB",time:2.5},{html:"\u6781\u5FEB",time:1}],onSelect:function(R){return h.config({speed:R.time}),R.html}},{width:200,html:"\u5B57\u4F53\u5927\u5C0F",icon:"",tooltip:"\u9002\u4E2D",selector:[{html:"\u6781\u5C0F",fontSize:"4%"},{html:"\u8F83\u5C0F",fontSize:"5%"},{default:!0,html:"\u9002\u4E2D",fontSize:"6%"},{html:"\u8F83\u5927",fontSize:"7%"},{html:"\u6781\u5927",fontSize:"8%"}],onSelect:function(R){return h.config({fontSize:R.fontSize}),R.html}},{width:200,html:"\u4E0D\u900F\u660E\u5EA6",icon:"",tooltip:"100%",selector:[{default:!0,opacity:1,html:"100%"},{opacity:.75,html:"75%"},{opacity:.5,html:"50%"},{opacity:.25,html:"25%"},{opacity:0,html:"0%"}],onSelect:function(R){return h.config({opacity:R.opacity}),R.html}},{width:200,html:"\u663E\u793A\u8303\u56F4",icon:"",tooltip:"3/4",selector:[{html:"1/4",margin:[10,"75%"]},{html:"\u534A\u5C4F",margin:[10,"50%"]},{default:!0,html:"3/4",margin:[10,"25%"]},{html:"\u6EE1\u5C4F",margin:[10,10]}],onSelect:function(R){return h.config({margin:R.margin}),R.html}},{html:"\u5F39\u5E55\u9632\u91CD\u53E0",icon:"",tooltip:t.antiOverlap?"\u5F00\u542F":"\u5173\u95ED",switch:t.antiOverlap,onSwitch:R=>(h.config({antiOverlap:!R.switch}),R.tooltip=R.switch?"\u5173\u95ED":"\u5F00\u542F",!R.switch)},{html:"\u540C\u6B65\u89C6\u9891\u901F\u5EA6",icon:"",tooltip:t.synchronousPlayback?"\u5F00\u542F":"\u5173\u95ED",switch:t.synchronousPlayback,onSwitch:R=>(h.config({synchronousPlayback:!R.switch}),R.tooltip=R.switch?"\u5173\u95ED":"\u5F00\u542F",!R.switch)}]})},typeof document<"u"&&!document.getElementById("artplayer-plugin-danmuku")){const c=document.createElement("style");c.id="artplayer-plugin-danmuku",c.textContent=m.default,document.head.appendChild(c)}},{"bundle-text:./style.less":"chNhY","bundle-text:./img/danmu-on.svg":"j5M2a","bundle-text:./img/danmu-off.svg":"d9WLf","bundle-text:./img/danmu-config.svg":"8Y3Ij","bundle-text:./img/danmu-style.svg":"hltwt","@parcel/transformer-js/src/esmodule-helpers.js":"9v6Cv"}],chNhY:[function(M,C,y){C.exports='.art-danmuku-emitter{height:32px;width:100%;max-width:100%;color:#fff;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#ffffff4d;border-radius:3px;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:12px;line-height:1;display:flex;position:relative}.art-danmuku-emitter *,.art-danmuku-emitter :before,.art-danmuku-emitter :after{box-sizing:border-box;margin:0;padding:0}.art-danmuku-emitter .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-danmuku-emitter .art-icon svg{fill:#fff}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-danmuku-emitter .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-danmuku-emitter .art-danmuku-left{border-radius:3px 0 0 3px;flex:1;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style{width:32px;justify-content:center;align-items:center;display:flex;position:relative}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel{z-index:999;width:200px;padding-bottom:10px;display:none;position:absolute;bottom:30px;left:-85px}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner{background-color:#000000e6;border-radius:3px;flex-direction:column;padding:10px 10px 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-title{margin-bottom:10px;font-size:13px}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes{justify-content:space-between;margin-bottom:15px;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes .art-danmuku-style-panel-mode{width:47%;cursor:pointer;color:#fff;border:1px solid #fff;justify-content:center;padding:5px 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-modes .art-danmuku-style-panel-mode.art-current{background-color:#00a1d6;border:1px solid #00a1d6}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors{flex-wrap:wrap;justify-content:space-between;gap:5px;margin-bottom:10px;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color{cursor:pointer;width:20px;height:20px;border:1px solid #fff}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color.art-current{position:relative;box-shadow:0 0 2px #fff}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel .art-danmuku-style-panel-inner .art-danmuku-style-panel-colors .art-danmuku-style-panel-color.art-current:before{content:"";width:100%;height:100%;border:2px solid #000;position:absolute;inset:0}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style:hover .art-danmuku-style-panel{display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-icon{opacity:.75;cursor:pointer}.art-danmuku-emitter .art-danmuku-left .art-danmuku-style .art-icon:hover{opacity:1}.art-danmuku-emitter .art-danmuku-left .art-danmuku-input{width:100%;color:#fff;background-color:#0000;border:none;outline:none;flex:1;padding:0 10px 0 0;display:flex}.art-danmuku-emitter .art-danmuku-left .art-danmuku-input::placeholder,.art-danmuku-emitter .art-danmuku-left .art-danmuku-input::-webkit-input-placeholder{color:#ffffff80}.art-danmuku-emitter .art-danmuku-send{width:50px;cursor:pointer;background-color:#00a1d6;border-radius:0 3px 3px 0;justify-content:center;align-items:center;display:flex}.art-danmuku-emitter .art-danmuku-send:hover{background-color:#00b5e5}.art-danmuku-emitter .art-danmuku-send.art-disabled{opacity:.5;pointer-events:none}.art-danmuku-emitter.art-danmuku-mount{height:34px;max-width:100%!important}.art-danmuku-emitter.art-danmuku-mount .art-danmuku-left .art-danmuku-style .art-danmuku-style-panel{left:0}.art-danmuku-emitter.art-danmuku-mount .art-danmuku-send{width:60px}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left{background:#f4f4f4;border:1px solid #dadada}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-style .art-icon svg{fill:#666}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input{color:#000}.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input::placeholder,.art-danmuku-emitter.art-danmuku-mount.art-danmuku-theme-light .art-danmuku-left .art-danmuku-input::-webkit-input-placeholder{color:#00000080}.art-layer-danmuku-emitter{z-index:99;width:100%;position:absolute;bottom:-40px;left:0;right:0}'},{}],j5M2a:[function(M,C,y){C.exports='<svg viewBox="0 0 1152 1024" width="22" height="22" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M311.467 661.333c0 4.267-4.267 8.534-8.534 12.8 0 4.267 0 4.267-4.266 8.534h-12.8c-4.267 0-8.534-4.267-17.067-8.534-8.533-8.533-17.067-8.533-25.6-8.533-8.533 0-12.8 4.267-17.067 12.8-4.266 12.8-8.533 21.333-4.266 29.867 4.266 8.533 12.8 17.066 25.6 21.333 17.066 8.533 34.133 17.067 46.933 17.067 12.8 0 21.333-4.267 34.133-8.534 8.534-4.266 17.067-17.066 25.6-29.866 8.534-12.8 12.8-34.134 17.067-55.467 4.267-21.333 4.267-51.2 4.267-85.333 0-12.8 0-21.334-4.267-29.867 0-8.533-4.267-12.8-8.533-17.067-4.267-4.266-8.534-8.533-12.8-8.533-4.267 0-12.8-4.267-21.334-4.267h-55.466s-4.267-4.266 0-8.533l4.266-38.4c0-4.267 0-8.533 4.267-8.533h46.933c17.067 0 25.6-4.267 34.134-12.8 8.533-8.534 12.8-21.334 12.8-42.667v-72.533c0-17.067-4.267-34.134-8.534-42.667-12.8-12.8-25.6-17.067-42.666-17.067H243.2c-8.533 0-17.067 0-21.333 4.267-4.267 8.533-4.267 12.8-4.267 25.6 0 8.533 0 17.067 4.267 21.333 4.266 4.267 12.8 8.534 21.333 8.534h64c4.267 0 8.533 0 8.533 4.266v34.134c0 8.533 0 12.8-4.266 12.8 0 0-4.267 4.266-8.534 4.266H268.8c-8.533 0-12.8 0-21.333 4.267-4.267 0-8.534 4.267-8.534 4.267-4.266 4.266-8.533 12.8-8.533 17.066 0 8.534-4.267 17.067-4.267 25.6l-8.533 72.534v29.866c0 8.534 4.267 12.8 8.533 17.067 4.267 4.267 8.534 4.267 17.067 8.533h68.267c4.266 0 8.533 0 8.533 4.267s4.267 8.533 4.267 17.067c0 21.333 0 42.666-4.267 55.466 0 8.534-4.267 21.334-8.533 25.6zM896 486.4c-93.867 0-174.933 51.2-217.6 123.733H571.733V576H640c21.333 0 34.133-4.267 42.667-12.8 8.533-8.533 12.8-21.333 12.8-42.667V358.4c0-21.333-4.267-34.133-12.8-42.667-8.534-8.533-21.334-12.8-42.667-12.8 0-4.266 4.267-4.266 4.267-8.533-4.267 0-4.267-4.267-4.267-4.267 4.267-12.8 8.533-21.333 4.267-25.6 0-8.533-4.267-12.8-12.8-21.333-8.534-4.267-17.067-4.267-21.334-4.267-8.533 4.267-12.8 8.534-21.333 21.334-4.267 8.533-8.533 12.8-12.8 21.333-4.267 8.533-8.533 12.8-12.8 21.333H512c-4.267-8.533-8.533-17.066-8.533-21.333-4.267-8.533-8.534-12.8-12.8-21.333-4.267-12.8-12.8-17.067-21.334-17.067s-17.066 0-25.6 8.533c-8.533 8.534-12.8 12.8-12.8 21.334s0 17.066 8.534 25.6l4.266 4.266L448 307.2c-17.067 0-29.867 4.267-38.4 12.8-8.533 4.267-12.8 21.333-12.8 38.4v157.867c0 21.333 4.267 34.133 12.8 42.666 8.533 8.534 21.333 12.8 42.667 12.8H512v34.134h-98.133c-12.8 0-21.334 0-25.6 4.266-4.267 4.267-8.534 8.534-8.534 21.334v17.066c0 4.267 4.267 8.534 4.267 8.534 4.267 0 4.267 4.266 8.533 4.266H512V716.8c0 12.8 4.267 21.333 8.533 25.6 4.267 4.267 12.8 8.533 21.334 8.533 12.8 0 21.333-4.266 25.6-8.533 4.266-4.267 4.266-12.8 4.266-25.6v-55.467H652.8c-8.533 25.6-12.8 51.2-12.8 76.8 0 140.8 115.2 256 256 256s256-115.2 256-256S1036.8 486.4 896 486.4zm-328.533-128h55.466c4.267 0 4.267 0 4.267 4.267V409.6h-59.733v-51.2zm0 102.4H627.2V512h-55.467v-51.2zM512 516.267h-55.467v-51.2H512v51.2zm0-102.4h-59.733V362.667H512v51.2zm384 499.2c-93.867 0-170.667-76.8-170.667-170.667S802.133 571.733 896 571.733s170.667 76.8 170.667 170.667S989.867 913.067 896 913.067z"/><path fill="#fff" d="M951.467 669.867 878.933 742.4l-29.866-25.6C832 699.733 806.4 704 789.333 721.067c-17.066 17.066-12.8 42.666 4.267 59.733l59.733 51.2c8.534 8.533 17.067 8.533 29.867 8.533s21.333-4.266 29.867-12.8l102.4-102.4c17.066-17.066 17.066-42.666 0-59.733-21.334-12.8-46.934-12.8-64 4.267zm-371.2 209.066H213.333c-72.533 0-128-55.466-128-119.466V230.4c0-64 55.467-119.467 128-119.467h512c72.534 0 128 55.467 128 119.467v140.8c0 25.6 17.067 42.667 42.667 42.667s42.667-17.067 42.667-42.667V230.4c0-115.2-93.867-204.8-213.334-204.8h-512C93.867 25.6 0 119.467 0 230.4v529.067c0 115.2 93.867 204.8 213.333 204.8h366.934c25.6 0 42.666-17.067 42.666-42.667s-21.333-42.667-42.666-42.667z"/></svg>'},{}],d9WLf:[function(M,C,y){C.exports='<svg viewBox="0 0 1152 1024" width="22" height="22" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M311.296 661.504c0 4.096-4.096 8.704-8.704 12.8 0 4.096 0 4.096-4.096 8.704h-12.8c-4.096 0-8.704-4.096-16.896-8.704-8.704-8.704-16.896-8.704-25.6-8.704s-12.8 4.096-16.896 12.8c-4.096 12.8-8.704 21.504-4.096 29.696 4.096 8.704 12.8 16.896 25.6 21.504 16.896 8.704 34.304 16.896 47.104 16.896 12.8 0 21.504-4.096 34.304-8.704 8.704-4.096 16.896-16.896 25.6-29.696s12.8-34.304 16.896-55.296c4.096-21.504 4.096-51.2 4.096-85.504 0-12.8 0-21.504-4.096-29.696 0-8.704-4.096-12.8-8.704-16.896-4.096-4.096-8.704-8.704-12.8-8.704s-12.8-4.096-21.504-4.096h-55.808s-4.096-4.096 0-8.704l4.096-38.4c0-4.096 0-8.704 4.096-8.704h47.104c16.896 0 25.6-4.096 34.304-12.8s12.8-21.504 12.8-42.496v-72.704c0-16.896-4.096-34.304-8.704-42.496-12.8-12.8-25.6-16.896-42.496-16.896H243.2c-8.704 0-16.896 0-21.504 4.096-4.096 8.704-4.096 12.8-4.096 25.6 0 8.704 0 16.896 4.096 21.504 4.096 4.096 12.8 8.704 21.504 8.704h64c4.096 0 8.704 0 8.704 4.096v34.304c0 8.704 0 12.8-4.096 12.8 0 0-4.096 4.096-8.704 4.096H268.8c-8.704 0-12.8 0-21.504 4.096-4.096 0-8.704 4.096-8.704 4.096-4.096 4.096-8.704 12.8-8.704 16.896 0 8.704-4.096 16.896-4.096 25.6l-8.704 72.704v29.696c0 8.704 4.096 12.8 8.704 16.896s8.704 4.096 16.896 8.704h68.096c4.096 0 8.704 0 8.704 4.096s4.096 8.704 4.096 16.896c0 21.504 0 42.496-4.096 55.296.512 9.216-3.584 22.016-8.192 26.624zM896 486.4c-93.696 0-175.104 51.2-217.6 123.904H571.904V576H640c21.504 0 34.304-4.096 42.496-12.8 8.704-8.704 12.8-21.504 12.8-42.496V358.4c0-21.504-4.096-34.304-12.8-42.496-8.704-8.704-21.504-12.8-42.496-12.8 0-4.096 4.096-4.096 4.096-8.704-4.096 0-4.096-4.096-4.096-4.096 4.096-12.8 8.704-21.504 4.096-25.6 0-8.704-4.096-12.8-12.8-21.504-8.704-4.096-16.896-4.096-21.504-4.096-8.704 4.096-12.8 8.704-21.504 21.504-4.096 8.704-8.704 12.8-12.8 21.504s-8.704 12.8-12.8 21.504h-51.2c-4.096-8.704-8.704-16.896-8.704-21.504-4.096-8.704-8.704-12.8-12.8-21.504-4.096-12.8-12.8-16.896-21.504-16.896s-16.896 0-25.6 8.704-12.8 12.8-12.8 21.504 0 16.896 8.704 25.6l4.096 4.096 4.096 4.096c-16.896 0-29.696 4.096-38.4 12.8-8.704 4.096-12.8 21.504-12.8 38.4v157.696c0 21.504 4.096 34.304 12.8 42.496 8.704 8.704 21.504 12.8 42.496 12.8H512v34.304h-98.304c-12.8 0-21.504 0-25.6 4.096s-8.704 8.704-8.704 21.504v16.896c0 4.096 4.096 8.704 4.096 8.704 4.096 0 4.096 4.096 8.704 4.096H512V716.8c0 12.8 4.096 21.504 8.704 25.6 4.096 4.096 12.8 8.704 21.504 8.704 12.8 0 21.504-4.096 25.6-8.704 4.096-4.096 4.096-12.8 4.096-25.6v-55.296H652.8c-8.704 25.6-12.8 51.2-12.8 76.8 0 140.8 115.2 256 256 256s256-115.2 256-256S1036.8 486.4 896 486.4zm-328.704-128h55.296c4.096 0 4.096 0 4.096 4.096V409.6h-59.904v-51.2zm0 102.4H627.2V512h-55.296v-51.2h-4.608zM512 516.096h-55.296v-51.2H512v51.2zm0-102.4h-59.904v-51.2H512v51.2zm384 499.2c-93.696 0-170.496-76.8-170.496-170.496S802.304 571.904 896 571.904s170.496 76.8 170.496 170.496S989.696 912.896 896 912.896z"/><path fill="#fff" d="M580.096 879.104H213.504c-72.704 0-128-55.296-128-119.296V230.4c0-64 55.296-119.296 128-119.296h512c72.704 0 128 55.296 128 119.296v140.8c0 25.6 16.896 42.496 42.496 42.496s42.496-16.896 42.496-42.496V230.4c0-115.2-93.696-204.8-213.504-204.8h-512C93.696 25.6 0 119.296 0 230.4v528.896c0 115.2 93.696 204.8 213.504 204.8h367.104c25.6 0 42.496-16.896 42.496-42.496s-21.504-42.496-43.008-42.496zm171.52 10.752c-15.36-15.36-15.36-40.96 0-56.32l237.568-237.568c15.36-15.36 40.96-15.36 56.32 0s15.36 40.96 0 56.32L807.936 889.856c-15.36 15.36-40.448 15.36-56.32 0z"/></svg>'},{}],"8Y3Ij":[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="M16.5 8c1.289 0 2.49.375 3.5 1.022V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7.022A6.5 6.5 0 0 1 16.5 8zM7 13H5a1 1 0 0 1 0-2h2a1 1 0 0 1 0 2zm2-4H5a1 1 0 0 1 0-2h4a1 1 0 0 1 0 2z"/><path d="m20.587 13.696-.787-.131a3.503 3.503 0 0 0-.593-1.051l.301-.804a.46.46 0 0 0-.21-.56l-1.005-.581a.52.52 0 0 0-.656.113l-.499.607a3.53 3.53 0 0 0-1.276 0l-.499-.607a.52.52 0 0 0-.656-.113l-1.005.581a.46.46 0 0 0-.21.56l.301.804c-.254.31-.456.665-.593 1.051l-.787.131a.48.48 0 0 0-.413.465v1.209a.48.48 0 0 0 .413.465l.811.135c.144.382.353.733.614 1.038l-.292.78a.46.46 0 0 0 .21.56l1.005.581a.52.52 0 0 0 .656-.113l.515-.626a3.549 3.549 0 0 0 1.136 0l.515.626a.52.52 0 0 0 .656.113l1.005-.581a.46.46 0 0 0 .21-.56l-.292-.78c.261-.305.47-.656.614-1.038l.811-.135A.48.48 0 0 0 21 15.37v-1.209a.48.48 0 0 0-.413-.465zM16.5 16.057a1.29 1.29 0 1 1 .002-2.582 1.29 1.29 0 0 1-.002 2.582z"/></svg>'},{}],hltwt:[function(M,C,y){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22" width="24" height="24"><path d="M17 16H5c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1zM6.96 15c.39 0 .74-.24.89-.6l.65-1.6h5l.66 1.6c.15.36.5.6.89.6.69 0 1.15-.71.88-1.34l-3.88-8.97C11.87 4.27 11.46 4 11 4s-.87.27-1.05.69l-3.88 8.97c-.27.63.2 1.34.89 1.34zM11 5.98 12.87 11H9.13L11 5.98z"/></svg>'},{}]},["E13ST"],"E13ST")})(Ge);const mt=Fe(Ge.exports);var He={exports:{}};(function(xe,Re){(function(C,y){xe.exports=y()})(self,function(){return function(){var M={"./node_modules/es6-promise/dist/es6-promise.js":function(p,m,A){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(_,g){p.exports=g()})(this,function(){function _(W){var z=typeof W;return W!==null&&(z==="object"||z==="function")}function g(W){return typeof W=="function"}var s=void 0;Array.isArray?s=Array.isArray:s=function(W){return Object.prototype.toString.call(W)==="[object Array]"};var r=s,u=0,a=void 0,d=void 0,c=function(z,Y){L[u]=z,L[u+1]=Y,u+=2,u===2&&(d?d(x):O())};function h(W){d=W}function t(W){c=W}var e=typeof window<"u"?window:void 0,n=e||{},i=n.MutationObserver||n.WebKitMutationObserver,f=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",l=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function o(){return function(){return process.nextTick(x)}}function v(){return typeof a<"u"?function(){a(x)}:E()}function D(){var W=0,z=new i(x),Y=document.createTextNode("");return z.observe(Y,{characterData:!0}),function(){Y.data=W=++W%2}}function S(){var W=new MessageChannel;return W.port1.onmessage=x,function(){return W.port2.postMessage(0)}}function E(){var W=setTimeout;return function(){return W(x,1)}}var L=new Array(1e3);function x(){for(var W=0;W<u;W+=2){var z=L[W],Y=L[W+1];z(Y),L[W]=void 0,L[W+1]=void 0}u=0}function b(){try{var W=Function("return this")().require("vertx");return a=W.runOnLoop||W.runOnContext,v()}catch{return E()}}var O=void 0;f?O=o():i?O=D():l?O=S():e===void 0?O=b():O=E();function R(W,z){var Y=this,Z=new this.constructor(F);Z[P]===void 0&&ue(Z);var re=Y._state;if(re){var ne=arguments[re-1];c(function(){return ie(re,Z,ne,Y._result)})}else J(Y,Z,W,z);return Z}function I(W){var z=this;if(W&&typeof W=="object"&&W.constructor===z)return W;var Y=new z(F);return G(Y,W),Y}var P=Math.random().toString(36).substring(2);function F(){}var w=void 0,k=1,B=2;function U(){return new TypeError("You cannot resolve a promise with itself")}function j(){return new TypeError("A promises callback cannot return that same promise.")}function N(W,z,Y,Z){try{W.call(z,Y,Z)}catch(re){return re}}function K(W,z,Y){c(function(Z){var re=!1,ne=N(Y,z,function(te){re||(re=!0,z!==te?G(Z,te):X(Z,te))},function(te){re||(re=!0,V(Z,te))},"Settle: "+(Z._label||" unknown promise"));!re&&ne&&(re=!0,V(Z,ne))},W)}function H(W,z){z._state===k?X(W,z._result):z._state===B?V(W,z._result):J(z,void 0,function(Y){return G(W,Y)},function(Y){return V(W,Y)})}function $(W,z,Y){z.constructor===W.constructor&&Y===R&&z.constructor.resolve===I?H(W,z):Y===void 0?X(W,z):g(Y)?K(W,z,Y):X(W,z)}function G(W,z){if(W===z)V(W,U());else if(_(z)){var Y=void 0;try{Y=z.then}catch(Z){V(W,Z);return}$(W,z,Y)}else X(W,z)}function ee(W){W._onerror&&W._onerror(W._result),Q(W)}function X(W,z){W._state===w&&(W._result=z,W._state=k,W._subscribers.length!==0&&c(Q,W))}function V(W,z){W._state===w&&(W._state=B,W._result=z,c(ee,W))}function J(W,z,Y,Z){var re=W._subscribers,ne=re.length;W._onerror=null,re[ne]=z,re[ne+k]=Y,re[ne+B]=Z,ne===0&&W._state&&c(Q,W)}function Q(W){var z=W._subscribers,Y=W._state;if(z.length!==0){for(var Z=void 0,re=void 0,ne=W._result,te=0;te<z.length;te+=3)Z=z[te],re=z[te+Y],Z?ie(Y,Z,re,ne):re(ne);W._subscribers.length=0}}function ie(W,z,Y,Z){var re=g(Y),ne=void 0,te=void 0,Ee=!0;if(re){try{ne=Y(Z)}catch(ve){Ee=!1,te=ve}if(z===ne){V(z,j());return}}else ne=Z;z._state!==w||(re&&Ee?G(z,ne):Ee===!1?V(z,te):W===k?X(z,ne):W===B&&V(z,ne))}function ae(W,z){try{z(function(Z){G(W,Z)},function(Z){V(W,Z)})}catch(Y){V(W,Y)}}var se=0;function le(){return se++}function ue(W){W[P]=se++,W._state=void 0,W._result=void 0,W._subscribers=[]}function q(){return new Error("Array Methods must be provided an Array")}var oe=function(){function W(z,Y){this._instanceConstructor=z,this.promise=new z(F),this.promise[P]||ue(this.promise),r(Y)?(this.length=Y.length,this._remaining=Y.length,this._result=new Array(this.length),this.length===0?X(this.promise,this._result):(this.length=this.length||0,this._enumerate(Y),this._remaining===0&&X(this.promise,this._result))):V(this.promise,q())}return W.prototype._enumerate=function(Y){for(var Z=0;this._state===w&&Z<Y.length;Z++)this._eachEntry(Y[Z],Z)},W.prototype._eachEntry=function(Y,Z){var re=this._instanceConstructor,ne=re.resolve;if(ne===I){var te=void 0,Ee=void 0,ve=!1;try{te=Y.then}catch(_e){ve=!0,Ee=_e}if(te===R&&Y._state!==w)this._settledAt(Y._state,Z,Y._result);else if(typeof te!="function")this._remaining--,this._result[Z]=Y;else if(re===fe){var ge=new re(F);ve?V(ge,Ee):$(ge,Y,te),this._willSettleAt(ge,Z)}else this._willSettleAt(new re(function(_e){return _e(Y)}),Z)}else this._willSettleAt(ne(Y),Z)},W.prototype._settledAt=function(Y,Z,re){var ne=this.promise;ne._state===w&&(this._remaining--,Y===B?V(ne,re):this._result[Z]=re),this._remaining===0&&X(ne,this._result)},W.prototype._willSettleAt=function(Y,Z){var re=this;J(Y,void 0,function(ne){return re._settledAt(k,Z,ne)},function(ne){return re._settledAt(B,Z,ne)})},W}();function de(W){return new oe(this,W).promise}function ce(W){var z=this;return r(W)?new z(function(Y,Z){for(var re=W.length,ne=0;ne<re;ne++)z.resolve(W[ne]).then(Y,Z)}):new z(function(Y,Z){return Z(new TypeError("You must pass an array to race."))})}function pe(W){var z=this,Y=new z(F);return V(Y,W),Y}function he(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ye(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var fe=function(){function W(z){this[P]=le(),this._result=this._state=void 0,this._subscribers=[],F!==z&&(typeof z!="function"&&he(),this instanceof W?ae(this,z):ye())}return W.prototype.catch=function(Y){return this.then(null,Y)},W.prototype.finally=function(Y){var Z=this,re=Z.constructor;return g(Y)?Z.then(function(ne){return re.resolve(Y()).then(function(){return ne})},function(ne){return re.resolve(Y()).then(function(){throw ne})}):Z.then(Y,Y)},W}();fe.prototype.then=R,fe.all=de,fe.race=ce,fe.resolve=I,fe.reject=pe,fe._setScheduler=h,fe._setAsap=t,fe._asap=c;function me(){var W=void 0;if(typeof A.g<"u")W=A.g;else if(typeof self<"u")W=self;else try{W=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var z=W.Promise;if(z){var Y=null;try{Y=Object.prototype.toString.call(z.resolve())}catch{}if(Y==="[object Promise]"&&!z.cast)return}W.Promise=fe}return fe.polyfill=me,fe.Promise=fe,fe})},"./node_modules/events/events.js":function(p){var m=typeof Reflect=="object"?Reflect:null,A=m&&typeof m.apply=="function"?m.apply:function(E,L,x){return Function.prototype.apply.call(E,L,x)},_;m&&typeof m.ownKeys=="function"?_=m.ownKeys:Object.getOwnPropertySymbols?_=function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:_=function(E){return Object.getOwnPropertyNames(E)};function g(S){console&&console.warn&&console.warn(S)}var s=Number.isNaN||function(E){return E!==E};function r(){r.init.call(this)}p.exports=r,p.exports.once=o,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var u=10;function a(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(S){if(typeof S!="number"||S<0||s(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");u=S}}),r.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(E){if(typeof E!="number"||E<0||s(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this};function d(S){return S._maxListeners===void 0?r.defaultMaxListeners:S._maxListeners}r.prototype.getMaxListeners=function(){return d(this)},r.prototype.emit=function(E){for(var L=[],x=1;x<arguments.length;x++)L.push(arguments[x]);var b=E==="error",O=this._events;if(O!==void 0)b=b&&O.error===void 0;else if(!b)return!1;if(b){var R;if(L.length>0&&(R=L[0]),R instanceof Error)throw R;var I=new Error("Unhandled error."+(R?" ("+R.message+")":""));throw I.context=R,I}var P=O[E];if(P===void 0)return!1;if(typeof P=="function")A(P,this,L);else for(var F=P.length,w=i(P,F),x=0;x<F;++x)A(w[x],this,L);return!0};function c(S,E,L,x){var b,O,R;if(a(L),O=S._events,O===void 0?(O=S._events=Object.create(null),S._eventsCount=0):(O.newListener!==void 0&&(S.emit("newListener",E,L.listener?L.listener:L),O=S._events),R=O[E]),R===void 0)R=O[E]=L,++S._eventsCount;else if(typeof R=="function"?R=O[E]=x?[L,R]:[R,L]:x?R.unshift(L):R.push(L),b=d(S),b>0&&R.length>b&&!R.warned){R.warned=!0;var I=new Error("Possible EventEmitter memory leak detected. "+R.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit");I.name="MaxListenersExceededWarning",I.emitter=S,I.type=E,I.count=R.length,g(I)}return S}r.prototype.addListener=function(E,L){return c(this,E,L,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(E,L){return c(this,E,L,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function t(S,E,L){var x={fired:!1,wrapFn:void 0,target:S,type:E,listener:L},b=h.bind(x);return b.listener=L,x.wrapFn=b,b}r.prototype.once=function(E,L){return a(L),this.on(E,t(this,E,L)),this},r.prototype.prependOnceListener=function(E,L){return a(L),this.prependListener(E,t(this,E,L)),this},r.prototype.removeListener=function(E,L){var x,b,O,R,I;if(a(L),b=this._events,b===void 0)return this;if(x=b[E],x===void 0)return this;if(x===L||x.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete b[E],b.removeListener&&this.emit("removeListener",E,x.listener||L));else if(typeof x!="function"){for(O=-1,R=x.length-1;R>=0;R--)if(x[R]===L||x[R].listener===L){I=x[R].listener,O=R;break}if(O<0)return this;O===0?x.shift():f(x,O),x.length===1&&(b[E]=x[0]),b.removeListener!==void 0&&this.emit("removeListener",E,I||L)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(E){var L,x,b;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[E]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[E]),this;if(arguments.length===0){var O=Object.keys(x),R;for(b=0;b<O.length;++b)R=O[b],R!=="removeListener"&&this.removeAllListeners(R);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=x[E],typeof L=="function")this.removeListener(E,L);else if(L!==void 0)for(b=L.length-1;b>=0;b--)this.removeListener(E,L[b]);return this};function e(S,E,L){var x=S._events;if(x===void 0)return[];var b=x[E];return b===void 0?[]:typeof b=="function"?L?[b.listener||b]:[b]:L?l(b):i(b,b.length)}r.prototype.listeners=function(E){return e(this,E,!0)},r.prototype.rawListeners=function(E){return e(this,E,!1)},r.listenerCount=function(S,E){return typeof S.listenerCount=="function"?S.listenerCount(E):n.call(S,E)},r.prototype.listenerCount=n;function n(S){var E=this._events;if(E!==void 0){var L=E[S];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}r.prototype.eventNames=function(){return this._eventsCount>0?_(this._events):[]};function i(S,E){for(var L=new Array(E),x=0;x<E;++x)L[x]=S[x];return L}function f(S,E){for(;E+1<S.length;E++)S[E]=S[E+1];S.pop()}function l(S){for(var E=new Array(S.length),L=0;L<E.length;++L)E[L]=S[L].listener||S[L];return E}function o(S,E){return new Promise(function(L,x){function b(R){S.removeListener(E,O),x(R)}function O(){typeof S.removeListener=="function"&&S.removeListener("error",b),L([].slice.call(arguments))}D(S,E,O,{once:!0}),E!=="error"&&v(S,b,{once:!0})})}function v(S,E,L){typeof S.on=="function"&&D(S,"error",E,L)}function D(S,E,L,x){if(typeof S.on=="function")x.once?S.once(E,L):S.on(E,L);else if(typeof S.addEventListener=="function")S.addEventListener(E,function b(O){x.once&&S.removeEventListener(E,b),L(O)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof S)}},"./node_modules/webworkify-webpack/index.js":function(p,m,A){function _(h){var t={};function e(i){if(t[i])return t[i].exports;var f=t[i]={i,l:!1,exports:{}};return h[i].call(f.exports,f,f.exports,e),f.l=!0,f.exports}e.m=h,e.c=t,e.i=function(i){return i},e.d=function(i,f,l){e.o(i,f)||Object.defineProperty(i,f,{configurable:!1,enumerable:!0,get:l})},e.r=function(i){Object.defineProperty(i,"__esModule",{value:!0})},e.n=function(i){var f=i&&i.__esModule?function(){return i.default}:function(){return i};return e.d(f,"a",f),f},e.o=function(i,f){return Object.prototype.hasOwnProperty.call(i,f)},e.p="/",e.oe=function(i){throw console.error(i),i};var n=e(e.s=ENTRY_MODULE);return n.default||n}var g="[\\.|\\-|\\+|\\w|/|@]+",s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+g+").*?\\)";function r(h){return(h+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function u(h){return!isNaN(1*h)}function a(h,t,e){var n={};n[e]=[];var i=t.toString(),f=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!f)return n;for(var l=f[1],o=new RegExp("(\\\\n|\\W)"+r(l)+s,"g"),v;v=o.exec(i);)v[3]!=="dll-reference"&&n[e].push(v[3]);for(o=new RegExp("\\("+r(l)+'\\("(dll-reference\\s('+g+'))"\\)\\)'+s,"g");v=o.exec(i);)h[v[2]]||(n[e].push(v[1]),h[v[2]]=A(v[1]).m),n[v[2]]=n[v[2]]||[],n[v[2]].push(v[4]);for(var D=Object.keys(n),S=0;S<D.length;S++)for(var E=0;E<n[D[S]].length;E++)u(n[D[S]][E])&&(n[D[S]][E]=1*n[D[S]][E]);return n}function d(h){var t=Object.keys(h);return t.reduce(function(e,n){return e||h[n].length>0},!1)}function c(h,t){for(var e={main:[t]},n={main:[]},i={main:{}};d(e);)for(var f=Object.keys(e),l=0;l<f.length;l++){var o=f[l],v=e[o],D=v.pop();if(i[o]=i[o]||{},!(i[o][D]||!h[o][D])){i[o][D]=!0,n[o]=n[o]||[],n[o].push(D);for(var S=a(h,h[o][D],o),E=Object.keys(S),L=0;L<E.length;L++)e[E[L]]=e[E[L]]||[],e[E[L]]=e[E[L]].concat(S[E[L]])}}return n}p.exports=function(h,t){t=t||{};var e={main:A.m},n=t.all?{main:Object.keys(e.main)}:c(e,h),i="";Object.keys(n).filter(function(D){return D!=="main"}).forEach(function(D){for(var S=0;n[D][S];)S++;n[D].push(S),e[D][S]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+"var "+D+" = ("+_.toString().replace("ENTRY_MODULE",JSON.stringify(S))+")({"+n[D].map(function(E){return""+JSON.stringify(E)+": "+e[D][E].toString()}).join(",")+`});
`}),i=i+"new (("+_.toString().replace("ENTRY_MODULE",JSON.stringify(h))+")({"+n.main.map(function(D){return""+JSON.stringify(D)+": "+e.main[D].toString()}).join(",")+"}))(self);";var f=new window.Blob([i],{type:"text/javascript"});if(t.bare)return f;var l=window.URL||window.webkitURL||window.mozURL||window.msURL,o=l.createObjectURL(f),v=new window.Worker(o);return v.objectURL=o,v}},"./src/config.js":function(p,m,A){A.r(m),A.d(m,{defaultConfig:function(){return _},createDefaultConfig:function(){return g}});var _={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function g(){return Object.assign({},_)}},"./src/core/features.js":function(p,m,A){A.r(m);var _=A("./src/io/io-controller.js"),g=A("./src/config.js"),s=function(){function r(){}return r.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},r.supportNetworkStreamIO=function(){var u=new _.default({},(0,g.createDefaultConfig)()),a=u.loaderType;return u.destroy(),a=="fetch-stream-loader"||a=="xhr-moz-chunked-loader"},r.getNetworkLoaderTypeName=function(){var u=new _.default({},(0,g.createDefaultConfig)()),a=u.loaderType;return u.destroy(),a},r.supportNativeMediaPlayback=function(u){r.videoElement==null&&(r.videoElement=window.document.createElement("video"));var a=r.videoElement.canPlayType(u);return a==="probably"||a=="maybe"},r.getFeatureList=function(){var u={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return u.mseFlvPlayback=r.supportMSEH264Playback(),u.networkStreamIO=r.supportNetworkStreamIO(),u.networkLoaderName=r.getNetworkLoaderTypeName(),u.mseLiveFlvPlayback=u.mseFlvPlayback&&u.networkStreamIO,u.nativeMP4H264Playback=r.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),u.nativeWebmVP8Playback=r.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),u.nativeWebmVP9Playback=r.supportNativeMediaPlayback('video/webm; codecs="vp9"'),u},r}();m.default=s},"./src/core/media-info.js":function(p,m,A){A.r(m);var _=function(){function g(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return g.prototype.isComplete=function(){var s=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,r=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&s&&r},g.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},g.prototype.getNearestKeyframe=function(s){if(this.keyframesIndex==null)return null;var r=this.keyframesIndex,u=this._search(r.times,s);return{index:u,milliseconds:r.times[u],fileposition:r.filepositions[u]}},g.prototype._search=function(s,r){var u=0,a=s.length-1,d=0,c=0,h=a;for(r<s[0]&&(u=0,c=h+1);c<=h;)if(d=c+Math.floor((h-c)/2),d===a||r>=s[d]&&r<s[d+1]){u=d;break}else s[d]<r?c=d+1:h=d-1;return u},g}();m.default=_},"./src/core/media-segment-info.js":function(p,m,A){A.r(m),A.d(m,{SampleInfo:function(){return _},MediaSegmentInfo:function(){return g},IDRSampleList:function(){return s},MediaSegmentInfoList:function(){return r}});var _=function(){function u(a,d,c,h,t){this.dts=a,this.pts=d,this.duration=c,this.originalDts=h,this.isSyncPoint=t,this.fileposition=null}return u}(),g=function(){function u(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return u.prototype.appendSyncPoint=function(a){a.isSyncPoint=!0,this.syncPoints.push(a)},u}(),s=function(){function u(){this._list=[]}return u.prototype.clear=function(){this._list=[]},u.prototype.appendArray=function(a){var d=this._list;a.length!==0&&(d.length>0&&a[0].originalDts<d[d.length-1].originalDts&&this.clear(),Array.prototype.push.apply(d,a))},u.prototype.getLastSyncPointBeforeDts=function(a){if(this._list.length==0)return null;var d=this._list,c=0,h=d.length-1,t=0,e=0,n=h;for(a<d[0].dts&&(c=0,e=n+1);e<=n;)if(t=e+Math.floor((n-e)/2),t===h||a>=d[t].dts&&a<d[t+1].dts){c=t;break}else d[t].dts<a?e=t+1:n=t-1;return this._list[c]},u}(),r=function(){function u(a){this._type=a,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(u.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),u.prototype.isEmpty=function(){return this._list.length===0},u.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},u.prototype._searchNearestSegmentBefore=function(a){var d=this._list;if(d.length===0)return-2;var c=d.length-1,h=0,t=0,e=c,n=0;if(a<d[0].originalBeginDts)return n=-1,n;for(;t<=e;)if(h=t+Math.floor((e-t)/2),h===c||a>d[h].lastSample.originalDts&&a<d[h+1].originalBeginDts){n=h;break}else d[h].originalBeginDts<a?t=h+1:e=h-1;return n},u.prototype._searchNearestSegmentAfter=function(a){return this._searchNearestSegmentBefore(a)+1},u.prototype.append=function(a){var d=this._list,c=a,h=this._lastAppendLocation,t=0;h!==-1&&h<d.length&&c.originalBeginDts>=d[h].lastSample.originalDts&&(h===d.length-1||h<d.length-1&&c.originalBeginDts<d[h+1].originalBeginDts)?t=h+1:d.length>0&&(t=this._searchNearestSegmentBefore(c.originalBeginDts)+1),this._lastAppendLocation=t,this._list.splice(t,0,c)},u.prototype.getLastSegmentBefore=function(a){var d=this._searchNearestSegmentBefore(a);return d>=0?this._list[d]:null},u.prototype.getLastSampleBefore=function(a){var d=this.getLastSegmentBefore(a);return d!=null?d.lastSample:null},u.prototype.getLastSyncPointBefore=function(a){for(var d=this._searchNearestSegmentBefore(a),c=this._list[d].syncPoints;c.length===0&&d>0;)d--,c=this._list[d].syncPoints;return c.length>0?c[c.length-1]:null},u}()},"./src/core/mse-controller.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./src/utils/logger.js"),r=A("./src/utils/browser.js"),u=A("./src/core/mse-events.js"),a=A("./src/core/media-segment-info.js"),d=A("./src/utils/exception.js"),c=function(){function h(t){this.TAG="MSEController",this._config=t,this._emitter=new(g()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new a.IDRSampleList}return h.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},h.prototype.on=function(t,e){this._emitter.addListener(t,e)},h.prototype.off=function(t,e){this._emitter.removeListener(t,e)},h.prototype.attachMediaElement=function(t){if(this._mediaSource)throw new d.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var e=this._mediaSource=new window.MediaSource;e.addEventListener("sourceopen",this.e.onSourceOpen),e.addEventListener("sourceended",this.e.onSourceEnded),e.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=t,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),t.src=this._mediaSourceObjectURL},h.prototype.detachMediaElement=function(){if(this._mediaSource){var t=this._mediaSource;for(var e in this._sourceBuffers){var n=this._pendingSegments[e];n.splice(0,n.length),this._pendingSegments[e]=null,this._pendingRemoveRanges[e]=null,this._lastInitSegments[e]=null;var i=this._sourceBuffers[e];if(i){if(t.readyState!=="closed"){try{t.removeSourceBuffer(i)}catch(f){s.default.e(this.TAG,f.message)}i.removeEventListener("error",this.e.onSourceBufferError),i.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[e]=null,this._sourceBuffers[e]=null}}if(t.readyState==="open")try{t.endOfStream()}catch(f){s.default.e(this.TAG,f.message)}t.removeEventListener("sourceopen",this.e.onSourceOpen),t.removeEventListener("sourceended",this.e.onSourceEnded),t.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},h.prototype.appendInitSegment=function(t,e){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(t),this._pendingSegments[t.type].push(t);return}var n=t,i=""+n.container;n.codec&&n.codec.length>0&&(i+=";codecs="+n.codec);var f=!1;if(s.default.v(this.TAG,"Received Initialization Segment, mimeType: "+i),this._lastInitSegments[n.type]=n,i!==this._mimeTypes[n.type]){if(this._mimeTypes[n.type])s.default.v(this.TAG,"Notice: "+n.type+" mimeType changed, origin: "+this._mimeTypes[n.type]+", target: "+i);else{f=!0;try{var l=this._sourceBuffers[n.type]=this._mediaSource.addSourceBuffer(i);l.addEventListener("error",this.e.onSourceBufferError),l.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(o){s.default.e(this.TAG,o.message),this._emitter.emit(u.default.ERROR,{code:o.code,msg:o.message});return}}this._mimeTypes[n.type]=i}e||this._pendingSegments[n.type].push(n),f||this._sourceBuffers[n.type]&&!this._sourceBuffers[n.type].updating&&this._doAppendSegments(),r.default.safari&&n.container==="audio/mpeg"&&n.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=n.mediaDuration/1e3,this._updateMediaSourceDuration())},h.prototype.appendMediaSegment=function(t){var e=t;this._pendingSegments[e.type].push(e),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var n=this._sourceBuffers[e.type];n&&!n.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},h.prototype.seek=function(t){for(var e in this._sourceBuffers)if(!!this._sourceBuffers[e]){var n=this._sourceBuffers[e];if(this._mediaSource.readyState==="open")try{n.abort()}catch(D){s.default.e(this.TAG,D.message)}this._idrList.clear();var i=this._pendingSegments[e];if(i.splice(0,i.length),this._mediaSource.readyState!=="closed"){for(var f=0;f<n.buffered.length;f++){var l=n.buffered.start(f),o=n.buffered.end(f);this._pendingRemoveRanges[e].push({start:l,end:o})}if(n.updating||this._doRemoveRanges(),r.default.safari){var v=this._lastInitSegments[e];v&&(this._pendingSegments[e].push(v),n.updating||this._doAppendSegments())}}}},h.prototype.endOfStream=function(){var t=this._mediaSource,e=this._sourceBuffers;if(!t||t.readyState!=="open"){t&&t.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}e.video&&e.video.updating||e.audio&&e.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,t.endOfStream())},h.prototype.getNearestKeyframe=function(t){return this._idrList.getLastSyncPointBeforeDts(t)},h.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var t=this._mediaElement.currentTime;for(var e in this._sourceBuffers){var n=this._sourceBuffers[e];if(n){var i=n.buffered;if(i.length>=1&&t-i.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},h.prototype._doCleanupSourceBuffer=function(){var t=this._mediaElement.currentTime;for(var e in this._sourceBuffers){var n=this._sourceBuffers[e];if(n){for(var i=n.buffered,f=!1,l=0;l<i.length;l++){var o=i.start(l),v=i.end(l);if(o<=t&&t<v+3){if(t-o>=this._config.autoCleanupMaxBackwardDuration){f=!0;var D=t-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[e].push({start:o,end:D})}}else v<t&&(f=!0,this._pendingRemoveRanges[e].push({start:o,end:v}))}f&&!n.updating&&this._doRemoveRanges()}}},h.prototype._updateMediaSourceDuration=function(){var t=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(t.video&&t.video.updating||t.audio&&t.audio.updating)){var e=this._mediaSource.duration,n=this._pendingMediaDuration;n>0&&(isNaN(e)||n>e)&&(s.default.v(this.TAG,"Update MediaSource duration from "+e+" to "+n),this._mediaSource.duration=n),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},h.prototype._doRemoveRanges=function(){for(var t in this._pendingRemoveRanges)if(!(!this._sourceBuffers[t]||this._sourceBuffers[t].updating))for(var e=this._sourceBuffers[t],n=this._pendingRemoveRanges[t];n.length&&!e.updating;){var i=n.shift();e.remove(i.start,i.end)}},h.prototype._doAppendSegments=function(){var t=this._pendingSegments;for(var e in t)if(!(!this._sourceBuffers[e]||this._sourceBuffers[e].updating)&&t[e].length>0){var n=t[e].shift();if(n.timestampOffset){var i=this._sourceBuffers[e].timestampOffset,f=n.timestampOffset/1e3,l=Math.abs(i-f);l>.1&&(s.default.v(this.TAG,"Update MPEG audio timestampOffset from "+i+" to "+f),this._sourceBuffers[e].timestampOffset=f),delete n.timestampOffset}if(!n.data||n.data.byteLength===0)continue;try{this._sourceBuffers[e].appendBuffer(n.data),this._isBufferFull=!1,e==="video"&&n.hasOwnProperty("info")&&this._idrList.appendArray(n.info.syncPoints)}catch(o){this._pendingSegments[e].unshift(n),o.code===22?(this._isBufferFull||this._emitter.emit(u.default.BUFFER_FULL),this._isBufferFull=!0):(s.default.e(this.TAG,o.message),this._emitter.emit(u.default.ERROR,{code:o.code,msg:o.message}))}}},h.prototype._onSourceOpen=function(){if(s.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var t=this._pendingSourceBufferInit;t.length;){var e=t.shift();this.appendInitSegment(e,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(u.default.SOURCE_OPEN)},h.prototype._onSourceEnded=function(){s.default.v(this.TAG,"MediaSource onSourceEnded")},h.prototype._onSourceClose=function(){s.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},h.prototype._hasPendingSegments=function(){var t=this._pendingSegments;return t.video.length>0||t.audio.length>0},h.prototype._hasPendingRemoveRanges=function(){var t=this._pendingRemoveRanges;return t.video.length>0||t.audio.length>0},h.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(u.default.UPDATE_END)},h.prototype._onSourceBufferError=function(t){s.default.e(this.TAG,"SourceBuffer Error: "+t)},h}();m.default=c},"./src/core/mse-events.js":function(p,m,A){A.r(m);var _={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};m.default=_},"./src/core/transmuxer.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./node_modules/webworkify-webpack/index.js"),r=A.n(s),u=A("./src/utils/logger.js"),a=A("./src/utils/logging-control.js"),d=A("./src/core/transmuxing-controller.js"),c=A("./src/core/transmuxing-events.js"),h=A("./src/core/media-info.js"),t=function(){function e(n,i){if(this.TAG="Transmuxer",this._emitter=new(g()),i.enableWorker&&typeof Worker<"u")try{this._worker=r()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[n,i]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},a.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:a.default.getConfig()})}catch{u.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new d.default(n,i)}else this._controller=new d.default(n,i);if(this._controller){var f=this._controller;f.on(c.default.IO_ERROR,this._onIOError.bind(this)),f.on(c.default.DEMUX_ERROR,this._onDemuxError.bind(this)),f.on(c.default.INIT_SEGMENT,this._onInitSegment.bind(this)),f.on(c.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),f.on(c.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),f.on(c.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),f.on(c.default.MEDIA_INFO,this._onMediaInfo.bind(this)),f.on(c.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),f.on(c.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),f.on(c.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),f.on(c.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),a.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(n,i){this._emitter.addListener(n,i)},e.prototype.off=function(n,i){this._emitter.removeListener(n,i)},e.prototype.hasWorker=function(){return this._worker!=null},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(n){this._worker?this._worker.postMessage({cmd:"seek",param:n}):this._controller.seek(n)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(n,i){var f=this;Promise.resolve().then(function(){f._emitter.emit(c.default.INIT_SEGMENT,n,i)})},e.prototype._onMediaSegment=function(n,i){var f=this;Promise.resolve().then(function(){f._emitter.emit(c.default.MEDIA_SEGMENT,n,i)})},e.prototype._onLoadingComplete=function(){var n=this;Promise.resolve().then(function(){n._emitter.emit(c.default.LOADING_COMPLETE)})},e.prototype._onRecoveredEarlyEof=function(){var n=this;Promise.resolve().then(function(){n._emitter.emit(c.default.RECOVERED_EARLY_EOF)})},e.prototype._onMediaInfo=function(n){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.MEDIA_INFO,n)})},e.prototype._onMetaDataArrived=function(n){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.METADATA_ARRIVED,n)})},e.prototype._onScriptDataArrived=function(n){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.SCRIPTDATA_ARRIVED,n)})},e.prototype._onStatisticsInfo=function(n){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.STATISTICS_INFO,n)})},e.prototype._onIOError=function(n,i){var f=this;Promise.resolve().then(function(){f._emitter.emit(c.default.IO_ERROR,n,i)})},e.prototype._onDemuxError=function(n,i){var f=this;Promise.resolve().then(function(){f._emitter.emit(c.default.DEMUX_ERROR,n,i)})},e.prototype._onRecommendSeekpoint=function(n){var i=this;Promise.resolve().then(function(){i._emitter.emit(c.default.RECOMMEND_SEEKPOINT,n)})},e.prototype._onLoggingConfigChanged=function(n){this._worker&&this._worker.postMessage({cmd:"logging_config",param:n})},e.prototype._onWorkerMessage=function(n){var i=n.data,f=i.data;if(i.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(i.msg){case c.default.INIT_SEGMENT:case c.default.MEDIA_SEGMENT:this._emitter.emit(i.msg,f.type,f.data);break;case c.default.LOADING_COMPLETE:case c.default.RECOVERED_EARLY_EOF:this._emitter.emit(i.msg);break;case c.default.MEDIA_INFO:Object.setPrototypeOf(f,h.default.prototype),this._emitter.emit(i.msg,f);break;case c.default.METADATA_ARRIVED:case c.default.SCRIPTDATA_ARRIVED:case c.default.STATISTICS_INFO:this._emitter.emit(i.msg,f);break;case c.default.IO_ERROR:case c.default.DEMUX_ERROR:this._emitter.emit(i.msg,f.type,f.info);break;case c.default.RECOMMEND_SEEKPOINT:this._emitter.emit(i.msg,f);break;case"logcat_callback":u.default.emitter.emit("log",f.type,f.logcat);break}},e}();m.default=t},"./src/core/transmuxing-controller.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./src/utils/logger.js"),r=A("./src/utils/browser.js"),u=A("./src/core/media-info.js"),a=A("./src/demux/flv-demuxer.js"),d=A("./src/remux/mp4-remuxer.js"),c=A("./src/demux/demux-errors.js"),h=A("./src/io/io-controller.js"),t=A("./src/core/transmuxing-events.js"),e=function(){function n(i,f){this.TAG="TransmuxingController",this._emitter=new(g()),this._config=f,i.segments||(i.segments=[{duration:i.duration,filesize:i.filesize,url:i.url}]),typeof i.cors!="boolean"&&(i.cors=!0),typeof i.withCredentials!="boolean"&&(i.withCredentials=!1),this._mediaDataSource=i,this._currentSegmentIndex=0;var l=0;this._mediaDataSource.segments.forEach(function(o){o.timestampBase=l,l+=o.duration,o.cors=i.cors,o.withCredentials=i.withCredentials,f.referrerPolicy&&(o.referrerPolicy=f.referrerPolicy)}),!isNaN(l)&&this._mediaDataSource.duration!==l&&(this._mediaDataSource.duration=l),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return n.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},n.prototype.on=function(i,f){this._emitter.addListener(i,f)},n.prototype.off=function(i,f){this._emitter.removeListener(i,f)},n.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},n.prototype._loadSegment=function(i,f){this._currentSegmentIndex=i;var l=this._mediaDataSource.segments[i],o=this._ioctl=new h.default(l,this._config,i);o.onError=this._onIOException.bind(this),o.onSeeked=this._onIOSeeked.bind(this),o.onComplete=this._onIOComplete.bind(this),o.onRedirect=this._onIORedirect.bind(this),o.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),f?this._demuxer.bindDataSource(this._ioctl):o.onDataArrival=this._onInitChunkArrival.bind(this),o.open(f)},n.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},n.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},n.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},n.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},n.prototype.seek=function(i){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var f=this._searchSegmentIndexContains(i);if(f===this._currentSegmentIndex){var l=this._mediaInfo.segments[f];if(l==null)this._pendingSeekTime=i;else{var o=l.getNearestKeyframe(i);this._remuxer.seek(o.milliseconds),this._ioctl.seek(o.fileposition),this._pendingResolveSeekPoint=o.milliseconds}}else{var v=this._mediaInfo.segments[f];if(v==null)this._pendingSeekTime=i,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(f);else{var o=v.getNearestKeyframe(i);this._internalAbort(),this._remuxer.seek(i),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[f].timestampBase,this._loadSegment(f,o.fileposition),this._pendingResolveSeekPoint=o.milliseconds,this._reportSegmentMediaInfo(f)}}this._enableStatisticsReporter()}},n.prototype._searchSegmentIndexContains=function(i){for(var f=this._mediaDataSource.segments,l=f.length-1,o=0;o<f.length;o++)if(i<f[o].timestampBase){l=o-1;break}return l},n.prototype._onInitChunkArrival=function(i,f){var l=this,o=null,v=0;if(f>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,v=this._demuxer.parseChunks(i,f);else if((o=a.default.probe(i)).match){this._demuxer=new a.default(o,this._config),this._remuxer||(this._remuxer=new d.default(this._config));var D=this._mediaDataSource;D.duration!=null&&!isNaN(D.duration)&&(this._demuxer.overridedDuration=D.duration),typeof D.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=D.hasAudio),typeof D.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=D.hasVideo),this._demuxer.timestampBase=D.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),v=this._demuxer.parseChunks(i,f)}else o=null,s.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){l._internalAbort()}),this._emitter.emit(t.default.DEMUX_ERROR,c.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),v=0;return v},n.prototype._onMediaInfo=function(i){var f=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},i),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,u.default.prototype));var l=Object.assign({},i);Object.setPrototypeOf(l,u.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=l,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var o=f._pendingSeekTime;f._pendingSeekTime=null,f.seek(o)})},n.prototype._onMetaDataArrived=function(i){this._emitter.emit(t.default.METADATA_ARRIVED,i)},n.prototype._onScriptDataArrived=function(i){this._emitter.emit(t.default.SCRIPTDATA_ARRIVED,i)},n.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},n.prototype._onIOComplete=function(i){var f=i,l=f+1;l<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(l)):(this._remuxer.flushStashedSamples(),this._emitter.emit(t.default.LOADING_COMPLETE),this._disableStatisticsReporter())},n.prototype._onIORedirect=function(i){var f=this._ioctl.extraData;this._mediaDataSource.segments[f].redirectedURL=i},n.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(t.default.RECOVERED_EARLY_EOF)},n.prototype._onIOException=function(i,f){s.default.e(this.TAG,"IOException: type = "+i+", code = "+f.code+", msg = "+f.msg),this._emitter.emit(t.default.IO_ERROR,i,f),this._disableStatisticsReporter()},n.prototype._onDemuxException=function(i,f){s.default.e(this.TAG,"DemuxException: type = "+i+", info = "+f),this._emitter.emit(t.default.DEMUX_ERROR,i,f)},n.prototype._onRemuxerInitSegmentArrival=function(i,f){this._emitter.emit(t.default.INIT_SEGMENT,i,f)},n.prototype._onRemuxerMediaSegmentArrival=function(i,f){if(this._pendingSeekTime==null&&(this._emitter.emit(t.default.MEDIA_SEGMENT,i,f),this._pendingResolveSeekPoint!=null&&i==="video")){var l=f.info.syncPoints,o=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,r.default.safari&&l.length>0&&l[0].originalDts===o&&(o=l[0].pts),this._emitter.emit(t.default.RECOMMEND_SEEKPOINT,o)}},n.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},n.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},n.prototype._reportSegmentMediaInfo=function(i){var f=this._mediaInfo.segments[i],l=Object.assign({},f);l.duration=this._mediaInfo.duration,l.segmentCount=this._mediaInfo.segmentCount,delete l.segments,delete l.keyframesIndex,this._emitter.emit(t.default.MEDIA_INFO,l)},n.prototype._reportStatisticsInfo=function(){var i={};i.url=this._ioctl.currentURL,i.hasRedirect=this._ioctl.hasRedirect,i.hasRedirect&&(i.redirectedURL=this._ioctl.currentRedirectedURL),i.speed=this._ioctl.currentSpeed,i.loaderType=this._ioctl.loaderType,i.currentSegmentIndex=this._currentSegmentIndex,i.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(t.default.STATISTICS_INFO,i)},n}();m.default=e},"./src/core/transmuxing-events.js":function(p,m,A){A.r(m);var _={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};m.default=_},"./src/core/transmuxing-worker.js":function(p,m,A){A.r(m);var _=A("./src/utils/logging-control.js"),g=A("./src/utils/polyfill.js"),s=A("./src/core/transmuxing-controller.js"),r=A("./src/core/transmuxing-events.js"),u=function(a){var d=null,c=E.bind(this);g.default.install(),a.addEventListener("message",function(L){switch(L.data.cmd){case"init":d=new s.default(L.data.param[0],L.data.param[1]),d.on(r.default.IO_ERROR,v.bind(this)),d.on(r.default.DEMUX_ERROR,D.bind(this)),d.on(r.default.INIT_SEGMENT,h.bind(this)),d.on(r.default.MEDIA_SEGMENT,t.bind(this)),d.on(r.default.LOADING_COMPLETE,e.bind(this)),d.on(r.default.RECOVERED_EARLY_EOF,n.bind(this)),d.on(r.default.MEDIA_INFO,i.bind(this)),d.on(r.default.METADATA_ARRIVED,f.bind(this)),d.on(r.default.SCRIPTDATA_ARRIVED,l.bind(this)),d.on(r.default.STATISTICS_INFO,o.bind(this)),d.on(r.default.RECOMMEND_SEEKPOINT,S.bind(this));break;case"destroy":d&&(d.destroy(),d=null),a.postMessage({msg:"destroyed"});break;case"start":d.start();break;case"stop":d.stop();break;case"seek":d.seek(L.data.param);break;case"pause":d.pause();break;case"resume":d.resume();break;case"logging_config":{var x=L.data.param;_.default.applyConfig(x),x.enableCallback===!0?_.default.addLogListener(c):_.default.removeLogListener(c);break}}});function h(L,x){var b={msg:r.default.INIT_SEGMENT,data:{type:L,data:x}};a.postMessage(b,[x.data])}function t(L,x){var b={msg:r.default.MEDIA_SEGMENT,data:{type:L,data:x}};a.postMessage(b,[x.data])}function e(){var L={msg:r.default.LOADING_COMPLETE};a.postMessage(L)}function n(){var L={msg:r.default.RECOVERED_EARLY_EOF};a.postMessage(L)}function i(L){var x={msg:r.default.MEDIA_INFO,data:L};a.postMessage(x)}function f(L){var x={msg:r.default.METADATA_ARRIVED,data:L};a.postMessage(x)}function l(L){var x={msg:r.default.SCRIPTDATA_ARRIVED,data:L};a.postMessage(x)}function o(L){var x={msg:r.default.STATISTICS_INFO,data:L};a.postMessage(x)}function v(L,x){a.postMessage({msg:r.default.IO_ERROR,data:{type:L,info:x}})}function D(L,x){a.postMessage({msg:r.default.DEMUX_ERROR,data:{type:L,info:x}})}function S(L){a.postMessage({msg:r.default.RECOMMEND_SEEKPOINT,data:L})}function E(L,x){a.postMessage({msg:"logcat_callback",data:{type:L,logcat:x}})}};m.default=u},"./src/demux/amf-parser.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/utils/utf8-conv.js"),s=A("./src/utils/exception.js"),r=function(){var a=new ArrayBuffer(2);return new DataView(a).setInt16(0,256,!0),new Int16Array(a)[0]===256}(),u=function(){function a(){}return a.parseScriptData=function(d,c,h){var t={};try{var e=a.parseValue(d,c,h),n=a.parseValue(d,c+e.size,h-e.size);t[e.data]=n.data}catch(i){_.default.e("AMF",i.toString())}return t},a.parseObject=function(d,c,h){if(h<3)throw new s.IllegalStateException("Data not enough when parse ScriptDataObject");var t=a.parseString(d,c,h),e=a.parseValue(d,c+t.size,h-t.size),n=e.objectEnd;return{data:{name:t.data,value:e.data},size:t.size+e.size,objectEnd:n}},a.parseVariable=function(d,c,h){return a.parseObject(d,c,h)},a.parseString=function(d,c,h){if(h<2)throw new s.IllegalStateException("Data not enough when parse String");var t=new DataView(d,c,h),e=t.getUint16(0,!r),n;return e>0?n=(0,g.default)(new Uint8Array(d,c+2,e)):n="",{data:n,size:2+e}},a.parseLongString=function(d,c,h){if(h<4)throw new s.IllegalStateException("Data not enough when parse LongString");var t=new DataView(d,c,h),e=t.getUint32(0,!r),n;return e>0?n=(0,g.default)(new Uint8Array(d,c+4,e)):n="",{data:n,size:4+e}},a.parseDate=function(d,c,h){if(h<10)throw new s.IllegalStateException("Data size invalid when parse Date");var t=new DataView(d,c,h),e=t.getFloat64(0,!r),n=t.getInt16(8,!r);return e+=n*60*1e3,{data:new Date(e),size:8+2}},a.parseValue=function(d,c,h){if(h<1)throw new s.IllegalStateException("Data not enough when parse Value");var t=new DataView(d,c,h),e=1,n=t.getUint8(0),i,f=!1;try{switch(n){case 0:i=t.getFloat64(1,!r),e+=8;break;case 1:{var l=t.getUint8(1);i=!!l,e+=1;break}case 2:{var o=a.parseString(d,c+1,h-1);i=o.data,e+=o.size;break}case 3:{i={};var v=0;for((t.getUint32(h-4,!r)&16777215)===9&&(v=3);e<h-4;){var D=a.parseObject(d,c+e,h-e-v);if(D.objectEnd)break;i[D.data.name]=D.data.value,e+=D.size}if(e<=h-3){var S=t.getUint32(e-1,!r)&16777215;S===9&&(e+=3)}break}case 8:{i={},e+=4;var v=0;for((t.getUint32(h-4,!r)&16777215)===9&&(v=3);e<h-8;){var E=a.parseVariable(d,c+e,h-e-v);if(E.objectEnd)break;i[E.data.name]=E.data.value,e+=E.size}if(e<=h-3){var S=t.getUint32(e-1,!r)&16777215;S===9&&(e+=3)}break}case 9:i=void 0,e=1,f=!0;break;case 10:{i=[];var L=t.getUint32(1,!r);e+=4;for(var x=0;x<L;x++){var b=a.parseValue(d,c+e,h-e);i.push(b.data),e+=b.size}break}case 11:{var O=a.parseDate(d,c+1,h-1);i=O.data,e+=O.size;break}case 12:{var R=a.parseString(d,c+1,h-1);i=R.data,e+=R.size;break}default:e=h,_.default.w("AMF","Unsupported AMF value type "+n)}}catch(I){_.default.e("AMF",I.toString())}return{data:i,size:e,objectEnd:f}},a}();m.default=u},"./src/demux/demux-errors.js":function(p,m,A){A.r(m);var _={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};m.default=_},"./src/demux/exp-golomb.js":function(p,m,A){A.r(m);var _=A("./src/utils/exception.js"),g=function(){function s(r){this.TAG="ExpGolomb",this._buffer=r,this._buffer_index=0,this._total_bytes=r.byteLength,this._total_bits=r.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return s.prototype.destroy=function(){this._buffer=null},s.prototype._fillCurrentWord=function(){var r=this._total_bytes-this._buffer_index;if(r<=0)throw new _.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var u=Math.min(4,r),a=new Uint8Array(4);a.set(this._buffer.subarray(this._buffer_index,this._buffer_index+u)),this._current_word=new DataView(a.buffer).getUint32(0,!1),this._buffer_index+=u,this._current_word_bits_left=u*8},s.prototype.readBits=function(r){if(r>32)throw new _.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(r<=this._current_word_bits_left){var u=this._current_word>>>32-r;return this._current_word<<=r,this._current_word_bits_left-=r,u}var a=this._current_word_bits_left?this._current_word:0;a=a>>>32-this._current_word_bits_left;var d=r-this._current_word_bits_left;this._fillCurrentWord();var c=Math.min(d,this._current_word_bits_left),h=this._current_word>>>32-c;return this._current_word<<=c,this._current_word_bits_left-=c,a=a<<c|h,a},s.prototype.readBool=function(){return this.readBits(1)===1},s.prototype.readByte=function(){return this.readBits(8)},s.prototype._skipLeadingZero=function(){var r;for(r=0;r<this._current_word_bits_left;r++)if((this._current_word&2147483648>>>r)!==0)return this._current_word<<=r,this._current_word_bits_left-=r,r;return this._fillCurrentWord(),r+this._skipLeadingZero()},s.prototype.readUEG=function(){var r=this._skipLeadingZero();return this.readBits(r+1)-1},s.prototype.readSEG=function(){var r=this.readUEG();return r&1?r+1>>>1:-1*(r>>>1)},s}();m.default=g},"./src/demux/flv-demuxer.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/demux/amf-parser.js"),s=A("./src/demux/sps-parser.js"),r=A("./src/demux/demux-errors.js"),u=A("./src/core/media-info.js"),a=A("./src/utils/exception.js");function d(h,t){return h[t]<<24|h[t+1]<<16|h[t+2]<<8|h[t+3]}var c=function(){function h(t,e){this.TAG="FLVDemuxer",this._config=e,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new u.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var n=new ArrayBuffer(2);return new DataView(n).setInt16(0,256,!0),new Int16Array(n)[0]===256}()}return h.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},h.probe=function(t){var e=new Uint8Array(t),n={match:!1};if(e[0]!==70||e[1]!==76||e[2]!==86||e[3]!==1)return n;var i=(e[4]&4)>>>2!==0,f=(e[4]&1)!==0,l=d(e,5);return l<9?n:{match:!0,consumed:l,dataOffset:l,hasAudioTrack:i,hasVideoTrack:f}},h.prototype.bindDataSource=function(t){return t.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(h.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(t){this._onTrackMetadata=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(t){this._onMediaInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(t){this._onMetaDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(t){this._onScriptDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(t){this._onDataAvailable=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(t){this._timestampBase=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"overridedDuration",{get:function(){return this._duration},set:function(t){this._durationOverrided=!0,this._duration=t,this._mediaInfo.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"overridedHasAudio",{set:function(t){this._hasAudioFlagOverrided=!0,this._hasAudio=t,this._mediaInfo.hasAudio=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"overridedHasVideo",{set:function(t){this._hasVideoFlagOverrided=!0,this._hasVideo=t,this._mediaInfo.hasVideo=t},enumerable:!1,configurable:!0}),h.prototype.resetMediaInfo=function(){this._mediaInfo=new u.default},h.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},h.prototype.parseChunks=function(t,e){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new a.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var n=0,i=this._littleEndian;if(e===0)if(t.byteLength>13){var f=h.probe(t);n=f.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,e+n!==this._dataOffset&&_.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var l=new DataView(t,n),o=l.getUint32(0,!i);o!==0&&_.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),n+=4}for(;n<t.byteLength;){this._dispatch=!0;var l=new DataView(t,n);if(n+11+4>t.byteLength)break;var v=l.getUint8(0),D=l.getUint32(0,!i)&16777215;if(n+11+D+4>t.byteLength)break;if(v!==8&&v!==9&&v!==18){_.default.w(this.TAG,"Unsupported tag type "+v+", skipped"),n+=11+D+4;continue}var S=l.getUint8(4),E=l.getUint8(5),L=l.getUint8(6),x=l.getUint8(7),b=L|E<<8|S<<16|x<<24,O=l.getUint32(7,!i)&16777215;O!==0&&_.default.w(this.TAG,"Meet tag which has StreamID != 0!");var R=n+11;switch(v){case 8:this._parseAudioData(t,R,D,b);break;case 9:this._parseVideoData(t,R,D,b,e+n);break;case 18:this._parseScriptData(t,R,D);break}var I=l.getUint32(11+D,!i);I!==11+D&&_.default.w(this.TAG,"Invalid PrevTagSize "+I),n+=11+D+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),n},h.prototype._parseScriptData=function(t,e,n){var i=g.default.parseScriptData(t,e,n);if(i.hasOwnProperty("onMetaData")){if(i.onMetaData==null||typeof i.onMetaData!="object"){_.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&_.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=i;var f=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},f)),typeof f.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=f.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof f.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=f.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof f.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=f.audiodatarate),typeof f.videodatarate=="number"&&(this._mediaInfo.videoDataRate=f.videodatarate),typeof f.width=="number"&&(this._mediaInfo.width=f.width),typeof f.height=="number"&&(this._mediaInfo.height=f.height),typeof f.duration=="number"){if(!this._durationOverrided){var l=Math.floor(f.duration*this._timescale);this._duration=l,this._mediaInfo.duration=l}}else this._mediaInfo.duration=0;if(typeof f.framerate=="number"){var o=Math.floor(f.framerate*1e3);if(o>0){var v=o/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=v,this._referenceFrameRate.fps_num=o,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=v}}if(typeof f.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var D=f.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(D),f.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=f,_.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(i).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},i))},h.prototype._parseKeyframesIndex=function(t){for(var e=[],n=[],i=1;i<t.times.length;i++){var f=this._timestampBase+Math.floor(t.times[i]*1e3);e.push(f),n.push(t.filepositions[i])}return{times:e,filepositions:n}},h.prototype._parseAudioData=function(t,e,n,i){if(n<=1){_.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var f=new DataView(t,e,n),l=f.getUint8(0),o=l>>>4;if(o!==2&&o!==10){this._onError(r.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o);return}var v=0,D=(l&12)>>>2;if(D>=0&&D<=4)v=this._flvSoundRateTable[D];else{this._onError(r.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+D);return}var S=l&1,E=this._audioMetadata,L=this._audioTrack;if(E||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),E=this._audioMetadata={},E.type="audio",E.id=L.id,E.timescale=this._timescale,E.duration=this._duration,E.audioSampleRate=v,E.channelCount=S===0?1:2),o===10){var x=this._parseAACAudioData(t,e+1,n-1);if(x==null)return;if(x.packetType===0){E.config&&_.default.w(this.TAG,"Found another AudioSpecificConfig!");var b=x.data;E.audioSampleRate=b.samplingRate,E.channelCount=b.channelCount,E.codec=b.codec,E.originalCodec=b.originalCodec,E.config=b.config,E.refSampleDuration=1024/E.audioSampleRate*E.timescale,_.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",E);var O=this._mediaInfo;O.audioCodec=E.originalCodec,O.audioSampleRate=E.audioSampleRate,O.audioChannelCount=E.channelCount,O.hasVideo?O.videoCodec!=null&&(O.mimeType='video/x-flv; codecs="'+O.videoCodec+","+O.audioCodec+'"'):O.mimeType='video/x-flv; codecs="'+O.audioCodec+'"',O.isComplete()&&this._onMediaInfo(O)}else if(x.packetType===1){var R=this._timestampBase+i,I={unit:x.data,length:x.data.byteLength,dts:R,pts:R};L.samples.push(I),L.length+=x.data.length}else _.default.e(this.TAG,"Flv: Unsupported AAC data type "+x.packetType)}else if(o===2){if(!E.codec){var b=this._parseMP3AudioData(t,e+1,n-1,!0);if(b==null)return;E.audioSampleRate=b.samplingRate,E.channelCount=b.channelCount,E.codec=b.codec,E.originalCodec=b.originalCodec,E.refSampleDuration=1152/E.audioSampleRate*E.timescale,_.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",E);var O=this._mediaInfo;O.audioCodec=E.codec,O.audioSampleRate=E.audioSampleRate,O.audioChannelCount=E.channelCount,O.audioDataRate=b.bitRate,O.hasVideo?O.videoCodec!=null&&(O.mimeType='video/x-flv; codecs="'+O.videoCodec+","+O.audioCodec+'"'):O.mimeType='video/x-flv; codecs="'+O.audioCodec+'"',O.isComplete()&&this._onMediaInfo(O)}var P=this._parseMP3AudioData(t,e+1,n-1,!1);if(P==null)return;var R=this._timestampBase+i,F={unit:P,length:P.byteLength,dts:R,pts:R};L.samples.push(F),L.length+=P.length}}},h.prototype._parseAACAudioData=function(t,e,n){if(n<=1){_.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var i={},f=new Uint8Array(t,e,n);return i.packetType=f[0],f[0]===0?i.data=this._parseAACAudioSpecificConfig(t,e+1,n-1):i.data=f.subarray(1),i},h.prototype._parseAACAudioSpecificConfig=function(t,e,n){var i=new Uint8Array(t,e,n),f=null,l=0,o=0,v=0,D=null;if(l=o=i[0]>>>3,v=(i[0]&7)<<1|i[1]>>>7,v<0||v>=this._mpegSamplingRates.length){this._onError(r.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var S=this._mpegSamplingRates[v],E=(i[1]&120)>>>3;if(E<0||E>=8){this._onError(r.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}l===5&&(D=(i[1]&7)<<1|i[2]>>>7,(i[2]&124)>>>2);var L=self.navigator.userAgent.toLowerCase();return L.indexOf("firefox")!==-1?v>=6?(l=5,f=new Array(4),D=v-3):(l=2,f=new Array(2),D=v):L.indexOf("android")!==-1?(l=2,f=new Array(2),D=v):(l=5,D=v,f=new Array(4),v>=6?D=v-3:E===1&&(l=2,f=new Array(2),D=v)),f[0]=l<<3,f[0]|=(v&15)>>>1,f[1]=(v&15)<<7,f[1]|=(E&15)<<3,l===5&&(f[1]|=(D&15)>>>1,f[2]=(D&1)<<7,f[2]|=2<<2,f[3]=0),{config:f,samplingRate:S,channelCount:E,codec:"mp4a.40."+l,originalCodec:"mp4a.40."+o}},h.prototype._parseMP3AudioData=function(t,e,n,i){if(n<4){_.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var f=new Uint8Array(t,e,n),l=null;if(i){if(f[0]!==255)return;var o=f[1]>>>3&3,v=(f[1]&6)>>1,D=(f[2]&240)>>>4,S=(f[2]&12)>>>2,E=f[3]>>>6&3,L=E!==3?2:1,x=0,b=0,O="mp3";switch(o){case 0:x=this._mpegAudioV25SampleRateTable[S];break;case 2:x=this._mpegAudioV20SampleRateTable[S];break;case 3:x=this._mpegAudioV10SampleRateTable[S];break}switch(v){case 1:D<this._mpegAudioL3BitRateTable.length&&(b=this._mpegAudioL3BitRateTable[D]);break;case 2:D<this._mpegAudioL2BitRateTable.length&&(b=this._mpegAudioL2BitRateTable[D]);break;case 3:D<this._mpegAudioL1BitRateTable.length&&(b=this._mpegAudioL1BitRateTable[D]);break}l={bitRate:b,samplingRate:x,channelCount:L,codec:O,originalCodec:O}}else l=f;return l},h.prototype._parseVideoData=function(t,e,n,i,f){if(n<=1){_.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var l=new Uint8Array(t,e,n)[0],o=(l&240)>>>4,v=l&15;if(v!==7){this._onError(r.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+v);return}this._parseAVCVideoPacket(t,e+1,n-1,i,f,o)}},h.prototype._parseAVCVideoPacket=function(t,e,n,i,f,l){if(n<4){_.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var o=this._littleEndian,v=new DataView(t,e,n),D=v.getUint8(0),S=v.getUint32(0,!o)&16777215,E=S<<8>>8;if(D===0)this._parseAVCDecoderConfigurationRecord(t,e+4,n-4);else if(D===1)this._parseAVCVideoData(t,e+4,n-4,i,f,l,E);else if(D!==2){this._onError(r.default.FORMAT_ERROR,"Flv: Invalid video packet type "+D);return}},h.prototype._parseAVCDecoderConfigurationRecord=function(t,e,n){if(n<7){_.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var i=this._videoMetadata,f=this._videoTrack,l=this._littleEndian,o=new DataView(t,e,n);i?typeof i.avcc<"u"&&_.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),i=this._videoMetadata={},i.type="video",i.id=f.id,i.timescale=this._timescale,i.duration=this._duration);var v=o.getUint8(0),D=o.getUint8(1);if(o.getUint8(2),o.getUint8(3),v!==1||D===0){this._onError(r.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(o.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(r.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var S=o.getUint8(5)&31;if(S===0){this._onError(r.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else S>1&&_.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+S);for(var E=6,L=0;L<S;L++){var x=o.getUint16(E,!l);if(E+=2,x!==0){var b=new Uint8Array(t,e+E,x);E+=x;var O=s.default.parseSPS(b);if(L===0){i.codecWidth=O.codec_size.width,i.codecHeight=O.codec_size.height,i.presentWidth=O.present_size.width,i.presentHeight=O.present_size.height,i.profile=O.profile_string,i.level=O.level_string,i.bitDepth=O.bit_depth,i.chromaFormat=O.chroma_format,i.sarRatio=O.sar_ratio,i.frameRate=O.frame_rate,(O.frame_rate.fixed===!1||O.frame_rate.fps_num===0||O.frame_rate.fps_den===0)&&(i.frameRate=this._referenceFrameRate);var R=i.frameRate.fps_den,I=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(R/I);for(var P=b.subarray(1,4),F="avc1.",w=0;w<3;w++){var k=P[w].toString(16);k.length<2&&(k="0"+k),F+=k}i.codec=F;var B=this._mediaInfo;B.width=i.codecWidth,B.height=i.codecHeight,B.fps=i.frameRate.fps,B.profile=i.profile,B.level=i.level,B.refFrames=O.ref_frames,B.chromaFormat=O.chroma_format_string,B.sarNum=i.sarRatio.width,B.sarDen=i.sarRatio.height,B.videoCodec=F,B.hasAudio?B.audioCodec!=null&&(B.mimeType='video/x-flv; codecs="'+B.videoCodec+","+B.audioCodec+'"'):B.mimeType='video/x-flv; codecs="'+B.videoCodec+'"',B.isComplete()&&this._onMediaInfo(B)}}}var U=o.getUint8(E);if(U===0){this._onError(r.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else U>1&&_.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+U);E++;for(var L=0;L<U;L++){var x=o.getUint16(E,!l);E+=2,x!==0&&(E+=x)}i.avcc=new Uint8Array(n),i.avcc.set(new Uint8Array(t,e,n),0),_.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",i)},h.prototype._parseAVCVideoData=function(t,e,n,i,f,l,o){for(var v=this._littleEndian,D=new DataView(t,e,n),S=[],E=0,L=0,x=this._naluLengthSize,b=this._timestampBase+i,O=l===1;L<n;){if(L+4>=n){_.default.w(this.TAG,"Malformed Nalu near timestamp "+b+", offset = "+L+", dataSize = "+n);break}var R=D.getUint32(L,!v);if(x===3&&(R>>>=8),R>n-x){_.default.w(this.TAG,"Malformed Nalus near timestamp "+b+", NaluSize > DataSize!");return}var I=D.getUint8(L+x)&31;I===5&&(O=!0);var P=new Uint8Array(t,e+L,x+R),F={type:I,data:P};S.push(F),E+=P.byteLength,L+=x+R}if(S.length){var w=this._videoTrack,k={units:S,length:E,isKeyframe:O,dts:b,cts:o,pts:b+o};O&&(k.fileposition=f),w.samples.push(k),w.length+=E}},h}();m.default=c},"./src/demux/sps-parser.js":function(p,m,A){A.r(m);var _=A("./src/demux/exp-golomb.js"),g=function(){function s(){}return s._ebsp2rbsp=function(r){for(var u=r,a=u.byteLength,d=new Uint8Array(a),c=0,h=0;h<a;h++)h>=2&&u[h]===3&&u[h-1]===0&&u[h-2]===0||(d[c]=u[h],c++);return new Uint8Array(d.buffer,0,c)},s.parseSPS=function(r){var u=s._ebsp2rbsp(r),a=new _.default(u);a.readByte();var d=a.readByte();a.readByte();var c=a.readByte();a.readUEG();var h=s.getProfileString(d),t=s.getLevelString(c),e=1,n=420,i=[0,420,422,444],f=8;if((d===100||d===110||d===122||d===244||d===44||d===83||d===86||d===118||d===128||d===138||d===144)&&(e=a.readUEG(),e===3&&a.readBits(1),e<=3&&(n=i[e]),f=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool()))for(var l=e!==3?8:12,o=0;o<l;o++)a.readBool()&&(o<6?s._skipScalingList(a,16):s._skipScalingList(a,64));a.readUEG();var v=a.readUEG();if(v===0)a.readUEG();else if(v===1){a.readBits(1),a.readSEG(),a.readSEG();for(var D=a.readUEG(),o=0;o<D;o++)a.readSEG()}var S=a.readUEG();a.readBits(1);var E=a.readUEG(),L=a.readUEG(),x=a.readBits(1);x===0&&a.readBits(1),a.readBits(1);var b=0,O=0,R=0,I=0,P=a.readBool();P&&(b=a.readUEG(),O=a.readUEG(),R=a.readUEG(),I=a.readUEG());var F=1,w=1,k=0,B=!0,U=0,j=0,N=a.readBool();if(N){if(a.readBool()){var K=a.readByte(),H=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],$=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];K>0&&K<16?(F=H[K-1],w=$[K-1]):K===255&&(F=a.readByte()<<8|a.readByte(),w=a.readByte()<<8|a.readByte())}if(a.readBool()&&a.readBool(),a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24)),a.readBool()&&(a.readUEG(),a.readUEG()),a.readBool()){var G=a.readBits(32),ee=a.readBits(32);B=a.readBool(),U=ee,j=G*2,k=U/j}}var X=1;(F!==1||w!==1)&&(X=F/w);var V=0,J=0;if(e===0)V=1,J=2-x;else{var Q=e===3?1:2,ie=e===1?2:1;V=Q,J=ie*(2-x)}var ae=(E+1)*16,se=(2-x)*((L+1)*16);ae-=(b+O)*V,se-=(R+I)*J;var le=Math.ceil(ae*X);return a.destroy(),a=null,{profile_string:h,level_string:t,bit_depth:f,ref_frames:S,chroma_format:n,chroma_format_string:s.getChromaFormatString(n),frame_rate:{fixed:B,fps:k,fps_den:j,fps_num:U},sar_ratio:{width:F,height:w},codec_size:{width:ae,height:se},present_size:{width:le,height:se}}},s._skipScalingList=function(r,u){for(var a=8,d=8,c=0,h=0;h<u;h++)d!==0&&(c=r.readSEG(),d=(a+c+256)%256),a=d===0?a:d},s.getProfileString=function(r){switch(r){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},s.getLevelString=function(r){return(r/10).toFixed(1)},s.getChromaFormatString=function(r){switch(r){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},s}();m.default=g},"./src/flv.js":function(p,m,A){A.r(m);var _=A("./src/utils/polyfill.js"),g=A("./src/core/features.js"),s=A("./src/io/loader.js"),r=A("./src/player/flv-player.js"),u=A("./src/player/native-player.js"),a=A("./src/player/player-events.js"),d=A("./src/player/player-errors.js"),c=A("./src/utils/logging-control.js"),h=A("./src/utils/exception.js");_.default.install();function t(f,l){var o=f;if(o==null||typeof o!="object")throw new h.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!o.hasOwnProperty("type"))throw new h.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(o.type){case"flv":return new r.default(o,l);default:return new u.default(o,l)}}function e(){return g.default.supportMSEH264Playback()}function n(){return g.default.getFeatureList()}var i={};i.createPlayer=t,i.isSupported=e,i.getFeatureList=n,i.BaseLoader=s.BaseLoader,i.LoaderStatus=s.LoaderStatus,i.LoaderErrors=s.LoaderErrors,i.Events=a.default,i.ErrorTypes=d.ErrorTypes,i.ErrorDetails=d.ErrorDetails,i.FlvPlayer=r.default,i.NativePlayer=u.default,i.LoggingControl=c.default,Object.defineProperty(i,"version",{enumerable:!0,get:function(){return"1.6.2"}}),m.default=i},"./src/index.js":function(p,m,A){p.exports=A("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(p,m,A){A.r(m);var _=A("./src/utils/browser.js"),g=A("./src/io/loader.js"),s=A("./src/utils/exception.js"),r=function(){var a=function(d,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,t){h.__proto__=t}||function(h,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(h[e]=t[e])},a(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(d,c);function h(){this.constructor=d}d.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)}}(),u=function(a){r(d,a);function d(c,h){var t=a.call(this,"fetch-stream-loader")||this;return t.TAG="FetchStreamLoader",t._seekHandler=c,t._config=h,t._needStash=!0,t._requestAbort=!1,t._contentLength=null,t._receivedLength=0,t}return d.isSupported=function(){try{var c=_.default.msedge&&_.default.version.minor>=15048,h=_.default.msedge?c:!0;return self.fetch&&self.ReadableStream&&h}catch{return!1}},d.prototype.destroy=function(){this.isWorking()&&this.abort(),a.prototype.destroy.call(this)},d.prototype.open=function(c,h){var t=this;this._dataSource=c,this._range=h;var e=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(e=c.redirectedURL);var n=this._seekHandler.getConfig(e,h),i=new self.Headers;if(typeof n.headers=="object"){var f=n.headers;for(var l in f)f.hasOwnProperty(l)&&i.append(l,f[l])}var o={method:"GET",headers:i,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var l in this._config.headers)i.append(l,this._config.headers[l]);c.cors===!1&&(o.mode="same-origin"),c.withCredentials&&(o.credentials="include"),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,o.signal=this._abortController.signal),this._status=g.LoaderStatus.kConnecting,self.fetch(n.url,o).then(function(v){if(t._requestAbort){t._status=g.LoaderStatus.kIdle,v.body.cancel();return}if(v.ok&&v.status>=200&&v.status<=299){if(v.url!==n.url&&t._onURLRedirect){var D=t._seekHandler.removeURLParameters(v.url);t._onURLRedirect(D)}var S=v.headers.get("Content-Length");return S!=null&&(t._contentLength=parseInt(S),t._contentLength!==0&&t._onContentLengthKnown&&t._onContentLengthKnown(t._contentLength)),t._pump.call(t,v.body.getReader())}else if(t._status=g.LoaderStatus.kError,t._onError)t._onError(g.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:v.status,msg:v.statusText});else throw new s.RuntimeException("FetchStreamLoader: Http code invalid, "+v.status+" "+v.statusText)}).catch(function(v){if(!(t._abortController&&t._abortController.signal.aborted))if(t._status=g.LoaderStatus.kError,t._onError)t._onError(g.LoaderErrors.EXCEPTION,{code:-1,msg:v.message});else throw v})},d.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==g.LoaderStatus.kBuffering||!_.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},d.prototype._pump=function(c){var h=this;return c.read().then(function(t){if(t.done)if(h._contentLength!==null&&h._receivedLength<h._contentLength){h._status=g.LoaderStatus.kError;var e=g.LoaderErrors.EARLY_EOF,n={code:-1,msg:"Fetch stream meet Early-EOF"};if(h._onError)h._onError(e,n);else throw new s.RuntimeException(n.msg)}else h._status=g.LoaderStatus.kComplete,h._onComplete&&h._onComplete(h._range.from,h._range.from+h._receivedLength-1);else{if(h._abortController&&h._abortController.signal.aborted){h._status=g.LoaderStatus.kComplete;return}else if(h._requestAbort===!0)return h._status=g.LoaderStatus.kComplete,c.cancel();h._status=g.LoaderStatus.kBuffering;var i=t.value.buffer,f=h._range.from+h._receivedLength;h._receivedLength+=i.byteLength,h._onDataArrival&&h._onDataArrival(i,f,h._receivedLength),h._pump(c)}}).catch(function(t){if(h._abortController&&h._abortController.signal.aborted){h._status=g.LoaderStatus.kComplete;return}if(!(t.code===11&&_.default.msedge)){h._status=g.LoaderStatus.kError;var e=0,n=null;if((t.code===19||t.message==="network error")&&(h._contentLength===null||h._contentLength!==null&&h._receivedLength<h._contentLength)?(e=g.LoaderErrors.EARLY_EOF,n={code:t.code,msg:"Fetch stream meet Early-EOF"}):(e=g.LoaderErrors.EXCEPTION,n={code:t.code,msg:t.message}),h._onError)h._onError(e,n);else throw new s.RuntimeException(n.msg)}})},d}(g.BaseLoader);m.default=u},"./src/io/io-controller.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/io/speed-sampler.js"),s=A("./src/io/loader.js"),r=A("./src/io/fetch-stream-loader.js"),u=A("./src/io/xhr-moz-chunked-loader.js"),a=A("./src/io/xhr-range-loader.js"),d=A("./src/io/websocket-loader.js"),c=A("./src/io/range-seek-handler.js"),h=A("./src/io/param-seek-handler.js"),t=A("./src/utils/exception.js"),e=function(){function n(i,f,l){this.TAG="IOController",this._config=f,this._extraData=l,this._stashInitialSize=1024*384,f.stashInitialSize!=null&&f.stashInitialSize>0&&(this._stashInitialSize=f.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,f.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=i,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(i.url),this._refTotalLength=i.filesize?i.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new g.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return n.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},n.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},n.prototype.isPaused=function(){return this._paused},Object.defineProperty(n.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"extraData",{get:function(){return this._extraData},set:function(i){this._extraData=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(i){this._onDataArrival=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(i){this._onSeeked=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onError",{get:function(){return this._onError},set:function(i){this._onError=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onComplete",{get:function(){return this._onComplete},set:function(i){this._onComplete=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(i){this._onRedirect=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(i){this._onRecoveredEarlyEof=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentSpeed",{get:function(){return this._loaderClass===a.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),n.prototype._selectSeekHandler=function(){var i=this._config;if(i.seekType==="range")this._seekHandler=new c.default(this._config.rangeLoadZeroStart);else if(i.seekType==="param"){var f=i.seekParamStart||"bstart",l=i.seekParamEnd||"bend";this._seekHandler=new h.default(f,l)}else if(i.seekType==="custom"){if(typeof i.customSeekHandler!="function")throw new t.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new i.customSeekHandler}else throw new t.InvalidArgumentException("Invalid seekType in config: "+i.seekType)},n.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=d.default;else if(r.default.isSupported())this._loaderClass=r.default;else if(u.default.isSupported())this._loaderClass=u.default;else if(a.default.isSupported())this._loaderClass=a.default;else throw new t.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},n.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},n.prototype.open=function(i){this._currentRange={from:0,to:-1},i&&(this._currentRange.from=i),this._speedSampler.reset(),i||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},n.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},n.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},n.prototype.resume=function(){if(this._paused){this._paused=!1;var i=this._resumeFrom;this._resumeFrom=0,this._internalSeek(i,!0)}},n.prototype.seek=function(i){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(i,!0)},n.prototype._internalSeek=function(i,f){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(f),this._loader.destroy(),this._loader=null;var l={from:i,to:-1};this._currentRange={from:l.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,l),this._onSeeked&&this._onSeeked()},n.prototype.updateUrl=function(i){if(!i||typeof i!="string"||i.length===0)throw new t.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=i},n.prototype._expandBuffer=function(i){for(var f=this._stashSize;f+1024*1024*1<i;)f*=2;if(f+=1024*1024*1,f!==this._bufferSize){var l=new ArrayBuffer(f);if(this._stashUsed>0){var o=new Uint8Array(this._stashBuffer,0,this._stashUsed),v=new Uint8Array(l,0,f);v.set(o,0)}this._stashBuffer=l,this._bufferSize=f}},n.prototype._normalizeSpeed=function(i){var f=this._speedNormalizeList,l=f.length-1,o=0,v=0,D=l;if(i<f[0])return f[0];for(;v<=D;){if(o=v+Math.floor((D-v)/2),o===l||i>=f[o]&&i<f[o+1])return f[o];f[o]<i?v=o+1:D=o-1}},n.prototype._adjustStashSize=function(i){var f=0;this._config.isLive||i<512?f=i:i>=512&&i<=1024?f=Math.floor(i*1.5):f=i*2,f>8192&&(f=8192);var l=f*1024+1024*1024*1;this._bufferSize<l&&this._expandBuffer(l),this._stashSize=f*1024},n.prototype._dispatchChunks=function(i,f){return this._currentRange.to=f+i.byteLength-1,this._onDataArrival(i,f)},n.prototype._onURLRedirect=function(i){this._redirectedURL=i,this._onRedirect&&this._onRedirect(i)},n.prototype._onContentLengthKnown=function(i){i&&this._fullRequestFlag&&(this._totalLength=i,this._fullRequestFlag=!1)},n.prototype._onLoaderChunkArrival=function(i,f,l){if(!this._onDataArrival)throw new t.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(i.byteLength);var o=this._speedSampler.lastSecondKBps;if(o!==0){var v=this._normalizeSpeed(o);this._speedNormalized!==v&&(this._speedNormalized=v,this._adjustStashSize(v))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=f),this._stashUsed+i.byteLength<=this._stashSize){var E=new Uint8Array(this._stashBuffer,0,this._stashSize);E.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength}else{var E=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var x=this._stashBuffer.slice(0,this._stashUsed),D=this._dispatchChunks(x,this._stashByteStart);if(D<x.byteLength){if(D>0){var L=new Uint8Array(x,D);E.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=D}}else this._stashUsed=0,this._stashByteStart+=D;this._stashUsed+i.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+i.byteLength),E=new Uint8Array(this._stashBuffer,0,this._bufferSize)),E.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength}else{var D=this._dispatchChunks(i,f);if(D<i.byteLength){var S=i.byteLength-D;S>this._bufferSize&&(this._expandBuffer(S),E=new Uint8Array(this._stashBuffer,0,this._bufferSize)),E.set(new Uint8Array(i,D),0),this._stashUsed+=S,this._stashByteStart=f+D}}}else if(this._stashUsed===0){var D=this._dispatchChunks(i,f);if(D<i.byteLength){var S=i.byteLength-D;S>this._bufferSize&&this._expandBuffer(S);var E=new Uint8Array(this._stashBuffer,0,this._bufferSize);E.set(new Uint8Array(i,D),0),this._stashUsed+=S,this._stashByteStart=f+D}}else{this._stashUsed+i.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+i.byteLength);var E=new Uint8Array(this._stashBuffer,0,this._bufferSize);E.set(new Uint8Array(i),this._stashUsed),this._stashUsed+=i.byteLength;var D=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(D<this._stashUsed&&D>0){var L=new Uint8Array(this._stashBuffer,D);E.set(L,0)}this._stashUsed-=D,this._stashByteStart+=D}}},n.prototype._flushStashBuffer=function(i){if(this._stashUsed>0){var f=this._stashBuffer.slice(0,this._stashUsed),l=this._dispatchChunks(f,this._stashByteStart),o=f.byteLength-l;if(l<f.byteLength)if(i)_.default.w(this.TAG,o+" bytes unconsumed data remain when flush buffer, dropped");else{if(l>0){var v=new Uint8Array(this._stashBuffer,0,this._bufferSize),D=new Uint8Array(f,l);v.set(D,0),this._stashUsed=D.byteLength,this._stashByteStart+=l}return 0}return this._stashUsed=0,this._stashByteStart=0,o}return 0},n.prototype._onLoaderComplete=function(i,f){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},n.prototype._onLoaderError=function(i,f){switch(_.default.e(this.TAG,"Loader error, code = "+f.code+", msg = "+f.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,i=s.LoaderErrors.UNRECOVERABLE_EARLY_EOF),i){case s.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var l=this._currentRange.to+1;l<this._totalLength&&(_.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(l,!1));return}i=s.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case s.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case s.LoaderErrors.CONNECTING_TIMEOUT:case s.LoaderErrors.HTTP_STATUS_CODE_INVALID:case s.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(i,f);else throw new t.RuntimeException("IOException: "+f.msg)},n}();m.default=e},"./src/io/loader.js":function(p,m,A){A.r(m),A.d(m,{LoaderStatus:function(){return g},LoaderErrors:function(){return s},BaseLoader:function(){return r}});var _=A("./src/utils/exception.js"),g={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},s={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},r=function(){function u(a){this._type=a||"undefined",this._status=g.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return u.prototype.destroy=function(){this._status=g.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},u.prototype.isWorking=function(){return this._status===g.kConnecting||this._status===g.kBuffering},Object.defineProperty(u.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(a){this._onContentLengthKnown=a},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(a){this._onURLRedirect=a},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(a){this._onDataArrival=a},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onError",{get:function(){return this._onError},set:function(a){this._onError=a},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onComplete",{get:function(){return this._onComplete},set:function(a){this._onComplete=a},enumerable:!1,configurable:!0}),u.prototype.open=function(a,d){throw new _.NotImplementedException("Unimplemented abstract function!")},u.prototype.abort=function(){throw new _.NotImplementedException("Unimplemented abstract function!")},u}()},"./src/io/param-seek-handler.js":function(p,m,A){A.r(m);var _=function(){function g(s,r){this._startName=s,this._endName=r}return g.prototype.getConfig=function(s,r){var u=s;if(r.from!==0||r.to!==-1){var a=!0;u.indexOf("?")===-1&&(u+="?",a=!1),a&&(u+="&"),u+=this._startName+"="+r.from.toString(),r.to!==-1&&(u+="&"+this._endName+"="+r.to.toString())}return{url:u,headers:{}}},g.prototype.removeURLParameters=function(s){var r=s.split("?")[0],u=void 0,a=s.indexOf("?");a!==-1&&(u=s.substring(a+1));var d="";if(u!=null&&u.length>0)for(var c=u.split("&"),h=0;h<c.length;h++){var t=c[h].split("="),e=h>0;t[0]!==this._startName&&t[0]!==this._endName&&(e&&(d+="&"),d+=c[h])}return d.length===0?r:r+"?"+d},g}();m.default=_},"./src/io/range-seek-handler.js":function(p,m,A){A.r(m);var _=function(){function g(s){this._zeroStart=s||!1}return g.prototype.getConfig=function(s,r){var u={};if(r.from!==0||r.to!==-1){var a=void 0;r.to!==-1?a="bytes="+r.from.toString()+"-"+r.to.toString():a="bytes="+r.from.toString()+"-",u.Range=a}else this._zeroStart&&(u.Range="bytes=0-");return{url:s,headers:u}},g.prototype.removeURLParameters=function(s){return s},g}();m.default=_},"./src/io/speed-sampler.js":function(p,m,A){A.r(m);var _=function(){function g(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return g.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},g.prototype.addBytes=function(s){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=s,this._totalBytes+=s):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=s,this._totalBytes+=s):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=s,this._totalBytes+=s,this._lastCheckpoint=this._now())},Object.defineProperty(g.prototype,"currentKBps",{get:function(){this.addBytes(0);var s=(this._now()-this._lastCheckpoint)/1e3;return s==0&&(s=1),this._intervalBytes/s/1024},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"averageKBps",{get:function(){var s=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/s/1024},enumerable:!1,configurable:!0}),g}();m.default=_},"./src/io/websocket-loader.js":function(p,m,A){A.r(m);var _=A("./src/io/loader.js"),g=A("./src/utils/exception.js"),s=function(){var u=function(a,d){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,h){c.__proto__=h}||function(c,h){for(var t in h)Object.prototype.hasOwnProperty.call(h,t)&&(c[t]=h[t])},u(a,d)};return function(a,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");u(a,d);function c(){this.constructor=a}a.prototype=d===null?Object.create(d):(c.prototype=d.prototype,new c)}}(),r=function(u){s(a,u);function a(){var d=u.call(this,"websocket-loader")||this;return d.TAG="WebSocketLoader",d._needStash=!0,d._ws=null,d._requestAbort=!1,d._receivedLength=0,d}return a.isSupported=function(){try{return typeof self.WebSocket<"u"}catch{return!1}},a.prototype.destroy=function(){this._ws&&this.abort(),u.prototype.destroy.call(this)},a.prototype.open=function(d){try{var c=this._ws=new self.WebSocket(d.url);c.binaryType="arraybuffer",c.onopen=this._onWebSocketOpen.bind(this),c.onclose=this._onWebSocketClose.bind(this),c.onmessage=this._onWebSocketMessage.bind(this),c.onerror=this._onWebSocketError.bind(this),this._status=_.LoaderStatus.kConnecting}catch(t){this._status=_.LoaderStatus.kError;var h={code:t.code,msg:t.message};if(this._onError)this._onError(_.LoaderErrors.EXCEPTION,h);else throw new g.RuntimeException(h.msg)}},a.prototype.abort=function(){var d=this._ws;d&&(d.readyState===0||d.readyState===1)&&(this._requestAbort=!0,d.close()),this._ws=null,this._status=_.LoaderStatus.kComplete},a.prototype._onWebSocketOpen=function(d){this._status=_.LoaderStatus.kBuffering},a.prototype._onWebSocketClose=function(d){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=_.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},a.prototype._onWebSocketMessage=function(d){var c=this;if(d.data instanceof ArrayBuffer)this._dispatchArrayBuffer(d.data);else if(d.data instanceof Blob){var h=new FileReader;h.onload=function(){c._dispatchArrayBuffer(h.result)},h.readAsArrayBuffer(d.data)}else{this._status=_.LoaderStatus.kError;var t={code:-1,msg:"Unsupported WebSocket message type: "+d.data.constructor.name};if(this._onError)this._onError(_.LoaderErrors.EXCEPTION,t);else throw new g.RuntimeException(t.msg)}},a.prototype._dispatchArrayBuffer=function(d){var c=d,h=this._receivedLength;this._receivedLength+=c.byteLength,this._onDataArrival&&this._onDataArrival(c,h,this._receivedLength)},a.prototype._onWebSocketError=function(d){this._status=_.LoaderStatus.kError;var c={code:d.code,msg:d.message};if(this._onError)this._onError(_.LoaderErrors.EXCEPTION,c);else throw new g.RuntimeException(c.msg)},a}(_.BaseLoader);m.default=r},"./src/io/xhr-moz-chunked-loader.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/io/loader.js"),s=A("./src/utils/exception.js"),r=function(){var a=function(d,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,t){h.__proto__=t}||function(h,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(h[e]=t[e])},a(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(d,c);function h(){this.constructor=d}d.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)}}(),u=function(a){r(d,a);function d(c,h){var t=a.call(this,"xhr-moz-chunked-loader")||this;return t.TAG="MozChunkedLoader",t._seekHandler=c,t._config=h,t._needStash=!0,t._xhr=null,t._requestAbort=!1,t._contentLength=null,t._receivedLength=0,t}return d.isSupported=function(){try{var c=new XMLHttpRequest;return c.open("GET","https://example.com",!0),c.responseType="moz-chunked-arraybuffer",c.responseType==="moz-chunked-arraybuffer"}catch(h){return _.default.w("MozChunkedLoader",h.message),!1}},d.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),a.prototype.destroy.call(this)},d.prototype.open=function(c,h){this._dataSource=c,this._range=h;var t=c.url;this._config.reuseRedirectedURL&&c.redirectedURL!=null&&(t=c.redirectedURL);var e=this._seekHandler.getConfig(t,h);this._requestURL=e.url;var n=this._xhr=new XMLHttpRequest;if(n.open("GET",e.url,!0),n.responseType="moz-chunked-arraybuffer",n.onreadystatechange=this._onReadyStateChange.bind(this),n.onprogress=this._onProgress.bind(this),n.onloadend=this._onLoadEnd.bind(this),n.onerror=this._onXhrError.bind(this),c.withCredentials&&(n.withCredentials=!0),typeof e.headers=="object"){var i=e.headers;for(var f in i)i.hasOwnProperty(f)&&n.setRequestHeader(f,i[f])}if(typeof this._config.headers=="object"){var i=this._config.headers;for(var f in i)i.hasOwnProperty(f)&&n.setRequestHeader(f,i[f])}this._status=g.LoaderStatus.kConnecting,n.send()},d.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=g.LoaderStatus.kComplete},d.prototype._onReadyStateChange=function(c){var h=c.target;if(h.readyState===2){if(h.responseURL!=null&&h.responseURL!==this._requestURL&&this._onURLRedirect){var t=this._seekHandler.removeURLParameters(h.responseURL);this._onURLRedirect(t)}if(h.status!==0&&(h.status<200||h.status>299))if(this._status=g.LoaderStatus.kError,this._onError)this._onError(g.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:h.status,msg:h.statusText});else throw new s.RuntimeException("MozChunkedLoader: Http code invalid, "+h.status+" "+h.statusText);else this._status=g.LoaderStatus.kBuffering}},d.prototype._onProgress=function(c){if(this._status!==g.LoaderStatus.kError){this._contentLength===null&&c.total!==null&&c.total!==0&&(this._contentLength=c.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var h=c.target.response,t=this._range.from+this._receivedLength;this._receivedLength+=h.byteLength,this._onDataArrival&&this._onDataArrival(h,t,this._receivedLength)}},d.prototype._onLoadEnd=function(c){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===g.LoaderStatus.kError)return;this._status=g.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},d.prototype._onXhrError=function(c){this._status=g.LoaderStatus.kError;var h=0,t=null;if(this._contentLength&&c.loaded<this._contentLength?(h=g.LoaderErrors.EARLY_EOF,t={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(h=g.LoaderErrors.EXCEPTION,t={code:-1,msg:c.constructor.name+" "+c.type}),this._onError)this._onError(h,t);else throw new s.RuntimeException(t.msg)},d}(g.BaseLoader);m.default=u},"./src/io/xhr-range-loader.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/io/speed-sampler.js"),s=A("./src/io/loader.js"),r=A("./src/utils/exception.js"),u=function(){var d=function(c,h){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},d(c,h)};return function(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");d(c,h);function t(){this.constructor=c}c.prototype=h===null?Object.create(h):(t.prototype=h.prototype,new t)}}(),a=function(d){u(c,d);function c(h,t){var e=d.call(this,"xhr-range-loader")||this;return e.TAG="RangeLoader",e._seekHandler=h,e._config=t,e._needStash=!1,e._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],e._currentChunkSizeKB=384,e._currentSpeedNormalized=0,e._zeroSpeedChunkCount=0,e._xhr=null,e._speedSampler=new g.default,e._requestAbort=!1,e._waitForTotalLength=!1,e._totalLengthReceived=!1,e._currentRequestURL=null,e._currentRedirectedURL=null,e._currentRequestRange=null,e._totalLength=null,e._contentLength=null,e._receivedLength=0,e._lastTimeLoaded=0,e}return c.isSupported=function(){try{var h=new XMLHttpRequest;return h.open("GET","https://example.com",!0),h.responseType="arraybuffer",h.responseType==="arraybuffer"}catch(t){return _.default.w("RangeLoader",t.message),!1}},c.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),d.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),c.prototype.open=function(h,t){this._dataSource=h,this._range=t,this._status=s.LoaderStatus.kConnecting;var e=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(e=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!e?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},c.prototype._openSubRange=function(){var h=this._currentChunkSizeKB*1024,t=this._range.from+this._receivedLength,e=t+h;this._contentLength!=null&&e-this._range.from>=this._contentLength&&(e=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:e},this._internalOpen(this._dataSource,this._currentRequestRange)},c.prototype._internalOpen=function(h,t){this._lastTimeLoaded=0;var e=h.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?e=this._currentRedirectedURL:h.redirectedURL!=null&&(e=h.redirectedURL));var n=this._seekHandler.getConfig(e,t);this._currentRequestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),h.withCredentials&&(i.withCredentials=!0),typeof n.headers=="object"){var f=n.headers;for(var l in f)f.hasOwnProperty(l)&&i.setRequestHeader(l,f[l])}if(typeof this._config.headers=="object"){var f=this._config.headers;for(var l in f)f.hasOwnProperty(l)&&i.setRequestHeader(l,f[l])}i.send()},c.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=s.LoaderStatus.kComplete},c.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},c.prototype._onReadyStateChange=function(h){var t=h.target;if(t.readyState===2){if(t.responseURL!=null){var e=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&e!==this._currentRedirectedURL&&(this._currentRedirectedURL=e,this._onURLRedirect&&this._onURLRedirect(e))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=s.LoaderStatus.kBuffering}else if(this._status=s.LoaderStatus.kError,this._onError)this._onError(s.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText});else throw new r.RuntimeException("RangeLoader: Http code invalid, "+t.status+" "+t.statusText)}},c.prototype._onProgress=function(h){if(this._status!==s.LoaderStatus.kError){if(this._contentLength===null){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var e=h.total;this._internalAbort(),e!=null&e!==0&&(this._totalLength=e)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var n=h.loaded-this._lastTimeLoaded;this._lastTimeLoaded=h.loaded,this._speedSampler.addBytes(n)}},c.prototype._normalizeSpeed=function(h){var t=this._chunkSizeKBList,e=t.length-1,n=0,i=0,f=e;if(h<t[0])return t[0];for(;i<=f;){if(n=i+Math.floor((f-i)/2),n===e||h>=t[n]&&h<t[n+1])return t[n];t[n]<h?i=n+1:f=n-1}},c.prototype._onLoad=function(h){if(this._status!==s.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(t===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),t!==0){var e=this._normalizeSpeed(t);this._currentSpeedNormalized!==e&&(this._currentSpeedNormalized=e,this._currentChunkSizeKB=e)}var n=h.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=n.byteLength;var f=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():f=!0,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),f&&(this._status=s.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},c.prototype._onXhrError=function(h){this._status=s.LoaderStatus.kError;var t=0,e=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=s.LoaderErrors.EARLY_EOF,e={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=s.LoaderErrors.EXCEPTION,e={code:-1,msg:h.constructor.name+" "+h.type}),this._onError)this._onError(t,e);else throw new r.RuntimeException(e.msg)},c}(s.BaseLoader);m.default=a},"./src/player/flv-player.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./src/utils/logger.js"),r=A("./src/utils/browser.js"),u=A("./src/player/player-events.js"),a=A("./src/core/transmuxer.js"),d=A("./src/core/transmuxing-events.js"),c=A("./src/core/mse-controller.js"),h=A("./src/core/mse-events.js"),t=A("./src/player/player-errors.js"),e=A("./src/config.js"),n=A("./src/utils/exception.js"),i=function(){function f(l,o){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(g()),this._config=(0,e.createDefaultConfig)(),typeof o=="object"&&Object.assign(this._config,o),l.type.toLowerCase()!=="flv")throw new n.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");l.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=l,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var v=r.default.chrome&&(r.default.version.major<50||r.default.version.major===50&&r.default.version.build<2661);this._alwaysSeekKeyframe=!!(v||r.default.msedge||r.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return f.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},f.prototype.on=function(l,o){var v=this;l===u.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){v._emitter.emit(u.default.MEDIA_INFO,v.mediaInfo)}):l===u.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){v._emitter.emit(u.default.STATISTICS_INFO,v.statisticsInfo)}),this._emitter.addListener(l,o)},f.prototype.off=function(l,o){this._emitter.removeListener(l,o)},f.prototype.attachMediaElement=function(l){var o=this;if(this._mediaElement=l,l.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),l.addEventListener("seeking",this.e.onvSeeking),l.addEventListener("canplay",this.e.onvCanPlay),l.addEventListener("stalled",this.e.onvStalled),l.addEventListener("progress",this.e.onvProgress),this._msectl=new c.default(this._config),this._msectl.on(h.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(h.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(h.default.SOURCE_OPEN,function(){o._mseSourceOpened=!0,o._hasPendingLoad&&(o._hasPendingLoad=!1,o.load())}),this._msectl.on(h.default.ERROR,function(v){o._emitter.emit(u.default.ERROR,t.ErrorTypes.MEDIA_ERROR,t.ErrorDetails.MEDIA_MSE_ERROR,v)}),this._msectl.attachMediaElement(l),this._pendingSeekTime!=null)try{l.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},f.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},f.prototype.load=function(){var l=this;if(!this._mediaElement)throw new n.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new n.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new a.default(this._mediaDataSource,this._config),this._transmuxer.on(d.default.INIT_SEGMENT,function(o,v){l._msectl.appendInitSegment(v)}),this._transmuxer.on(d.default.MEDIA_SEGMENT,function(o,v){if(l._msectl.appendMediaSegment(v),l._config.lazyLoad&&!l._config.isLive){var D=l._mediaElement.currentTime;v.info.endDts>=(D+l._config.lazyLoadMaxDuration)*1e3&&l._progressChecker==null&&(s.default.v(l.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),l._suspendTransmuxer())}}),this._transmuxer.on(d.default.LOADING_COMPLETE,function(){l._msectl.endOfStream(),l._emitter.emit(u.default.LOADING_COMPLETE)}),this._transmuxer.on(d.default.RECOVERED_EARLY_EOF,function(){l._emitter.emit(u.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(d.default.IO_ERROR,function(o,v){l._emitter.emit(u.default.ERROR,t.ErrorTypes.NETWORK_ERROR,o,v)}),this._transmuxer.on(d.default.DEMUX_ERROR,function(o,v){l._emitter.emit(u.default.ERROR,t.ErrorTypes.MEDIA_ERROR,o,{code:-1,msg:v})}),this._transmuxer.on(d.default.MEDIA_INFO,function(o){l._mediaInfo=o,l._emitter.emit(u.default.MEDIA_INFO,Object.assign({},o))}),this._transmuxer.on(d.default.METADATA_ARRIVED,function(o){l._emitter.emit(u.default.METADATA_ARRIVED,o)}),this._transmuxer.on(d.default.SCRIPTDATA_ARRIVED,function(o){l._emitter.emit(u.default.SCRIPTDATA_ARRIVED,o)}),this._transmuxer.on(d.default.STATISTICS_INFO,function(o){l._statisticsInfo=l._fillStatisticsInfo(o),l._emitter.emit(u.default.STATISTICS_INFO,Object.assign({},l._statisticsInfo))}),this._transmuxer.on(d.default.RECOMMEND_SEEKPOINT,function(o){l._mediaElement&&!l._config.accurateSeek&&(l._requestSetTime=!0,l._mediaElement.currentTime=o/1e3)}),this._transmuxer.open()}},f.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},f.prototype.play=function(){return this._mediaElement.play()},f.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(l){this._mediaElement.volume=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(l){this._mediaElement.muted=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(l){this._mediaElement?this._internalSeek(l):this._pendingSeekTime=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),f.prototype._fillStatisticsInfo=function(l){if(l.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return l;var o=!0,v=0,D=0;if(this._mediaElement.getVideoPlaybackQuality){var S=this._mediaElement.getVideoPlaybackQuality();v=S.totalVideoFrames,D=S.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(v=this._mediaElement.webkitDecodedFrameCount,D=this._mediaElement.webkitDroppedFrameCount):o=!1;return o&&(l.decodedFrames=v,l.droppedFrames=D),l},f.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var l=this._mediaElement.buffered,o=this._mediaElement.currentTime,v=0,D=0;D<l.length;D++){var S=l.start(D),E=l.end(D);if(S<=o&&o<E){v=E;break}}v>=o+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(s.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},f.prototype._onmseBufferFull=function(){s.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},f.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},f.prototype._checkProgressAndResume=function(){for(var l=this._mediaElement.currentTime,o=this._mediaElement.buffered,v=!1,D=0;D<o.length;D++){var S=o.start(D),E=o.end(D);if(l>=S&&l<E){l>=E-this._config.lazyLoadRecoverDuration&&(v=!0);break}}v&&(window.clearInterval(this._progressChecker),this._progressChecker=null,v&&(s.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},f.prototype._isTimepointBuffered=function(l){for(var o=this._mediaElement.buffered,v=0;v<o.length;v++){var D=o.start(v),S=o.end(v);if(l>=D&&l<S)return!0}return!1},f.prototype._internalSeek=function(l){var o=this._isTimepointBuffered(l),v=!1,D=0;if(l<1&&this._mediaElement.buffered.length>0){var S=this._mediaElement.buffered.start(0);(S<1&&l<S||r.default.safari)&&(v=!0,D=r.default.safari?.1:S)}if(v)this._requestSetTime=!0,this._mediaElement.currentTime=D;else if(o){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=l;else{var E=this._msectl.getNearestKeyframe(Math.floor(l*1e3));this._requestSetTime=!0,E!=null?this._mediaElement.currentTime=E.dts/1e3:this._mediaElement.currentTime=l}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(l),this._transmuxer.seek(Math.floor(l*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=l)},f.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var l=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(l)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(l),this._transmuxer.seek(Math.floor(l*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=l))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},f.prototype._checkAndResumeStuckPlayback=function(l){var o=this._mediaElement;if(l||!this._receivedCanPlay||o.readyState<2){var v=o.buffered;v.length>0&&o.currentTime<v.start(0)&&(s.default.w(this.TAG,"Playback seems stuck at "+o.currentTime+", seek to "+v.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=v.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},f.prototype._onvLoadedMetadata=function(l){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},f.prototype._onvSeeking=function(l){var o=this._mediaElement.currentTime,v=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(o<1&&v.length>0){var D=v.start(0);if(D<1&&o<D||r.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=r.default.safari?.1:D;return}}if(this._isTimepointBuffered(o)){if(this._alwaysSeekKeyframe){var S=this._msectl.getNearestKeyframe(Math.floor(o*1e3));S!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=S.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:o,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},f.prototype._onvCanPlay=function(l){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},f.prototype._onvStalled=function(l){this._checkAndResumeStuckPlayback(!0)},f.prototype._onvProgress=function(l){this._checkAndResumeStuckPlayback()},f}();m.default=i},"./src/player/native-player.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./src/player/player-events.js"),r=A("./src/config.js"),u=A("./src/utils/exception.js"),a=function(){function d(c,h){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(g()),this._config=(0,r.createDefaultConfig)(),typeof h=="object"&&Object.assign(this._config,h),c.type.toLowerCase()==="flv")throw new u.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(c.hasOwnProperty("segments"))throw new u.InvalidArgumentException("NativePlayer("+c.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=c,this._mediaElement=null}return d.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},d.prototype.on=function(c,h){var t=this;c===s.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){t._emitter.emit(s.default.MEDIA_INFO,t.mediaInfo)}):c===s.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){t._emitter.emit(s.default.STATISTICS_INFO,t.statisticsInfo)}),this._emitter.addListener(c,h)},d.prototype.off=function(c,h){this._emitter.removeListener(c,h)},d.prototype.attachMediaElement=function(c){if(this._mediaElement=c,c.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{c.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},d.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},d.prototype.load=function(){if(!this._mediaElement)throw new u.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},d.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},d.prototype.play=function(){return this._mediaElement.play()},d.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(d.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(c){this._mediaElement.volume=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(c){this._mediaElement.muted=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(c){this._mediaElement?this._mediaElement.currentTime=c:this._pendingSeekTime=c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mediaInfo",{get:function(){var c=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",h={mimeType:c+this._mediaDataSource.type};return this._mediaElement&&(h.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(h.width=this._mediaElement.videoWidth,h.height=this._mediaElement.videoHeight)),h},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"statisticsInfo",{get:function(){var c={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return c;var h=!0,t=0,e=0;if(this._mediaElement.getVideoPlaybackQuality){var n=this._mediaElement.getVideoPlaybackQuality();t=n.totalVideoFrames,e=n.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(t=this._mediaElement.webkitDecodedFrameCount,e=this._mediaElement.webkitDroppedFrameCount):h=!1;return h&&(c.decodedFrames=t,c.droppedFrames=e),c},enumerable:!1,configurable:!0}),d.prototype._onvLoadedMetadata=function(c){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(s.default.MEDIA_INFO,this.mediaInfo)},d.prototype._reportStatisticsInfo=function(){this._emitter.emit(s.default.STATISTICS_INFO,this.statisticsInfo)},d}();m.default=a},"./src/player/player-errors.js":function(p,m,A){A.r(m),A.d(m,{ErrorTypes:function(){return s},ErrorDetails:function(){return r}});var _=A("./src/io/loader.js"),g=A("./src/demux/demux-errors.js"),s={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},r={NETWORK_EXCEPTION:_.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:_.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:_.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:_.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:g.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:g.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:g.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(p,m,A){A.r(m);var _={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};m.default=_},"./src/remux/aac-silent.js":function(p,m,A){A.r(m);var _=function(){function g(){}return g.getSilentFrame=function(s,r){if(s==="mp4a.40.2"){if(r===1)return new Uint8Array([0,200,0,128,35,128]);if(r===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(r===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(r===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(r===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(r===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(r===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},g}();m.default=_},"./src/remux/mp4-generator.js":function(p,m,A){A.r(m);var _=function(){function g(){}return g.init=function(){g.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var s in g.types)g.types.hasOwnProperty(s)&&(g.types[s]=[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3)]);var r=g.constants={};r.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),r.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),r.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),r.STSC=r.STCO=r.STTS,r.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),r.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),r.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),r.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},g.box=function(s){for(var r=8,u=null,a=Array.prototype.slice.call(arguments,1),d=a.length,c=0;c<d;c++)r+=a[c].byteLength;u=new Uint8Array(r),u[0]=r>>>24&255,u[1]=r>>>16&255,u[2]=r>>>8&255,u[3]=r&255,u.set(s,4);for(var h=8,c=0;c<d;c++)u.set(a[c],h),h+=a[c].byteLength;return u},g.generateInitSegment=function(s){var r=g.box(g.types.ftyp,g.constants.FTYP),u=g.moov(s),a=new Uint8Array(r.byteLength+u.byteLength);return a.set(r,0),a.set(u,r.byteLength),a},g.moov=function(s){var r=g.mvhd(s.timescale,s.duration),u=g.trak(s),a=g.mvex(s);return g.box(g.types.moov,r,u,a)},g.mvhd=function(s,r){return g.box(g.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,s&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},g.trak=function(s){return g.box(g.types.trak,g.tkhd(s),g.mdia(s))},g.tkhd=function(s){var r=s.id,u=s.duration,a=s.presentWidth,d=s.presentHeight;return g.box(g.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>>8&255,a&255,0,0,d>>>8&255,d&255,0,0]))},g.mdia=function(s){return g.box(g.types.mdia,g.mdhd(s),g.hdlr(s),g.minf(s))},g.mdhd=function(s){var r=s.timescale,u=s.duration;return g.box(g.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,85,196,0,0]))},g.hdlr=function(s){var r=null;return s.type==="audio"?r=g.constants.HDLR_AUDIO:r=g.constants.HDLR_VIDEO,g.box(g.types.hdlr,r)},g.minf=function(s){var r=null;return s.type==="audio"?r=g.box(g.types.smhd,g.constants.SMHD):r=g.box(g.types.vmhd,g.constants.VMHD),g.box(g.types.minf,r,g.dinf(),g.stbl(s))},g.dinf=function(){var s=g.box(g.types.dinf,g.box(g.types.dref,g.constants.DREF));return s},g.stbl=function(s){var r=g.box(g.types.stbl,g.stsd(s),g.box(g.types.stts,g.constants.STTS),g.box(g.types.stsc,g.constants.STSC),g.box(g.types.stsz,g.constants.STSZ),g.box(g.types.stco,g.constants.STCO));return r},g.stsd=function(s){return s.type==="audio"?s.codec==="mp3"?g.box(g.types.stsd,g.constants.STSD_PREFIX,g.mp3(s)):g.box(g.types.stsd,g.constants.STSD_PREFIX,g.mp4a(s)):g.box(g.types.stsd,g.constants.STSD_PREFIX,g.avc1(s))},g.mp3=function(s){var r=s.channelCount,u=s.audioSampleRate,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,u>>>8&255,u&255,0,0]);return g.box(g.types[".mp3"],a)},g.mp4a=function(s){var r=s.channelCount,u=s.audioSampleRate,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,u>>>8&255,u&255,0,0]);return g.box(g.types.mp4a,a,g.esds(s))},g.esds=function(s){var r=s.config||[],u=r.length,a=new Uint8Array([0,0,0,0,3,23+u,0,1,0,4,15+u,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([u]).concat(r).concat([6,1,2]));return g.box(g.types.esds,a)},g.avc1=function(s){var r=s.avcc,u=s.codecWidth,a=s.codecHeight,d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>>8&255,u&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return g.box(g.types.avc1,d,g.box(g.types.avcC,r))},g.mvex=function(s){return g.box(g.types.mvex,g.trex(s))},g.trex=function(s){var r=s.id,u=new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return g.box(g.types.trex,u)},g.moof=function(s,r){return g.box(g.types.moof,g.mfhd(s.sequenceNumber),g.traf(s,r))},g.mfhd=function(s){var r=new Uint8Array([0,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,s&255]);return g.box(g.types.mfhd,r)},g.traf=function(s,r){var u=s.id,a=g.box(g.types.tfhd,new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255])),d=g.box(g.types.tfdt,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255])),c=g.sdtp(s),h=g.trun(s,c.byteLength+16+16+8+16+8+8);return g.box(g.types.traf,a,d,h,c)},g.sdtp=function(s){for(var r=s.samples||[],u=r.length,a=new Uint8Array(4+u),d=0;d<u;d++){var c=r[d].flags;a[d+4]=c.isLeading<<6|c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy}return g.box(g.types.sdtp,a)},g.trun=function(s,r){var u=s.samples||[],a=u.length,d=12+16*a,c=new Uint8Array(d);r+=8+d,c.set([0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255],0);for(var h=0;h<a;h++){var t=u[h].duration,e=u[h].size,n=u[h].flags,i=u[h].cts;c.set([t>>>24&255,t>>>16&255,t>>>8&255,t&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255,n.isLeading<<2|n.dependsOn,n.isDependedOn<<6|n.hasRedundancy<<4|n.isNonSync,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*h)}return g.box(g.types.trun,c)},g.mdat=function(s){return g.box(g.types.mdat,s)},g}();_.init(),m.default=_},"./src/remux/mp4-remuxer.js":function(p,m,A){A.r(m);var _=A("./src/utils/logger.js"),g=A("./src/remux/mp4-generator.js"),s=A("./src/remux/aac-silent.js"),r=A("./src/utils/browser.js"),u=A("./src/core/media-segment-info.js"),a=A("./src/utils/exception.js"),d=function(){function c(h){this.TAG="MP4Remuxer",this._config=h,this._isLive=h.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new u.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new u.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(r.default.chrome&&(r.default.version.major<50||r.default.version.major===50&&r.default.version.build<2661)),this._fillSilentAfterSeek=r.default.msedge||r.default.msie,this._mp3UseMpegAudio=!r.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return c.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},c.prototype.bindDataSource=function(h){return h.onDataAvailable=this.remux.bind(this),h.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(c.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(h){this._onInitSegment=h},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(h){this._onMediaSegment=h},enumerable:!1,configurable:!0}),c.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},c.prototype.seek=function(h){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},c.prototype.remux=function(h,t){if(!this._onMediaSegment)throw new a.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(h,t),this._remuxVideo(t),this._remuxAudio(h)},c.prototype._onTrackMetadataReceived=function(h,t){var e=null,n="mp4",i=t.codec;if(h==="audio")this._audioMeta=t,t.codec==="mp3"&&this._mp3UseMpegAudio?(n="mpeg",i="",e=new Uint8Array):e=g.default.generateInitSegment(t);else if(h==="video")this._videoMeta=t,e=g.default.generateInitSegment(t);else return;if(!this._onInitSegment)throw new a.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(h,{type:h,data:e.buffer,codec:i,container:h+"/"+n,mediaDuration:t.duration})},c.prototype._calculateDtsBase=function(h,t){this._dtsBaseInited||(h.samples&&h.samples.length&&(this._audioDtsBase=h.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},c.prototype.flushStashedSamples=function(){var h=this._videoStashedLastSample,t=this._audioStashedLastSample,e={type:"video",id:1,sequenceNumber:0,samples:[],length:0};h!=null&&(e.samples.push(h),e.length=h.length);var n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};t!=null&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(e,!0),this._remuxAudio(n,!0)},c.prototype._remuxAudio=function(h,t){if(this._audioMeta!=null){var e=h,n=e.samples,i=void 0,f=-1,l=-1,o=this._audioMeta.refSampleDuration,v=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,D=this._dtsBaseInited&&this._audioNextDts===void 0,S=!1;if(!(!n||n.length===0)&&!(n.length===1&&!t)){var E=0,L=null,x=0;v?(E=0,x=e.length):(E=8,x=8+e.length);var b=null;if(n.length>1&&(b=n.pop(),x-=b.length),this._audioStashedLastSample!=null){var O=this._audioStashedLastSample;this._audioStashedLastSample=null,n.unshift(O),x+=O.length}b!=null&&(this._audioStashedLastSample=b);var R=n[0].dts-this._dtsBase;if(this._audioNextDts)i=R-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())i=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(S=!0);else{var I=this._audioSegmentInfoList.getLastSampleBefore(R);if(I!=null){var P=R-(I.originalDts+I.duration);P<=3&&(P=0);var F=I.dts+I.duration+P;i=R-F}else i=0}if(S){var w=R-i,k=this._videoSegmentInfoList.getLastSegmentBefore(R);if(k!=null&&k.beginDts<w){var B=s.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(B){var U=k.beginDts,j=w-k.beginDts;_.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+U+", duration: "+j),n.unshift({unit:B,dts:U,pts:U}),x+=B.byteLength}}else S=!1}for(var N=[],K=0;K<n.length;K++){var O=n[K],H=O.unit,$=O.dts-this._dtsBase,U=$,G=!1,ee=null,X=0;if(!($<-.001)){if(this._audioMeta.codec!=="mp3"){var V=$,J=3;if(this._audioNextDts&&(V=this._audioNextDts),i=$-V,i<=-J*o){_.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+$+" ms ,curRefDts: "+V+" ms)  due to dtsCorrection: "+i+" ms overlap.");continue}else if(i>=J*o&&this._fillAudioTimestampGap&&!r.default.safari){G=!0;var Q=Math.floor(i/o);_.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+$+" ms, curRefDts: "+V+" ms, ")+("dtsCorrection: "+Math.round(i)+" ms, generate: "+Q+" frames")),U=Math.floor(V),X=Math.floor(V+o)-U;var B=s.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);B==null&&(_.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),B=H),ee=[];for(var ie=0;ie<Q;ie++){V=V+o;var ae=Math.floor(V),se=Math.floor(V+o)-ae,le={dts:ae,pts:ae,cts:0,unit:B,size:B.byteLength,duration:se,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ee.push(le),x+=le.size}this._audioNextDts=V+o}else U=Math.floor(V),X=Math.floor(V+o)-U,this._audioNextDts=V+o}else{if(U=$-i,K!==n.length-1){var ue=n[K+1].dts-this._dtsBase-i;X=ue-U}else if(b!=null){var ue=b.dts-this._dtsBase-i;X=ue-U}else N.length>=1?X=N[N.length-1].duration:X=Math.floor(o);this._audioNextDts=U+X}f===-1&&(f=U),N.push({dts:U,pts:U,cts:0,unit:O.unit,size:O.unit.byteLength,duration:X,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),G&&N.push.apply(N,ee)}}if(N.length===0){e.samples=[],e.length=0;return}v?L=new Uint8Array(x):(L=new Uint8Array(x),L[0]=x>>>24&255,L[1]=x>>>16&255,L[2]=x>>>8&255,L[3]=x&255,L.set(g.default.types.mdat,4));for(var K=0;K<N.length;K++){var H=N[K].unit;L.set(H,E),E+=H.byteLength}var q=N[N.length-1];l=q.dts+q.duration;var oe=new u.MediaSegmentInfo;oe.beginDts=f,oe.endDts=l,oe.beginPts=f,oe.endPts=l,oe.originalBeginDts=N[0].originalDts,oe.originalEndDts=q.originalDts+q.duration,oe.firstSample=new u.SampleInfo(N[0].dts,N[0].pts,N[0].duration,N[0].originalDts,!1),oe.lastSample=new u.SampleInfo(q.dts,q.pts,q.duration,q.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(oe),e.samples=N,e.sequenceNumber++;var de=null;v?de=new Uint8Array:de=g.default.moof(e,f),e.samples=[],e.length=0;var ce={type:"audio",data:this._mergeBoxes(de,L).buffer,sampleCount:N.length,info:oe};v&&D&&(ce.timestampOffset=f),this._onMediaSegment("audio",ce)}}},c.prototype._remuxVideo=function(h,t){if(this._videoMeta!=null){var e=h,n=e.samples,i=void 0,f=-1,l=-1,o=-1,v=-1;if(!(!n||n.length===0)&&!(n.length===1&&!t)){var D=8,S=null,E=8+h.length,L=null;if(n.length>1&&(L=n.pop(),E-=L.length),this._videoStashedLastSample!=null){var x=this._videoStashedLastSample;this._videoStashedLastSample=null,n.unshift(x),E+=x.length}L!=null&&(this._videoStashedLastSample=L);var b=n[0].dts-this._dtsBase;if(this._videoNextDts)i=b-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())i=0;else{var O=this._videoSegmentInfoList.getLastSampleBefore(b);if(O!=null){var R=b-(O.originalDts+O.duration);R<=3&&(R=0);var I=O.dts+O.duration+R;i=b-I}else i=0}for(var P=new u.MediaSegmentInfo,F=[],w=0;w<n.length;w++){var x=n[w],k=x.dts-this._dtsBase,B=x.isKeyframe,U=k-i,j=x.cts,N=U+j;f===-1&&(f=U,o=N);var K=0;if(w!==n.length-1){var H=n[w+1].dts-this._dtsBase-i;K=H-U}else if(L!=null){var H=L.dts-this._dtsBase-i;K=H-U}else F.length>=1?K=F[F.length-1].duration:K=Math.floor(this._videoMeta.refSampleDuration);if(B){var $=new u.SampleInfo(U,N,K,x.dts,!0);$.fileposition=x.fileposition,P.appendSyncPoint($)}F.push({dts:U,pts:N,cts:j,units:x.units,size:x.length,isKeyframe:B,duration:K,originalDts:k,flags:{isLeading:0,dependsOn:B?2:1,isDependedOn:B?1:0,hasRedundancy:0,isNonSync:B?0:1}})}S=new Uint8Array(E),S[0]=E>>>24&255,S[1]=E>>>16&255,S[2]=E>>>8&255,S[3]=E&255,S.set(g.default.types.mdat,4);for(var w=0;w<F.length;w++)for(var G=F[w].units;G.length;){var ee=G.shift(),X=ee.data;S.set(X,D),D+=X.byteLength}var V=F[F.length-1];if(l=V.dts+V.duration,v=V.pts+V.duration,this._videoNextDts=l,P.beginDts=f,P.endDts=l,P.beginPts=o,P.endPts=v,P.originalBeginDts=F[0].originalDts,P.originalEndDts=V.originalDts+V.duration,P.firstSample=new u.SampleInfo(F[0].dts,F[0].pts,F[0].duration,F[0].originalDts,F[0].isKeyframe),P.lastSample=new u.SampleInfo(V.dts,V.pts,V.duration,V.originalDts,V.isKeyframe),this._isLive||this._videoSegmentInfoList.append(P),e.samples=F,e.sequenceNumber++,this._forceFirstIDR){var J=F[0].flags;J.dependsOn=2,J.isNonSync=0}var Q=g.default.moof(e,f);e.samples=[],e.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Q,S).buffer,sampleCount:F.length,info:P})}}},c.prototype._mergeBoxes=function(h,t){var e=new Uint8Array(h.byteLength+t.byteLength);return e.set(h,0),e.set(t,h.byteLength),e},c}();m.default=d},"./src/utils/browser.js":function(p,m,A){A.r(m);var _={};function g(){var s=self.navigator.userAgent.toLowerCase(),r=/(edge)\/([\w.]+)/.exec(s)||/(opr)[\/]([\w.]+)/.exec(s)||/(chrome)[ \/]([\w.]+)/.exec(s)||/(iemobile)[\/]([\w.]+)/.exec(s)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(s)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(s)||/(webkit)[ \/]([\w.]+)/.exec(s)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(s)||/(msie) ([\w.]+)/.exec(s)||s.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(s)||s.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(s)||[],u=/(ipad)/.exec(s)||/(ipod)/.exec(s)||/(windows phone)/.exec(s)||/(iphone)/.exec(s)||/(kindle)/.exec(s)||/(android)/.exec(s)||/(windows)/.exec(s)||/(mac)/.exec(s)||/(linux)/.exec(s)||/(cros)/.exec(s)||[],a={browser:r[5]||r[3]||r[1]||"",version:r[2]||r[4]||"0",majorVersion:r[4]||r[2]||"0",platform:u[0]||""},d={};if(a.browser){d[a.browser]=!0;var c=a.majorVersion.split(".");d.version={major:parseInt(a.majorVersion,10),string:a.version},c.length>1&&(d.version.minor=parseInt(c[1],10)),c.length>2&&(d.version.build=parseInt(c[2],10))}if(a.platform&&(d[a.platform]=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.iemobile){d.rv&&delete d.rv;var h="msie";a.browser=h,d[h]=!0}if(d.edge){delete d.edge;var t="msedge";a.browser=t,d[t]=!0}if(d.opr){var e="opera";a.browser=e,d[e]=!0}if(d.safari&&d.android){var n="android";a.browser=n,d[n]=!0}d.name=a.browser,d.platform=a.platform;for(var i in _)_.hasOwnProperty(i)&&delete _[i];Object.assign(_,d)}g(),m.default=_},"./src/utils/exception.js":function(p,m,A){A.r(m),A.d(m,{RuntimeException:function(){return g},IllegalStateException:function(){return s},InvalidArgumentException:function(){return r},NotImplementedException:function(){return u}});var _=function(){var a=function(d,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,t){h.__proto__=t}||function(h,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(h[e]=t[e])},a(d,c)};return function(d,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(d,c);function h(){this.constructor=d}d.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)}}(),g=function(){function a(d){this._message=d}return Object.defineProperty(a.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),a.prototype.toString=function(){return this.name+": "+this.message},a}(),s=function(a){_(d,a);function d(c){return a.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),d}(g),r=function(a){_(d,a);function d(c){return a.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),d}(g),u=function(a){_(d,a);function d(c){return a.call(this,c)||this}return Object.defineProperty(d.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),d}(g)},"./src/utils/logger.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=function(){function r(){}return r.e=function(u,a){(!u||r.FORCE_GLOBAL_TAG)&&(u=r.GLOBAL_TAG);var d="["+u+"] > "+a;r.ENABLE_CALLBACK&&r.emitter.emit("log","error",d),r.ENABLE_ERROR&&(console.error?console.error(d):console.warn?console.warn(d):console.log(d))},r.i=function(u,a){(!u||r.FORCE_GLOBAL_TAG)&&(u=r.GLOBAL_TAG);var d="["+u+"] > "+a;r.ENABLE_CALLBACK&&r.emitter.emit("log","info",d),r.ENABLE_INFO&&(console.info?console.info(d):console.log(d))},r.w=function(u,a){(!u||r.FORCE_GLOBAL_TAG)&&(u=r.GLOBAL_TAG);var d="["+u+"] > "+a;r.ENABLE_CALLBACK&&r.emitter.emit("log","warn",d),r.ENABLE_WARN&&(console.warn?console.warn(d):console.log(d))},r.d=function(u,a){(!u||r.FORCE_GLOBAL_TAG)&&(u=r.GLOBAL_TAG);var d="["+u+"] > "+a;r.ENABLE_CALLBACK&&r.emitter.emit("log","debug",d),r.ENABLE_DEBUG&&(console.debug?console.debug(d):console.log(d))},r.v=function(u,a){(!u||r.FORCE_GLOBAL_TAG)&&(u=r.GLOBAL_TAG);var d="["+u+"] > "+a;r.ENABLE_CALLBACK&&r.emitter.emit("log","verbose",d),r.ENABLE_VERBOSE&&console.log(d)},r}();s.GLOBAL_TAG="flv.js",s.FORCE_GLOBAL_TAG=!1,s.ENABLE_ERROR=!0,s.ENABLE_INFO=!0,s.ENABLE_WARN=!0,s.ENABLE_DEBUG=!0,s.ENABLE_VERBOSE=!0,s.ENABLE_CALLBACK=!1,s.emitter=new(g()),m.default=s},"./src/utils/logging-control.js":function(p,m,A){A.r(m);var _=A("./node_modules/events/events.js"),g=A.n(_),s=A("./src/utils/logger.js"),r=function(){function u(){}return Object.defineProperty(u,"forceGlobalTag",{get:function(){return s.default.FORCE_GLOBAL_TAG},set:function(a){s.default.FORCE_GLOBAL_TAG=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"globalTag",{get:function(){return s.default.GLOBAL_TAG},set:function(a){s.default.GLOBAL_TAG=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableAll",{get:function(){return s.default.ENABLE_VERBOSE&&s.default.ENABLE_DEBUG&&s.default.ENABLE_INFO&&s.default.ENABLE_WARN&&s.default.ENABLE_ERROR},set:function(a){s.default.ENABLE_VERBOSE=a,s.default.ENABLE_DEBUG=a,s.default.ENABLE_INFO=a,s.default.ENABLE_WARN=a,s.default.ENABLE_ERROR=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableDebug",{get:function(){return s.default.ENABLE_DEBUG},set:function(a){s.default.ENABLE_DEBUG=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableVerbose",{get:function(){return s.default.ENABLE_VERBOSE},set:function(a){s.default.ENABLE_VERBOSE=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableInfo",{get:function(){return s.default.ENABLE_INFO},set:function(a){s.default.ENABLE_INFO=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableWarn",{get:function(){return s.default.ENABLE_WARN},set:function(a){s.default.ENABLE_WARN=a,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableError",{get:function(){return s.default.ENABLE_ERROR},set:function(a){s.default.ENABLE_ERROR=a,u._notifyChange()},enumerable:!1,configurable:!0}),u.getConfig=function(){return{globalTag:s.default.GLOBAL_TAG,forceGlobalTag:s.default.FORCE_GLOBAL_TAG,enableVerbose:s.default.ENABLE_VERBOSE,enableDebug:s.default.ENABLE_DEBUG,enableInfo:s.default.ENABLE_INFO,enableWarn:s.default.ENABLE_WARN,enableError:s.default.ENABLE_ERROR,enableCallback:s.default.ENABLE_CALLBACK}},u.applyConfig=function(a){s.default.GLOBAL_TAG=a.globalTag,s.default.FORCE_GLOBAL_TAG=a.forceGlobalTag,s.default.ENABLE_VERBOSE=a.enableVerbose,s.default.ENABLE_DEBUG=a.enableDebug,s.default.ENABLE_INFO=a.enableInfo,s.default.ENABLE_WARN=a.enableWarn,s.default.ENABLE_ERROR=a.enableError,s.default.ENABLE_CALLBACK=a.enableCallback},u._notifyChange=function(){var a=u.emitter;if(a.listenerCount("change")>0){var d=u.getConfig();a.emit("change",d)}},u.registerListener=function(a){u.emitter.addListener("change",a)},u.removeListener=function(a){u.emitter.removeListener("change",a)},u.addLogListener=function(a){s.default.emitter.addListener("log",a),s.default.emitter.listenerCount("log")>0&&(s.default.ENABLE_CALLBACK=!0,u._notifyChange())},u.removeLogListener=function(a){s.default.emitter.removeListener("log",a),s.default.emitter.listenerCount("log")===0&&(s.default.ENABLE_CALLBACK=!1,u._notifyChange())},u}();r.emitter=new(g()),m.default=r},"./src/utils/polyfill.js":function(p,m,A){A.r(m);var _=function(){function g(){}return g.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(s,r){return s.__proto__=r,s},Object.assign=Object.assign||function(s){if(s==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(s),u=1;u<arguments.length;u++){var a=arguments[u];if(a!=null)for(var d in a)a.hasOwnProperty(d)&&(r[d]=a[d])}return r},typeof self.Promise!="function"&&A("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},g}();_.install(),m.default=_},"./src/utils/utf8-conv.js":function(p,m,A){A.r(m);function _(s,r,u){var a=s;if(r+u<a.length){for(;u--;)if((a[++r]&192)!==128)return!1;return!0}else return!1}function g(s){for(var r=[],u=s,a=0,d=s.length;a<d;){if(u[a]<128){r.push(String.fromCharCode(u[a])),++a;continue}else if(!(u[a]<192)){if(u[a]<224){if(_(u,a,1)){var c=(u[a]&31)<<6|u[a+1]&63;if(c>=128){r.push(String.fromCharCode(c&65535)),a+=2;continue}}}else if(u[a]<240){if(_(u,a,2)){var c=(u[a]&15)<<12|(u[a+1]&63)<<6|u[a+2]&63;if(c>=2048&&(c&63488)!==55296){r.push(String.fromCharCode(c&65535)),a+=3;continue}}}else if(u[a]<248&&_(u,a,3)){var c=(u[a]&7)<<18|(u[a+1]&63)<<12|(u[a+2]&63)<<6|u[a+3]&63;if(c>65536&&c<1114112){c-=65536,r.push(String.fromCharCode(c>>>10|55296)),r.push(String.fromCharCode(c&1023|56320)),a+=4;continue}}}r.push(String.fromCharCode(65533)),++a}return r.join("")}m.default=g}},C={};function y(p){var m=C[p];if(m!==void 0)return m.exports;var A=C[p]={exports:{}};return M[p].call(A.exports,A,A.exports,y),A.exports}y.m=M,function(){y.n=function(p){var m=p&&p.__esModule?function(){return p.default}:function(){return p};return y.d(m,{a:m}),m}}(),function(){y.d=function(p,m){for(var A in m)y.o(m,A)&&!y.o(p,A)&&Object.defineProperty(p,A,{enumerable:!0,get:m[A]})}}(),function(){y.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){y.o=function(p,m){return Object.prototype.hasOwnProperty.call(p,m)}}(),function(){y.r=function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})}}();var T=y("./src/index.js");return T}()})})(He);const gt=Fe(He.exports);var Ve={exports:{}};(function(xe,Re){typeof window<"u"&&function(C,y){xe.exports=y()}(Pe,function(){return function(M){var C={};function y(T){if(C[T])return C[T].exports;var p=C[T]={i:T,l:!1,exports:{}};return M[T].call(p.exports,p,p.exports,y),p.l=!0,p.exports}return y.m=M,y.c=C,y.d=function(T,p,m){y.o(T,p)||Object.defineProperty(T,p,{enumerable:!0,get:m})},y.r=function(T){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})},y.t=function(T,p){if(p&1&&(T=y(T)),p&8||p&4&&typeof T=="object"&&T&&T.__esModule)return T;var m=Object.create(null);if(y.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:T}),p&2&&typeof T!="string")for(var A in T)y.d(m,A,function(_){return T[_]}.bind(null,A));return m},y.n=function(T){var p=T&&T.__esModule?function(){return T.default}:function(){return T};return y.d(p,"a",p),p},y.o=function(T,p){return Object.prototype.hasOwnProperty.call(T,p)},y.p="/dist/",y(y.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(M,C,y){var T=Object.prototype.hasOwnProperty,p="~";function m(){}Object.create&&(m.prototype=Object.create(null),new m().__proto__||(p=!1));function A(r,u,a){this.fn=r,this.context=u,this.once=a||!1}function _(r,u,a,d,c){if(typeof a!="function")throw new TypeError("The listener must be a function");var h=new A(a,d||r,c),t=p?p+u:u;return r._events[t]?r._events[t].fn?r._events[t]=[r._events[t],h]:r._events[t].push(h):(r._events[t]=h,r._eventsCount++),r}function g(r,u){--r._eventsCount===0?r._events=new m:delete r._events[u]}function s(){this._events=new m,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],a,d;if(this._eventsCount===0)return u;for(d in a=this._events)T.call(a,d)&&u.push(p?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(a)):u},s.prototype.listeners=function(u){var a=p?p+u:u,d=this._events[a];if(!d)return[];if(d.fn)return[d.fn];for(var c=0,h=d.length,t=new Array(h);c<h;c++)t[c]=d[c].fn;return t},s.prototype.listenerCount=function(u){var a=p?p+u:u,d=this._events[a];return d?d.fn?1:d.length:0},s.prototype.emit=function(u,a,d,c,h,t){var e=p?p+u:u;if(!this._events[e])return!1;var n=this._events[e],i=arguments.length,f,l;if(n.fn){switch(n.once&&this.removeListener(u,n.fn,void 0,!0),i){case 1:return n.fn.call(n.context),!0;case 2:return n.fn.call(n.context,a),!0;case 3:return n.fn.call(n.context,a,d),!0;case 4:return n.fn.call(n.context,a,d,c),!0;case 5:return n.fn.call(n.context,a,d,c,h),!0;case 6:return n.fn.call(n.context,a,d,c,h,t),!0}for(l=1,f=new Array(i-1);l<i;l++)f[l-1]=arguments[l];n.fn.apply(n.context,f)}else{var o=n.length,v;for(l=0;l<o;l++)switch(n[l].once&&this.removeListener(u,n[l].fn,void 0,!0),i){case 1:n[l].fn.call(n[l].context);break;case 2:n[l].fn.call(n[l].context,a);break;case 3:n[l].fn.call(n[l].context,a,d);break;case 4:n[l].fn.call(n[l].context,a,d,c);break;default:if(!f)for(v=1,f=new Array(i-1);v<i;v++)f[v-1]=arguments[v];n[l].fn.apply(n[l].context,f)}}return!0},s.prototype.on=function(u,a,d){return _(this,u,a,d,!1)},s.prototype.once=function(u,a,d){return _(this,u,a,d,!0)},s.prototype.removeListener=function(u,a,d,c){var h=p?p+u:u;if(!this._events[h])return this;if(!a)return g(this,h),this;var t=this._events[h];if(t.fn)t.fn===a&&(!c||t.once)&&(!d||t.context===d)&&g(this,h);else{for(var e=0,n=[],i=t.length;e<i;e++)(t[e].fn!==a||c&&!t[e].once||d&&t[e].context!==d)&&n.push(t[e]);n.length?this._events[h]=n.length===1?n[0]:n:g(this,h)}return this},s.prototype.removeAllListeners=function(u){var a;return u?(a=p?p+u:u,this._events[a]&&g(this,a)):(this._events=new m,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=p,s.EventEmitter=s,M.exports=s},"./node_modules/url-toolkit/src/url-toolkit.js":function(M,C,y){(function(T){var p=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,m=/^(?=([^\/?#]*))\1([^]*)$/,A=/(?:\/|^)\.(?=\/)/g,_=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,g={buildAbsoluteURL:function(s,r,u){if(u=u||{},s=s.trim(),r=r.trim(),!r){if(!u.alwaysNormalize)return s;var a=g.parseURL(s);if(!a)throw new Error("Error trying to parse base URL.");return a.path=g.normalizePath(a.path),g.buildURLFromParts(a)}var d=g.parseURL(r);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return u.alwaysNormalize?(d.path=g.normalizePath(d.path),g.buildURLFromParts(d)):r;var c=g.parseURL(s);if(!c)throw new Error("Error trying to parse base URL.");if(!c.netLoc&&c.path&&c.path[0]!=="/"){var h=m.exec(c.path);c.netLoc=h[1],c.path=h[2]}c.netLoc&&!c.path&&(c.path="/");var t={scheme:c.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(t.netLoc=c.netLoc,d.path[0]!=="/"))if(!d.path)t.path=c.path,d.params||(t.params=c.params,d.query||(t.query=c.query));else{var e=c.path,n=e.substring(0,e.lastIndexOf("/")+1)+d.path;t.path=g.normalizePath(n)}return t.path===null&&(t.path=u.alwaysNormalize?g.normalizePath(d.path):d.path),g.buildURLFromParts(t)},parseURL:function(s){var r=p.exec(s);return r?{scheme:r[1]||"",netLoc:r[2]||"",path:r[3]||"",params:r[4]||"",query:r[5]||"",fragment:r[6]||""}:null},normalizePath:function(s){for(s=s.split("").reverse().join("").replace(A,"");s.length!==(s=s.replace(_,"")).length;);return s.split("").reverse().join("")},buildURLFromParts:function(s){return s.scheme+s.netLoc+s.path+s.params+s.query+s.fragment}};M.exports=g})()},"./node_modules/webworkify-webpack/index.js":function(M,C,y){function T(u){var a={};function d(h){if(a[h])return a[h].exports;var t=a[h]={i:h,l:!1,exports:{}};return u[h].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.m=u,d.c=a,d.i=function(h){return h},d.d=function(h,t,e){d.o(h,t)||Object.defineProperty(h,t,{configurable:!1,enumerable:!0,get:e})},d.r=function(h){Object.defineProperty(h,"__esModule",{value:!0})},d.n=function(h){var t=h&&h.__esModule?function(){return h.default}:function(){return h};return d.d(t,"a",t),t},d.o=function(h,t){return Object.prototype.hasOwnProperty.call(h,t)},d.p="/",d.oe=function(h){throw console.error(h),h};var c=d(d.s=ENTRY_MODULE);return c.default||c}var p="[\\.|\\-|\\+|\\w|/|@]+",m="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function A(u){return(u+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function _(u){return!isNaN(1*u)}function g(u,a,d){var c={};c[d]=[];var h=a.toString(),t=h.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!t)return c;for(var e=t[1],n=new RegExp("(\\\\n|\\W)"+A(e)+m,"g"),i;i=n.exec(h);)i[3]!=="dll-reference"&&c[d].push(i[3]);for(n=new RegExp("\\("+A(e)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+m,"g");i=n.exec(h);)u[i[2]]||(c[d].push(i[1]),u[i[2]]=y(i[1]).m),c[i[2]]=c[i[2]]||[],c[i[2]].push(i[4]);for(var f=Object.keys(c),l=0;l<f.length;l++)for(var o=0;o<c[f[l]].length;o++)_(c[f[l]][o])&&(c[f[l]][o]=1*c[f[l]][o]);return c}function s(u){var a=Object.keys(u);return a.reduce(function(d,c){return d||u[c].length>0},!1)}function r(u,a){for(var d={main:[a]},c={main:[]},h={main:{}};s(d);)for(var t=Object.keys(d),e=0;e<t.length;e++){var n=t[e],i=d[n],f=i.pop();if(h[n]=h[n]||{},!(h[n][f]||!u[n][f])){h[n][f]=!0,c[n]=c[n]||[],c[n].push(f);for(var l=g(u,u[n][f],n),o=Object.keys(l),v=0;v<o.length;v++)d[o[v]]=d[o[v]]||[],d[o[v]]=d[o[v]].concat(l[o[v]])}}return c}M.exports=function(u,a){a=a||{};var d={main:y.m},c=a.all?{main:Object.keys(d.main)}:r(d,u),h="";Object.keys(c).filter(function(f){return f!=="main"}).forEach(function(f){for(var l=0;c[f][l];)l++;c[f].push(l),d[f][l]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",h=h+"var "+f+" = ("+T.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+c[f].map(function(o){return""+JSON.stringify(o)+": "+d[f][o].toString()}).join(",")+`});
`}),h=h+"new (("+T.toString().replace("ENTRY_MODULE",JSON.stringify(u))+")({"+c.main.map(function(f){return""+JSON.stringify(f)+": "+d.main[f].toString()}).join(",")+"}))(self);";var t=new window.Blob([h],{type:"text/javascript"});if(a.bare)return t;var e=window.URL||window.webkitURL||window.mozURL||window.msURL,n=e.createObjectURL(t),i=new window.Worker(n);return i.objectURL=n,i}},"./src/config.ts":function(M,C,y){y.r(C),y.d(C,"hlsDefaultConfig",function(){return v}),y.d(C,"mergeConfig",function(){return S}),y.d(C,"enableStreamingMode",function(){return E});var T=y("./src/controller/abr-controller.ts"),p=y("./src/controller/audio-stream-controller.ts"),m=y("./src/controller/audio-track-controller.ts"),A=y("./src/controller/subtitle-stream-controller.ts"),_=y("./src/controller/subtitle-track-controller.ts"),g=y("./src/controller/buffer-controller.ts"),s=y("./src/controller/timeline-controller.ts"),r=y("./src/controller/cap-level-controller.ts"),u=y("./src/controller/fps-controller.ts"),a=y("./src/controller/eme-controller.ts"),d=y("./src/controller/cmcd-controller.ts"),c=y("./src/utils/xhr-loader.ts"),h=y("./src/utils/fetch-loader.ts"),t=y("./src/utils/cues.ts"),e=y("./src/utils/mediakeys-helper.ts"),n=y("./src/utils/logger.ts");function i(){return i=Object.assign?Object.assign.bind():function(L){for(var x=1;x<arguments.length;x++){var b=arguments[x];for(var O in b)Object.prototype.hasOwnProperty.call(b,O)&&(L[O]=b[O])}return L},i.apply(this,arguments)}function f(L,x){var b=Object.keys(L);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(L);x&&(O=O.filter(function(R){return Object.getOwnPropertyDescriptor(L,R).enumerable})),b.push.apply(b,O)}return b}function l(L){for(var x=1;x<arguments.length;x++){var b=arguments[x]!=null?arguments[x]:{};x%2?f(Object(b),!0).forEach(function(O){o(L,O,b[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(b)):f(Object(b)).forEach(function(O){Object.defineProperty(L,O,Object.getOwnPropertyDescriptor(b,O))})}return L}function o(L,x,b){return x in L?Object.defineProperty(L,x,{value:b,enumerable:!0,configurable:!0,writable:!0}):L[x]=b,L}var v=l(l({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:c.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:T.default,bufferController:g.default,capLevelController:r.default,fpsController:u.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:e.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},D()),{},{subtitleStreamController:A.SubtitleStreamController,subtitleTrackController:_.default,timelineController:s.TimelineController,audioStreamController:p.default,audioTrackController:m.default,emeController:a.default,cmcdController:d.default});function D(){return{cueHandler:t.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function S(L,x){if((x.liveSyncDurationCount||x.liveMaxLatencyDurationCount)&&(x.liveSyncDuration||x.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(x.liveMaxLatencyDurationCount!==void 0&&(x.liveSyncDurationCount===void 0||x.liveMaxLatencyDurationCount<=x.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(x.liveMaxLatencyDuration!==void 0&&(x.liveSyncDuration===void 0||x.liveMaxLatencyDuration<=x.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return i({},L,x)}function E(L){var x=L.loader;if(x!==h.default&&x!==c.default)n.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),L.progressive=!1;else{var b=Object(h.fetchSupported)();b&&(L.loader=h.default,L.progressive=!0,L.enableSoftwareAES=!0,n.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/utils/ewma-bandwidth-estimator.ts"),m=y("./src/events.ts"),A=y("./src/utils/buffer-helper.ts"),_=y("./src/errors.ts"),g=y("./src/types/loader.ts"),s=y("./src/utils/logger.ts");function r(d,c){for(var h=0;h<c.length;h++){var t=c[h];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(d,t.key,t)}}function u(d,c,h){return c&&r(d.prototype,c),h&&r(d,h),Object.defineProperty(d,"prototype",{writable:!1}),d}var a=function(){function d(h){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=h;var t=h.config;this.bwEstimator=new p.default(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var c=d.prototype;return c.registerListeners=function(){var t=this.hls;t.on(m.Events.FRAG_LOADING,this.onFragLoading,this),t.on(m.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.on(m.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var t=this.hls;t.off(m.Events.FRAG_LOADING,this.onFragLoading,this),t.off(m.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.off(m.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},c.onFragLoading=function(t,e){var n=e.frag;if(n.type===g.PlaylistLevelType.MAIN&&!this.timer){var i;this.fragCurrent=n,this.partCurrent=(i=e.part)!=null?i:null,this.timer=self.setInterval(this.onCheck,100)}},c.onLevelLoaded=function(t,e){var n=this.hls.config;e.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)},c._abandonRulesCheck=function(){var t=this.fragCurrent,e=this.partCurrent,n=this.hls,i=n.autoLevelEnabled,f=n.config,l=n.media;if(!(!t||!l)){var o=e?e.stats:t.stats,v=e?e.duration:t.duration;if(o.aborted){s.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!i||l.paused||!l.playbackRate||!l.readyState)){var D=performance.now()-o.loading.start,S=Math.abs(l.playbackRate);if(!(D<=500*v/S)){var E=n.levels,L=n.minAutoLevel,x=E[t.level],b=o.total||Math.max(o.loaded,Math.round(v*x.maxBitrate/8)),O=Math.max(1,o.bwEstimate?o.bwEstimate/8:o.loaded*1e3/D),R=(b-o.loaded)/O,I=l.currentTime,P=(A.BufferHelper.bufferInfo(l,I,f.maxBufferHole).end-I)/S;if(!(P>=2*v/S||R<=P)){var F=Number.POSITIVE_INFINITY,w;for(w=t.level-1;w>L;w--){var k=E[w].maxBitrate;if(F=v*k/(8*.8*O),F<P)break}if(!(F>=R)){var B=this.bwEstimator.getEstimate();s.logger.warn("Fragment "+t.sn+(e?" part "+e.index:"")+" of level "+t.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+w+`
      Current BW estimate: `+(Object(T.isFiniteNumber)(B)?(B/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+R.toFixed(3)+` s
      Estimated load time for the next fragment: `+F.toFixed(3)+` s
      Time to underbuffer: `+P.toFixed(3)+" s"),n.nextLoadLevel=w,this.bwEstimator.sample(D,o.loaded),this.clearTimer(),t.loader&&(this.fragCurrent=this.partCurrent=null,t.loader.abort()),n.trigger(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:e,stats:o})}}}}}},c.onFragLoaded=function(t,e){var n=e.frag,i=e.part;if(n.type===g.PlaylistLevelType.MAIN&&Object(T.isFiniteNumber)(n.sn)){var f=i?i.stats:n.stats,l=i?i.duration:n.duration;if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var o=this.hls.levels[n.level],v=(o.loaded?o.loaded.bytes:0)+f.loaded,D=(o.loaded?o.loaded.duration:0)+l;o.loaded={bytes:v,duration:D},o.realBitrate=Math.round(8*v/D)}if(n.bitrateTest){var S={stats:f,frag:n,part:i,id:n.type};this.onFragBuffered(m.Events.FRAG_BUFFERED,S),n.bitrateTest=!1}}},c.onFragBuffered=function(t,e){var n=e.frag,i=e.part,f=i?i.stats:n.stats;if(!f.aborted&&!(n.type!==g.PlaylistLevelType.MAIN||n.sn==="initSegment")){var l=f.parsing.end-f.loading.start;this.bwEstimator.sample(l,f.loaded),f.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}},c.onError=function(t,e){switch(e.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},c.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},c.getNextABRAutoLevel=function(){var t=this.fragCurrent,e=this.partCurrent,n=this.hls,i=n.maxAutoLevel,f=n.config,l=n.minAutoLevel,o=n.media,v=e?e.duration:t?t.duration:0,D=o?o.currentTime:0,S=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,E=this.bwEstimator?this.bwEstimator.getEstimate():f.abrEwmaDefaultEstimate,L=(A.BufferHelper.bufferInfo(o,D,f.maxBufferHole).end-D)/S,x=this.findBestLevel(E,l,i,L,f.abrBandWidthFactor,f.abrBandWidthUpFactor);if(x>=0)return x;s.logger.trace((L?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var b=v?Math.min(v,f.maxStarvationDelay):f.maxStarvationDelay,O=f.abrBandWidthFactor,R=f.abrBandWidthUpFactor;if(!L){var I=this.bitrateTestDelay;if(I){var P=v?Math.min(v,f.maxLoadingDelay):f.maxLoadingDelay;b=P-I,s.logger.trace("bitrate test took "+Math.round(1e3*I)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*b)+" ms"),O=R=1}}return x=this.findBestLevel(E,l,i,L+b,O,R),Math.max(x,0)},c.findBestLevel=function(t,e,n,i,f,l){for(var o,v=this.fragCurrent,D=this.partCurrent,S=this.lastLoadedFragLevel,E=this.hls.levels,L=E[S],x=!!(L!=null&&(o=L.details)!==null&&o!==void 0&&o.live),b=L==null?void 0:L.codecSet,O=D?D.duration:v?v.duration:0,R=n;R>=e;R--){var I=E[R];if(!(!I||b&&I.codecSet!==b)){var P=I.details,F=(D?P==null?void 0:P.partTarget:P==null?void 0:P.averagetargetduration)||O,w=void 0;R<=S?w=f*t:w=l*t;var k=E[R].maxBitrate,B=k*F/w;if(s.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+R+"/"+Math.round(w)+"/"+k+"/"+F+"/"+i+"/"+B),w>k&&(!B||x&&!this.bitrateTestDelay||B<i))return R}}return-1},u(d,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this.bwEstimator;if(t!==-1&&(!e||!e.canEstimate()))return t;var n=this.getNextABRAutoLevel();return t!==-1&&(n=Math.min(t,n)),n},set:function(t){this._nextAutoLevel=t}}]),d}();C.default=a},"./src/controller/audio-stream-controller.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/controller/base-stream-controller.ts"),m=y("./src/events.ts"),A=y("./src/utils/buffer-helper.ts"),_=y("./src/controller/fragment-tracker.ts"),g=y("./src/types/level.ts"),s=y("./src/types/loader.ts"),r=y("./src/loader/fragment.ts"),u=y("./src/demux/chunk-cache.ts"),a=y("./src/demux/transmuxer-interface.ts"),d=y("./src/types/transmuxer.ts"),c=y("./src/controller/fragment-finders.ts"),h=y("./src/utils/discontinuities.ts"),t=y("./src/errors.ts");function e(){return e=Object.assign?Object.assign.bind():function(o){for(var v=1;v<arguments.length;v++){var D=arguments[v];for(var S in D)Object.prototype.hasOwnProperty.call(D,S)&&(o[S]=D[S])}return o},e.apply(this,arguments)}function n(o,v){o.prototype=Object.create(v.prototype),o.prototype.constructor=o,i(o,v)}function i(o,v){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,E){return S.__proto__=E,S},i(o,v)}var f=100,l=function(o){n(v,o);function v(S,E){var L;return L=o.call(this,S,E,"[audio-stream-controller]")||this,L.videoBuffer=null,L.videoTrackCC=-1,L.waitingVideoCC=-1,L.audioSwitch=!1,L.trackId=-1,L.waitingData=null,L.mainDetails=null,L.bufferFlushed=!1,L.cachedTrackLoadedData=null,L._registerListeners(),L}var D=v.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var E=this.hls;E.on(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.on(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.on(m.Events.ERROR,this.onError,this),E.on(m.Events.BUFFER_RESET,this.onBufferReset,this),E.on(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var E=this.hls;E.off(m.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(m.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(m.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(m.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.off(m.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(m.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.off(m.Events.ERROR,this.onError,this),E.off(m.Events.BUFFER_RESET,this.onBufferReset,this),E.off(m.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(m.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(m.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.off(m.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(E,L){var x=L.frag,b=L.id,O=L.initPTS;if(b==="main"){var R=x.cc;this.initPTS[x.cc]=O,this.log("InitPTS for cc: "+R+" found from main: "+O),this.videoTrackCC=R,this.state===p.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(E){if(!this.levels){this.startPosition=E,this.state=p.State.STOPPED;return}var L=this.lastCurrentTime;this.stopLoad(),this.setInterval(f),this.fragLoadError=0,L>0&&E===-1?(this.log("Override startPosition with lastCurrentTime @"+L.toFixed(3)),E=L,this.state=p.State.IDLE):(this.loadedmetadata=!1,this.state=p.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()},D.doTick=function(){switch(this.state){case p.State.IDLE:this.doTickIdle();break;case p.State.WAITING_TRACK:{var E,L=this.levels,x=this.trackId,b=L==null||(E=L[x])===null||E===void 0?void 0:E.details;if(b){if(this.waitForCdnTuneIn(b))break;this.state=p.State.WAITING_INIT_PTS}break}case p.State.FRAG_LOADING_WAITING_RETRY:{var O,R=performance.now(),I=this.retryDate;(!I||R>=I||(O=this.media)!==null&&O!==void 0&&O.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=p.State.IDLE);break}case p.State.WAITING_INIT_PTS:{var P=this.waitingData;if(P){var F=P.frag,w=P.part,k=P.cache,B=P.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=p.State.FRAG_LOADING;var U=k.flush(),j={frag:F,part:w,payload:U,networkDetails:null};this._handleFragmentLoadProgress(j),B&&o.prototype._handleFragmentLoadComplete.call(this,j)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=this.getLoadPosition(),K=A.BufferHelper.bufferInfo(this.mediaBuffer,N,this.config.maxBufferHole),H=Object(c.fragmentWithinToleranceTest)(K.end,this.config.maxFragLookUpTolerance,F);H<0&&(this.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+K.end+" is needed"),this.clearWaitingFragment())}}else this.state=p.State.IDLE}}this.onTickEnd()},D.clearWaitingFragment=function(){var E=this.waitingData;E&&(this.fragmentTracker.removeFragment(E.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=p.State.IDLE)},D.resetLoadingState=function(){this.clearWaitingFragment(),o.prototype.resetLoadingState.call(this)},D.onTickEnd=function(){var E=this.media;if(!(!E||!E.readyState)){var L=this.mediaBuffer?this.mediaBuffer:E,x=L.buffered;!this.loadedmetadata&&x.length&&(this.loadedmetadata=!0),this.lastCurrentTime=E.currentTime}},D.doTickIdle=function(){var E,L,x=this.hls,b=this.levels,O=this.media,R=this.trackId,I=x.config;if(!(!b||!b[R])&&!(!O&&(this.startFragRequested||!I.startFragPrefetch))){var P=b[R],F=P.details;if(!F||F.live&&this.levelLastLoaded!==R||this.waitForCdnTuneIn(F)){this.state=p.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,r.ElementaryStreamTypes.AUDIO,s.PlaylistLevelType.AUDIO));var w=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,s.PlaylistLevelType.AUDIO);if(w!==null){var k=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,s.PlaylistLevelType.MAIN),B=w.len,U=this.getMaxBufferLength(k==null?void 0:k.len),j=this.audioSwitch;if(!(B>=U&&!j)){if(!j&&this._streamEnded(w,F)){x.trigger(m.Events.BUFFER_EOS,{type:"audio"}),this.state=p.State.ENDED;return}var N=F.fragments,K=N[0].start,H=w.end;if(j){var $=this.getLoadPosition();H=$,F.PTSKnown&&$<K&&(w.end>K||w.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),O.currentTime=K+.05)}if(!(k&&H>k.end+F.targetduration)&&!((!k||!k.len)&&w.len)){var G=this.getNextFragment(H,F);if(!G){this.bufferFlushed=!0;return}((E=G.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((L=G.decryptdata)!==null&&L!==void 0&&L.key)?this.loadKey(G,F):this.loadFragment(G,F,H)}}}}},D.getMaxBufferLength=function(E){var L=o.prototype.getMaxBufferLength.call(this);return E?Math.max(L,E):L},D.onMediaDetaching=function(){this.videoBuffer=null,o.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(E,L){var x=L.audioTracks;this.resetTransmuxer(),this.levels=x.map(function(b){return new g.Level(b)})},D.onAudioTrackSwitching=function(E,L){var x=!!L.url;this.trackId=L.id;var b=this.fragCurrent;b!=null&&b.loader&&b.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),x?this.setInterval(f):this.resetTransmuxer(),x?(this.audioSwitch=!0,this.state=p.State.IDLE):this.state=p.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(E,L){this.mainDetails=L.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(m.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},D.onAudioTrackLoaded=function(E,L){var x;if(this.mainDetails==null){this.cachedTrackLoadedData=L;return}var b=this.levels,O=L.details,R=L.id;if(!b){this.warn("Audio tracks were reset while loading level "+R);return}this.log("Track "+R+" loaded ["+O.startSN+","+O.endSN+"],duration:"+O.totalduration);var I=b[R],P=0;if(O.live||(x=I.details)!==null&&x!==void 0&&x.live){var F=this.mainDetails;if(O.fragments[0]||(O.deltaUpdateFailed=!0),O.deltaUpdateFailed||!F)return;!I.details&&O.hasProgramDateTime&&F.hasProgramDateTime?(Object(h.alignMediaPlaylistByPDT)(O,F),P=O.fragments[0].start):P=this.alignPlaylists(O,I.details)}I.details=O,this.levelLastLoaded=R,!this.startFragRequested&&(this.mainDetails||!O.live)&&this.setStartPosition(I.details,P),this.state===p.State.WAITING_TRACK&&!this.waitForCdnTuneIn(O)&&(this.state=p.State.IDLE),this.tick()},D._handleFragmentLoadProgress=function(E){var L,x=E.frag,b=E.part,O=E.payload,R=this.config,I=this.trackId,P=this.levels;if(!P){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+x.sn+" of level "+x.level+" will not be buffered");return}var F=P[I];console.assert(F,"Audio track is defined on fragment load progress");var w=F.details;console.assert(w,"Audio track details are defined on fragment load progress");var k=R.defaultAudioCodec||F.audioCodec||"mp4a.40.2",B=this.transmuxer;B||(B=this.transmuxer=new a.default(this.hls,s.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var U=this.initPTS[x.cc],j=(L=x.initSegment)===null||L===void 0?void 0:L.data;if(U!==void 0){var N=!1,K=b?b.index:-1,H=K!==-1,$=new d.ChunkMetadata(x.level,x.sn,x.stats.chunkCount,O.byteLength,K,H);B.push(O,j,k,"",x,b,w.totalduration,N,$,U)}else{this.log("Unknown video PTS for cc "+x.cc+", waiting for video PTS before demuxing audio frag "+x.sn+" of ["+w.startSN+" ,"+w.endSN+"],track "+I);var G=this.waitingData=this.waitingData||{frag:x,part:b,cache:new u.default,complete:!1},ee=G.cache;ee.push(new Uint8Array(O)),this.waitingVideoCC=this.videoTrackCC,this.state=p.State.WAITING_INIT_PTS}},D._handleFragmentLoadComplete=function(E){if(this.waitingData){this.waitingData.complete=!0;return}o.prototype._handleFragmentLoadComplete.call(this,E)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(E,L){var x=L.tracks.audio;x&&(this.mediaBuffer=x.buffer),L.tracks.video&&(this.videoBuffer=L.tracks.video.buffer)},D.onFragBuffered=function(E,L){var x=L.frag,b=L.part;if(x.type===s.PlaylistLevelType.AUDIO){if(this.fragContextChanged(x)){this.warn("Fragment "+x.sn+(b?" p: "+b.index:"")+" of level "+x.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}x.sn!=="initSegment"&&(this.fragPrevious=x,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(x,b)}},D.onError=function(E,L){switch(L.details){case t.ErrorDetails.FRAG_LOAD_ERROR:case t.ErrorDetails.FRAG_LOAD_TIMEOUT:case t.ErrorDetails.KEY_LOAD_ERROR:case t.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(s.PlaylistLevelType.AUDIO,L);break;case t.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case t.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==p.State.ERROR&&this.state!==p.State.STOPPED&&(this.state=L.fatal?p.State.ERROR:p.State.IDLE,this.warn(L.details+" while loading frag, switching to "+this.state+" state"));break;case t.ErrorDetails.BUFFER_FULL_ERROR:if(L.parent==="audio"&&(this.state===p.State.PARSING||this.state===p.State.PARSED)){var x=!0,b=this.getFwdBufferInfo(this.mediaBuffer,s.PlaylistLevelType.AUDIO);b&&b.len>.5&&(x=!this.reduceMaxBufferLength(b.len)),x&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,o.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},D.onBufferFlushed=function(E,L){var x=L.type;x===r.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(E){var L,x="audio",b=this.hls,O=E.remuxResult,R=E.chunkMeta,I=this.getCurrentContext(R);if(!I){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(R.level);return}var P=I.frag,F=I.part,w=I.level.details,k=O.audio,B=O.text,U=O.id3,j=O.initSegment;if(!(this.fragContextChanged(P)||!w)){if(this.state=p.State.PARSING,this.audioSwitch&&k&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,P,R),b.trigger(m.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:x,tracks:j.tracks})),k){var N=k.startPTS,K=k.endPTS,H=k.startDTS,$=k.endDTS;F&&(F.elementaryStreams[r.ElementaryStreamTypes.AUDIO]={startPTS:N,endPTS:K,startDTS:H,endDTS:$}),P.setElementaryStreamInfo(r.ElementaryStreamTypes.AUDIO,N,K,H,$),this.bufferFragmentData(k,P,F,R)}if(U!=null&&(L=U.samples)!==null&&L!==void 0&&L.length){var G=e({id:x,frag:P,details:w},U);b.trigger(m.Events.FRAG_PARSING_METADATA,G)}if(B){var ee=e({id:x,frag:P,details:w},B);b.trigger(m.Events.FRAG_PARSING_USERDATA,ee)}}},D._bufferInitSegment=function(E,L,x){if(this.state===p.State.PARSING){E.video&&delete E.video;var b=E.audio;if(!!b){b.levelCodec=b.codec,b.id="audio",this.log("Init audio buffer, container:"+b.container+", codecs[parsed]=["+b.codec+"]"),this.hls.trigger(m.Events.BUFFER_CODECS,E);var O=b.initSegment;if(O!=null&&O.byteLength){var R={type:"audio",frag:L,part:null,chunkMeta:x,parent:L.type,data:O};this.hls.trigger(m.Events.BUFFER_APPENDING,R)}this.tick()}}},D.loadFragment=function(E,L,x){var b=this.fragmentTracker.getState(E);this.fragCurrent=E,(this.audioSwitch||b===_.FragmentState.NOT_LOADED||b===_.FragmentState.PARTIAL)&&(E.sn==="initSegment"?this._loadInitSegment(E):L.live&&!Object(T.isFiniteNumber)(this.initPTS[E.cc])?(this.log("Waiting for video PTS in continuity counter "+E.cc+" of live stream before loading audio fragment "+E.sn+" of level "+this.trackId),this.state=p.State.WAITING_INIT_PTS):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,E,L,x)))},D.completeAudioSwitch=function(){var E=this.hls,L=this.media,x=this.trackId;L&&(this.log("Switching audio track : flushing all audio"),o.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,E.trigger(m.Events.AUDIO_TRACK_SWITCHED,{id:x})},v}(p.default);C.default=l},"./src/controller/audio-track-controller.ts":function(M,C,y){y.r(C);var T=y("./src/events.ts"),p=y("./src/errors.ts"),m=y("./src/controller/base-playlist-controller.ts"),A=y("./src/types/loader.ts");function _(a,d){for(var c=0;c<d.length;c++){var h=d[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(a,h.key,h)}}function g(a,d,c){return d&&_(a.prototype,d),c&&_(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function s(a,d){a.prototype=Object.create(d.prototype),a.prototype.constructor=a,r(a,d)}function r(a,d){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,t){return h.__proto__=t,h},r(a,d)}var u=function(a){s(d,a);function d(h){var t;return t=a.call(this,h,"[audio-track-controller]")||this,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.trackName="",t.selectDefaultTrack=!0,t.registerListeners(),t}var c=d.prototype;return c.registerListeners=function(){var t=this.hls;t.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(T.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(T.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var t=this.hls;t.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(T.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(T.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,a.prototype.destroy.call(this)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},c.onManifestParsed=function(t,e){this.tracks=e.audioTracks||[]},c.onAudioTrackLoaded=function(t,e){var n=e.id,i=e.details,f=this.tracksInGroup[n];if(!f){this.warn("Invalid audio track id "+n);return}var l=f.details;f.details=e.details,this.log("audioTrack "+n+" loaded ["+i.startSN+"-"+i.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,e,l))},c.onLevelLoading=function(t,e){this.switchLevel(e.level)},c.onLevelSwitching=function(t,e){this.switchLevel(e.level)},c.switchLevel=function(t){var e=this.hls.levels[t];if(!!(e!=null&&e.audioGroupIds)){var n=e.audioGroupIds[e.urlId];if(this.groupId!==n){this.groupId=n;var i=this.tracks.filter(function(l){return!n||l.groupId===n});this.selectDefaultTrack&&!i.some(function(l){return l.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;var f={audioTracks:i};this.log("Updating audio tracks, "+i.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(T.Events.AUDIO_TRACKS_UPDATED,f),this.selectInitialTrack()}}},c.onError=function(t,e){a.prototype.onError.call(this,t,e),!(e.fatal||!e.context)&&e.context.type===A.PlaylistContextType.AUDIO_TRACK&&e.context.id===this.trackId&&e.context.groupId===this.groupId&&this.retryLoadingOrFail(e)},c.setAudioTrack=function(t){var e=this.tracksInGroup;if(t<0||t>=e.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var n=e[this.trackId];this.log("Now switching to audio-track index "+t);var i=e[t],f=i.id,l=i.groupId,o=l===void 0?"":l,v=i.name,D=i.type,S=i.url;if(this.trackId=t,this.trackName=v,this.selectDefaultTrack=!1,this.hls.trigger(T.Events.AUDIO_TRACK_SWITCHING,{id:f,groupId:o,name:v,type:D,url:S}),!(i.details&&!i.details.live)){var E=this.switchParams(i.url,n==null?void 0:n.details);this.loadPlaylist(E)}},c.selectInitialTrack=function(){var t=this.tracksInGroup;console.assert(t.length,"Initial audio track should be selected when tracks are known");var e=this.trackName,n=this.findTrackId(e)||this.findTrackId();n!==-1?this.setAudioTrack(n):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},c.findTrackId=function(t){for(var e=this.tracksInGroup,n=0;n<e.length;n++){var i=e[n];if((!this.selectDefaultTrack||i.default)&&(!t||t===i.name))return i.id}return-1},c.loadPlaylist=function(t){var e=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(e)){var n=e.id,i=e.groupId,f=e.url;if(t)try{f=t.addDirectives(f)}catch(l){this.warn("Could not construct new URL with HLS Delivery Directives: "+l)}this.log("loading audio-track playlist for id: "+n),this.clearTimer(),this.hls.trigger(T.Events.AUDIO_TRACK_LOADING,{url:f,id:n,groupId:i,deliveryDirectives:t||null})}},g(d,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}}]),d}(m.default);C.default=u},"./src/controller/base-playlist-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return g});var T=y("./src/polyfills/number.ts"),p=y("./src/types/level.ts"),m=y("./src/controller/level-helper.ts"),A=y("./src/utils/logger.ts"),_=y("./src/errors.ts"),g=function(){function s(u,a){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=A.logger.log.bind(A.logger,a+":"),this.warn=A.logger.warn.bind(A.logger,a+":"),this.hls=u}var r=s.prototype;return r.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},r.onError=function(a,d){d.fatal&&d.type===_.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},r.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},r.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},r.stopLoad=function(){this.canLoad=!1,this.clearTimer()},r.switchParams=function(a,d){var c=d==null?void 0:d.renditionReports;if(c)for(var h=0;h<c.length;h++){var t=c[h],e=""+t.URI;if(e===a.slice(-e.length)){var n=parseInt(t["LAST-MSN"]),i=parseInt(t["LAST-PART"]);if(d&&this.hls.config.lowLatencyMode){var f=Math.min(d.age-d.partTarget,d.targetduration);i!==void 0&&f>d.partTarget&&(i+=1)}if(Object(T.isFiniteNumber)(n))return new p.HlsUrlParameters(n,Object(T.isFiniteNumber)(i)?i:void 0,p.HlsSkip.No)}}},r.loadPlaylist=function(a){},r.shouldLoadTrack=function(a){return this.canLoad&&a&&!!a.url&&(!a.details||a.details.live)},r.playlistLoaded=function(a,d,c){var h=this,t=d.details,e=d.stats,n=e.loading.end?Math.max(0,self.performance.now()-e.loading.end):0;if(t.advancedDateTime=Date.now()-n,t.live||c!=null&&c.live){if(t.reloaded(c),c&&this.log("live playlist "+a+" "+(t.advanced?"REFRESHED "+t.lastPartSn+"-"+t.lastPartIndex:"MISSED")),c&&t.fragments.length>0&&Object(m.mergeDetails)(c,t),!this.canLoad||!t.live)return;var i,f=void 0,l=void 0;if(t.canBlockReload&&t.endSN&&t.advanced){var o=this.hls.config.lowLatencyMode,v=t.lastPartSn,D=t.endSN,S=t.lastPartIndex,E=S!==-1,L=v===D,x=o?0:S;E?(f=L?D+1:v,l=L?x:S+1):f=D+1;var b=t.age,O=b+t.ageHeader,R=Math.min(O-t.partTarget,t.targetduration*1.5);if(R>0){if(c&&R>c.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+c.tuneInGoal+" to: "+R+" with playlist age: "+t.age),R=0;else{var I=Math.floor(R/t.targetduration);if(f+=I,l!==void 0){var P=Math.round(R%t.targetduration/t.partTarget);l+=P}this.log("CDN Tune-in age: "+t.ageHeader+"s last advanced "+b.toFixed(2)+"s goal: "+R+" skip sn "+I+" to part "+l)}t.tuneInGoal=R}if(i=this.getDeliveryDirectives(t,d.deliveryDirectives,f,l),o||!L){this.loadPlaylist(i);return}}else i=this.getDeliveryDirectives(t,d.deliveryDirectives,f,l);var F=Object(m.computeReloadInterval)(t,e);f!==void 0&&t.canBlockReload&&(F-=t.partTarget||1),this.log("reload live playlist "+a+" in "+Math.round(F)+" ms"),this.timer=self.setTimeout(function(){return h.loadPlaylist(i)},F)}else this.clearTimer()},r.getDeliveryDirectives=function(a,d,c,h){var t=Object(p.getSkipValue)(a,c);return d!=null&&d.skip&&a.deltaUpdateFailed&&(c=d.msn,h=d.part,t=p.HlsSkip.No),new p.HlsUrlParameters(c,h,t)},r.retryLoadingOrFail=function(a){var d=this,c=this.hls.config,h=this.retryCount<c.levelLoadingMaxRetry;if(h){var t;if(this.retryCount++,a.details.indexOf("LoadTimeOut")>-1&&(t=a.context)!==null&&t!==void 0&&t.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+a.details+'"'),this.loadPlaylist();else{var e=Math.min(Math.pow(2,this.retryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return d.loadPlaylist()},e),this.warn("retry playlist loading #"+this.retryCount+" in "+e+' ms after "'+a.details+'"')}}else this.warn('cannot recover from error "'+a.details+'"'),this.clearTimer(),a.fatal=!0;return h},s}()},"./src/controller/base-stream-controller.ts":function(M,C,y){y.r(C),y.d(C,"State",function(){return D}),y.d(C,"default",function(){return S});var T=y("./src/polyfills/number.ts"),p=y("./src/task-loop.ts"),m=y("./src/controller/fragment-tracker.ts"),A=y("./src/utils/buffer-helper.ts"),_=y("./src/utils/logger.ts"),g=y("./src/events.ts"),s=y("./src/errors.ts"),r=y("./src/types/transmuxer.ts"),u=y("./src/utils/mp4-tools.ts"),a=y("./src/utils/discontinuities.ts"),d=y("./src/controller/fragment-finders.ts"),c=y("./src/controller/level-helper.ts"),h=y("./src/loader/fragment-loader.ts"),t=y("./src/crypt/decrypter.ts"),e=y("./src/utils/time-ranges.ts"),n=y("./src/types/loader.ts");function i(E,L){for(var x=0;x<L.length;x++){var b=L[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(E,b.key,b)}}function f(E,L,x){return L&&i(E.prototype,L),x&&i(E,x),Object.defineProperty(E,"prototype",{writable:!1}),E}function l(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function o(E,L){E.prototype=Object.create(L.prototype),E.prototype.constructor=E,v(E,L)}function v(E,L){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(b,O){return b.__proto__=O,b},v(E,L)}var D={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},S=function(E){o(L,E);function L(b,O,R){var I;return I=E.call(this)||this,I.hls=void 0,I.fragPrevious=null,I.fragCurrent=null,I.fragmentTracker=void 0,I.transmuxer=null,I._state=D.STOPPED,I.media=void 0,I.mediaBuffer=void 0,I.config=void 0,I.bitrateTest=!1,I.lastCurrentTime=0,I.nextLoadPosition=0,I.startPosition=0,I.loadedmetadata=!1,I.fragLoadError=0,I.retryDate=0,I.levels=null,I.fragmentLoader=void 0,I.levelLastLoaded=null,I.startFragRequested=!1,I.decrypter=void 0,I.initPTS=[],I.onvseeking=null,I.onvended=null,I.logPrefix="",I.log=void 0,I.warn=void 0,I.logPrefix=R,I.log=_.logger.log.bind(_.logger,R+":"),I.warn=_.logger.warn.bind(_.logger,R+":"),I.hls=b,I.fragmentLoader=new h.default(b.config),I.fragmentTracker=O,I.config=b.config,I.decrypter=new t.default(b,b.config),b.on(g.Events.KEY_LOADED,I.onKeyLoaded,l(I)),I}var x=L.prototype;return x.doTick=function(){this.onTickEnd()},x.onTickEnd=function(){},x.startLoad=function(O){},x.stopLoad=function(){this.fragmentLoader.abort();var O=this.fragCurrent;O&&this.fragmentTracker.removeFragment(O),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=D.STOPPED},x._streamEnded=function(O,R){var I=this.fragCurrent,P=this.fragmentTracker;if(!R.live&&I&&I.sn>=R.endSN&&!O.nextStart){var F=R.partList;if(F!=null&&F.length){var w=F[F.length-1],k=A.BufferHelper.isBuffered(this.media,w.start+w.duration/2);return k}var B=P.getState(I);return B===m.FragmentState.PARTIAL||B===m.FragmentState.OK}return!1},x.onMediaAttached=function(O,R){var I=this.media=this.mediaBuffer=R.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),I.addEventListener("seeking",this.onvseeking),I.addEventListener("ended",this.onvended);var P=this.config;this.levels&&P.autoStartLoad&&this.state===D.STOPPED&&this.startLoad(P.startPosition)},x.onMediaDetaching=function(){var O=this.media;O!=null&&O.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),O&&(O.removeEventListener("seeking",this.onvseeking),O.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},x.onMediaSeeking=function(){var O=this.config,R=this.fragCurrent,I=this.media,P=this.mediaBuffer,F=this.state,w=I?I.currentTime:0,k=A.BufferHelper.bufferInfo(P||I,w,O.maxBufferHole);if(this.log("media seeking to "+(Object(T.isFiniteNumber)(w)?w.toFixed(3):w)+", state: "+F),F===D.ENDED)this.resetLoadingState();else if(R&&!k.len){var B=O.maxFragLookUpTolerance,U=R.start-B,j=R.start+R.duration+B,N=w>j;(w<U||N)&&(N&&R.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),R.loader.abort()),this.resetLoadingState())}I&&(this.lastCurrentTime=w),!this.loadedmetadata&&!k.len&&(this.nextLoadPosition=this.startPosition=w),this.tickImmediate()},x.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},x.onKeyLoaded=function(O,R){if(!(this.state!==D.KEY_LOADING||R.frag!==this.fragCurrent||!this.levels)){this.state=D.IDLE;var I=this.levels[R.frag.level].details;I&&this.loadFragment(R.frag,I,R.frag.start)}},x.onHandlerDestroying=function(){this.stopLoad(),E.prototype.onHandlerDestroying.call(this)},x.onHandlerDestroyed=function(){this.state=D.STOPPED,this.hls.off(g.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,E.prototype.onHandlerDestroyed.call(this)},x.loadKey=function(O,R){this.log("Loading key for "+O.sn+" of ["+R.startSN+"-"+R.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+O.level),this.state=D.KEY_LOADING,this.fragCurrent=O,this.hls.trigger(g.Events.KEY_LOADING,{frag:O})},x.loadFragment=function(O,R,I){this._loadFragForPlayback(O,R,I)},x._loadFragForPlayback=function(O,R,I){var P=this,F=function(k){if(P.fragContextChanged(O)){P.warn("Fragment "+O.sn+(k.part?" p: "+k.part.index:"")+" of level "+O.level+" was dropped during download."),P.fragmentTracker.removeFragment(O);return}O.stats.chunkCount++,P._handleFragmentLoadProgress(k)};this._doFragLoad(O,R,I,F).then(function(w){if(!!w){P.fragLoadError=0;var k=P.state;if(P.fragContextChanged(O)){(k===D.FRAG_LOADING||!P.fragCurrent&&k===D.PARSING)&&(P.fragmentTracker.removeFragment(O),P.state=D.IDLE);return}"payload"in w&&(P.log("Loaded fragment "+O.sn+" of level "+O.level),P.hls.trigger(g.Events.FRAG_LOADED,w)),P._handleFragmentLoadComplete(w)}}).catch(function(w){P.state!==D.STOPPED&&(P.warn(w),P.resetFragmentLoading(O))})},x.flushMainBuffer=function(O,R,I){if(I===void 0&&(I=null),!!(O-R)){var P={startOffset:O,endOffset:R,type:I};this.fragLoadError=0,this.hls.trigger(g.Events.BUFFER_FLUSHING,P)}},x._loadInitSegment=function(O){var R=this;this._doFragLoad(O).then(function(I){if(!I||R.fragContextChanged(O)||!R.levels)throw new Error("init load aborted");return I}).then(function(I){var P=R.hls,F=I.payload,w=O.decryptdata;if(F&&F.byteLength>0&&w&&w.key&&w.iv&&w.method==="AES-128"){var k=self.performance.now();return R.decrypter.webCryptoDecrypt(new Uint8Array(F),w.key.buffer,w.iv.buffer).then(function(B){var U=self.performance.now();return P.trigger(g.Events.FRAG_DECRYPTED,{frag:O,payload:B,stats:{tstart:k,tdecrypt:U}}),I.payload=B,I})}return I}).then(function(I){var P=R.fragCurrent,F=R.hls,w=R.levels;if(!w)throw new Error("init load aborted, missing levels");var k=w[O.level].details;console.assert(k,"Level details are defined when init segment is loaded");var B=O.stats;R.state=D.IDLE,R.fragLoadError=0,O.data=new Uint8Array(I.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),I.frag===P&&F.trigger(g.Events.FRAG_BUFFERED,{stats:B,frag:P,part:null,id:O.type}),R.tick()}).catch(function(I){R.warn(I),R.resetFragmentLoading(O)})},x.fragContextChanged=function(O){var R=this.fragCurrent;return!O||!R||O.level!==R.level||O.sn!==R.sn||O.urlId!==R.urlId},x.fragBufferedComplete=function(O,R){var I=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+O.type+" sn: "+O.sn+(R?" part: "+R.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+O.level+" "+e.default.toString(A.BufferHelper.getBuffered(I))),this.state=D.IDLE,this.tick()},x._handleFragmentLoadComplete=function(O){var R=this.transmuxer;if(!!R){var I=O.frag,P=O.part,F=O.partsLoaded,w=!F||F.length===0||F.some(function(B){return!B}),k=new r.ChunkMetadata(I.level,I.sn,I.stats.chunkCount+1,0,P?P.index:-1,!w);R.flush(k)}},x._handleFragmentLoadProgress=function(O){},x._doFragLoad=function(O,R,I,P){var F=this;if(I===void 0&&(I=null),!this.levels)throw new Error("frag load aborted, missing levels");if(I=Math.max(O.start,I||0),this.config.lowLatencyMode&&R){var w=R.partList;if(w&&P){I>O.end&&R.fragmentHint&&(O=R.fragmentHint);var k=this.getNextPart(w,O,I);if(k>-1){var B=w[k];return this.log("Loading part sn: "+O.sn+" p: "+B.index+" cc: "+O.cc+" of playlist ["+R.startSN+"-"+R.endSN+"] parts [0-"+k+"-"+(w.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+O.level+", target: "+parseFloat(I.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=D.FRAG_LOADING,this.hls.trigger(g.Events.FRAG_LOADING,{frag:O,part:w[k],targetBufferTime:I}),this.doFragPartsLoad(O,w,k,P).catch(function(U){return F.handleFragLoadError(U)})}else if(!O.url||this.loadedEndOfParts(w,I))return Promise.resolve(null)}}return this.log("Loading fragment "+O.sn+" cc: "+O.cc+" "+(R?"of ["+R.startSN+"-"+R.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+O.level+", target: "+parseFloat(I.toFixed(3))),Object(T.isFiniteNumber)(O.sn)&&!this.bitrateTest&&(this.nextLoadPosition=O.start+O.duration),this.state=D.FRAG_LOADING,this.hls.trigger(g.Events.FRAG_LOADING,{frag:O,targetBufferTime:I}),this.fragmentLoader.load(O,P).catch(function(U){return F.handleFragLoadError(U)})},x.doFragPartsLoad=function(O,R,I,P){var F=this;return new Promise(function(w,k){var B=[],U=function j(N){var K=R[N];F.fragmentLoader.loadPart(O,K,P).then(function(H){B[K.index]=H;var $=H.part;F.hls.trigger(g.Events.FRAG_LOADED,H);var G=R[N+1];if(G&&G.fragment===O)j(N+1);else return w({frag:O,part:$,partsLoaded:B})}).catch(k)};U(I)})},x.handleFragLoadError=function(O){var R=O.data;return R&&R.details===s.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(R.frag,R.part):this.hls.trigger(g.Events.ERROR,R),null},x._handleTransmuxerFlush=function(O){var R=this.getCurrentContext(O);if(!R||this.state!==D.PARSING){this.fragCurrent||(this.state=D.IDLE);return}var I=R.frag,P=R.part,F=R.level,w=self.performance.now();I.stats.parsing.end=w,P&&(P.stats.parsing.end=w),this.updateLevelTiming(I,P,F,O.partial)},x.getCurrentContext=function(O){var R=this.levels,I=O.level,P=O.sn,F=O.part;if(!R||!R[I])return this.warn("Levels object was unset while buffering fragment "+P+" of level "+I+". The current chunk will not be buffered."),null;var w=R[I],k=F>-1?Object(c.getPartWith)(w,P,F):null,B=k?k.fragment:Object(c.getFragmentWithSN)(w,P,this.fragCurrent);return B?{frag:B,part:k,level:w}:null},x.bufferFragmentData=function(O,R,I,P){if(!(!O||this.state!==D.PARSING)){var F=O.data1,w=O.data2,k=F;if(F&&w&&(k=Object(u.appendUint8Array)(F,w)),!(!k||!k.length)){var B={type:O.type,frag:R,part:I,chunkMeta:P,parent:R.type,data:k};this.hls.trigger(g.Events.BUFFER_APPENDING,B),O.dropped&&O.independent&&!I&&this.flushBufferGap(R)}}},x.flushBufferGap=function(O){var R=this.media;if(!!R){if(!A.BufferHelper.isBuffered(R,R.currentTime)){this.flushMainBuffer(0,O.start);return}var I=R.currentTime,P=A.BufferHelper.bufferInfo(R,I,0),F=O.duration,w=Math.min(this.config.maxFragLookUpTolerance*2,F*.25),k=Math.max(Math.min(O.start-w,P.end-w),I+w);O.start-k>w&&this.flushMainBuffer(k,O.start)}},x.getFwdBufferInfo=function(O,R){var I=this.config,P=this.getLoadPosition();if(!Object(T.isFiniteNumber)(P))return null;var F=A.BufferHelper.bufferInfo(O,P,I.maxBufferHole);if(F.len===0&&F.nextStart!==void 0){var w=this.fragmentTracker.getBufferedFrag(P,R);if(w&&F.nextStart<w.end)return A.BufferHelper.bufferInfo(O,P,Math.max(F.nextStart,I.maxBufferHole))}return F},x.getMaxBufferLength=function(O){var R=this.config,I;return O?I=Math.max(8*R.maxBufferSize/O,R.maxBufferLength):I=R.maxBufferLength,Math.min(I,R.maxMaxBufferLength)},x.reduceMaxBufferLength=function(O){var R=this.config,I=O||R.maxBufferLength;return R.maxMaxBufferLength>=I?(R.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+R.maxMaxBufferLength+"s"),!0):!1},x.getNextFragment=function(O,R){var I=R.fragments,P=I.length;if(!P)return null;var F=this.config,w=I[0].start,k;if(R.live){var B=F.initialLiveManifestSize;if(P<B)return this.warn("Not enough fragments to start playback (have: "+P+", need: "+B+")"),null;!R.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(k=this.getInitialLiveFragment(R,I),this.startPosition=k?this.hls.liveSyncPosition||k.start:O)}else O<=w&&(k=I[0]);if(!k){var U=F.lowLatencyMode?R.partEnd:R.fragmentEnd;k=this.getFragmentAtPosition(O,U,R)}return this.mapToInitFragWhenRequired(k)},x.mapToInitFragWhenRequired=function(O){return O!=null&&O.initSegment&&!(O!=null&&O.initSegment.data)&&!this.bitrateTest?O.initSegment:O},x.getNextPart=function(O,R,I){for(var P=-1,F=!1,w=!0,k=0,B=O.length;k<B;k++){var U=O[k];if(w=w&&!U.independent,P>-1&&I<U.start)break;var j=U.loaded;!j&&(F||U.independent||w)&&U.fragment===R&&(P=k),F=j}return P},x.loadedEndOfParts=function(O,R){var I=O[O.length-1];return I&&R>I.start&&I.loaded},x.getInitialLiveFragment=function(O,R){var I=this.fragPrevious,P=null;if(I){if(O.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+I.programDateTime),P=Object(d.findFragmentByPDT)(R,I.endProgramDateTime,this.config.maxFragLookUpTolerance)),!P){var F=I.sn+1;if(F>=O.startSN&&F<=O.endSN){var w=R[F-O.startSN];I.cc===w.cc&&(P=w,this.log("Live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=Object(d.findFragWithCC)(R,I.cc),P&&this.log("Live playlist, switching playlist, load frag with same CC: "+P.sn))}}else{var k=this.hls.liveSyncPosition;k!==null&&(P=this.getFragmentAtPosition(k,this.bitrateTest?O.fragmentEnd:O.edge,O))}return P},x.getFragmentAtPosition=function(O,R,I){var P=this.config,F=this.fragPrevious,w=I.fragments,k=I.endSN,B=I.fragmentHint,U=P.maxFragLookUpTolerance,j=!!(P.lowLatencyMode&&I.partList&&B);j&&B&&!this.bitrateTest&&(w=w.concat(B),k=B.sn);var N;if(O<R){var K=O>R-U?0:U;N=Object(d.findFragmentByPTS)(F,w,O,K)}else N=w[w.length-1];if(N){var H=N.sn-I.startSN,$=F&&N.level===F.level,G=w[H+1];F&&N.sn===F.sn&&!j&&$&&(N.sn<k&&this.fragmentTracker.getState(G)!==m.FragmentState.OK?(this.log("SN "+N.sn+" just loaded, load next one: "+G.sn),N=G):N=null)}return N},x.synchronizeToLiveEdge=function(O){var R=this.config,I=this.media;if(!!I){var P=this.hls.liveSyncPosition,F=I.currentTime,w=O.fragments[0].start,k=O.edge,B=F>=w-R.maxFragLookUpTolerance&&F<=k;if(P!==null&&I.duration>P&&(F<P||!B)){var U=R.liveMaxLatencyDuration!==void 0?R.liveMaxLatencyDuration:R.liveMaxLatencyDurationCount*O.targetduration;(!B&&I.readyState<4||F<k-U)&&(this.loadedmetadata||(this.nextLoadPosition=P),I.readyState&&(this.warn("Playback: "+F.toFixed(3)+" is located too far from the end of live sliding playlist: "+k+", reset currentTime to : "+P.toFixed(3)),I.currentTime=P))}}},x.alignPlaylists=function(O,R){var I=this.levels,P=this.levelLastLoaded,F=this.fragPrevious,w=P!==null?I[P]:null,k=O.fragments.length;if(!k)return this.warn("No fragments in live playlist"),0;var B=O.fragments[0].start,U=!R,j=O.alignedSliding&&Object(T.isFiniteNumber)(B);if(U||!j&&!B){Object(a.alignStream)(F,w,O);var N=O.fragments[0].start;return this.log("Live playlist sliding: "+N.toFixed(2)+" start-sn: "+(R?R.startSN:"na")+"->"+O.startSN+" prev-sn: "+(F?F.sn:"na")+" fragments: "+k),N}return B},x.waitForCdnTuneIn=function(O){var R=3;return O.live&&O.canBlockReload&&O.partTarget&&O.tuneInGoal>Math.max(O.partHoldBack,O.partTarget*R)},x.setStartPosition=function(O,R){var I=this.startPosition;if(I<R&&(I=-1),I===-1||this.lastCurrentTime===-1){var P=O.startTimeOffset;Object(T.isFiniteNumber)(P)?(I=R+P,P<0&&(I+=O.totalduration),I=Math.min(Math.max(R,I),R+O.totalduration),this.log("Start time offset "+P+" found in playlist, adjust startPosition to "+I),this.startPosition=I):O.live?I=this.hls.liveSyncPosition||R:this.startPosition=I=0,this.lastCurrentTime=I}this.nextLoadPosition=I},x.getLoadPosition=function(){var O=this.media,R=0;return this.loadedmetadata&&O?R=O.currentTime:this.nextLoadPosition&&(R=this.nextLoadPosition),R},x.handleFragLoadAborted=function(O,R){this.transmuxer&&O.sn!=="initSegment"&&O.stats.aborted&&(this.warn("Fragment "+O.sn+(R?" part"+R.index:"")+" of level "+O.level+" was aborted"),this.resetFragmentLoading(O))},x.resetFragmentLoading=function(O){(!this.fragCurrent||!this.fragContextChanged(O))&&(this.state=D.IDLE)},x.onFragmentOrKeyLoadError=function(O,R){if(!R.fatal){var I=R.frag;if(!(!I||I.type!==O)){var P=this.fragCurrent;console.assert(P&&I.sn===P.sn&&I.level===P.level&&I.urlId===P.urlId,"Frag load error must match current frag to retry");var F=this.config;if(this.fragLoadError+1<=F.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(I.level))return;var w=Math.min(Math.pow(2,this.fragLoadError)*F.fragLoadingRetryDelay,F.fragLoadingMaxRetryTimeout);this.warn("Fragment "+I.sn+" of "+O+" "+I.level+" failed to load, retrying in "+w+"ms"),this.retryDate=self.performance.now()+w,this.fragLoadError++,this.state=D.FRAG_LOADING_WAITING_RETRY}else R.levelRetry?(O===n.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=D.IDLE):(_.logger.error(R.details+" reaches max retry, redispatch as fatal ..."),R.fatal=!0,this.hls.stopLoad(),this.state=D.ERROR)}}},x.afterBufferFlushed=function(O,R,I){if(!!O){var P=A.BufferHelper.getBuffered(O);this.fragmentTracker.detectEvictedFragments(R,P,I),this.state===D.ENDED&&this.resetLoadingState()}},x.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=D.IDLE},x.resetLiveStartWhenNotLoaded=function(O){if(!this.loadedmetadata){this.startFragRequested=!1;var R=this.levels?this.levels[O].details:null;if(R!=null&&R.live)return this.startPosition=-1,this.setStartPosition(R,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},x.updateLevelTiming=function(O,R,I,P){var F=this,w=I.details;console.assert(!!w,"level.details must be defined");var k=Object.keys(O.elementaryStreams).reduce(function(B,U){var j=O.elementaryStreams[U];if(j){var N=j.endPTS-j.startPTS;if(N<=0)return F.warn("Could not parse fragment "+O.sn+" "+U+" duration reliably ("+N+")"),B||!1;var K=P?0:Object(c.updateFragPTSDTS)(w,O,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return F.hls.trigger(g.Events.LEVEL_PTS_UPDATED,{details:w,level:I,drift:K,type:U,frag:O,start:j.startPTS,end:j.endPTS}),!0}return B},!1);k||(this.warn("Found no media in fragment "+O.sn+" of level "+I.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=D.PARSED,this.hls.trigger(g.Events.FRAG_PARSED,{frag:O,part:R})},x.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},f(L,[{key:"state",get:function(){return this._state},set:function(O){var R=this._state;R!==O&&(this._state=O,this.log(R+"->"+O))}}]),L}(p.default)},"./src/controller/buffer-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return d});var T=y("./src/polyfills/number.ts"),p=y("./src/events.ts"),m=y("./src/utils/logger.ts"),A=y("./src/errors.ts"),_=y("./src/utils/buffer-helper.ts"),g=y("./src/utils/mediasource-helper.ts"),s=y("./src/loader/fragment.ts"),r=y("./src/controller/buffer-operation-queue.ts"),u=Object(g.getMediaSource)(),a=/([ha]vc.)(?:\.[^.,]+)+/,d=function(){function c(t){var e=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var n=e.hls,i=e.media,f=e.mediaSource;m.logger.log("[buffer-controller]: Media source opened"),i&&(e.updateMediaElementDuration(),n.trigger(p.Events.MEDIA_ATTACHED,{media:i})),f&&f.removeEventListener("sourceopen",e._onMediaSourceOpen),e.checkPendingTracks()},this._onMediaSourceClose=function(){m.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){m.logger.log("[buffer-controller]: Media source ended")},this.hls=t,this._initSourceBuffer(),this.registerListeners()}var h=c.prototype;return h.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},h.destroy=function(){this.unregisterListeners(),this.details=null},h.registerListeners=function(){var e=this.hls;e.on(p.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(p.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(p.Events.BUFFER_RESET,this.onBufferReset,this),e.on(p.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(p.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(p.Events.BUFFER_EOS,this.onBufferEos,this),e.on(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(p.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(p.Events.FRAG_PARSED,this.onFragParsed,this),e.on(p.Events.FRAG_CHANGED,this.onFragChanged,this)},h.unregisterListeners=function(){var e=this.hls;e.off(p.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(p.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(p.Events.BUFFER_RESET,this.onBufferReset,this),e.off(p.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(p.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(p.Events.BUFFER_EOS,this.onBufferEos,this),e.off(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(p.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(p.Events.FRAG_PARSED,this.onFragParsed,this),e.off(p.Events.FRAG_CHANGED,this.onFragChanged,this)},h._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new r.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},h.onManifestParsed=function(e,n){var i=2;(n.audio&&!n.video||!n.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.details=null,m.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},h.onMediaAttaching=function(e,n){var i=this.media=n.media;if(i&&u){var f=this.mediaSource=new u;f.addEventListener("sourceopen",this._onMediaSourceOpen),f.addEventListener("sourceended",this._onMediaSourceEnded),f.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(f),this._objectUrl=i.src}},h.onMediaDetaching=function(){var e=this.media,n=this.mediaSource,i=this._objectUrl;if(n){if(m.logger.log("[buffer-controller]: media source detaching"),n.readyState==="open")try{n.endOfStream()}catch(f){m.logger.warn("[buffer-controller]: onMediaDetaching: "+f.message+" while calling endOfStream")}this.onBufferReset(),n.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("sourceended",this._onMediaSourceEnded),n.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):m.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(p.Events.MEDIA_DETACHED,void 0)},h.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach(function(n){var i=e.sourceBuffer[n];try{i&&(e.removeBufferListeners(n),e.mediaSource&&e.mediaSource.removeSourceBuffer(i),e.sourceBuffer[n]=void 0)}catch(f){m.logger.warn("[buffer-controller]: Failed to reset the "+n+" buffer",f)}}),this._initSourceBuffer()},h.onBufferCodecs=function(e,n){var i=this,f=this.getSourceBufferTypes().length;Object.keys(n).forEach(function(l){if(f){var o=i.tracks[l];if(o&&typeof o.buffer.changeType=="function"){var v=n[l],D=v.id,S=v.codec,E=v.levelCodec,L=v.container,x=v.metadata,b=(o.levelCodec||o.codec).replace(a,"$1"),O=(E||S).replace(a,"$1");if(b!==O){var R=L+";codecs="+(E||S);i.appendChangeType(l,R),m.logger.log("[buffer-controller]: switching codec "+b+" to "+O),i.tracks[l]={buffer:o.buffer,codec:S,container:L,levelCodec:E,metadata:x,id:D}}}}else i.pendingTracks[l]=n[l]}),!f&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},h.appendChangeType=function(e,n){var i=this,f=this.operationQueue,l={execute:function(){var v=i.sourceBuffer[e];v&&(m.logger.log("[buffer-controller]: changing "+e+" sourceBuffer type to "+n),v.changeType(n)),f.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(v){m.logger.warn("[buffer-controller]: Failed to change "+e+" SourceBuffer type",v)}};f.append(l,e)},h.onBufferAppending=function(e,n){var i=this,f=this.hls,l=this.operationQueue,o=this.tracks,v=n.data,D=n.type,S=n.frag,E=n.part,L=n.chunkMeta,x=L.buffering[D],b=self.performance.now();x.start=b;var O=S.stats.buffering,R=E?E.stats.buffering:null;O.start===0&&(O.start=b),R&&R.start===0&&(R.start=b);var I=o.audio,P=D==="audio"&&L.id===1&&(I==null?void 0:I.container)==="audio/mpeg",F={execute:function(){if(x.executeStart=self.performance.now(),P){var k=i.sourceBuffer[D];if(k){var B=S.start-k.timestampOffset;Math.abs(B)>=.1&&(m.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+S.start+" (delta: "+B+") sn: "+S.sn+")"),k.timestampOffset=S.start)}}i.appendExecutor(v,D)},onStart:function(){},onComplete:function(){var k=self.performance.now();x.executeEnd=x.end=k,O.first===0&&(O.first=k),R&&R.first===0&&(R.first=k);var B=i.sourceBuffer,U={};for(var j in B)U[j]=_.BufferHelper.getBuffered(B[j]);i.appendError=0,i.hls.trigger(p.Events.BUFFER_APPENDED,{type:D,frag:S,part:E,chunkMeta:L,parent:S.type,timeRanges:U})},onError:function(k){m.logger.error("[buffer-controller]: Error encountered while trying to append to the "+D+" SourceBuffer",k);var B={type:A.ErrorTypes.MEDIA_ERROR,parent:S.type,details:A.ErrorDetails.BUFFER_APPEND_ERROR,err:k,fatal:!1};k.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=A.ErrorDetails.BUFFER_FULL_ERROR:(i.appendError++,B.details=A.ErrorDetails.BUFFER_APPEND_ERROR,i.appendError>f.config.appendErrorMaxRetry&&(m.logger.error("[buffer-controller]: Failed "+f.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),B.fatal=!0)),f.trigger(p.Events.ERROR,B)}};l.append(F,D)},h.onBufferFlushing=function(e,n){var i=this,f=this.operationQueue,l=function(v){return{execute:i.removeExecutor.bind(i,v,n.startOffset,n.endOffset),onStart:function(){},onComplete:function(){i.hls.trigger(p.Events.BUFFER_FLUSHED,{type:v})},onError:function(S){m.logger.warn("[buffer-controller]: Failed to remove from "+v+" SourceBuffer",S)}}};n.type?f.append(l(n.type),n.type):this.getSourceBufferTypes().forEach(function(o){f.append(l(o),o)})},h.onFragParsed=function(e,n){var i=this,f=n.frag,l=n.part,o=[],v=l?l.elementaryStreams:f.elementaryStreams;v[s.ElementaryStreamTypes.AUDIOVIDEO]?o.push("audiovideo"):(v[s.ElementaryStreamTypes.AUDIO]&&o.push("audio"),v[s.ElementaryStreamTypes.VIDEO]&&o.push("video"));var D=function(){var E=self.performance.now();f.stats.buffering.end=E,l&&(l.stats.buffering.end=E);var L=l?l.stats:f.stats;i.hls.trigger(p.Events.FRAG_BUFFERED,{frag:f,part:l,stats:L,id:f.type})};o.length===0&&m.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+f.type+" level: "+f.level+" sn: "+f.sn),this.blockBuffers(D,o)},h.onFragChanged=function(e,n){this.flushBackBuffer()},h.onBufferEos=function(e,n){var i=this,f=this.getSourceBufferTypes().reduce(function(l,o){var v=i.sourceBuffer[o];return(!n.type||n.type===o)&&v&&!v.ended&&(v.ended=!0,m.logger.log("[buffer-controller]: "+o+" sourceBuffer now EOS")),l&&!!(!v||v.ended)},!0);f&&this.blockBuffers(function(){var l=i.mediaSource;!l||l.readyState!=="open"||l.endOfStream()})},h.onLevelUpdated=function(e,n){var i=n.details;!i.fragments.length||(this.details=i,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},h.flushBackBuffer=function(){var e=this.hls,n=this.details,i=this.media,f=this.sourceBuffer;if(!(!i||n===null)){var l=this.getSourceBufferTypes();if(!!l.length){var o=n.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!(!Object(T.isFiniteNumber)(o)||o<0)){var v=i.currentTime,D=n.levelTargetDuration,S=Math.max(o,D),E=Math.floor(v/D)*D-S;l.forEach(function(L){var x=f[L];if(x){var b=_.BufferHelper.getBuffered(x);b.length>0&&E>b.start(0)&&(e.trigger(p.Events.BACK_BUFFER_REACHED,{bufferEnd:E}),n.live&&e.trigger(p.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:E}),e.trigger(p.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:E,type:L}))}})}}}},h.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var e=this.details,n=this.hls,i=this.media,f=this.mediaSource,l=e.fragments[0].start+e.totalduration,o=i.duration,v=Object(T.isFiniteNumber)(f.duration)?f.duration:0;e.live&&n.config.liveDurationInfinity?(m.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),f.duration=1/0,this.updateSeekableRange(e)):(l>v&&l>o||!Object(T.isFiniteNumber)(o))&&(m.logger.log("[buffer-controller]: Updating Media Source duration to "+l.toFixed(3)),f.duration=l)}},h.updateSeekableRange=function(e){var n=this.mediaSource,i=e.fragments,f=i.length;if(f&&e.live&&n!==null&&n!==void 0&&n.setLiveSeekableRange){var l=Math.max(0,i[0].start),o=Math.max(l,l+e.totalduration);n.setLiveSeekableRange(l,o)}},h.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,n=this.operationQueue,i=this.pendingTracks,f=Object.keys(i).length;if(f&&!e||f===2){this.createSourceBuffers(i),this.pendingTracks={};var l=this.getSourceBufferTypes();if(l.length===0){this.hls.trigger(p.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}l.forEach(function(o){n.executeNext(o)})}},h.createSourceBuffers=function(e){var n=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");var f=0;for(var l in e)if(!n[l]){var o=e[l];if(!o)throw Error("source buffer exists for track "+l+", however track does not");var v=o.levelCodec||o.codec,D=o.container+";codecs="+v;m.logger.log("[buffer-controller]: creating sourceBuffer("+D+")");try{var S=n[l]=i.addSourceBuffer(D),E=l;this.addBufferListener(E,"updatestart",this._onSBUpdateStart),this.addBufferListener(E,"updateend",this._onSBUpdateEnd),this.addBufferListener(E,"error",this._onSBUpdateError),this.tracks[l]={buffer:S,codec:v,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id},f++}catch(L){m.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+L.message),this.hls.trigger(p.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:L,mimeType:D})}}f&&this.hls.trigger(p.Events.BUFFER_CREATED,{tracks:this.tracks})},h._onSBUpdateStart=function(e){var n=this.operationQueue,i=n.current(e);i.onStart()},h._onSBUpdateEnd=function(e){var n=this.operationQueue,i=n.current(e);i.onComplete(),n.shiftAndExecuteNext(e)},h._onSBUpdateError=function(e,n){m.logger.error("[buffer-controller]: "+e+" SourceBuffer error",n),this.hls.trigger(p.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var i=this.operationQueue.current(e);i&&i.onError(n)},h.removeExecutor=function(e,n,i){var f=this.media,l=this.mediaSource,o=this.operationQueue,v=this.sourceBuffer,D=v[e];if(!f||!l||!D){m.logger.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),o.shiftAndExecuteNext(e);return}var S=Object(T.isFiniteNumber)(f.duration)?f.duration:1/0,E=Object(T.isFiniteNumber)(l.duration)?l.duration:1/0,L=Math.max(0,n),x=Math.min(i,S,E);x>L?(m.logger.log("[buffer-controller]: Removing ["+L+","+x+"] from the "+e+" SourceBuffer"),console.assert(!D.updating,e+" sourceBuffer must not be updating"),D.remove(L,x)):o.shiftAndExecuteNext(e)},h.appendExecutor=function(e,n){var i=this.operationQueue,f=this.sourceBuffer,l=f[n];if(!l){m.logger.warn("[buffer-controller]: Attempting to append to the "+n+" SourceBuffer, but it does not exist"),i.shiftAndExecuteNext(n);return}l.ended=!1,console.assert(!l.updating,n+" sourceBuffer must not be updating"),l.appendBuffer(e)},h.blockBuffers=function(e,n){var i=this;if(n===void 0&&(n=this.getSourceBufferTypes()),!n.length){m.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}var f=this.operationQueue,l=n.map(function(o){return f.appendBlocker(o)});Promise.all(l).then(function(){e(),n.forEach(function(o){var v=i.sourceBuffer[o];(!v||!v.updating)&&f.shiftAndExecuteNext(o)})})},h.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},h.addBufferListener=function(e,n,i){var f=this.sourceBuffer[e];if(!!f){var l=i.bind(this,e);this.listeners[e].push({event:n,listener:l}),f.addEventListener(n,l)}},h.removeBufferListeners=function(e){var n=this.sourceBuffer[e];!n||this.listeners[e].forEach(function(i){n.removeEventListener(i.event,i.listener)})},c}()},"./src/controller/buffer-operation-queue.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return p});var T=y("./src/utils/logger.ts"),p=function(){function m(_){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=_}var A=m.prototype;return A.append=function(g,s){var r=this.queues[s];r.push(g),r.length===1&&this.buffers[s]&&this.executeNext(s)},A.insertAbort=function(g,s){var r=this.queues[s];r.unshift(g),this.executeNext(s)},A.appendBlocker=function(g){var s,r=new Promise(function(a){s=a}),u={execute:s,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(u,g),r},A.executeNext=function(g){var s=this.buffers,r=this.queues,u=s[g],a=r[g];if(a.length){var d=a[0];try{d.execute()}catch(c){T.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),d.onError(c),(!u||!u.updating)&&(a.shift(),this.executeNext(g))}}},A.shiftAndExecuteNext=function(g){this.queues[g].shift(),this.executeNext(g)},A.current=function(g){return this.queues[g][0]},m}()},"./src/controller/cap-level-controller.ts":function(M,C,y){y.r(C);var T=y("./src/events.ts");function p(_,g){for(var s=0;s<g.length;s++){var r=g[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(_,r.key,r)}}function m(_,g,s){return g&&p(_.prototype,g),s&&p(_,s),Object.defineProperty(_,"prototype",{writable:!1}),_}var A=function(){function _(s){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=s,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var g=_.prototype;return g.setStreamController=function(r){this.streamController=r},g.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},g.registerListeners=function(){var r=this.hls;r.on(T.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),r.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),r.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.on(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),r.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},g.unregisterListener=function(){var r=this.hls;r.off(T.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),r.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),r.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.off(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),r.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},g.onFpsDropLevelCapping=function(r,u){_.isLevelAllowed(u.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(u.droppedLevel)},g.onMediaAttaching=function(r,u){this.media=u.media instanceof HTMLVideoElement?u.media:null},g.onManifestParsed=function(r,u){var a=this.hls;this.restrictedLevels=[],this.firstLevel=u.firstLevel,a.config.capLevelToPlayerSize&&u.video&&this.startCapping()},g.onBufferCodecs=function(r,u){var a=this.hls;a.config.capLevelToPlayerSize&&u.video&&this.startCapping()},g.onMediaDetaching=function(){this.stopCapping()},g.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var r=this.hls.levels;if(r.length){var u=this.hls;u.autoLevelCapping=this.getMaxLevel(r.length-1),u.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=u.autoLevelCapping}}},g.getMaxLevel=function(r){var u=this,a=this.hls.levels;if(!a.length)return-1;var d=a.filter(function(c,h){return _.isLevelAllowed(h,u.restrictedLevels)&&h<=r});return this.clientRect=null,_.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)},g.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},g.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},g.getDimensions=function(){if(this.clientRect)return this.clientRect;var r=this.media,u={width:0,height:0};if(r){var a=r.getBoundingClientRect();u.width=a.width,u.height=a.height,!u.width&&!u.height&&(u.width=a.right-a.left||r.width||0,u.height=a.bottom-a.top||r.height||0)}return this.clientRect=u,u},_.isLevelAllowed=function(r,u){return u===void 0&&(u=[]),u.indexOf(r)===-1},_.getMaxLevelByMediaSize=function(r,u,a){if(!r||!r.length)return-1;for(var d=function(n,i){return i?n.width!==i.width||n.height!==i.height:!0},c=r.length-1,h=0;h<r.length;h+=1){var t=r[h];if((t.width>=u||t.height>=a)&&d(t,r[h+1])){c=h;break}}return c},m(_,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var r=1;if(!this.hls.config.ignoreDevicePixelRatio)try{r=self.devicePixelRatio}catch{}return r}}]),_}();C.default=A},"./src/controller/cmcd-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return d});var T=y("./src/events.ts"),p=y("./src/types/cmcd.ts"),m=y("./src/utils/buffer-helper.ts"),A=y("./src/utils/logger.ts");function _(c,h){for(var t=0;t<h.length;t++){var e=h[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(c,e.key,e)}}function g(c,h,t){return h&&_(c.prototype,h),t&&_(c,t),Object.defineProperty(c,"prototype",{writable:!1}),c}function s(c,h){var t=typeof Symbol<"u"&&c[Symbol.iterator]||c["@@iterator"];if(t)return(t=t.call(c)).next.bind(t);if(Array.isArray(c)||(t=r(c))||h&&c&&typeof c.length=="number"){t&&(c=t);var e=0;return function(){return e>=c.length?{done:!0}:{done:!1,value:c[e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(c,h){if(!!c){if(typeof c=="string")return u(c,h);var t=Object.prototype.toString.call(c).slice(8,-1);if(t==="Object"&&c.constructor&&(t=c.constructor.name),t==="Map"||t==="Set")return Array.from(c);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return u(c,h)}}function u(c,h){(h==null||h>c.length)&&(h=c.length);for(var t=0,e=new Array(h);t<h;t++)e[t]=c[t];return e}function a(){return a=Object.assign?Object.assign.bind():function(c){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(c[e]=t[e])}return c},a.apply(this,arguments)}var d=function(){function c(t){var e=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){e.initialized&&(e.starved=!0),e.buffering=!0},this.onPlaying=function(){e.initialized||(e.initialized=!0),e.buffering=!1},this.applyPlaylistData=function(f){try{e.apply(f,{ot:p.CMCDObjectType.MANIFEST,su:!e.initialized})}catch(l){A.logger.warn("Could not generate manifest CMCD data.",l)}},this.applyFragmentData=function(f){try{var l=f.frag,o=e.hls.levels[l.level],v=e.getObjectType(l),D={d:l.duration*1e3,ot:v};(v===p.CMCDObjectType.VIDEO||v===p.CMCDObjectType.AUDIO||v==p.CMCDObjectType.MUXED)&&(D.br=o.bitrate/1e3,D.tb=e.getTopBandwidth(v)/1e3,D.bl=e.getBufferLength(v)),e.apply(f,D)}catch(S){A.logger.warn("Could not generate segment CMCD data.",S)}},this.hls=t;var n=this.config=t.config,i=n.cmcd;i!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||c.uuid(),this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.registerListeners())}var h=c.prototype;return h.registerListeners=function(){var e=this.hls;e.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(T.Events.BUFFER_CREATED,this.onBufferCreated,this)},h.unregisterListeners=function(){var e=this.hls;e.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(T.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},h.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},h.onMediaAttached=function(e,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},h.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},h.onBufferCreated=function(e,n){var i,f;this.audioBuffer=(i=n.tracks.audio)===null||i===void 0?void 0:i.buffer,this.videoBuffer=(f=n.tracks.video)===null||f===void 0?void 0:f.buffer},h.createData=function(){var e;return{v:p.CMCDVersion,sf:p.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)===null||e===void 0?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},h.apply=function(e,n){n===void 0&&(n={}),a(n,this.createData());var i=n.ot===p.CMCDObjectType.INIT||n.ot===p.CMCDObjectType.VIDEO||n.ot===p.CMCDObjectType.MUXED;if(this.starved&&i&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering),this.useHeaders){var f=c.toHeaders(n);if(!Object.keys(f).length)return;e.headers||(e.headers={}),a(e.headers,f)}else{var l=c.toQuery(n);if(!l)return;e.url=c.appendQueryToUri(e.url,l)}},h.getObjectType=function(e){var n=e.type;if(n==="subtitle")return p.CMCDObjectType.TIMED_TEXT;if(e.sn==="initSegment")return p.CMCDObjectType.INIT;if(n==="audio")return p.CMCDObjectType.AUDIO;if(n==="main")return this.hls.audioTracks.length?p.CMCDObjectType.VIDEO:p.CMCDObjectType.MUXED},h.getTopBandwidth=function(e){var n=0,i,f=this.hls;if(e===p.CMCDObjectType.AUDIO)i=f.audioTracks;else{var l=f.maxAutoLevel,o=l>-1?l+1:f.levels.length;i=f.levels.slice(0,o)}for(var v=s(i),D;!(D=v()).done;){var S=D.value;S.bitrate>n&&(n=S.bitrate)}return n>0?n:NaN},h.getBufferLength=function(e){var n=this.hls.media,i=e===p.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!i||!n)return NaN;var f=m.BufferHelper.bufferInfo(i,n.currentTime,this.config.maxBufferHole);return f.len*1e3},h.createPlaylistLoader=function(){var e=this.config.pLoader,n=this.applyPlaylistData,i=e||this.config.loader;return function(){function f(o){this.loader=void 0,this.loader=new i(o)}var l=f.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(v,D,S){n(v),this.loader.load(v,D,S)},g(f,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),f}()},h.createFragmentLoader=function(){var e=this.config.fLoader,n=this.applyFragmentData,i=e||this.config.loader;return function(){function f(o){this.loader=void 0,this.loader=new i(o)}var l=f.prototype;return l.destroy=function(){this.loader.destroy()},l.abort=function(){this.loader.abort()},l.load=function(v,D,S){n(v),this.loader.load(v,D,S)},g(f,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),f}()},c.uuid=function(){var e=URL.createObjectURL(new Blob),n=e.toString();return URL.revokeObjectURL(e),n.slice(n.lastIndexOf("/")+1)},c.serialize=function(e){for(var n=[],i=function(P){return!Number.isNaN(P)&&P!=null&&P!==""&&P!==!1},f=function(P){return Math.round(P)},l=function(P){return f(P/100)*100},o=function(P){return encodeURIComponent(P)},v={br:f,d:f,bl:l,dl:l,mtp:l,nor:o,rtp:l,tb:f},D=Object.keys(e||{}).sort(),S=s(D),E;!(E=S()).done;){var L=E.value,x=e[L];if(!!i(x)&&!(L==="v"&&x===1)&&!(L=="pr"&&x===1)){var b=v[L];b&&(x=b(x));var O=typeof x,R=void 0;L==="ot"||L==="sf"||L==="st"?R=L+"="+x:O==="boolean"?R=L:O==="number"?R=L+"="+x:R=L+"="+JSON.stringify(x),n.push(R)}}return n.join(",")},c.toHeaders=function(e){for(var n=Object.keys(e),i={},f=["Object","Request","Session","Status"],l=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},v=0,D=n;v<D.length;v++){var S=D[v],E=o[S]!=null?o[S]:1;l[E][S]=e[S]}for(var L=0;L<l.length;L++){var x=c.serialize(l[L]);x&&(i["CMCD-"+f[L]]=x)}return i},c.toQuery=function(e){return"CMCD="+encodeURIComponent(c.serialize(e))},c.appendQueryToUri=function(e,n){if(!n)return e;var i=e.includes("?")?"&":"?";return""+e+i+n},c}()},"./src/controller/eme-controller.ts":function(M,C,y){y.r(C);var T=y("./src/events.ts"),p=y("./src/errors.ts"),m=y("./src/utils/logger.ts"),A=y("./src/utils/mediakeys-helper.ts");function _(d,c){for(var h=0;h<c.length;h++){var t=c[h];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(d,t.key,t)}}function g(d,c,h){return c&&_(d.prototype,c),h&&_(d,h),Object.defineProperty(d,"prototype",{writable:!1}),d}var s=3,r=function(c,h,t){var e={audioCapabilities:[],videoCapabilities:[]};return c.forEach(function(n){e.audioCapabilities.push({contentType:'audio/mp4; codecs="'+n+'"',robustness:t.audioRobustness||""})}),h.forEach(function(n){e.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"',robustness:t.videoRobustness||""})}),[e]},u=function(c,h,t,e){switch(c){case A.KeySystems.WIDEVINE:return r(h,t,e);default:throw new Error("Unknown key-system: "+c)}},a=function(){function d(h){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=h,this._config=h.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var c=d.prototype;return c.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},c._registerListeners=function(){this.hls.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this)},c._unregisterListeners=function(){this.hls.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this)},c.getLicenseServerUrl=function(t){switch(t){case A.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},c._attemptKeySystemAccess=function(t,e,n){var i=this,f=u(t,e,n,this._drmSystemOptions);m.logger.log("Requesting encrypted media key-system access");var l=this.requestMediaKeySystemAccess(t,f);this.mediaKeysPromise=l.then(function(o){return i._onMediaKeySystemAccessObtained(t,o)}),l.catch(function(o){m.logger.error('Failed to obtain key-system "'+t+'" access:',o)})},c._onMediaKeySystemAccessObtained=function(t,e){var n=this;m.logger.log('Access for key-system "'+t+'" obtained');var i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i);var f=Promise.resolve().then(function(){return e.createMediaKeys()}).then(function(l){return i.mediaKeys=l,m.logger.log('Media-keys created for key-system "'+t+'"'),n._onMediaKeysCreated(),l});return f.catch(function(l){m.logger.error("Failed to create media-keys:",l)}),f},c._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},c._onNewMediaKeySession=function(t){var e=this;m.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(n){e._onKeySessionMessage(t,n.message)},!1)},c._onKeySessionMessage=function(t,e){m.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(n){m.logger.log("Received license data (length: "+(n&&n.byteLength)+"), updating key-session"),t.update(n).catch(function(i){m.logger.warn("Updating key-session failed: "+i)})})},c.onMediaEncrypted=function(t){var e=this;if(m.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!this.mediaKeysPromise){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var n=function(f){!e._media||(e._attemptSetMediaKeys(f),e._generateRequestWithPreferredKeySession(t.initDataType,t.initData))};this.mediaKeysPromise.then(n).catch(n)},c._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys){m.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}m.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},c._generateRequestWithPreferredKeySession=function(t,e){var n=this,i=this._mediaKeysList[0];if(!i){m.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(i.mediaKeysSessionInitialized){m.logger.warn("Key-Session already initialized but requested again");return}var f=i.mediaKeysSession;if(!f){m.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!e){m.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}m.logger.log('Generating key-session request for "'+t+'" init data type'),i.mediaKeysSessionInitialized=!0,f.generateRequest(t,e).then(function(){m.logger.debug("Key-session generation succeeded")}).catch(function(l){m.logger.error("Error generating key-session request:",l),n.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},c._createLicenseXhr=function(t,e,n){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,n);var f=this._licenseXhrSetup;if(f)try{f.call(this.hls,i,t),f=void 0}catch(l){m.logger.error(l)}try{i.readyState||i.open("POST",t,!0),f&&f.call(this.hls,i,t)}catch(l){throw new Error("issue setting up KeySystem license XHR "+l)}return i},c._onLicenseRequestReadyStageChange=function(t,e,n,i){switch(t.readyState){case 4:if(t.status===200){this._requestLicenseFailureCount=0,m.logger.log("License request succeeded");var f=t.response,l=this._licenseResponseCallback;if(l)try{f=l.call(this.hls,t,e)}catch(v){m.logger.error(v)}i(f)}else{if(m.logger.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>s){this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var o=s-this._requestLicenseFailureCount+1;m.logger.warn("Retrying license request, "+o+" attempts left"),this._requestLicense(n,i)}break}},c._generateLicenseRequestChallenge=function(t,e){switch(t.mediaKeySystemDomain){case A.KeySystems.WIDEVINE:return e}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},c._requestLicense=function(t,e){m.logger.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n){m.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var i=this.getLicenseServerUrl(n.mediaKeySystemDomain),f=this._createLicenseXhr(i,t,e);m.logger.log("Sending license request to URL: "+i);var l=this._generateLicenseRequestChallenge(n,t);f.send(l)}catch(o){m.logger.error("Failure requesting DRM license: "+o),this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.KEY_SYSTEM_ERROR,details:p.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},c.onMediaAttached=function(t,e){if(!!this._emeEnabled){var n=e.media;this._media=n,n.addEventListener("encrypted",this._onMediaEncrypted)}},c.onMediaDetached=function(){var t=this._media,e=this._mediaKeysList;!t||(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(e.map(function(n){if(n.mediaKeysSession)return n.mediaKeysSession.close().catch(function(){})})).then(function(){return t.setMediaKeys(null)}).catch(function(){}))},c.onManifestParsed=function(t,e){if(!!this._emeEnabled){var n=e.levels.map(function(f){return f.audioCodec}).filter(function(f){return!!f}),i=e.levels.map(function(f){return f.videoCodec}).filter(function(f){return!!f});this._attemptKeySystemAccess(A.KeySystems.WIDEVINE,n,i)}},g(d,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),d}();C.default=a},"./src/controller/fps-controller.ts":function(M,C,y){y.r(C);var T=y("./src/events.ts"),p=y("./src/utils/logger.ts"),m=function(){function A(g){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=g,this.registerListeners()}var _=A.prototype;return _.setStreamController=function(s){this.streamController=s},_.registerListeners=function(){this.hls.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},_.unregisterListeners=function(){this.hls.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching)},_.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},_.onMediaAttaching=function(s,r){var u=this.hls.config;if(u.capLevelOnFPSDrop){var a=r.media instanceof self.HTMLVideoElement?r.media:null;this.media=a,a&&typeof a.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),u.fpsDroppedMonitoringPeriod)}},_.checkFPS=function(s,r,u){var a=performance.now();if(r){if(this.lastTime){var d=a-this.lastTime,c=u-this.lastDroppedFrames,h=r-this.lastDecodedFrames,t=1e3*c/d,e=this.hls;if(e.trigger(T.Events.FPS_DROP,{currentDropped:c,currentDecoded:h,totalDroppedFrames:u}),t>0&&c>e.config.fpsDroppedMonitoringThreshold*h){var n=e.currentLevel;p.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+n),n>0&&(e.autoLevelCapping===-1||e.autoLevelCapping>=n)&&(n=n-1,e.trigger(T.Events.FPS_DROP_LEVEL_CAPPING,{level:n,droppedLevel:e.currentLevel}),e.autoLevelCapping=n,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=u,this.lastDecodedFrames=r}},_.checkFPSInterval=function(){var s=this.media;if(s)if(this.isVideoPlaybackQualityAvailable){var r=s.getVideoPlaybackQuality();this.checkFPS(s,r.totalVideoFrames,r.droppedVideoFrames)}else this.checkFPS(s,s.webkitDecodedFrameCount,s.webkitDroppedFrameCount)},A}();C.default=m},"./src/controller/fragment-finders.ts":function(M,C,y){y.r(C),y.d(C,"findFragmentByPDT",function(){return m}),y.d(C,"findFragmentByPTS",function(){return A}),y.d(C,"fragmentWithinToleranceTest",function(){return _}),y.d(C,"pdtWithinToleranceTest",function(){return g}),y.d(C,"findFragWithCC",function(){return s});var T=y("./src/polyfills/number.ts"),p=y("./src/utils/binary-search.ts");function m(r,u,a){if(u===null||!Array.isArray(r)||!r.length||!Object(T.isFiniteNumber)(u))return null;var d=r[0].programDateTime;if(u<(d||0))return null;var c=r[r.length-1].endProgramDateTime;if(u>=(c||0))return null;a=a||0;for(var h=0;h<r.length;++h){var t=r[h];if(g(u,a,t))return t}return null}function A(r,u,a,d){a===void 0&&(a=0),d===void 0&&(d=0);var c=null;if(r?c=u[r.sn-u[0].sn+1]||null:a===0&&u[0].start===0&&(c=u[0]),c&&_(a,d,c)===0)return c;var h=p.default.search(u,_.bind(null,a,d));return h||c}function _(r,u,a){r===void 0&&(r=0),u===void 0&&(u=0);var d=Math.min(u,a.duration+(a.deltaPTS?a.deltaPTS:0));return a.start+a.duration-d<=r?1:a.start-d>r&&a.start?-1:0}function g(r,u,a){var d=Math.min(u,a.duration+(a.deltaPTS?a.deltaPTS:0))*1e3,c=a.endProgramDateTime||0;return c-d>r}function s(r,u){return p.default.search(r,function(a){return a.cc<u?1:a.cc>u?-1:0})}},"./src/controller/fragment-tracker.ts":function(M,C,y){y.r(C),y.d(C,"FragmentState",function(){return m}),y.d(C,"FragmentTracker",function(){return A});var T=y("./src/events.ts"),p=y("./src/types/loader.ts"),m;(function(s){s.NOT_LOADED="NOT_LOADED",s.APPENDING="APPENDING",s.PARTIAL="PARTIAL",s.OK="OK"})(m||(m={}));var A=function(){function s(u){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=u,this._registerListeners()}var r=s.prototype;return r._registerListeners=function(){var a=this.hls;a.on(T.Events.BUFFER_APPENDED,this.onBufferAppended,this),a.on(T.Events.FRAG_BUFFERED,this.onFragBuffered,this),a.on(T.Events.FRAG_LOADED,this.onFragLoaded,this)},r._unregisterListeners=function(){var a=this.hls;a.off(T.Events.BUFFER_APPENDED,this.onBufferAppended,this),a.off(T.Events.FRAG_BUFFERED,this.onFragBuffered,this),a.off(T.Events.FRAG_LOADED,this.onFragLoaded,this)},r.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},r.getAppendedFrag=function(a,d){if(d===p.PlaylistLevelType.MAIN){var c=this.activeFragment,h=this.activeParts;if(!c)return null;if(h)for(var t=h.length;t--;){var e=h[t],n=e?e.end:c.appendedPTS;if(e.start<=a&&n!==void 0&&a<=n)return t>9&&(this.activeParts=h.slice(t-9)),e}else if(c.start<=a&&c.appendedPTS!==void 0&&a<=c.appendedPTS)return c}return this.getBufferedFrag(a,d)},r.getBufferedFrag=function(a,d){for(var c=this.fragments,h=Object.keys(c),t=h.length;t--;){var e=c[h[t]];if((e==null?void 0:e.body.type)===d&&e.buffered){var n=e.body;if(n.start<=a&&a<=n.end)return n}}return null},r.detectEvictedFragments=function(a,d,c){var h=this;Object.keys(this.fragments).forEach(function(t){var e=h.fragments[t];if(!!e){if(!e.buffered){e.body.type===c&&h.removeFragment(e.body);return}var n=e.range[a];!n||n.time.some(function(i){var f=!h.isTimeBuffered(i.startPTS,i.endPTS,d);return f&&h.removeFragment(e.body),f})}})},r.detectPartialFragments=function(a){var d=this,c=this.timeRanges,h=a.frag,t=a.part;if(!(!c||h.sn==="initSegment")){var e=g(h),n=this.fragments[e];!n||(Object.keys(c).forEach(function(i){var f=h.elementaryStreams[i];if(!!f){var l=c[i],o=t!==null||f.partial===!0;n.range[i]=d.getBufferedTimes(h,t,o,l)}}),n.loaded=null,Object.keys(n.range).length?n.buffered=!0:this.removeFragment(n.body))}},r.fragBuffered=function(a){var d=g(a),c=this.fragments[d];c&&(c.loaded=null,c.buffered=!0)},r.getBufferedTimes=function(a,d,c,h){for(var t={time:[],partial:c},e=d?d.start:a.start,n=d?d.end:a.end,i=a.minEndPTS||n,f=a.maxStartPTS||e,l=0;l<h.length;l++){var o=h.start(l)-this.bufferPadding,v=h.end(l)+this.bufferPadding;if(f>=o&&i<=v){t.time.push({startPTS:Math.max(e,h.start(l)),endPTS:Math.min(n,h.end(l))});break}else if(e<v&&n>o)t.partial=!0,t.time.push({startPTS:Math.max(e,h.start(l)),endPTS:Math.min(n,h.end(l))});else if(n<=o)break}return t},r.getPartialFragment=function(a){var d=null,c,h,t,e=0,n=this.bufferPadding,i=this.fragments;return Object.keys(i).forEach(function(f){var l=i[f];!l||_(l)&&(h=l.body.start-n,t=l.body.end+n,a>=h&&a<=t&&(c=Math.min(a-h,t-a),e<=c&&(d=l.body,e=c)))}),d},r.getState=function(a){var d=g(a),c=this.fragments[d];return c?c.buffered?_(c)?m.PARTIAL:m.OK:m.APPENDING:m.NOT_LOADED},r.isTimeBuffered=function(a,d,c){for(var h,t,e=0;e<c.length;e++){if(h=c.start(e)-this.bufferPadding,t=c.end(e)+this.bufferPadding,a>=h&&d<=t)return!0;if(d<=h)return!1}return!1},r.onFragLoaded=function(a,d){var c=d.frag,h=d.part;if(!(c.sn==="initSegment"||c.bitrateTest||h)){var t=g(c);this.fragments[t]={body:c,loaded:d,buffered:!1,range:Object.create(null)}}},r.onBufferAppended=function(a,d){var c=this,h=d.frag,t=d.part,e=d.timeRanges;if(h.type===p.PlaylistLevelType.MAIN)if(this.activeFragment=h,t){var n=this.activeParts;n||(this.activeParts=n=[]),n.push(t)}else this.activeParts=null;this.timeRanges=e,Object.keys(e).forEach(function(i){var f=e[i];if(c.detectEvictedFragments(i,f),!t)for(var l=0;l<f.length;l++)h.appendedPTS=Math.max(f.end(l),h.appendedPTS||0)})},r.onFragBuffered=function(a,d){this.detectPartialFragments(d)},r.hasFragment=function(a){var d=g(a);return!!this.fragments[d]},r.removeFragmentsInRange=function(a,d,c){var h=this;Object.keys(this.fragments).forEach(function(t){var e=h.fragments[t];if(!!e&&e.buffered){var n=e.body;n.type===c&&n.start<d&&n.end>a&&h.removeFragment(n)}})},r.removeFragment=function(a){var d=g(a);a.stats.loaded=0,a.clearElementaryStreamInfo(),delete this.fragments[d]},r.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},s}();function _(s){var r,u;return s.buffered&&(((r=s.range.video)===null||r===void 0?void 0:r.partial)||((u=s.range.audio)===null||u===void 0?void 0:u.partial))}function g(s){return s.type+"_"+s.level+"_"+s.urlId+"_"+s.sn}},"./src/controller/gap-controller.ts":function(M,C,y){y.r(C),y.d(C,"STALL_MINIMUM_DURATION_MS",function(){return _}),y.d(C,"MAX_START_GAP_JUMP",function(){return g}),y.d(C,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return s}),y.d(C,"SKIP_BUFFER_RANGE_START",function(){return r}),y.d(C,"default",function(){return u});var T=y("./src/utils/buffer-helper.ts"),p=y("./src/errors.ts"),m=y("./src/events.ts"),A=y("./src/utils/logger.ts"),_=250,g=2,s=.1,r=.05,u=function(){function a(c,h,t,e){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=c,this.media=h,this.fragmentTracker=t,this.hls=e}var d=a.prototype;return d.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},d.poll=function(h,t){var e=this.config,n=this.media,i=this.stalled;if(n!==null){var f=n.currentTime,l=n.seeking,o=this.seeking&&!l,v=!this.seeking&&l;if(this.seeking=l,f!==h){if(this.moved=!0,i!==null){if(this.stallReported){var D=self.performance.now()-i;A.logger.warn("playback not stuck anymore @"+f+", after "+Math.round(D)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((v||o)&&(this.stalled=null),!(n.paused&&!l||n.ended||n.playbackRate===0||!T.BufferHelper.getBuffered(n).length)){var S=T.BufferHelper.bufferInfo(n,f,0),E=S.len>0,L=S.nextStart||0;if(!(!E&&!L)){if(l){var x=S.len>g,b=!L||t&&t.start<=f||L-f>g&&!this.fragmentTracker.getPartialFragment(f);if(x||b)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var O,R=Math.max(L,S.start||0)-f,I=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,P=I==null||(O=I.details)===null||O===void 0?void 0:O.live,F=P?I.details.targetduration*2:g;if(R>0&&R<=F){this._trySkipBufferHole(null);return}}var w=self.performance.now();if(i===null){this.stalled=w;return}var k=w-i;if(!(!l&&k>=_&&(this._reportStall(S),!this.media))){var B=T.BufferHelper.bufferInfo(n,f,e.maxBufferHole);this._tryFixBufferStall(B,k)}}}}},d._tryFixBufferStall=function(h,t){var e=this.config,n=this.fragmentTracker,i=this.media;if(i!==null){var f=i.currentTime,l=n.getPartialFragment(f);if(l){var o=this._trySkipBufferHole(l);if(o||!this.media)return}h.len>e.maxBufferHole&&t>e.highBufferWatchdogPeriod*1e3&&(A.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},d._reportStall=function(h){var t=this.hls,e=this.media,n=this.stallReported;!n&&e&&(this.stallReported=!0,A.logger.warn("Playback stalling at @"+e.currentTime+" due to low buffer ("+JSON.stringify(h)+")"),t.trigger(m.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:h.len}))},d._trySkipBufferHole=function(h){var t=this.config,e=this.hls,n=this.media;if(n===null)return 0;for(var i=n.currentTime,f=0,l=T.BufferHelper.getBuffered(n),o=0;o<l.length;o++){var v=l.start(o);if(i+t.maxBufferHole>=f&&i<v){var D=Math.max(v+r,n.currentTime+s);return A.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+D),this.moved=!0,this.stalled=null,n.currentTime=D,h&&e.trigger(m.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+D,frag:h}),D}f=l.end(o)}return 0},d._tryNudgeBuffer=function(){var h=this.config,t=this.hls,e=this.media,n=this.nudgeRetry;if(e!==null){var i=e.currentTime;if(this.nudgeRetry++,n<h.nudgeMaxRetry){var f=i+(n+1)*h.nudgeOffset;A.logger.warn("Nudging 'currentTime' from "+i+" to "+f),e.currentTime=f,t.trigger(m.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else A.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+h.nudgeMaxRetry+" nudges"),t.trigger(m.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},a}()},"./src/controller/id3-track-controller.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/events.ts"),m=y("./src/utils/texttrack-utils.ts"),A=y("./src/demux/id3.ts"),_=y("./src/loader/date-range.ts"),g=y("./src/types/demuxer.ts"),s=.25;function r(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function u(c,h){return c.getTime()/1e3-h}function a(c){return Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var d=function(){function c(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}var h=c.prototype;return h.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},h._registerListeners=function(){var e=this.hls;e.on(p.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(p.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(p.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h._unregisterListeners=function(){var e=this.hls;e.off(p.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(p.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(p.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h.onMediaAttached=function(e,n){this.media=n.media},h.onMediaDetaching=function(){!this.id3Track||(Object(m.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},h.onManifestLoading=function(){this.dateRangeCuesAppended={}},h.createTrack=function(e){var n=this.getID3Track(e.textTracks);return n.mode="hidden",n},h.getID3Track=function(e){if(!!this.media){for(var n=0;n<e.length;n++){var i=e[n];if(i.kind==="metadata"&&i.label==="id3")return Object(m.sendAddTrackEvent)(i,this.media),i}return this.media.addTextTrack("metadata","id3")}},h.onFragParsingMetadata=function(e,n){if(!!this.media){var i=this.hls.config,f=i.enableEmsgMetadataCues,l=i.enableID3MetadataCues;if(!(!f&&!l)){var o=n.frag,v=n.samples,D=n.details;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var S=D.edge||o.end,E=r(),L=!1,x={},b=0;b<v.length;b++){var O=v[b].type;if(!(O===g.MetadataSchema.emsg&&!f||!l)){var R=A.getID3Frames(v[b].data);if(R){var I=v[b].pts,P=S,F=P-I;F<=0&&(P=I+s);for(var w=0;w<R.length;w++){var k=R[w];if(!A.isTimeStampFrame(k)){var B=new E(I,P,"");B.value=k,O&&(B.type=O),this.id3Track.addCue(B),x[k.key]=null,L=!0}}}}}L&&this.updateId3CueEnds(x)}}},h.updateId3CueEnds=function(e){var n,i=(n=this.id3Track)===null||n===void 0?void 0:n.cues;if(i)for(var f=i.length;f--;){var l,o=i[f],v=(l=o.value)===null||l===void 0?void 0:l.key;if(v&&v in e){var D=e[v];D&&o.endTime!==D&&(o.endTime=D),e[v]=o.startTime}}},h.onBufferFlushing=function(e,n){var i=n.startOffset,f=n.endOffset,l=n.type,o=this.id3Track,v=this.hls;if(!!v){var D=v.config,S=D.enableEmsgMetadataCues,E=D.enableID3MetadataCues;if(o&&(S||E)){var L;l==="audio"?L=function(b){return b.type===g.MetadataSchema.audioId3&&E}:l==="video"?L=function(b){return b.type===g.MetadataSchema.emsg&&S}:L=function(b){return b.type===g.MetadataSchema.audioId3&&E||b.type===g.MetadataSchema.emsg&&S},Object(m.removeCuesInRange)(o,i,f,L)}}},h.onLevelUpdated=function(e,n){var i=this,f=n.details;if(!(!this.media||!f.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var l=this.dateRangeCuesAppended,o=this.id3Track,v=f.dateRanges,D=Object.keys(v);if(o)for(var S=Object.keys(l).filter(function(F){return!D.includes(F)}),E=function(w){var k=S[w];Object.keys(l[k].cues).forEach(function(B){o.removeCue(l[k].cues[B])}),delete l[k]},L=S.length;L--;)E(L);var x=f.fragments[f.fragments.length-1];if(!(D.length===0||!Object(T.isFiniteNumber)(x==null?void 0:x.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var b=x.programDateTime/1e3-x.start,O=f.edge||x.end,R=r(),I=function(w){var k=D[w],B=v[k],U=l[k],j=(U==null?void 0:U.cues)||{},N=(U==null?void 0:U.durationKnown)||!1,K=u(B.startDate,b),H=O,$=B.endDate;if($)H=u($,b),N=!0;else if(B.endOnNext&&!N){var G=D.reduce(function(ie,ae){var se=v[ae];return se.class===B.class&&se.id!==ae&&se.startDate>B.startDate&&ie.push(se),ie},[]).sort(function(ie,ae){return ie.startDate.getTime()-ae.startDate.getTime()})[0];G&&(H=u(G.startDate,b),N=!0)}for(var ee=Object.keys(B.attr),X=0;X<ee.length;X++){var V=ee[X];if(!(V===_.DateRangeAttribute.ID||V===_.DateRangeAttribute.CLASS||V===_.DateRangeAttribute.START_DATE||V===_.DateRangeAttribute.DURATION||V===_.DateRangeAttribute.END_DATE||V===_.DateRangeAttribute.END_ON_NEXT)){var J=j[V];if(J)N&&!U.durationKnown&&(J.endTime=H);else{var Q=B.attr[V];J=new R(K,H,""),(V===_.DateRangeAttribute.SCTE35_OUT||V===_.DateRangeAttribute.SCTE35_IN)&&(Q=a(Q)),J.value={key:V,data:Q},J.type=g.MetadataSchema.dateRange,i.id3Track.addCue(J),j[V]=J}}}l[k]={cues:j,dateRange:B,durationKnown:N}},P=0;P<D.length;P++)I(P)}}},c}();C.default=d},"./src/controller/latency-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return g});var T=y("./src/errors.ts"),p=y("./src/events.ts"),m=y("./src/utils/logger.ts");function A(s,r){for(var u=0;u<r.length;u++){var a=r[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,a.key,a)}}function _(s,r,u){return r&&A(s.prototype,r),u&&A(s,u),Object.defineProperty(s,"prototype",{writable:!1}),s}var g=function(){function s(u){var a=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return a.timeupdate()},this.hls=u,this.config=u.config,this.registerListeners()}var r=s.prototype;return r.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},r.registerListeners=function(){this.hls.on(p.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(p.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(p.Events.ERROR,this.onError,this)},r.unregisterListeners=function(){this.hls.off(p.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(p.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(p.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(p.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(p.Events.ERROR,this.onError)},r.onMediaAttached=function(a,d){this.media=d.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},r.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},r.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},r.onLevelUpdated=function(a,d){var c=d.details;this.levelDetails=c,c.advanced&&this.timeupdate(),!c.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},r.onError=function(a,d){d.details===T.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,m.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},r.timeupdate=function(){var a=this.media,d=this.levelDetails;if(!(!a||!d)){this.currentTime=a.currentTime;var c=this.computeLatency();if(c!==null){this._latency=c;var h=this.config,t=h.lowLatencyMode,e=h.maxLiveSyncPlaybackRate;if(!(!t||e===1)){var n=this.targetLatency;if(n!==null){var i=c-n,f=Math.min(this.maxLatency,n+d.targetduration),l=i<f;if(d.live&&l&&i>.05&&this.forwardBufferLength>1){var o=Math.min(2,Math.max(1,e)),v=Math.round(2/(1+Math.exp(-.75*i-this.edgeStalled))*20)/20;a.playbackRate=Math.min(o,Math.max(1,v))}else a.playbackRate!==1&&a.playbackRate!==0&&(a.playbackRate=1)}}}}},r.estimateLiveEdge=function(){var a=this.levelDetails;return a===null?null:a.edge+a.age},r.computeLatency=function(){var a=this.estimateLiveEdge();return a===null?null:a-this.currentTime},_(s,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var a=this.config,d=this.levelDetails;return a.liveMaxLatencyDuration!==void 0?a.liveMaxLatencyDuration:d?a.liveMaxLatencyDurationCount*d.targetduration:0}},{key:"targetLatency",get:function(){var a=this.levelDetails;if(a===null)return null;var d=a.holdBack,c=a.partHoldBack,h=a.targetduration,t=this.config,e=t.liveSyncDuration,n=t.liveSyncDurationCount,i=t.lowLatencyMode,f=this.hls.userConfig,l=i&&c||d;(f.liveSyncDuration||f.liveSyncDurationCount||l===0)&&(l=e!==void 0?e:n*h);var o=h,v=1;return l+Math.min(this.stallCount*v,o)}},{key:"liveSyncPosition",get:function(){var a=this.estimateLiveEdge(),d=this.targetLatency,c=this.levelDetails;if(a===null||d===null||c===null)return null;var h=c.edge,t=a-d-this.edgeStalled,e=h-c.totalduration,n=h-(this.config.lowLatencyMode&&c.partTarget||c.targetduration);return Math.min(Math.max(e,t),n)}},{key:"drift",get:function(){var a=this.levelDetails;return a===null?1:a.drift}},{key:"edgeStalled",get:function(){var a=this.levelDetails;if(a===null)return 0;var d=(this.config.lowLatencyMode&&a.partTarget||a.targetduration)*3;return Math.max(a.age-d,0)}},{key:"forwardBufferLength",get:function(){var a=this.media,d=this.levelDetails;if(!a||!d)return 0;var c=a.buffered.length;return(c?a.buffered.end(c-1):d.edge)-this.currentTime}}]),s}()},"./src/controller/level-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return t});var T=y("./src/types/level.ts"),p=y("./src/events.ts"),m=y("./src/errors.ts"),A=y("./src/utils/codecs.ts"),_=y("./src/controller/level-helper.ts"),g=y("./src/controller/base-playlist-controller.ts"),s=y("./src/types/loader.ts");function r(){return r=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var f in i)Object.prototype.hasOwnProperty.call(i,f)&&(e[f]=i[f])}return e},r.apply(this,arguments)}function u(e,n){for(var i=0;i<n.length;i++){var f=n[i];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(e,f.key,f)}}function a(e,n,i){return n&&u(e.prototype,n),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,c(e,n)}function c(e,n){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,l){return f.__proto__=l,f},c(e,n)}var h=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t=function(e){d(n,e);function n(f){var l;return l=e.call(this,f,"[level-controller]")||this,l._levels=[],l._firstLevel=-1,l._startLevel=void 0,l.currentLevelIndex=-1,l.manualLevelIndex=-1,l.onParsedComplete=void 0,l._registerListeners(),l}var i=n.prototype;return i._registerListeners=function(){var l=this.hls;l.on(p.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.on(p.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(p.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.on(p.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(p.Events.ERROR,this.onError,this)},i._unregisterListeners=function(){var l=this.hls;l.off(p.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.off(p.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(p.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.off(p.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(p.Events.ERROR,this.onError,this)},i.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,e.prototype.destroy.call(this)},i.startLoad=function(){var l=this._levels;l.forEach(function(o){o.loadError=0}),e.prototype.startLoad.call(this)},i.onManifestLoaded=function(l,o){var v=[],D=[],S=[],E,L={},x,b=!1,O=!1,R=!1;if(o.levels.forEach(function(w){var k=w.attrs;b=b||!!(w.width&&w.height),O=O||!!w.videoCodec,R=R||!!w.audioCodec,h&&w.audioCodec&&w.audioCodec.indexOf("mp4a.40.34")!==-1&&(w.audioCodec=void 0);var B=w.bitrate+"-"+w.attrs.RESOLUTION+"-"+w.attrs.CODECS;x=L[B],x?x.url.push(w.url):(x=new T.Level(w),L[B]=x,v.push(x)),k&&(k.AUDIO&&Object(_.addGroupId)(x,"audio",k.AUDIO),k.SUBTITLES&&Object(_.addGroupId)(x,"text",k.SUBTITLES))}),(b||O)&&R&&(v=v.filter(function(w){var k=w.videoCodec,B=w.width,U=w.height;return!!k||!!(B&&U)})),v=v.filter(function(w){var k=w.audioCodec,B=w.videoCodec;return(!k||Object(A.isCodecSupportedInMp4)(k,"audio"))&&(!B||Object(A.isCodecSupportedInMp4)(B,"video"))}),o.audioTracks&&(D=o.audioTracks.filter(function(w){return!w.audioCodec||Object(A.isCodecSupportedInMp4)(w.audioCodec,"audio")}),Object(_.assignTrackIdsByGroup)(D)),o.subtitles&&(S=o.subtitles,Object(_.assignTrackIdsByGroup)(S)),v.length>0){E=v[0].bitrate,v.sort(function(w,k){return w.bitrate-k.bitrate}),this._levels=v;for(var I=0;I<v.length;I++)if(v[I].bitrate===E){this._firstLevel=I,this.log("manifest loaded, "+v.length+" level(s) found, first bitrate: "+E);break}var P=R&&!O,F={levels:v,audioTracks:D,subtitleTracks:S,firstLevel:this._firstLevel,stats:o.stats,audio:R,video:O,altAudio:!P&&D.some(function(w){return!!w.url})};this.hls.trigger(p.Events.MANIFEST_PARSED,F),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(p.Events.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:o.url,reason:"no level with compatible codecs found in manifest"})},i.onError=function(l,o){if(e.prototype.onError.call(this,l,o),!o.fatal){var v=o.context,D=this._levels[this.currentLevelIndex];if(v&&(v.type===s.PlaylistContextType.AUDIO_TRACK&&D.audioGroupIds&&v.groupId===D.audioGroupIds[D.urlId]||v.type===s.PlaylistContextType.SUBTITLE_TRACK&&D.textGroupIds&&v.groupId===D.textGroupIds[D.urlId])){this.redundantFailover(this.currentLevelIndex);return}var S=!1,E=!0,L;switch(o.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(o.frag){var x=this._levels[o.frag.level];x?(x.fragmentError++,x.fragmentError>this.hls.config.fragLoadingMaxRetry&&(L=o.frag.level)):L=o.frag.level}break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:v&&(v.deliveryDirectives&&(E=!1),L=v.level),S=!0;break;case m.ErrorDetails.REMUX_ALLOC_ERROR:L=o.level,S=!0;break}L!==void 0&&this.recoverLevel(o,L,S,E)}},i.recoverLevel=function(l,o,v,D){var S=l.details,E=this._levels[o];if(E.loadError++,v){var L=this.retryLoadingOrFail(l);if(L)l.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(D){var x=E.url.length;if(x>1&&E.loadError<x)l.levelRetry=!0,this.redundantFailover(o);else if(this.manualLevelIndex===-1){var b=o===0?this._levels.length-1:o-1;this.currentLevelIndex!==b&&this._levels[b].loadError===0&&(this.warn(S+": switch to "+b),l.levelRetry=!0,this.hls.nextAutoLevel=b)}}},i.redundantFailover=function(l){var o=this._levels[l],v=o.url.length;if(v>1){var D=(o.urlId+1)%v;this.warn("Switching to redundant URL-id "+D),this._levels.forEach(function(S){S.urlId=D}),this.level=l}},i.onFragLoaded=function(l,o){var v=o.frag;if(v!==void 0&&v.type===s.PlaylistLevelType.MAIN){var D=this._levels[v.level];D!==void 0&&(D.fragmentError=0,D.loadError=0)}},i.onLevelLoaded=function(l,o){var v,D=o.level,S=o.details,E=this._levels[D];if(!E){var L;this.warn("Invalid level index "+D),(L=o.deliveryDirectives)!==null&&L!==void 0&&L.skip&&(S.deltaUpdateFailed=!0);return}D===this.currentLevelIndex?(E.fragmentError===0&&(E.loadError=0,this.retryCount=0),this.playlistLoaded(D,o,E.details)):(v=o.deliveryDirectives)!==null&&v!==void 0&&v.skip&&(S.deltaUpdateFailed=!0)},i.onAudioTrackSwitched=function(l,o){var v=this.hls.levels[this.currentLevelIndex];if(!!v&&v.audioGroupIds){for(var D=-1,S=this.hls.audioTracks[o.id].groupId,E=0;E<v.audioGroupIds.length;E++)if(v.audioGroupIds[E]===S){D=E;break}D!==v.urlId&&(v.urlId=D,this.startLoad())}},i.loadPlaylist=function(l){var o=this.currentLevelIndex,v=this._levels[o];if(this.canLoad&&v&&v.url.length>0){var D=v.urlId,S=v.url[D];if(l)try{S=l.addDirectives(S)}catch(E){this.warn("Could not construct new URL with HLS Delivery Directives: "+E)}this.log("Attempt loading level index "+o+(l?" at sn "+l.msn+" part "+l.part:"")+" with URL-id "+D+" "+S),this.clearTimer(),this.hls.trigger(p.Events.LEVEL_LOADING,{url:S,level:o,id:D,deliveryDirectives:l||null})}},i.removeLevel=function(l,o){var v=function(E,L){return L!==o},D=this._levels.filter(function(S,E){return E!==l?!0:S.url.length>1&&o!==void 0?(S.url=S.url.filter(v),S.audioGroupIds&&(S.audioGroupIds=S.audioGroupIds.filter(v)),S.textGroupIds&&(S.textGroupIds=S.textGroupIds.filter(v)),S.urlId=0,!0):!1}).map(function(S,E){var L=S.details;return L!=null&&L.fragments&&L.fragments.forEach(function(x){x.level=E}),S});this._levels=D,this.hls.trigger(p.Events.LEVELS_UPDATED,{levels:D})},a(n,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(l){var o,v=this._levels;if(v.length!==0&&!(this.currentLevelIndex===l&&(o=v[l])!==null&&o!==void 0&&o.details)){if(l<0||l>=v.length){var D=l<0;if(this.hls.trigger(p.Events.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.LEVEL_SWITCH_ERROR,level:l,fatal:D,reason:"invalid level idx"}),D)return;l=Math.min(l,v.length-1)}this.clearTimer();var S=this.currentLevelIndex,E=v[S],L=v[l];this.log("switching to level "+l+" from "+S),this.currentLevelIndex=l;var x=r({},L,{level:l,maxBitrate:L.maxBitrate,uri:L.uri,urlId:L.urlId});delete x._urlId,this.hls.trigger(p.Events.LEVEL_SWITCHING,x);var b=L.details;if(!b||b.live){var O=this.switchParams(L.uri,E==null?void 0:E.details);this.loadPlaylist(O)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(l){this.manualLevelIndex=l,this._startLevel===void 0&&(this._startLevel=l),l!==-1&&(this.level=l)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(l){this._firstLevel=l}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var l=this.hls.config.startLevel;return l!==void 0?l:this._firstLevel}else return this._startLevel},set:function(l){this._startLevel=l}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(l){this.level=l,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=l)}}]),n}(g.default)},"./src/controller/level-helper.ts":function(M,C,y){y.r(C),y.d(C,"addGroupId",function(){return _}),y.d(C,"assignTrackIdsByGroup",function(){return g}),y.d(C,"updatePTS",function(){return s}),y.d(C,"updateFragPTSDTS",function(){return u}),y.d(C,"mergeDetails",function(){return a}),y.d(C,"mapPartIntersection",function(){return c}),y.d(C,"mapFragmentIntersection",function(){return h}),y.d(C,"adjustSliding",function(){return t}),y.d(C,"addSliding",function(){return e}),y.d(C,"computeReloadInterval",function(){return n}),y.d(C,"getFragmentWithSN",function(){return i}),y.d(C,"getPartWith",function(){return f});var T=y("./src/polyfills/number.ts"),p=y("./src/utils/logger.ts"),m=y("./src/loader/date-range.ts");function A(){return A=Object.assign?Object.assign.bind():function(l){for(var o=1;o<arguments.length;o++){var v=arguments[o];for(var D in v)Object.prototype.hasOwnProperty.call(v,D)&&(l[D]=v[D])}return l},A.apply(this,arguments)}function _(l,o,v){switch(o){case"audio":l.audioGroupIds||(l.audioGroupIds=[]),l.audioGroupIds.push(v);break;case"text":l.textGroupIds||(l.textGroupIds=[]),l.textGroupIds.push(v);break}}function g(l){var o={};l.forEach(function(v){var D=v.groupId||"";v.id=o[D]=o[D]||0,o[D]++})}function s(l,o,v){var D=l[o],S=l[v];r(D,S)}function r(l,o){var v=o.startPTS;if(Object(T.isFiniteNumber)(v)){var D=0,S;o.sn>l.sn?(D=v-l.start,S=l):(D=l.start-v,S=o),S.duration!==D&&(S.duration=D)}else if(o.sn>l.sn){var E=l.cc===o.cc;E&&l.minEndPTS?o.start=l.start+(l.minEndPTS-l.start):o.start=l.start+l.duration}else o.start=Math.max(l.start-o.duration,0)}function u(l,o,v,D,S,E){var L=D-v;L<=0&&(p.logger.warn("Fragment should have a positive duration",o),D=v+o.duration,E=S+o.duration);var x=v,b=D,O=o.startPTS,R=o.endPTS;if(Object(T.isFiniteNumber)(O)){var I=Math.abs(O-v);Object(T.isFiniteNumber)(o.deltaPTS)?o.deltaPTS=Math.max(I,o.deltaPTS):o.deltaPTS=I,x=Math.max(v,O),v=Math.min(v,O),S=Math.min(S,o.startDTS),b=Math.min(D,R),D=Math.max(D,R),E=Math.max(E,o.endDTS)}o.duration=D-v;var P=v-o.start;o.appendedPTS=D,o.start=o.startPTS=v,o.maxStartPTS=x,o.startDTS=S,o.endPTS=D,o.minEndPTS=b,o.endDTS=E;var F=o.sn;if(!l||F<l.startSN||F>l.endSN)return 0;var w,k=F-l.startSN,B=l.fragments;for(B[k]=o,w=k;w>0;w--)r(B[w],B[w-1]);for(w=k;w<B.length-1;w++)r(B[w],B[w+1]);return l.fragmentHint&&r(B[B.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,P}function a(l,o){for(var v=null,D=l.fragments,S=D.length-1;S>=0;S--){var E=D[S].initSegment;if(E){v=E;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;var L=0,x;if(h(l,o,function(w,k){w.relurl&&(L=w.cc-k.cc),Object(T.isFiniteNumber)(w.startPTS)&&Object(T.isFiniteNumber)(w.endPTS)&&(k.start=k.startPTS=w.startPTS,k.startDTS=w.startDTS,k.appendedPTS=w.appendedPTS,k.maxStartPTS=w.maxStartPTS,k.endPTS=w.endPTS,k.endDTS=w.endDTS,k.minEndPTS=w.minEndPTS,k.duration=w.endPTS-w.startPTS,k.duration&&(x=k),o.PTSKnown=o.alignedSliding=!0),k.elementaryStreams=w.elementaryStreams,k.loader=w.loader,k.stats=w.stats,k.urlId=w.urlId,w.initSegment&&(k.initSegment=w.initSegment,v=w.initSegment)}),v){var b=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments;b.forEach(function(w){var k;(!w.initSegment||w.initSegment.relurl===((k=v)===null||k===void 0?void 0:k.relurl))&&(w.initSegment=v)})}if(o.skippedSegments)if(o.deltaUpdateFailed=o.fragments.some(function(w){return!w}),o.deltaUpdateFailed){p.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var O=o.skippedSegments;O--;)o.fragments.shift();o.startSN=o.fragments[0].sn,o.startCC=o.fragments[0].cc}else o.canSkipDateRanges&&(o.dateRanges=d(l.dateRanges,o.dateRanges,o.recentlyRemovedDateranges));var R=o.fragments;if(L){p.logger.warn("discontinuity sliding from playlist, take drift into account");for(var I=0;I<R.length;I++)R[I].cc+=L}o.skippedSegments&&(o.startCC=o.fragments[0].cc),c(l.partList,o.partList,function(w,k){k.elementaryStreams=w.elementaryStreams,k.stats=w.stats}),x?u(o,x,x.startPTS,x.endPTS,x.startDTS,x.endDTS):t(l,o),R.length&&(o.totalduration=o.edge-R[0].start),o.driftStartTime=l.driftStartTime,o.driftStart=l.driftStart;var P=o.advancedDateTime;if(o.advanced&&P){var F=o.edge;o.driftStart||(o.driftStartTime=P,o.driftStart=F),o.driftEndTime=P,o.driftEnd=F}else o.driftEndTime=l.driftEndTime,o.driftEnd=l.driftEnd,o.advancedDateTime=l.advancedDateTime}function d(l,o,v){var D=A({},l);return v&&v.forEach(function(S){delete D[S]}),Object.keys(o).forEach(function(S){var E=new m.DateRange(o[S].attr,D[S]);E.isValid?D[S]=E:p.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(o[S].attr)+'"')}),D}function c(l,o,v){if(l&&o)for(var D=0,S=0,E=l.length;S<=E;S++){var L=l[S],x=o[S+D];L&&x&&L.index===x.index&&L.fragment.sn===x.fragment.sn?v(L,x):D--}}function h(l,o,v){for(var D=o.skippedSegments,S=Math.max(l.startSN,o.startSN)-o.startSN,E=(l.fragmentHint?1:0)+(D?o.endSN:Math.min(l.endSN,o.endSN))-o.startSN,L=o.startSN-l.startSN,x=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments,b=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,O=S;O<=E;O++){var R=b[L+O],I=x[O];D&&!I&&O<D&&(I=o.fragments[O]=R),R&&I&&v(R,I)}}function t(l,o){var v=o.startSN+o.skippedSegments-l.startSN,D=l.fragments;v<0||v>=D.length||e(o,D[v].start)}function e(l,o){if(o){for(var v=l.fragments,D=l.skippedSegments;D<v.length;D++)v[D].start+=o;l.fragmentHint&&(l.fragmentHint.start+=o)}}function n(l,o){var v=1e3*l.levelTargetDuration,D=v/2,S=l.age,E=S>0&&S<v*3,L=o.loading.end-o.loading.start,x,b=l.availabilityDelay;if(l.updated===!1)if(E){var O=333*l.misses;x=Math.max(Math.min(D,L*2),O),l.availabilityDelay=(l.availabilityDelay||0)+x}else x=D;else E?(b=Math.min(b||v/2,S),l.availabilityDelay=b,x=b+v-S):x=v-L;return Math.round(x)}function i(l,o,v){if(!l||!l.details)return null;var D=l.details,S=D.fragments[o-D.startSN];return S||(S=D.fragmentHint,S&&S.sn===o)?S:o<D.startSN&&v&&v.sn===o?v:null}function f(l,o,v){if(!l||!l.details)return null;var D=l.details.partList;if(D)for(var S=D.length;S--;){var E=D[S];if(E.index===v&&E.fragment.sn===o)return E}return null}},"./src/controller/stream-controller.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return f});var T=y("./src/polyfills/number.ts"),p=y("./src/controller/base-stream-controller.ts"),m=y("./src/is-supported.ts"),A=y("./src/events.ts"),_=y("./src/utils/buffer-helper.ts"),g=y("./src/controller/fragment-tracker.ts"),s=y("./src/types/loader.ts"),r=y("./src/loader/fragment.ts"),u=y("./src/demux/transmuxer-interface.ts"),a=y("./src/types/transmuxer.ts"),d=y("./src/controller/gap-controller.ts"),c=y("./src/errors.ts");function h(l,o){for(var v=0;v<o.length;v++){var D=o[v];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(l,D.key,D)}}function t(l,o,v){return o&&h(l.prototype,o),v&&h(l,v),Object.defineProperty(l,"prototype",{writable:!1}),l}function e(l,o){l.prototype=Object.create(o.prototype),l.prototype.constructor=l,n(l,o)}function n(l,o){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,S){return D.__proto__=S,D},n(l,o)}var i=100,f=function(l){e(o,l);function o(D,S){var E;return E=l.call(this,D,S,"[stream-controller]")||this,E.audioCodecSwap=!1,E.gapController=null,E.level=-1,E._forceStartLoad=!1,E.altAudio=!1,E.audioOnly=!1,E.fragPlaying=null,E.onvplaying=null,E.onvseeked=null,E.fragLastKbps=0,E.couldBacktrack=!1,E.backtrackFragment=null,E.audioCodecSwitch=!1,E.videoBuffer=null,E._registerListeners(),E}var v=o.prototype;return v._registerListeners=function(){var S=this.hls;S.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),S.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),S.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),S.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),S.on(A.Events.LEVEL_LOADING,this.onLevelLoading,this),S.on(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.on(A.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),S.on(A.Events.ERROR,this.onError,this),S.on(A.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),S.on(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.on(A.Events.BUFFER_CREATED,this.onBufferCreated,this),S.on(A.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),S.on(A.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),S.on(A.Events.FRAG_BUFFERED,this.onFragBuffered,this)},v._unregisterListeners=function(){var S=this.hls;S.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),S.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),S.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),S.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),S.off(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),S.off(A.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),S.off(A.Events.ERROR,this.onError,this),S.off(A.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),S.off(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),S.off(A.Events.BUFFER_CREATED,this.onBufferCreated,this),S.off(A.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),S.off(A.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),S.off(A.Events.FRAG_BUFFERED,this.onFragBuffered,this)},v.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},v.startLoad=function(S){if(this.levels){var E=this.lastCurrentTime,L=this.hls;if(this.stopLoad(),this.setInterval(i),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var x=L.startLevel;x===-1&&(L.config.testBandwidth?(x=0,this.bitrateTest=!0):x=L.nextAutoLevel),this.level=L.nextLoadLevel=x,this.loadedmetadata=!1}E>0&&S===-1&&(this.log("Override startPosition with lastCurrentTime @"+E.toFixed(3)),S=E),this.state=p.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=S,this.tick()}else this._forceStartLoad=!0,this.state=p.State.STOPPED},v.stopLoad=function(){this._forceStartLoad=!1,l.prototype.stopLoad.call(this)},v.doTick=function(){switch(this.state){case p.State.IDLE:this.doTickIdle();break;case p.State.WAITING_LEVEL:{var S,E=this.levels,L=this.level,x=E==null||(S=E[L])===null||S===void 0?void 0:S.details;if(x&&(!x.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(x))break;this.state=p.State.IDLE;break}break}case p.State.FRAG_LOADING_WAITING_RETRY:{var b,O=self.performance.now(),R=this.retryDate;(!R||O>=R||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=p.State.IDLE)}break}this.onTickEnd()},v.onTickEnd=function(){l.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},v.doTickIdle=function(){var S,E,L=this.hls,x=this.levelLastLoaded,b=this.levels,O=this.media,R=L.config,I=L.nextLoadLevel;if(!(x===null||!O&&(this.startFragRequested||!R.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!b||!b[I])){var P=b[I];this.level=L.nextLoadLevel=I;var F=P.details;if(!F||this.state===p.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==I){this.state=p.State.WAITING_LEVEL;return}var w=this.getMainFwdBufferInfo();if(w!==null){var k=w.len,B=this.getMaxBufferLength(P.maxBitrate);if(!(k>=B)){if(this._streamEnded(w,F)){var U={};this.altAudio&&(U.type="video"),this.hls.trigger(A.Events.BUFFER_EOS,U),this.state=p.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>w.end&&(this.backtrackFragment=null);var j=this.backtrackFragment?this.backtrackFragment.start:w.end,N=this.getNextFragment(j,F);if(this.couldBacktrack&&!this.fragPrevious&&N&&N.sn!=="initSegment"&&this.fragmentTracker.getState(N)!==g.FragmentState.OK){var K,H=((K=this.backtrackFragment)!=null?K:N).sn,$=H-F.startSN,G=F.fragments[$-1];G&&N.cc===G.cc&&(N=G,this.fragmentTracker.removeFragment(G))}else this.backtrackFragment&&w.len&&(this.backtrackFragment=null);if(N&&this.fragmentTracker.getState(N)===g.FragmentState.OK&&this.nextLoadPosition>j){var ee=this.audioOnly&&!this.altAudio?r.ElementaryStreamTypes.AUDIO:r.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(O,ee,s.PlaylistLevelType.MAIN),N=this.getNextFragment(this.nextLoadPosition,F)}!N||(N.initSegment&&!N.initSegment.data&&!this.bitrateTest&&(N=N.initSegment),((S=N.decryptdata)===null||S===void 0?void 0:S.keyFormat)==="identity"&&!((E=N.decryptdata)!==null&&E!==void 0&&E.key)?this.loadKey(N,F):this.loadFragment(N,F,j))}}}},v.loadFragment=function(S,E,L){var x,b=this.fragmentTracker.getState(S);this.fragCurrent=S,b===g.FragmentState.NOT_LOADED||b===g.FragmentState.PARTIAL?S.sn==="initSegment"?this._loadInitSegment(S):this.bitrateTest?(S.bitrateTest=!0,this.log("Fragment "+S.sn+" of level "+S.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(S)):(this.startFragRequested=!0,l.prototype.loadFragment.call(this,S,E,L)):b===g.FragmentState.APPENDING?this.reduceMaxBufferLength(S.duration)&&this.fragmentTracker.removeFragment(S):((x=this.media)===null||x===void 0?void 0:x.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},v.getAppendedFrag=function(S){var E=this.fragmentTracker.getAppendedFrag(S,s.PlaylistLevelType.MAIN);return E&&"fragment"in E?E.fragment:E},v.getBufferedFrag=function(S){return this.fragmentTracker.getBufferedFrag(S,s.PlaylistLevelType.MAIN)},v.followingBufferedFrag=function(S){return S?this.getBufferedFrag(S.end+.5):null},v.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},v.nextLevelSwitch=function(){var S=this.levels,E=this.media;if(E!=null&&E.readyState){var L,x=this.getAppendedFrag(E.currentTime);if(x&&x.start>1&&this.flushMainBuffer(0,x.start-1),!E.paused&&S){var b=this.hls.nextLoadLevel,O=S[b],R=this.fragLastKbps;R&&this.fragCurrent?L=this.fragCurrent.duration*O.maxBitrate/(1e3*R)+1:L=0}else L=0;var I=this.getBufferedFrag(E.currentTime+L);if(I){var P=this.followingBufferedFrag(I);if(P){this.abortCurrentFrag();var F=P.maxStartPTS?P.maxStartPTS:P.start,w=P.duration,k=Math.max(I.end,F+Math.min(Math.max(w-this.config.maxFragLookUpTolerance,w*.5),w*.75));this.flushMainBuffer(k,Number.POSITIVE_INFINITY)}}}},v.abortCurrentFrag=function(){var S=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,S!=null&&S.loader&&S.loader.abort(),this.state){case p.State.KEY_LOADING:case p.State.FRAG_LOADING:case p.State.FRAG_LOADING_WAITING_RETRY:case p.State.PARSING:case p.State.PARSED:this.state=p.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},v.flushMainBuffer=function(S,E){l.prototype.flushMainBuffer.call(this,S,E,this.altAudio?"video":null)},v.onMediaAttached=function(S,E){l.prototype.onMediaAttached.call(this,S,E);var L=E.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),L.addEventListener("playing",this.onvplaying),L.addEventListener("seeked",this.onvseeked),this.gapController=new d.default(this.config,L,this.fragmentTracker,this.hls)},v.onMediaDetaching=function(){var S=this.media;S&&(S.removeEventListener("playing",this.onvplaying),S.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),l.prototype.onMediaDetaching.call(this)},v.onMediaPlaying=function(){this.tick()},v.onMediaSeeked=function(){var S=this.media,E=S?S.currentTime:null;Object(T.isFiniteNumber)(E)&&this.log("Media seeked to "+E.toFixed(3)),this.tick()},v.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},v.onManifestParsed=function(S,E){var L=!1,x=!1,b;E.levels.forEach(function(O){b=O.audioCodec,b&&(b.indexOf("mp4a.40.2")!==-1&&(L=!0),b.indexOf("mp4a.40.5")!==-1&&(x=!0))}),this.audioCodecSwitch=L&&x&&!Object(m.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=E.levels,this.startFragRequested=!1},v.onLevelLoading=function(S,E){var L=this.levels;if(!(!L||this.state!==p.State.IDLE)){var x=L[E.level];(!x.details||x.details.live&&this.levelLastLoaded!==E.level||this.waitForCdnTuneIn(x.details))&&(this.state=p.State.WAITING_LEVEL)}},v.onLevelLoaded=function(S,E){var L,x=this.levels,b=E.level,O=E.details,R=O.totalduration;if(!x){this.warn("Levels were reset while loading level "+b);return}this.log("Level "+b+" loaded ["+O.startSN+","+O.endSN+"], cc ["+O.startCC+", "+O.endCC+"] duration:"+R);var I=this.fragCurrent;I&&(this.state===p.State.FRAG_LOADING||this.state===p.State.FRAG_LOADING_WAITING_RETRY)&&I.level!==E.level&&I.loader&&(this.state=p.State.IDLE,this.backtrackFragment=null,I.loader.abort());var P=x[b],F=0;if(O.live||(L=P.details)!==null&&L!==void 0&&L.live){if(O.fragments[0]||(O.deltaUpdateFailed=!0),O.deltaUpdateFailed)return;F=this.alignPlaylists(O,P.details)}if(P.details=O,this.levelLastLoaded=b,this.hls.trigger(A.Events.LEVEL_UPDATED,{details:O,level:b}),this.state===p.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(O))return;this.state=p.State.IDLE}this.startFragRequested?O.live&&this.synchronizeToLiveEdge(O):this.setStartPosition(O,F),this.tick()},v._handleFragmentLoadProgress=function(S){var E,L=S.frag,x=S.part,b=S.payload,O=this.levels;if(!O){this.warn("Levels were reset while fragment load was in progress. Fragment "+L.sn+" of level "+L.level+" will not be buffered");return}var R=O[L.level],I=R.details;if(!I){this.warn("Dropping fragment "+L.sn+" of level "+L.level+" after level details were reset");return}var P=R.videoCodec,F=I.PTSKnown||!I.live,w=(E=L.initSegment)===null||E===void 0?void 0:E.data,k=this._getAudioCodec(R),B=this.transmuxer=this.transmuxer||new u.default(this.hls,s.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),U=x?x.index:-1,j=U!==-1,N=new a.ChunkMetadata(L.level,L.sn,L.stats.chunkCount,b.byteLength,U,j),K=this.initPTS[L.cc];B.push(b,w,k,P,L,x,I.totalduration,F,N,K)},v.onAudioTrackSwitching=function(S,E){var L=this.altAudio,x=!!E.url,b=E.id;if(!x){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var O=this.fragCurrent;O!=null&&O.loader&&(this.log("Switching to main audio track, cancel main fragment load"),O.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;L&&R.trigger(A.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(A.Events.AUDIO_TRACK_SWITCHED,{id:b})}},v.onAudioTrackSwitched=function(S,E){var L=E.id,x=!!this.hls.audioTracks[L].url;if(x){var b=this.videoBuffer;b&&this.mediaBuffer!==b&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=b)}this.altAudio=x,this.tick()},v.onBufferCreated=function(S,E){var L=E.tracks,x,b,O=!1;for(var R in L){var I=L[R];if(I.id==="main"){if(b=R,x=I,R==="video"){var P=L[R];P&&(this.videoBuffer=P.buffer)}}else O=!0}O&&x?(this.log("Alternate track found, use "+b+".buffered to schedule main fragment loading"),this.mediaBuffer=x.buffer):this.mediaBuffer=this.media},v.onFragBuffered=function(S,E){var L=E.frag,x=E.part;if(!(L&&L.type!==s.PlaylistLevelType.MAIN)){if(this.fragContextChanged(L)){this.warn("Fragment "+L.sn+(x?" p: "+x.index:"")+" of level "+L.level+" finished buffering, but was aborted. state: "+this.state),this.state===p.State.PARSED&&(this.state=p.State.IDLE);return}var b=x?x.stats:L.stats;this.fragLastKbps=Math.round(8*b.total/(b.buffering.end-b.loading.first)),L.sn!=="initSegment"&&(this.fragPrevious=L),this.fragBufferedComplete(L,x)}},v.onError=function(S,E){switch(E.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(s.PlaylistLevelType.MAIN,E);break;case c.ErrorDetails.LEVEL_LOAD_ERROR:case c.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==p.State.ERROR&&(E.fatal?(this.warn(""+E.details),this.state=p.State.ERROR):!E.levelRetry&&this.state===p.State.WAITING_LEVEL&&(this.state=p.State.IDLE));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(E.parent==="main"&&(this.state===p.State.PARSING||this.state===p.State.PARSED)){var L=!0,x=this.getFwdBufferInfo(this.media,s.PlaylistLevelType.MAIN);x&&x.len>.5&&(L=!this.reduceMaxBufferLength(x.len)),L&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},v.checkBuffer=function(){var S=this.media,E=this.gapController;if(!(!S||!E||!S.readyState)){var L=_.BufferHelper.getBuffered(S);if(!this.loadedmetadata&&L.length)this.loadedmetadata=!0,this.seekToStartPos();else{var x=this.state!==p.State.IDLE?this.fragCurrent:null;E.poll(this.lastCurrentTime,x)}this.lastCurrentTime=S.currentTime}},v.onFragLoadEmergencyAborted=function(){this.state=p.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},v.onBufferFlushed=function(S,E){var L=E.type;if(L!==r.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var x=(L===r.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(x,L,s.PlaylistLevelType.MAIN)}},v.onLevelsUpdated=function(S,E){this.levels=E.levels},v.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},v.seekToStartPos=function(){var S=this.media,E=S.currentTime,L=this.startPosition;if(L>=0&&E<L){if(S.seeking){this.log("could not seek to "+L+", already seeking at "+E);return}var x=_.BufferHelper.getBuffered(S),b=x.length?x.start(0):0,O=b-L;O>0&&(O<this.config.maxBufferHole||O<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+O+" to match buffer start"),L+=O,this.startPosition=L),this.log("seek to target start position "+L+" from current time "+E),S.currentTime=L}},v._getAudioCodec=function(S){var E=this.config.defaultAudioCodec||S.audioCodec;return this.audioCodecSwap&&E&&(this.log("Swapping audio codec"),E.indexOf("mp4a.40.5")!==-1?E="mp4a.40.2":E="mp4a.40.5"),E},v._loadBitrateTestFrag=function(S){var E=this;this._doFragLoad(S).then(function(L){var x=E.hls;if(!(!L||x.nextLoadLevel||E.fragContextChanged(S))){E.fragLoadError=0,E.state=p.State.IDLE,E.startFragRequested=!1,E.bitrateTest=!1;var b=S.stats;b.parsing.start=b.parsing.end=b.buffering.start=b.buffering.end=self.performance.now(),x.trigger(A.Events.FRAG_LOADED,L)}})},v._handleTransmuxComplete=function(S){var E,L="main",x=this.hls,b=S.remuxResult,O=S.chunkMeta,R=this.getCurrentContext(O);if(!R){this.warn("The loading context changed while buffering fragment "+O.sn+" of level "+O.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(O.level);return}var I=R.frag,P=R.part,F=R.level,w=b.video,k=b.text,B=b.id3,U=b.initSegment,j=F.details,N=this.altAudio?void 0:b.audio;if(!this.fragContextChanged(I)){if(this.state=p.State.PARSING,U){U.tracks&&(this._bufferInitSegment(F,U.tracks,I,O),x.trigger(A.Events.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:L,tracks:U.tracks}));var K=U.initPTS,H=U.timescale;Object(T.isFiniteNumber)(K)&&(this.initPTS[I.cc]=K,x.trigger(A.Events.INIT_PTS_FOUND,{frag:I,id:L,initPTS:K,timescale:H}))}if(w&&b.independent!==!1){if(j){var $=w.startPTS,G=w.endPTS,ee=w.startDTS,X=w.endDTS;if(P)P.elementaryStreams[w.type]={startPTS:$,endPTS:G,startDTS:ee,endDTS:X};else if(w.firstKeyFrame&&w.independent&&(this.couldBacktrack=!0),w.dropped&&w.independent){var V=this.getMainFwdBufferInfo(),J=(V?V.end:this.getLoadPosition())+this.config.maxBufferHole,Q=w.firstKeyFramePTS?w.firstKeyFramePTS:$;if(J<Q-this.config.maxBufferHole){this.backtrack(I);return}I.setElementaryStreamInfo(w.type,I.start,G,I.start,X,!0)}I.setElementaryStreamInfo(w.type,$,G,ee,X),this.backtrackFragment&&(this.backtrackFragment=I),this.bufferFragmentData(w,I,P,O)}}else if(b.independent===!1){this.backtrack(I);return}if(N){var ie=N.startPTS,ae=N.endPTS,se=N.startDTS,le=N.endDTS;P&&(P.elementaryStreams[r.ElementaryStreamTypes.AUDIO]={startPTS:ie,endPTS:ae,startDTS:se,endDTS:le}),I.setElementaryStreamInfo(r.ElementaryStreamTypes.AUDIO,ie,ae,se,le),this.bufferFragmentData(N,I,P,O)}if(j&&B!==null&&B!==void 0&&(E=B.samples)!==null&&E!==void 0&&E.length){var ue={id:L,frag:I,details:j,samples:B.samples};x.trigger(A.Events.FRAG_PARSING_METADATA,ue)}if(j&&k){var q={id:L,frag:I,details:j,samples:k.samples};x.trigger(A.Events.FRAG_PARSING_USERDATA,q)}}},v._bufferInitSegment=function(S,E,L,x){var b=this;if(this.state===p.State.PARSING){this.audioOnly=!!E.audio&&!E.video,this.altAudio&&!this.audioOnly&&delete E.audio;var O=E.audio,R=E.video,I=E.audiovideo;if(O){var P=S.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(P&&(P.indexOf("mp4a.40.5")!==-1?P="mp4a.40.2":P="mp4a.40.5"),O.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(P="mp4a.40.5")),F.indexOf("android")!==-1&&O.container!=="audio/mpeg"&&(P="mp4a.40.2",this.log("Android: force audio codec to "+P)),S.audioCodec&&S.audioCodec!==P&&this.log('Swapping manifest audio codec "'+S.audioCodec+'" for "'+P+'"'),O.levelCodec=P,O.id="main",this.log("Init audio buffer, container:"+O.container+", codecs[selected/level/parsed]=["+(P||"")+"/"+(S.audioCodec||"")+"/"+O.codec+"]")}R&&(R.levelCodec=S.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(S.videoCodec||"")+"/"+R.codec+"]")),I&&this.log("Init audiovideo buffer, container:"+I.container+", codecs[level/parsed]=["+(S.attrs.CODECS||"")+"/"+I.codec+"]"),this.hls.trigger(A.Events.BUFFER_CODECS,E),Object.keys(E).forEach(function(w){var k=E[w],B=k.initSegment;B!=null&&B.byteLength&&b.hls.trigger(A.Events.BUFFER_APPENDING,{type:w,data:B,frag:L,part:null,chunkMeta:x,parent:L.type})}),this.tick()}},v.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,s.PlaylistLevelType.MAIN)},v.backtrack=function(S){this.couldBacktrack=!0,this.backtrackFragment=S,this.resetTransmuxer(),this.flushBufferGap(S),this.fragmentTracker.removeFragment(S),this.fragPrevious=null,this.nextLoadPosition=S.start,this.state=p.State.IDLE},v.checkFragmentChanged=function(){var S=this.media,E=null;if(S&&S.readyState>1&&S.seeking===!1){var L=S.currentTime;if(_.BufferHelper.isBuffered(S,L)?E=this.getAppendedFrag(L):_.BufferHelper.isBuffered(S,L+.1)&&(E=this.getAppendedFrag(L+.1)),E){this.backtrackFragment=null;var x=this.fragPlaying,b=E.level;(!x||E.sn!==x.sn||x.level!==b||E.urlId!==x.urlId)&&(this.hls.trigger(A.Events.FRAG_CHANGED,{frag:E}),(!x||x.level!==b)&&this.hls.trigger(A.Events.LEVEL_SWITCHED,{level:b}),this.fragPlaying=E)}}},t(o,[{key:"nextLevel",get:function(){var S=this.nextBufferedFrag;return S?S.level:-1}},{key:"currentFrag",get:function(){var S=this.media;return S?this.fragPlaying||this.getAppendedFrag(S.currentTime):null}},{key:"currentProgramDateTime",get:function(){var S=this.media;if(S){var E=S.currentTime,L=this.currentFrag;if(L&&Object(T.isFiniteNumber)(E)&&Object(T.isFiniteNumber)(L.programDateTime)){var x=L.programDateTime+(E-L.start)*1e3;return new Date(x)}}return null}},{key:"currentLevel",get:function(){var S=this.currentFrag;return S?S.level:-1}},{key:"nextBufferedFrag",get:function(){var S=this.currentFrag;return S?this.followingBufferedFrag(S):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),o}(p.default)},"./src/controller/subtitle-stream-controller.ts":function(M,C,y){y.r(C),y.d(C,"SubtitleStreamController",function(){return e});var T=y("./src/events.ts"),p=y("./src/utils/buffer-helper.ts"),m=y("./src/controller/fragment-finders.ts"),A=y("./src/utils/discontinuities.ts"),_=y("./src/controller/level-helper.ts"),g=y("./src/controller/fragment-tracker.ts"),s=y("./src/controller/base-stream-controller.ts"),r=y("./src/types/loader.ts"),u=y("./src/types/level.ts");function a(n,i){for(var f=0;f<i.length;f++){var l=i[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}function d(n,i,f){return i&&a(n.prototype,i),f&&a(n,f),Object.defineProperty(n,"prototype",{writable:!1}),n}function c(n,i){n.prototype=Object.create(i.prototype),n.prototype.constructor=n,h(n,i)}function h(n,i){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,o){return l.__proto__=o,l},h(n,i)}var t=500,e=function(n){c(i,n);function i(l,o){var v;return v=n.call(this,l,o,"[subtitle-stream-controller]")||this,v.levels=[],v.currentTrackId=-1,v.tracksBuffered=[],v.mainDetails=null,v._registerListeners(),v}var f=i.prototype;return f.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},f._registerListeners=function(){var o=this.hls;o.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(T.Events.ERROR,this.onError,this),o.on(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(T.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.on(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.on(T.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f._unregisterListeners=function(){var o=this.hls;o.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(T.Events.ERROR,this.onError,this),o.off(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(T.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.off(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.off(T.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f.startLoad=function(){this.stopLoad(),this.state=s.State.IDLE,this.setInterval(t),this.tick()},f.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},f.onLevelLoaded=function(o,v){this.mainDetails=v.details},f.onSubtitleFragProcessed=function(o,v){var D=v.frag,S=v.success;if(this.fragPrevious=D,this.state=s.State.IDLE,!!S){var E=this.tracksBuffered[this.currentTrackId];if(!!E){for(var L,x=D.start,b=0;b<E.length;b++)if(x>=E[b].start&&x<=E[b].end){L=E[b];break}var O=D.start+D.duration;L?L.end=O:(L={start:x,end:O},E.push(L)),this.fragmentTracker.fragBuffered(D)}}},f.onBufferFlushing=function(o,v){var D=v.startOffset,S=v.endOffset;if(D===0&&S!==Number.POSITIVE_INFINITY){var E=this.currentTrackId,L=this.levels;if(!L.length||!L[E]||!L[E].details)return;var x=L[E].details,b=x.targetduration,O=S-b;if(O<=0)return;v.endOffsetSubtitles=Math.max(0,O),this.tracksBuffered.forEach(function(R){for(var I=0;I<R.length;){if(R[I].end<=O){R.shift();continue}else if(R[I].start<O)R[I].start=O;else break;I++}}),this.fragmentTracker.removeFragmentsInRange(D,O,r.PlaylistLevelType.SUBTITLE)}},f.onError=function(o,v){var D,S=v.frag;!S||S.type!==r.PlaylistLevelType.SUBTITLE||((D=this.fragCurrent)!==null&&D!==void 0&&D.loader&&this.fragCurrent.loader.abort(),this.state=s.State.IDLE)},f.onSubtitleTracksUpdated=function(o,v){var D=this,S=v.subtitleTracks;this.tracksBuffered=[],this.levels=S.map(function(E){return new u.Level(E)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(E){D.tracksBuffered[E.id]=[]}),this.mediaBuffer=null},f.onSubtitleTrackSwitch=function(o,v){if(this.currentTrackId=v.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var D=this.levels[this.currentTrackId];D!=null&&D.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,D&&this.setInterval(t)},f.onSubtitleTrackLoaded=function(o,v){var D,S=v.details,E=v.id,L=this.currentTrackId,x=this.levels;if(!!x.length){var b=x[L];if(!(E>=x.length||E!==L||!b)){if(this.mediaBuffer=this.mediaBufferTimeRanges,S.live||(D=b.details)!==null&&D!==void 0&&D.live){var O=this.mainDetails;if(S.deltaUpdateFailed||!O)return;var R=O.fragments[0];if(!b.details)S.hasProgramDateTime&&O.hasProgramDateTime?Object(A.alignMediaPlaylistByPDT)(S,O):R&&Object(_.addSliding)(S,R.start);else{var I=this.alignPlaylists(S,b.details);I===0&&R&&Object(_.addSliding)(S,R.start)}}if(b.details=S,this.levelLastLoaded=E,this.tick(),S.live&&!this.fragCurrent&&this.media&&this.state===s.State.IDLE){var P=Object(m.findFragmentByPTS)(null,S.fragments,this.media.currentTime,0);P||(this.warn("Subtitle playlist not aligned with playback"),b.details=void 0)}}}},f._handleFragmentLoadComplete=function(o){var v=o.frag,D=o.payload,S=v.decryptdata,E=this.hls;if(!this.fragContextChanged(v)&&D&&D.byteLength>0&&S&&S.key&&S.iv&&S.method==="AES-128"){var L=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(D),S.key.buffer,S.iv.buffer).then(function(x){var b=performance.now();E.trigger(T.Events.FRAG_DECRYPTED,{frag:v,payload:x,stats:{tstart:L,tdecrypt:b}})})}},f.doTick=function(){if(!this.media){this.state=s.State.IDLE;return}if(this.state===s.State.IDLE){var o=this.currentTrackId,v=this.levels;if(!v.length||!v[o]||!v[o].details)return;var D=v[o].details,S=D.targetduration,E=this.config,L=this.media,x=p.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,L.currentTime-S,E.maxBufferHole),b=x.end,O=x.len,R=this.getMaxBufferLength()+S;if(O>R)return;console.assert(D,"Subtitle track details are defined on idle subtitle stream controller tick");var I=D.fragments,P=I.length,F=D.edge,w,k=this.fragPrevious;if(b<F){var B=E.maxFragLookUpTolerance;w=Object(m.findFragmentByPTS)(k,I,Math.max(I[0].start,b),B),!w&&k&&k.start<I[0].start&&(w=I[0])}else w=I[P-1];if(w=this.mapToInitFragWhenRequired(w),!w)return;w.encrypted?this.loadKey(w,D):this.fragmentTracker.getState(w)===g.FragmentState.NOT_LOADED&&this.loadFragment(w,D,b)}},f.loadFragment=function(o,v,D){this.fragCurrent=o,o.sn==="initSegment"?this._loadInitSegment(o):n.prototype.loadFragment.call(this,o,v,D)},d(i,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),i}(s.default)},"./src/controller/subtitle-track-controller.ts":function(M,C,y){y.r(C);var T=y("./src/events.ts"),p=y("./src/utils/texttrack-utils.ts"),m=y("./src/controller/base-playlist-controller.ts"),A=y("./src/types/loader.ts");function _(d,c){for(var h=0;h<c.length;h++){var t=c[h];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(d,t.key,t)}}function g(d,c,h){return c&&_(d.prototype,c),h&&_(d,h),Object.defineProperty(d,"prototype",{writable:!1}),d}function s(d,c){d.prototype=Object.create(c.prototype),d.prototype.constructor=d,r(d,c)}function r(d,c){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(d,c)}var u=function(d){s(c,d);function c(t){var e;return e=d.call(this,t,"[subtitle-track-controller]")||this,e.media=null,e.tracks=[],e.groupId=null,e.tracksInGroup=[],e.trackId=-1,e.selectDefaultTrack=!0,e.queuedDefaultTrack=-1,e.trackChangeListener=function(){return e.onTextTracksChanged()},e.asyncPollTrackChange=function(){return e.pollTrackChange(0)},e.useTextTrackPolling=!1,e.subtitlePollingInterval=-1,e._subtitleDisplay=!0,e.registerListeners(),e}var h=c.prototype;return h.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,d.prototype.destroy.call(this)},h.registerListeners=function(){var e=this.hls;e.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.Events.ERROR,this.onError,this)},h.unregisterListeners=function(){var e=this.hls;e.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.Events.ERROR,this.onError,this)},h.onMediaAttached=function(e,n){this.media=n.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},h.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)},h.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var e=a(this.media.textTracks);e.forEach(function(n){Object(p.clearCurrentCues)(n)}),this.subtitleTrack=-1,this.media=null}},h.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},h.onManifestParsed=function(e,n){this.tracks=n.subtitleTracks},h.onSubtitleTrackLoaded=function(e,n){var i=n.id,f=n.details,l=this.trackId,o=this.tracksInGroup[l];if(!o){this.warn("Invalid subtitle track id "+i);return}var v=o.details;o.details=n.details,this.log("subtitle track "+i+" loaded ["+f.startSN+"-"+f.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,n,v))},h.onLevelLoading=function(e,n){this.switchLevel(n.level)},h.onLevelSwitching=function(e,n){this.switchLevel(n.level)},h.switchLevel=function(e){var n=this.hls.levels[e];if(!!(n!=null&&n.textGroupIds)){var i=n.textGroupIds[n.urlId];if(this.groupId!==i){var f=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,l=this.tracks.filter(function(D){return!i||D.groupId===i});this.tracksInGroup=l;var o=this.findTrackId(f==null?void 0:f.name)||this.findTrackId();this.groupId=i;var v={subtitleTracks:l};this.log("Updating subtitle tracks, "+l.length+' track(s) found in "'+i+'" group-id'),this.hls.trigger(T.Events.SUBTITLE_TRACKS_UPDATED,v),o!==-1&&this.setSubtitleTrack(o,f)}}},h.findTrackId=function(e){for(var n=this.tracksInGroup,i=0;i<n.length;i++){var f=n[i];if((!this.selectDefaultTrack||f.default)&&(!e||e===f.name))return f.id}return-1},h.onError=function(e,n){d.prototype.onError.call(this,e,n),!(n.fatal||!n.context)&&n.context.type===A.PlaylistContextType.SUBTITLE_TRACK&&n.context.id===this.trackId&&n.context.groupId===this.groupId&&this.retryLoadingOrFail(n)},h.loadPlaylist=function(e){var n=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(n)){var i=n.id,f=n.groupId,l=n.url;if(e)try{l=e.addDirectives(l)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("Loading subtitle playlist for id "+i),this.hls.trigger(T.Events.SUBTITLE_TRACK_LOADING,{url:l,id:i,groupId:f,deliveryDirectives:e||null})}},h.toggleTrackModes=function(e){var n=this,i=this.media,f=this.trackId;if(!!i){var l=a(i.textTracks),o=l.filter(function(S){return S.groupId===n.groupId});if(e===-1)[].slice.call(l).forEach(function(S){S.mode="disabled"});else{var v=o[f];v&&(v.mode="disabled")}var D=o[e];D&&(D.mode=this.subtitleDisplay?"showing":"hidden")}},h.setSubtitleTrack=function(e,n){var i,f=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),!(this.trackId===e&&(e===-1||(i=f[e])!==null&&i!==void 0&&i.details)||e<-1||e>=f.length)){this.clearTimer();var l=f[e];if(this.log("Switching to subtitle track "+e),this.trackId=e,l){var o=l.id,v=l.groupId,D=v===void 0?"":v,S=l.name,E=l.type,L=l.url;this.hls.trigger(T.Events.SUBTITLE_TRACK_SWITCH,{id:o,groupId:D,name:S,type:E,url:L});var x=this.switchParams(l.url,n==null?void 0:n.details);this.loadPlaylist(x)}else this.hls.trigger(T.Events.SUBTITLE_TRACK_SWITCH,{id:e})}},h.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var e=-1,n=a(this.media.textTracks),i=0;i<n.length;i++)if(n[i].mode==="hidden")e=i;else if(n[i].mode==="showing"){e=i;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},g(c,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1;var n=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,n)}}]),c}(m.default);function a(d){for(var c=[],h=0;h<d.length;h++){var t=d[h];t.kind==="subtitles"&&t.label&&c.push(d[h])}return c}C.default=u},"./src/controller/timeline-controller.ts":function(M,C,y){y.r(C),y.d(C,"TimelineController",function(){return d});var T=y("./src/polyfills/number.ts"),p=y("./src/events.ts"),m=y("./src/utils/cea-608-parser.ts"),A=y("./src/utils/output-filter.ts"),_=y("./src/utils/webvtt-parser.ts"),g=y("./src/utils/texttrack-utils.ts"),s=y("./src/utils/imsc1-ttml-parser.ts"),r=y("./src/utils/mp4-tools.ts"),u=y("./src/types/loader.ts"),a=y("./src/utils/logger.ts"),d=function(){function e(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=t(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var f=new A.default(this,"textTrack1"),l=new A.default(this,"textTrack2"),o=new A.default(this,"textTrack3"),v=new A.default(this,"textTrack4");this.cea608Parser1=new m.default(1,f,l),this.cea608Parser2=new m.default(3,o,v)}i.on(p.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(p.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(p.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(p.Events.FRAG_LOADING,this.onFragLoading,this),i.on(p.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(p.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(p.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(p.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(p.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var n=e.prototype;return n.destroy=function(){var f=this.hls;f.off(p.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(p.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(p.Events.MANIFEST_LOADED,this.onManifestLoaded,this),f.off(p.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),f.off(p.Events.FRAG_LOADING,this.onFragLoading,this),f.off(p.Events.FRAG_LOADED,this.onFragLoaded,this),f.off(p.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),f.off(p.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),f.off(p.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),f.off(p.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),f.off(p.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},n.addCues=function(f,l,o,v,D){for(var S=!1,E=D.length;E--;){var L=D[E],x=h(L[0],L[1],l,o);if(x>=0&&(L[0]=Math.min(L[0],l),L[1]=Math.max(L[1],o),S=!0,x/(o-l)>.5))return}if(S||D.push([l,o]),this.config.renderTextTracksNatively){var b=this.captionsTracks[f];this.Cues.newCue(b,l,o,v)}else{var O=this.Cues.newCue(null,l,o,v);this.hls.trigger(p.Events.CUES_PARSED,{type:"captions",cues:O,track:f})}},n.onInitPtsFound=function(f,l){var o=this,v=l.frag,D=l.id,S=l.initPTS,E=l.timescale,L=this.unparsedVttFrags;D==="main"&&(this.initPTS[v.cc]=S,this.timescale[v.cc]=E),L.length&&(this.unparsedVttFrags=[],L.forEach(function(x){o.onFragLoaded(p.Events.FRAG_LOADED,x)}))},n.getExistingTrack=function(f){var l=this.media;if(l)for(var o=0;o<l.textTracks.length;o++){var v=l.textTracks[o];if(v[f])return v}return null},n.createCaptionsTrack=function(f){this.config.renderTextTracksNatively?this.createNativeTrack(f):this.createNonNativeTrack(f)},n.createNativeTrack=function(f){if(!this.captionsTracks[f]){var l=this.captionsProperties,o=this.captionsTracks,v=this.media,D=l[f],S=D.label,E=D.languageCode,L=this.getExistingTrack(f);if(L)o[f]=L,Object(g.clearCurrentCues)(o[f]),Object(g.sendAddTrackEvent)(o[f],v);else{var x=this.createTextTrack("captions",S,E);x&&(x[f]=!0,o[f]=x)}}},n.createNonNativeTrack=function(f){if(!this.nonNativeCaptionsTracks[f]){var l=this.captionsProperties[f];if(!!l){var o=l.label,v={_id:f,label:o,kind:"captions",default:l.media?!!l.media.default:!1,closedCaptions:l.media};this.nonNativeCaptionsTracks[f]=v,this.hls.trigger(p.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[v]})}}},n.createTextTrack=function(f,l,o){var v=this.media;if(!!v)return v.addTextTrack(f,l,o)},n.onMediaAttaching=function(f,l){this.media=l.media,this._cleanTracks()},n.onMediaDetaching=function(){var f=this.captionsTracks;Object.keys(f).forEach(function(l){Object(g.clearCurrentCues)(f[l]),delete f[l]}),this.nonNativeCaptionsTracks={}},n.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=t(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},n._cleanTracks=function(){var f=this.media;if(!!f){var l=f.textTracks;if(l)for(var o=0;o<l.length;o++)Object(g.clearCurrentCues)(l[o])}},n.onSubtitleTracksUpdated=function(f,l){var o=this;this.textTracks=[];var v=l.subtitleTracks||[],D=v.some(function(x){return x.textCodec===s.IMSC1_CODEC});if(this.config.enableWebVTT||D&&this.config.enableIMSC1){var S=this.tracks&&v&&this.tracks.length===v.length;if(this.tracks=v||[],this.config.renderTextTracksNatively){var E=this.media?this.media.textTracks:[];this.tracks.forEach(function(x,b){var O;if(b<E.length){for(var R=null,I=0;I<E.length;I++)if(c(E[I],x)){R=E[I];break}R&&(O=R)}if(O)Object(g.clearCurrentCues)(O);else{var P=o._captionsOrSubtitlesFromCharacteristics(x);O=o.createTextTrack(P,x.name,x.lang),O&&(O.mode="disabled")}O&&(O.groupId=x.groupId,o.textTracks.push(O))})}else if(!S&&this.tracks&&this.tracks.length){var L=this.tracks.map(function(x){return{label:x.name,kind:x.type.toLowerCase(),default:x.default,subtitleTrack:x}});this.hls.trigger(p.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:L})}}},n._captionsOrSubtitlesFromCharacteristics=function(f){var l;if((l=f.attrs)!==null&&l!==void 0&&l.CHARACTERISTICS){var o=/transcribes-spoken-dialog/gi.test(f.attrs.CHARACTERISTICS),v=/describes-music-and-sound/gi.test(f.attrs.CHARACTERISTICS);if(o&&v)return"captions"}return"subtitles"},n.onManifestLoaded=function(f,l){var o=this;this.config.enableCEA708Captions&&l.captions&&l.captions.forEach(function(v){var D=/(?:CC|SERVICE)([1-4])/.exec(v.instreamId);if(!!D){var S="textTrack"+D[1],E=o.captionsProperties[S];!E||(E.label=v.name,v.lang&&(E.languageCode=v.lang),E.media=v)}})},n.onFragLoading=function(f,l){var o=this.cea608Parser1,v=this.cea608Parser2,D=this.lastSn,S=this.lastPartIndex;if(!(!this.enabled||!(o&&v))&&l.frag.type===u.PlaylistLevelType.MAIN){var E,L,x=l.frag.sn,b=(E=l==null||(L=l.part)===null||L===void 0?void 0:L.index)!=null?E:-1;x===D+1||x===D&&b===S+1||(o.reset(),v.reset()),this.lastSn=x,this.lastPartIndex=b}},n.onFragLoaded=function(f,l){var o=l.frag,v=l.payload,D=this.initPTS,S=this.unparsedVttFrags;if(o.type===u.PlaylistLevelType.SUBTITLE)if(v.byteLength){if(!Object(T.isFiniteNumber)(D[o.cc])){S.push(l),D.length&&this.hls.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Missing initial subtitle PTS")});return}var E=o.decryptdata,L="stats"in l;if(E==null||E.key==null||E.method!=="AES-128"||L){var x=this.tracks[o.level],b=this.vttCCs;b[o.cc]||(b[o.cc]={start:o.start,prevCC:this.prevCC,new:!0},this.prevCC=o.cc),x&&x.textCodec===s.IMSC1_CODEC?this._parseIMSC1(o,v):this._parseVTTs(o,v,b)}}else this.hls.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Empty subtitle payload")})},n._parseIMSC1=function(f,l){var o=this,v=this.hls;Object(s.parseIMSC1)(l,this.initPTS[f.cc],this.timescale[f.cc],function(D){o._appendCues(D,f.level),v.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:f})},function(D){a.logger.log("Failed to parse IMSC1: "+D),v.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:D})})},n._parseVTTs=function(f,l,o){var v,D=this,S=this.hls,E=(v=f.initSegment)!==null&&v!==void 0&&v.data?Object(r.appendUint8Array)(f.initSegment.data,new Uint8Array(l)):l;Object(_.parseWebVTT)(E,this.initPTS[f.cc],this.timescale[f.cc],o,f.cc,f.start,function(L){D._appendCues(L,f.level),S.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:f})},function(L){D._fallbackToIMSC1(f,l),a.logger.log("Failed to parse VTT cue: "+L),S.trigger(p.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:L})})},n._fallbackToIMSC1=function(f,l){var o=this,v=this.tracks[f.level];v.textCodec||Object(s.parseIMSC1)(l,this.initPTS[f.cc],this.timescale[f.cc],function(){v.textCodec=s.IMSC1_CODEC,o._parseIMSC1(f,l)},function(){v.textCodec="wvtt"})},n._appendCues=function(f,l){var o=this.hls;if(this.config.renderTextTracksNatively){var v=this.textTracks[l];if(!v||v.mode==="disabled")return;f.forEach(function(E){return Object(g.addCueToTrack)(v,E)})}else{var D=this.tracks[l];if(!D)return;var S=D.default?"default":"subtitles"+l;o.trigger(p.Events.CUES_PARSED,{type:"subtitles",cues:f,track:S})}},n.onFragDecrypted=function(f,l){var o=l.frag;if(o.type===u.PlaylistLevelType.SUBTITLE){if(!Object(T.isFiniteNumber)(this.initPTS[o.cc])){this.unparsedVttFrags.push(l);return}this.onFragLoaded(p.Events.FRAG_LOADED,l)}},n.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},n.onFragParsingUserdata=function(f,l){var o=this.cea608Parser1,v=this.cea608Parser2;if(!(!this.enabled||!(o&&v)))for(var D=0;D<l.samples.length;D++){var S=l.samples[D].bytes;if(S){var E=this.extractCea608Data(S);o.addData(l.samples[D].pts,E[0]),v.addData(l.samples[D].pts,E[1])}}},n.onBufferFlushing=function(f,l){var o=l.startOffset,v=l.endOffset,D=l.endOffsetSubtitles,S=l.type,E=this.media;if(!(!E||E.currentTime<v)){if(!S||S==="video"){var L=this.captionsTracks;Object.keys(L).forEach(function(b){return Object(g.removeCuesInRange)(L[b],o,v)})}if(this.config.renderTextTracksNatively&&o===0&&D!==void 0){var x=this.textTracks;Object.keys(x).forEach(function(b){return Object(g.removeCuesInRange)(x[b],o,D)})}}},n.extractCea608Data=function(f){for(var l=[[],[]],o=f[0]&31,v=2,D=0;D<o;D++){var S=f[v++],E=127&f[v++],L=127&f[v++];if(!(E===0&&L===0)){var x=(4&S)!==0;if(x){var b=3&S;(b===0||b===1)&&(l[b].push(E),l[b].push(L))}}}return l},e}();function c(e,n){return e&&e.label===n.name&&!(e.textTrack1||e.textTrack2)}function h(e,n,i,f){return Math.min(n,f)-Math.max(e,i)}function t(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return T});var T=function(){function p(A,_){this.subtle=void 0,this.aesIV=void 0,this.subtle=A,this.aesIV=_}var m=p.prototype;return m.decrypt=function(_,g){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},g,_)},p}()},"./src/crypt/aes-decryptor.ts":function(M,C,y){y.r(C),y.d(C,"removePadding",function(){return p}),y.d(C,"default",function(){return m});var T=y("./src/utils/typed-array.ts");function p(A){var _=A.byteLength,g=_&&new DataView(A.buffer).getUint8(_-1);return g?Object(T.sliceUint8)(A,0,_-g):A}var m=function(){function A(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var _=A.prototype;return _.uint8ArrayToUint32Array_=function(s){for(var r=new DataView(s),u=new Uint32Array(4),a=0;a<4;a++)u[a]=r.getUint32(a*4);return u},_.initTable=function(){var s=this.sBox,r=this.invSBox,u=this.subMix,a=u[0],d=u[1],c=u[2],h=u[3],t=this.invSubMix,e=t[0],n=t[1],i=t[2],f=t[3],l=new Uint32Array(256),o=0,v=0,D=0;for(D=0;D<256;D++)D<128?l[D]=D<<1:l[D]=D<<1^283;for(D=0;D<256;D++){var S=v^v<<1^v<<2^v<<3^v<<4;S=S>>>8^S&255^99,s[o]=S,r[S]=o;var E=l[o],L=l[E],x=l[L],b=l[S]*257^S*16843008;a[o]=b<<24|b>>>8,d[o]=b<<16|b>>>16,c[o]=b<<8|b>>>24,h[o]=b,b=x*16843009^L*65537^E*257^o*16843008,e[S]=b<<24|b>>>8,n[S]=b<<16|b>>>16,i[S]=b<<8|b>>>24,f[S]=b,o?(o=E^l[l[l[x^E]]],v^=l[l[v]]):o=v=1}},_.expandKey=function(s){for(var r=this.uint8ArrayToUint32Array_(s),u=!0,a=0;a<r.length&&u;)u=r[a]===this.key[a],a++;if(!u){this.key=r;var d=this.keySize=r.length;if(d!==4&&d!==6&&d!==8)throw new Error("Invalid aes key size="+d);var c=this.ksRows=(d+6+1)*4,h,t,e=this.keySchedule=new Uint32Array(c),n=this.invKeySchedule=new Uint32Array(c),i=this.sBox,f=this.rcon,l=this.invSubMix,o=l[0],v=l[1],D=l[2],S=l[3],E,L;for(h=0;h<c;h++){if(h<d){E=e[h]=r[h];continue}L=E,h%d===0?(L=L<<8|L>>>24,L=i[L>>>24]<<24|i[L>>>16&255]<<16|i[L>>>8&255]<<8|i[L&255],L^=f[h/d|0]<<24):d>6&&h%d===4&&(L=i[L>>>24]<<24|i[L>>>16&255]<<16|i[L>>>8&255]<<8|i[L&255]),e[h]=E=(e[h-d]^L)>>>0}for(t=0;t<c;t++)h=c-t,t&3?L=e[h]:L=e[h-4],t<4||h<=4?n[t]=L:n[t]=o[i[L>>>24]]^v[i[L>>>16&255]]^D[i[L>>>8&255]]^S[i[L&255]],n[t]=n[t]>>>0}},_.networkToHostOrderSwap=function(s){return s<<24|(s&65280)<<8|(s&16711680)>>8|s>>>24},_.decrypt=function(s,r,u){for(var a=this.keySize+6,d=this.invKeySchedule,c=this.invSBox,h=this.invSubMix,t=h[0],e=h[1],n=h[2],i=h[3],f=this.uint8ArrayToUint32Array_(u),l=f[0],o=f[1],v=f[2],D=f[3],S=new Int32Array(s),E=new Int32Array(S.length),L,x,b,O,R,I,P,F,w,k,B,U,j,N,K=this.networkToHostOrderSwap;r<S.length;){for(w=K(S[r]),k=K(S[r+1]),B=K(S[r+2]),U=K(S[r+3]),R=w^d[0],I=U^d[1],P=B^d[2],F=k^d[3],j=4,N=1;N<a;N++)L=t[R>>>24]^e[I>>16&255]^n[P>>8&255]^i[F&255]^d[j],x=t[I>>>24]^e[P>>16&255]^n[F>>8&255]^i[R&255]^d[j+1],b=t[P>>>24]^e[F>>16&255]^n[R>>8&255]^i[I&255]^d[j+2],O=t[F>>>24]^e[R>>16&255]^n[I>>8&255]^i[P&255]^d[j+3],R=L,I=x,P=b,F=O,j=j+4;L=c[R>>>24]<<24^c[I>>16&255]<<16^c[P>>8&255]<<8^c[F&255]^d[j],x=c[I>>>24]<<24^c[P>>16&255]<<16^c[F>>8&255]<<8^c[R&255]^d[j+1],b=c[P>>>24]<<24^c[F>>16&255]<<16^c[R>>8&255]<<8^c[I&255]^d[j+2],O=c[F>>>24]<<24^c[R>>16&255]<<16^c[I>>8&255]<<8^c[P&255]^d[j+3],E[r]=K(L^l),E[r+1]=K(O^o),E[r+2]=K(b^v),E[r+3]=K(x^D),l=w,o=k,v=B,D=U,r=r+4}return E.buffer},A}()},"./src/crypt/decrypter.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return r});var T=y("./src/crypt/aes-crypto.ts"),p=y("./src/crypt/fast-aes-key.ts"),m=y("./src/crypt/aes-decryptor.ts"),A=y("./src/utils/logger.ts"),_=y("./src/utils/mp4-tools.ts"),g=y("./src/utils/typed-array.ts"),s=16,r=function(){function u(d,c,h){var t=h===void 0?{}:h,e=t.removePKCS7Padding,n=e===void 0?!0:e;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=d,this.config=c,this.removePKCS7Padding=n,n)try{var i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var a=u.prototype;return a.destroy=function(){this.observer=null},a.isSync=function(){return this.config.enableSoftwareAES},a.flush=function(){var c=this.currentResult;if(!c){this.reset();return}var h=new Uint8Array(c);return this.reset(),this.removePKCS7Padding?Object(m.removePadding)(h):h},a.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},a.decrypt=function(c,h,t,e){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(c),h,t);var n=this.flush();n&&e(n.buffer)}else this.webCryptoDecrypt(new Uint8Array(c),h,t).then(e)},a.softwareDecrypt=function(c,h,t){var e=this.currentIV,n=this.currentResult,i=this.remainderData;this.logOnce("JS AES decrypt"),i&&(c=Object(_.appendUint8Array)(i,c),this.remainderData=null);var f=this.getValidChunk(c);if(!f.length)return null;e&&(t=e);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new m.default),l.expandKey(h);var o=n;return this.currentResult=l.decrypt(f.buffer,0,t),this.currentIV=Object(g.sliceUint8)(f,-16).buffer,o||null},a.webCryptoDecrypt=function(c,h,t){var e=this,n=this.subtle;return(this.key!==h||!this.fastAesKey)&&(this.key=h,this.fastAesKey=new p.default(n,h)),this.fastAesKey.expandKey().then(function(i){if(!n)return Promise.reject(new Error("web crypto not initialized"));var f=new T.default(n,t);return f.decrypt(c.buffer,i)}).catch(function(i){return e.onWebCryptoError(i,c,h,t)})},a.onWebCryptoError=function(c,h,t,e){return A.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",c),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(h,t,e)},a.getValidChunk=function(c){var h=c,t=c.length-c.length%s;return t!==c.length&&(h=Object(g.sliceUint8)(c,0,t),this.remainderData=Object(g.sliceUint8)(c,t)),h},a.logOnce=function(c){!this.logEnabled||(A.logger.log("[decrypter.ts]: "+c),this.logEnabled=!1)},u}()},"./src/crypt/fast-aes-key.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return T});var T=function(){function p(A,_){this.subtle=void 0,this.key=void 0,this.subtle=A,this.key=_}var m=p.prototype;return m.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},p}()},"./src/demux/aacdemuxer.ts":function(M,C,y){y.r(C);var T=y("./src/demux/base-audio-demuxer.ts"),p=y("./src/demux/adts.ts"),m=y("./src/utils/logger.ts"),A=y("./src/demux/id3.ts");function _(r,u){r.prototype=Object.create(u.prototype),r.prototype.constructor=r,g(r,u)}function g(r,u){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,c){return d.__proto__=c,d},g(r,u)}var s=function(r){_(u,r);function u(d,c){var h;return h=r.call(this)||this,h.observer=void 0,h.config=void 0,h.observer=d,h.config=c,h}var a=u.prototype;return a.resetInitSegment=function(c,h,t,e){r.prototype.resetInitSegment.call(this,c,h,t,e),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:h,duration:e,inputTimeScale:9e4,dropped:0}},u.probe=function(c){if(!c)return!1;for(var h=A.getID3Data(c,0)||[],t=h.length,e=c.length;t<e;t++)if(p.probe(c,t))return m.logger.log("ADTS sync word found !"),!0;return!1},a.canParse=function(c,h){return p.canParse(c,h)},a.appendFrame=function(c,h,t){p.initTrackConfig(c,this.observer,h,t,c.manifestCodec);var e=p.appendFrame(c,h,t,this.basePTS,this.frameIndex);if(e&&e.missing===0)return e},u}(T.default);s.minProbeByteLength=9,C.default=s},"./src/demux/adts.ts":function(M,C,y){y.r(C),y.d(C,"getAudioConfig",function(){return A}),y.d(C,"isHeaderPattern",function(){return _}),y.d(C,"getHeaderLength",function(){return g}),y.d(C,"getFullFrameLength",function(){return s}),y.d(C,"canGetFrameLength",function(){return r}),y.d(C,"isHeader",function(){return u}),y.d(C,"canParse",function(){return a}),y.d(C,"probe",function(){return d}),y.d(C,"initTrackConfig",function(){return c}),y.d(C,"getFrameDuration",function(){return h}),y.d(C,"parseFrameHeader",function(){return t}),y.d(C,"appendFrame",function(){return e});var T=y("./src/utils/logger.ts"),p=y("./src/errors.ts"),m=y("./src/events.ts");function A(n,i,f,l){var o,v,D,S,E=navigator.userAgent.toLowerCase(),L=l,x=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];o=((i[f+2]&192)>>>6)+1;var b=(i[f+2]&60)>>>2;if(b>x.length-1){n.trigger(m.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+b});return}return D=(i[f+2]&1)<<2,D|=(i[f+3]&192)>>>6,T.logger.log("manifest codec:"+l+", ADTS type:"+o+", samplingIndex:"+b),/firefox/i.test(E)?b>=6?(o=5,S=new Array(4),v=b-3):(o=2,S=new Array(2),v=b):E.indexOf("android")!==-1?(o=2,S=new Array(2),v=b):(o=5,S=new Array(4),l&&(l.indexOf("mp4a.40.29")!==-1||l.indexOf("mp4a.40.5")!==-1)||!l&&b>=6?v=b-3:((l&&l.indexOf("mp4a.40.2")!==-1&&(b>=6&&D===1||/vivaldi/i.test(E))||!l&&D===1)&&(o=2,S=new Array(2)),v=b)),S[0]=o<<3,S[0]|=(b&14)>>1,S[1]|=(b&1)<<7,S[1]|=D<<3,o===5&&(S[1]|=(v&14)>>1,S[2]=(v&1)<<7,S[2]|=2<<2,S[3]=0),{config:S,samplerate:x[b],channelCount:D,codec:"mp4a.40."+o,manifestCodec:L}}function _(n,i){return n[i]===255&&(n[i+1]&246)===240}function g(n,i){return n[i+1]&1?7:9}function s(n,i){return(n[i+3]&3)<<11|n[i+4]<<3|(n[i+5]&224)>>>5}function r(n,i){return i+5<n.length}function u(n,i){return i+1<n.length&&_(n,i)}function a(n,i){return r(n,i)&&_(n,i)&&s(n,i)<=n.length-i}function d(n,i){if(u(n,i)){var f=g(n,i);if(i+f>=n.length)return!1;var l=s(n,i);if(l<=f)return!1;var o=i+l;return o===n.length||u(n,o)}return!1}function c(n,i,f,l,o){if(!n.samplerate){var v=A(i,f,l,o);if(!v)return;n.config=v.config,n.samplerate=v.samplerate,n.channelCount=v.channelCount,n.codec=v.codec,n.manifestCodec=v.manifestCodec,T.logger.log("parsed codec:"+n.codec+", rate:"+v.samplerate+", channels:"+v.channelCount)}}function h(n){return 1024*9e4/n}function t(n,i){var f=g(n,i);if(i+f<=n.length){var l=s(n,i)-f;if(l>0)return{headerLength:f,frameLength:l}}}function e(n,i,f,l,o){var v=h(n.samplerate),D=l+o*v,S=t(i,f),E;if(S){var L=S.frameLength,x=S.headerLength,b=x+L,O=Math.max(0,f+b-i.length);O?(E=new Uint8Array(b-x),E.set(i.subarray(f+x,i.length),0)):E=i.subarray(f+x,f+b);var R={unit:E,pts:D};return O||n.samples.push(R),{sample:R,length:b,missing:O}}var I=i.length-f;E=new Uint8Array(I),E.set(i.subarray(f,i.length),0);var P={unit:E,pts:D};return{sample:P,length:I,missing:-1}}},"./src/demux/base-audio-demuxer.ts":function(M,C,y){y.r(C),y.d(C,"initPTSFn",function(){return r});var T=y("./src/polyfills/number.ts"),p=y("./src/demux/id3.ts"),m=y("./src/types/demuxer.ts"),A=y("./src/demux/dummy-demuxed-track.ts"),_=y("./src/utils/mp4-tools.ts"),g=y("./src/utils/typed-array.ts"),s=function(){function u(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null}var a=u.prototype;return a.resetInitSegment=function(c,h,t,e){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},a.resetTimeStamp=function(c){this.initPTS=c,this.resetContiguity()},a.resetContiguity=function(){this.basePTS=null,this.frameIndex=0},a.canParse=function(c,h){return!1},a.appendFrame=function(c,h,t){},a.demux=function(c,h){this.cachedData&&(c=Object(_.appendUint8Array)(this.cachedData,c),this.cachedData=null);var t=p.getID3Data(c,0),e=t?t.length:0,n,i,f=this._audioTrack,l=this._id3Track,o=t?p.getTimeStamp(t):void 0,v=c.length;for((this.basePTS===null||this.frameIndex===0&&Object(T.isFiniteNumber)(o))&&(this.basePTS=r(o,h,this.initPTS)),t&&t.length>0&&l.samples.push({pts:this.basePTS,dts:this.basePTS,data:t,type:m.MetadataSchema.audioId3}),i=this.basePTS;e<v;){if(this.canParse(c,e)){var D=this.appendFrame(f,c,e);D?(this.frameIndex++,i=D.sample.pts,e+=D.length,n=e):e=v}else p.canParse(c,e)?(t=p.getID3Data(c,e),l.samples.push({pts:i,dts:i,data:t,type:m.MetadataSchema.audioId3}),e+=t.length,n=e):e++;if(e===v&&n!==v){var S=Object(g.sliceUint8)(c,n);this.cachedData?this.cachedData=Object(_.appendUint8Array)(this.cachedData,S):this.cachedData=S}}return{audioTrack:f,videoTrack:Object(A.dummyTrack)(),id3Track:l,textTrack:Object(A.dummyTrack)()}},a.demuxSampleAes=function(c,h,t){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},a.flush=function(c){var h=this.cachedData;return h&&(this.cachedData=null,this.demux(h,0)),{audioTrack:this._audioTrack,videoTrack:Object(A.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(A.dummyTrack)()}},a.destroy=function(){},u}(),r=function(a,d,c){return Object(T.isFiniteNumber)(a)?a*90:d*9e4+(c||0)};C.default=s},"./src/demux/chunk-cache.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return T});var T=function(){function m(){this.chunks=[],this.dataLength=0}var A=m.prototype;return A.push=function(g){this.chunks.push(g),this.dataLength+=g.length},A.flush=function(){var g=this.chunks,s=this.dataLength,r;if(g.length)g.length===1?r=g[0]:r=p(g,s);else return new Uint8Array(0);return this.reset(),r},A.reset=function(){this.chunks.length=0,this.dataLength=0},m}();function p(m,A){for(var _=new Uint8Array(A),g=0,s=0;s<m.length;s++){var r=m[s];_.set(r,g),g+=r.length}return _}},"./src/demux/dummy-demuxed-track.ts":function(M,C,y){y.r(C),y.d(C,"dummyTrack",function(){return T});function T(p,m){return p===void 0&&(p=""),m===void 0&&(m=9e4),{type:p,id:-1,pid:-1,inputTimeScale:m,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(M,C,y){y.r(C);var T=y("./src/utils/logger.ts"),p=function(){function m(_){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=_,this.bytesAvailable=_.byteLength,this.word=0,this.bitsAvailable=0}var A=m.prototype;return A.loadWord=function(){var g=this.data,s=this.bytesAvailable,r=g.byteLength-s,u=new Uint8Array(4),a=Math.min(4,s);if(a===0)throw new Error("no bytes available");u.set(g.subarray(r,r+a)),this.word=new DataView(u.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a},A.skipBits=function(g){var s;this.bitsAvailable>g?(this.word<<=g,this.bitsAvailable-=g):(g-=this.bitsAvailable,s=g>>3,g-=s>>3,this.bytesAvailable-=s,this.loadWord(),this.word<<=g,this.bitsAvailable-=g)},A.readBits=function(g){var s=Math.min(this.bitsAvailable,g),r=this.word>>>32-s;return g>32&&T.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=s,this.bitsAvailable>0?this.word<<=s:this.bytesAvailable>0&&this.loadWord(),s=g-s,s>0&&this.bitsAvailable?r<<s|this.readBits(s):r},A.skipLZ=function(){var g;for(g=0;g<this.bitsAvailable;++g)if((this.word&2147483648>>>g)!==0)return this.word<<=g,this.bitsAvailable-=g,g;return this.loadWord(),g+this.skipLZ()},A.skipUEG=function(){this.skipBits(1+this.skipLZ())},A.skipEG=function(){this.skipBits(1+this.skipLZ())},A.readUEG=function(){var g=this.skipLZ();return this.readBits(g+1)-1},A.readEG=function(){var g=this.readUEG();return 1&g?1+g>>>1:-1*(g>>>1)},A.readBoolean=function(){return this.readBits(1)===1},A.readUByte=function(){return this.readBits(8)},A.readUShort=function(){return this.readBits(16)},A.readUInt=function(){return this.readBits(32)},A.skipScalingList=function(g){for(var s=8,r=8,u,a=0;a<g;a++)r!==0&&(u=this.readEG(),r=(s+u+256)%256),s=r===0?s:r},A.readSPS=function(){var g=0,s=0,r=0,u=0,a,d,c,h=this.readUByte.bind(this),t=this.readBits.bind(this),e=this.readUEG.bind(this),n=this.readBoolean.bind(this),i=this.skipBits.bind(this),f=this.skipEG.bind(this),l=this.skipUEG.bind(this),o=this.skipScalingList.bind(this);h();var v=h();if(t(5),i(3),h(),l(),v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128){var D=e();if(D===3&&i(1),l(),l(),i(1),n())for(d=D!==3?8:12,c=0;c<d;c++)n()&&(c<6?o(16):o(64))}l();var S=e();if(S===0)e();else if(S===1)for(i(1),f(),f(),a=e(),c=0;c<a;c++)f();l(),i(1);var E=e(),L=e(),x=t(1);x===0&&i(1),i(1),n()&&(g=e(),s=e(),r=e(),u=e());var b=[1,1];if(n()&&n()){var O=h();switch(O){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:{b=[h()<<8|h(),h()<<8|h()];break}}}return{width:Math.ceil((E+1)*16-g*2-s*2),height:(2-x)*(L+1)*16-(x?2:4)*(r+u),pixelRatio:b}},A.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},m}();C.default=p},"./src/demux/id3.ts":function(M,C,y){y.r(C),y.d(C,"isHeader",function(){return T}),y.d(C,"isFooter",function(){return p}),y.d(C,"getID3Data",function(){return m}),y.d(C,"canParse",function(){return _}),y.d(C,"getTimeStamp",function(){return g}),y.d(C,"isTimeStampFrame",function(){return s}),y.d(C,"getID3Frames",function(){return u}),y.d(C,"decodeFrame",function(){return a}),y.d(C,"utf8ArrayToStr",function(){return e}),y.d(C,"testables",function(){return n});var T=function(o,v){return v+10<=o.length&&o[v]===73&&o[v+1]===68&&o[v+2]===51&&o[v+3]<255&&o[v+4]<255&&o[v+6]<128&&o[v+7]<128&&o[v+8]<128&&o[v+9]<128},p=function(o,v){return v+10<=o.length&&o[v]===51&&o[v+1]===68&&o[v+2]===73&&o[v+3]<255&&o[v+4]<255&&o[v+6]<128&&o[v+7]<128&&o[v+8]<128&&o[v+9]<128},m=function(o,v){for(var D=v,S=0;T(o,v);){S+=10;var E=A(o,v+6);S+=E,p(o,v+10)&&(S+=10),v+=S}if(S>0)return o.subarray(D,D+S)},A=function(o,v){var D=0;return D=(o[v]&127)<<21,D|=(o[v+1]&127)<<14,D|=(o[v+2]&127)<<7,D|=o[v+3]&127,D},_=function(o,v){return T(o,v)&&A(o,v+6)+10<=o.length-v},g=function(o){for(var v=u(o),D=0;D<v.length;D++){var S=v[D];if(s(S))return t(S)}},s=function(o){return o&&o.key==="PRIV"&&o.info==="com.apple.streaming.transportStreamTimestamp"},r=function(o){var v=String.fromCharCode(o[0],o[1],o[2],o[3]),D=A(o,4),S=10;return{type:v,size:D,data:o.subarray(S,S+D)}},u=function(o){for(var v=0,D=[];T(o,v);){var S=A(o,v+6);v+=10;for(var E=v+S;v+8<E;){var L=r(o.subarray(v)),x=a(L);x&&D.push(x),v+=L.size+10}p(o,v)&&(v+=10)}return D},a=function(o){return o.type==="PRIV"?d(o):o.type[0]==="W"?h(o):c(o)},d=function(o){if(!(o.size<2)){var v=e(o.data,!0),D=new Uint8Array(o.data.subarray(v.length+1));return{key:o.type,info:v,data:D.buffer}}},c=function(o){if(!(o.size<2)){if(o.type==="TXXX"){var v=1,D=e(o.data.subarray(v),!0);v+=D.length+1;var S=e(o.data.subarray(v));return{key:o.type,info:D,data:S}}var E=e(o.data.subarray(1));return{key:o.type,data:E}}},h=function(o){if(o.type==="WXXX"){if(o.size<2)return;var v=1,D=e(o.data.subarray(v),!0);v+=D.length+1;var S=e(o.data.subarray(v));return{key:o.type,info:D,data:S}}var E=e(o.data);return{key:o.type,data:E}},t=function(o){if(o.data.byteLength===8){var v=new Uint8Array(o.data),D=v[3]&1,S=(v[4]<<23)+(v[5]<<15)+(v[6]<<7)+v[7];return S/=45,D&&(S+=4772185884e-2),Math.round(S)}},e=function(o,v){v===void 0&&(v=!1);var D=f();if(D){var S=D.decode(o);if(v){var E=S.indexOf("\0");return E!==-1?S.substring(0,E):S}return S.replace(/\0/g,"")}for(var L=o.length,x,b,O,R="",I=0;I<L;){if(x=o[I++],x===0&&v)return R;if(x===0||x===3)continue;switch(x>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:R+=String.fromCharCode(x);break;case 12:case 13:b=o[I++],R+=String.fromCharCode((x&31)<<6|b&63);break;case 14:b=o[I++],O=o[I++],R+=String.fromCharCode((x&15)<<12|(b&63)<<6|(O&63)<<0);break}}return R},n={decodeTextFrame:c},i;function f(){return!i&&typeof self.TextDecoder<"u"&&(i=new self.TextDecoder("utf-8")),i}},"./src/demux/mp3demuxer.ts":function(M,C,y){y.r(C);var T=y("./src/demux/base-audio-demuxer.ts"),p=y("./src/demux/id3.ts"),m=y("./src/utils/logger.ts"),A=y("./src/demux/mpegaudio.ts");function _(r,u){r.prototype=Object.create(u.prototype),r.prototype.constructor=r,g(r,u)}function g(r,u){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,c){return d.__proto__=c,d},g(r,u)}var s=function(r){_(u,r);function u(){return r.apply(this,arguments)||this}var a=u.prototype;return a.resetInitSegment=function(c,h,t,e){r.prototype.resetInitSegment.call(this,c,h,t,e),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:h,duration:e,inputTimeScale:9e4,dropped:0}},u.probe=function(c){if(!c)return!1;for(var h=p.getID3Data(c,0)||[],t=h.length,e=c.length;t<e;t++)if(A.probe(c,t))return m.logger.log("MPEG Audio sync word found !"),!0;return!1},a.canParse=function(c,h){return A.canParse(c,h)},a.appendFrame=function(c,h,t){if(this.basePTS!==null)return A.appendFrame(c,h,t,this.basePTS,this.frameIndex)},u}(T.default);s.minProbeByteLength=4,C.default=s},"./src/demux/mp4demuxer.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/types/demuxer.ts"),m=y("./src/utils/mp4-tools.ts"),A=y("./src/demux/dummy-demuxed-track.ts"),_=/\/emsg[-/]ID3/i,g=function(){function s(u,a){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=a}var r=s.prototype;return r.resetTimeStamp=function(){},r.resetInitSegment=function(a,d,c,h){var t=Object(m.parseInitSegment)(a),e=this.videoTrack=Object(A.dummyTrack)("video",1),n=this.audioTrack=Object(A.dummyTrack)("audio",1),i=this.txtTrack=Object(A.dummyTrack)("text",1);if(this.id3Track=Object(A.dummyTrack)("id3",1),this.timeOffset=0,t.video){var f=t.video,l=f.id,o=f.timescale,v=f.codec;e.id=l,e.timescale=i.timescale=o,e.codec=v}if(t.audio){var D=t.audio,S=D.id,E=D.timescale,L=D.codec;n.id=S,n.timescale=E,n.codec=L}i.id=m.RemuxerTrackIdConfig.text,e.sampleDuration=0,e.duration=n.duration=h},r.resetContiguity=function(){},s.probe=function(a){return a=a.length>16384?a.subarray(0,16384):a,Object(m.findBox)(a,["moof"]).length>0},r.demux=function(a,d){this.timeOffset=d;var c=a,h=this.videoTrack,t=this.txtTrack;if(this.config.progressive){this.remainderData&&(c=Object(m.appendUint8Array)(this.remainderData,a));var e=Object(m.segmentValidRange)(c);this.remainderData=e.remainder,h.samples=e.valid||new Uint8Array}else h.samples=c;var n=this.extractID3Track(h,d);return t.samples=Object(m.parseSamples)(d,h),{videoTrack:h,audioTrack:this.audioTrack,id3Track:n,textTrack:this.txtTrack}},r.flush=function(){var a=this.timeOffset,d=this.videoTrack,c=this.txtTrack;d.samples=this.remainderData||new Uint8Array,this.remainderData=null;var h=this.extractID3Track(d,this.timeOffset);return c.samples=Object(m.parseSamples)(a,d),{videoTrack:d,audioTrack:Object(A.dummyTrack)(),id3Track:h,textTrack:Object(A.dummyTrack)()}},r.extractID3Track=function(a,d){var c=this.id3Track;if(a.samples.length){var h=Object(m.findBox)(a.samples,["emsg"]);h&&h.forEach(function(t){var e=Object(m.parseEmsg)(t);if(_.test(e.schemeIdUri)){var n=Object(T.isFiniteNumber)(e.presentationTime)?e.presentationTime/e.timeScale:d+e.presentationTimeDelta/e.timeScale,i=e.payload;c.samples.push({data:i,len:i.byteLength,dts:n,pts:n,type:p.MetadataSchema.emsg})}})}return c},r.demuxSampleAes=function(a,d,c){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},r.destroy=function(){},s}();g.minProbeByteLength=1024,C.default=g},"./src/demux/mpegaudio.ts":function(M,C,y){y.r(C),y.d(C,"appendFrame",function(){return g}),y.d(C,"parseHeader",function(){return s}),y.d(C,"isHeaderPattern",function(){return r}),y.d(C,"isHeader",function(){return u}),y.d(C,"canParse",function(){return a}),y.d(C,"probe",function(){return d});var T=null,p=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],m=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],A=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],_=[0,1,1,4];function g(c,h,t,e,n){if(!(t+24>h.length)){var i=s(h,t);if(i&&t+i.frameLength<=h.length){var f=i.samplesPerFrame*9e4/i.sampleRate,l=e+n*f,o={unit:h.subarray(t,t+i.frameLength),pts:l,dts:l};return c.config=[],c.channelCount=i.channelCount,c.samplerate=i.sampleRate,c.samples.push(o),{sample:o,length:i.frameLength,missing:0}}}}function s(c,h){var t=c[h+1]>>3&3,e=c[h+1]>>1&3,n=c[h+2]>>4&15,i=c[h+2]>>2&3;if(t!==1&&n!==0&&n!==15&&i!==3){var f=c[h+2]>>1&1,l=c[h+3]>>6,o=t===3?3-e:e===3?3:4,v=p[o*14+n-1]*1e3,D=t===3?0:t===2?1:2,S=m[D*3+i],E=l===3?1:2,L=A[t][e],x=_[e],b=L*8*x,O=Math.floor(L*v/S+f)*x;if(T===null){var R=navigator.userAgent||"",I=R.match(/Chrome\/(\d+)/i);T=I?parseInt(I[1]):0}var P=!!T&&T<=87;return P&&e===2&&v>=224e3&&l===0&&(c[h+3]=c[h+3]|128),{sampleRate:S,channelCount:E,frameLength:O,samplesPerFrame:b}}}function r(c,h){return c[h]===255&&(c[h+1]&224)===224&&(c[h+1]&6)!==0}function u(c,h){return h+1<c.length&&r(c,h)}function a(c,h){var t=4;return r(c,h)&&t<=c.length-h}function d(c,h){if(h+1<c.length&&r(c,h)){var t=4,e=s(c,h),n=t;e!=null&&e.frameLength&&(n=e.frameLength);var i=h+n;return i===c.length||u(c,i)}return!1}},"./src/demux/sample-aes.ts":function(M,C,y){y.r(C);var T=y("./src/crypt/decrypter.ts"),p=y("./src/demux/tsdemuxer.ts"),m=function(){function A(g,s,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new T.default(g,s,{removePKCS7Padding:!1})}var _=A.prototype;return _.decryptBuffer=function(s,r){this.decrypter.decrypt(s,this.keyData.key.buffer,this.keyData.iv.buffer,r)},_.decryptAacSample=function(s,r,u,a){var d=s[r].unit;if(!(d.length<=16)){var c=d.subarray(16,d.length-d.length%16),h=c.buffer.slice(c.byteOffset,c.byteOffset+c.length),t=this;this.decryptBuffer(h,function(e){var n=new Uint8Array(e);d.set(n,16),a||t.decryptAacSamples(s,r+1,u)})}},_.decryptAacSamples=function(s,r,u){for(;;r++){if(r>=s.length){u();return}if(!(s[r].unit.length<32)){var a=this.decrypter.isSync();if(this.decryptAacSample(s,r,u,a),!a)return}}},_.getAvcEncryptedData=function(s){for(var r=Math.floor((s.length-48)/160)*16+16,u=new Int8Array(r),a=0,d=32;d<s.length-16;d+=160,a+=16)u.set(s.subarray(d,d+16),a);return u},_.getAvcDecryptedUnit=function(s,r){for(var u=new Uint8Array(r),a=0,d=32;d<s.length-16;d+=160,a+=16)s.set(u.subarray(a,a+16),d);return s},_.decryptAvcSample=function(s,r,u,a,d,c){var h=Object(p.discardEPB)(d.data),t=this.getAvcEncryptedData(h),e=this;this.decryptBuffer(t.buffer,function(n){d.data=e.getAvcDecryptedUnit(h,n),c||e.decryptAvcSamples(s,r,u+1,a)})},_.decryptAvcSamples=function(s,r,u,a){if(s instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;r++,u=0){if(r>=s.length){a();return}for(var d=s[r].units;!(u>=d.length);u++){var c=d[u];if(!(c.data.length<=48||c.type!==1&&c.type!==5)){var h=this.decrypter.isSync();if(this.decryptAvcSample(s,r,u,a,c,h),!h)return}}}},A}();C.default=m},"./src/demux/transmuxer-interface.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return u});var T=y("./node_modules/webworkify-webpack/index.js"),p=y("./src/events.ts"),m=y("./src/demux/transmuxer.ts"),A=y("./src/utils/logger.ts"),_=y("./src/errors.ts"),g=y("./src/utils/mediasource-helper.ts"),s=y("./node_modules/eventemitter3/index.js"),r=Object(g.getMediaSource)()||{isTypeSupported:function(){return!1}},u=function(){function a(c,h,t,e){var n=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=c,this.id=h,this.onTransmuxComplete=t,this.onFlush=e;var i=c.config,f=function(S,E){E=E||{},E.frag=n.frag,E.id=n.id,c.trigger(S,E)};this.observer=new s.EventEmitter,this.observer.on(p.Events.FRAG_DECRYPTED,f),this.observer.on(p.Events.ERROR,f);var l={mp4:r.isTypeSupported("video/mp4"),mpeg:r.isTypeSupported("audio/mpeg"),mp3:r.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(i.enableWorker&&typeof Worker<"u"){A.logger.log("demuxing in webworker");var v;try{v=this.worker=T("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(D){c.trigger(p.Events.ERROR,{type:_.ErrorTypes.OTHER_ERROR,details:_.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(D.message+"  ("+D.filename+":"+D.lineno+")")})},v.postMessage({cmd:"init",typeSupported:l,vendor:o,id:h,config:JSON.stringify(i)})}catch(D){A.logger.warn("Error in worker:",D),A.logger.error("Error while initializing DemuxerWorker, fallback to inline"),v&&self.URL.revokeObjectURL(v.objectURL),this.transmuxer=new m.default(this.observer,l,i,o,h),this.worker=null}}else this.transmuxer=new m.default(this.observer,l,i,o,h)}var d=a.prototype;return d.destroy=function(){var h=this.worker;if(h)h.removeEventListener("message",this.onwmsg),h.terminate(),this.worker=null,this.onwmsg=void 0;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},d.push=function(h,t,e,n,i,f,l,o,v,D){var S,E,L=this;v.transmuxing.start=self.performance.now();var x=this.transmuxer,b=this.worker,O=f?f.start:i.start,R=i.decryptdata,I=this.frag,P=!(I&&i.cc===I.cc),F=!(I&&v.level===I.level),w=I?v.sn-I.sn:-1,k=this.part?v.part-this.part.index:-1,B=w===0&&v.id>1&&v.id===(I==null?void 0:I.stats.chunkCount),U=!F&&(w===1||w===0&&(k===1||B&&k<=0)),j=self.performance.now();(F||w||i.stats.parsing.start===0)&&(i.stats.parsing.start=j),f&&(k||!U)&&(f.stats.parsing.start=j);var N=!(I&&((S=i.initSegment)===null||S===void 0?void 0:S.url)===((E=I.initSegment)===null||E===void 0?void 0:E.url)),K=new m.TransmuxState(P,U,o,F,O,N);if(!U||P||N){A.logger.log("[transmuxer-interface, "+i.type+"]: Starting new transmux session for sn: "+v.sn+" p: "+v.part+" level: "+v.level+" id: "+v.id+`
        discontinuity: `+P+`
        trackSwitch: `+F+`
        contiguous: `+U+`
        accurateTimeOffset: `+o+`
        timeOffset: `+O+`
        initSegmentChange: `+N);var H=new m.TransmuxConfig(e,n,t,l,D);this.configureTransmuxer(H)}if(this.frag=i,this.part=f,b)b.postMessage({cmd:"demux",data:h,decryptdata:R,chunkMeta:v,state:K},h instanceof ArrayBuffer?[h]:[]);else if(x){var $=x.push(h,R,v,K);Object(m.isPromise)($)?$.then(function(G){L.handleTransmuxComplete(G)}):this.handleTransmuxComplete($)}},d.flush=function(h){var t=this;h.transmuxing.start=self.performance.now();var e=this.transmuxer,n=this.worker;if(n)n.postMessage({cmd:"flush",chunkMeta:h});else if(e){var i=e.flush(h);Object(m.isPromise)(i)?i.then(function(f){t.handleFlushResult(f,h)}):this.handleFlushResult(i,h)}},d.handleFlushResult=function(h,t){var e=this;h.forEach(function(n){e.handleTransmuxComplete(n)}),this.onFlush(t)},d.onWorkerMessage=function(h){var t=h.data,e=this.hls;switch(t.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":A.logger[t.data.logType]&&A.logger[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,e.trigger(t.event,t.data);break}}},d.configureTransmuxer=function(h){var t=this.worker,e=this.transmuxer;t?t.postMessage({cmd:"configure",config:h}):e&&e.configure(h)},d.handleTransmuxComplete=function(h){h.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(h)},a}()},"./src/demux/transmuxer-worker.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return _});var T=y("./src/demux/transmuxer.ts"),p=y("./src/events.ts"),m=y("./src/utils/logger.ts"),A=y("./node_modules/eventemitter3/index.js");function _(a){var d=new A.EventEmitter,c=function(e,n){a.postMessage({event:e,data:n})};d.on(p.Events.FRAG_DECRYPTED,c),d.on(p.Events.ERROR,c);var h=function(){var e=function(f){var l=function(v){c("workerLog",{logType:f,message:v})};m.logger[f]=l};for(var n in m.logger)e(n)};a.addEventListener("message",function(t){var e=t.data;switch(e.cmd){case"init":{var n=JSON.parse(e.config);a.transmuxer=new T.default(d,e.typeSupported,n,e.vendor,e.id),Object(m.enableLogs)(n.debug),h(),c("init",null);break}case"configure":{a.transmuxer.configure(e.config);break}case"demux":{var i=a.transmuxer.push(e.data,e.decryptdata,e.chunkMeta,e.state);Object(T.isPromise)(i)?i.then(function(o){g(a,o)}):g(a,i);break}case"flush":{var f=e.chunkMeta,l=a.transmuxer.flush(f);Object(T.isPromise)(l)?l.then(function(o){r(a,o,f)}):r(a,l,f);break}}})}function g(a,d){if(u(d.remuxResult))return!1;var c=[],h=d.remuxResult,t=h.audio,e=h.video;return t&&s(c,t),e&&s(c,e),a.postMessage({event:"transmuxComplete",data:d},c),!0}function s(a,d){d.data1&&a.push(d.data1.buffer),d.data2&&a.push(d.data2.buffer)}function r(a,d,c){var h=d.reduce(function(t,e){return g(a,e)||t},!1);h||a.postMessage({event:"transmuxComplete",data:d[0]}),a.postMessage({event:"flush",data:c})}function u(a){return!a.audio&&!a.video&&!a.text&&!a.id3&&!a.initSegment}},"./src/demux/transmuxer.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return n}),y.d(C,"isPromise",function(){return l}),y.d(C,"TransmuxConfig",function(){return o}),y.d(C,"TransmuxState",function(){return v});var T=y("./src/events.ts"),p=y("./src/errors.ts"),m=y("./src/crypt/decrypter.ts"),A=y("./src/demux/aacdemuxer.ts"),_=y("./src/demux/mp4demuxer.ts"),g=y("./src/demux/tsdemuxer.ts"),s=y("./src/demux/mp3demuxer.ts"),r=y("./src/remux/mp4-remuxer.ts"),u=y("./src/remux/passthrough-remuxer.ts"),a=y("./src/demux/chunk-cache.ts"),d=y("./src/utils/mp4-tools.ts"),c=y("./src/utils/logger.ts"),h;try{h=self.performance.now.bind(self.performance)}catch{c.logger.debug("Unable to use Performance API on this environment"),h=self.Date.now}var t=[{demux:g.default,remux:r.default},{demux:_.default,remux:u.default},{demux:A.default,remux:r.default},{demux:s.default,remux:r.default}],e=1024;t.forEach(function(D){var S=D.demux;e=Math.max(e,S.minProbeByteLength)});var n=function(){function D(E,L,x,b,O){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new a.default,this.observer=E,this.typeSupported=L,this.config=x,this.vendor=b,this.id=O}var S=D.prototype;return S.configure=function(L){this.transmuxConfig=L,this.decrypter&&this.decrypter.reset()},S.push=function(L,x,b,O){var R=this,I=b.transmuxing;I.executeStart=h();var P=new Uint8Array(L),F=this.cache,w=this.config,k=this.currentTransmuxState,B=this.transmuxConfig;O&&(this.currentTransmuxState=O);var U=i(P,x);if(U&&U.method==="AES-128"){var j=this.getDecrypter();if(w.enableSoftwareAES){var N=j.softwareDecrypt(P,U.key.buffer,U.iv.buffer);if(!N)return I.executeEnd=h(),f(b);P=new Uint8Array(N)}else return this.decryptionPromise=j.webCryptoDecrypt(P,U.key.buffer,U.iv.buffer).then(function(oe){var de=R.push(oe,null,b);return R.decryptionPromise=null,de}),this.decryptionPromise}var K=O||k,H=K.contiguous,$=K.discontinuity,G=K.trackSwitch,ee=K.accurateTimeOffset,X=K.timeOffset,V=K.initSegmentChange,J=B.audioCodec,Q=B.videoCodec,ie=B.defaultInitPts,ae=B.duration,se=B.initSegmentData;if(($||G||V)&&this.resetInitSegment(se,J,Q,ae),($||V)&&this.resetInitialTimestamp(ie),H||this.resetContiguity(),this.needsProbing(P,$,G)){if(F.dataLength){var le=F.flush();P=Object(d.appendUint8Array)(le,P)}this.configureTransmuxer(P,B)}var ue=this.transmux(P,U,X,ee,b),q=this.currentTransmuxState;return q.contiguous=!0,q.discontinuity=!1,q.trackSwitch=!1,I.executeEnd=h(),ue},S.flush=function(L){var x=this,b=L.transmuxing;b.executeStart=h();var O=this.decrypter,R=this.cache,I=this.currentTransmuxState,P=this.decryptionPromise;if(P)return P.then(function(){return x.flush(L)});var F=[],w=I.timeOffset;if(O){var k=O.flush();k&&F.push(this.push(k,null,L))}var B=R.dataLength;R.reset();var U=this.demuxer,j=this.remuxer;if(!U||!j)return B>=e&&this.observer.emit(T.Events.ERROR,T.Events.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),b.executeEnd=h(),[f(L)];var N=U.flush(w);return l(N)?N.then(function(K){return x.flushRemux(F,K,L),F}):(this.flushRemux(F,N,L),F)},S.flushRemux=function(L,x,b){var O=x.audioTrack,R=x.videoTrack,I=x.id3Track,P=x.textTrack,F=this.currentTransmuxState,w=F.accurateTimeOffset,k=F.timeOffset;c.logger.log("[transmuxer.ts]: Flushed fragment "+b.sn+(b.part>-1?" p: "+b.part:"")+" of level "+b.level);var B=this.remuxer.remux(O,R,I,P,k,w,!0,this.id);L.push({remuxResult:B,chunkMeta:b}),b.transmuxing.executeEnd=h()},S.resetInitialTimestamp=function(L){var x=this.demuxer,b=this.remuxer;!x||!b||(x.resetTimeStamp(L),b.resetTimeStamp(L))},S.resetContiguity=function(){var L=this.demuxer,x=this.remuxer;!L||!x||(L.resetContiguity(),x.resetNextTimestamp())},S.resetInitSegment=function(L,x,b,O){var R=this.demuxer,I=this.remuxer;!R||!I||(R.resetInitSegment(L,x,b,O),I.resetInitSegment(L,x,b))},S.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},S.transmux=function(L,x,b,O,R){var I;return x&&x.method==="SAMPLE-AES"?I=this.transmuxSampleAes(L,x,b,O,R):I=this.transmuxUnencrypted(L,b,O,R),I},S.transmuxUnencrypted=function(L,x,b,O){var R=this.demuxer.demux(L,x,!1,!this.config.progressive),I=R.audioTrack,P=R.videoTrack,F=R.id3Track,w=R.textTrack,k=this.remuxer.remux(I,P,F,w,x,b,!1,this.id);return{remuxResult:k,chunkMeta:O}},S.transmuxSampleAes=function(L,x,b,O,R){var I=this;return this.demuxer.demuxSampleAes(L,x,b).then(function(P){var F=I.remuxer.remux(P.audioTrack,P.videoTrack,P.id3Track,P.textTrack,b,O,!1,I.id);return{remuxResult:F,chunkMeta:R}})},S.configureTransmuxer=function(L,x){for(var b=this.config,O=this.observer,R=this.typeSupported,I=this.vendor,P=x.audioCodec,F=x.defaultInitPts,w=x.duration,k=x.initSegmentData,B=x.videoCodec,U,j=0,N=t.length;j<N;j++)if(t[j].demux.probe(L)){U=t[j];break}U||(c.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),U={demux:_.default,remux:u.default});var K=this.demuxer,H=this.remuxer,$=U.remux,G=U.demux;(!H||!(H instanceof $))&&(this.remuxer=new $(O,b,R,I)),(!K||!(K instanceof G))&&(this.demuxer=new G(O,b,R),this.probe=G.probe),this.resetInitSegment(k,P,B,w),this.resetInitialTimestamp(F)},S.needsProbing=function(L,x,b){return!this.demuxer||!this.remuxer||x||b},S.getDecrypter=function(){var L=this.decrypter;return L||(L=this.decrypter=new m.default(this.observer,this.config)),L},D}();function i(D,S){var E=null;return D.byteLength>0&&S!=null&&S.key!=null&&S.iv!==null&&S.method!=null&&(E=S),E}var f=function(S){return{remuxResult:{},chunkMeta:S}};function l(D){return"then"in D&&D.then instanceof Function}var o=function(S,E,L,x,b){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=S,this.videoCodec=E,this.initSegmentData=L,this.duration=x,this.defaultInitPts=b},v=function(S,E,L,x,b,O){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=S,this.contiguous=E,this.accurateTimeOffset=L,this.trackSwitch=x,this.timeOffset=b,this.initSegmentChange=O}},"./src/demux/tsdemuxer.ts":function(M,C,y){y.r(C),y.d(C,"discardEPB",function(){return i});var T=y("./src/demux/adts.ts"),p=y("./src/demux/mpegaudio.ts"),m=y("./src/demux/exp-golomb.ts"),A=y("./src/demux/sample-aes.ts"),_=y("./src/events.ts"),g=y("./src/utils/mp4-tools.ts"),s=y("./src/utils/logger.ts"),r=y("./src/errors.ts"),u=y("./src/types/demuxer.ts");function a(){return a=Object.assign?Object.assign.bind():function(f){for(var l=1;l<arguments.length;l++){var o=arguments[l];for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&(f[v]=o[v])}return f},a.apply(this,arguments)}var d=function(){function f(o,v,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=o,this.config=v,this.typeSupported=D}f.probe=function(v){var D=f.syncOffset(v);return D<0?!1:(D&&s.logger.warn("MPEG2-TS detected but first sync word found @ offset "+D+", junk ahead ?"),!0)},f.syncOffset=function(v){for(var D=Math.min(1e3,v.length-564),S=0;S<D;){if(v[S]===71&&v[S+188]===71&&v[S+2*188]===71)return S;S++}return-1},f.createTrack=function(v,D){return{container:v==="video"||v==="audio"?"video/mp2t":void 0,type:v,id:g.RemuxerTrackIdConfig[v],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:v==="audio"?D:void 0}};var l=f.prototype;return l.resetInitSegment=function(v,D,S,E){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=f.createTrack("video"),this._audioTrack=f.createTrack("audio",E),this._id3Track=f.createTrack("id3"),this._txtTrack=f.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.audioCodec=D,this.videoCodec=S,this._duration=E},l.resetTimeStamp=function(){},l.resetContiguity=function(){var v=this._audioTrack,D=this._avcTrack,S=this._id3Track;v&&(v.pesData=null),D&&(D.pesData=null),S&&(S.pesData=null),this.aacOverFlow=null},l.demux=function(v,D,S,E){S===void 0&&(S=!1),E===void 0&&(E=!1),S||(this.sampleAes=null);var L,x=this._avcTrack,b=this._audioTrack,O=this._id3Track,R=this._txtTrack,I=x.pid,P=x.pesData,F=b.pid,w=O.pid,k=b.pesData,B=O.pesData,U=!1,j=this.pmtParsed,N=this._pmtId,K=v.length;if(this.remainderData&&(v=Object(g.appendUint8Array)(this.remainderData,v),K=v.length,this.remainderData=null),K<188&&!E)return this.remainderData=v,{audioTrack:b,videoTrack:x,id3Track:O,textTrack:R};var H=Math.max(0,f.syncOffset(v));K-=(K+H)%188,K<v.byteLength&&!E&&(this.remainderData=new Uint8Array(v.buffer,K,v.buffer.byteLength-K));for(var $=0,G=H;G<K;G+=188)if(v[G]===71){var ee=!!(v[G+1]&64),X=((v[G+1]&31)<<8)+v[G+2],V=(v[G+3]&48)>>4,J=void 0;if(V>1){if(J=G+5+v[G+4],J===G+188)continue}else J=G+4;switch(X){case I:ee&&(P&&(L=e(P))&&this.parseAVCPES(x,R,L,!1),P={data:[],size:0}),P&&(P.data.push(v.subarray(J,G+188)),P.size+=G+188-J);break;case F:if(ee){if(k&&(L=e(k)))switch(b.segmentCodec){case"aac":this.parseAACPES(b,L);break;case"mp3":this.parseMPEGPES(b,L);break}k={data:[],size:0}}k&&(k.data.push(v.subarray(J,G+188)),k.size+=G+188-J);break;case w:ee&&(B&&(L=e(B))&&this.parseID3PES(O,L),B={data:[],size:0}),B&&(B.data.push(v.subarray(J,G+188)),B.size+=G+188-J);break;case 0:ee&&(J+=v[J]+1),N=this._pmtId=h(v,J);break;case N:{ee&&(J+=v[J]+1);var Q=t(v,J,this.typeSupported,S);I=Q.avc,I>0&&(x.pid=I),F=Q.audio,F>0&&(b.pid=F,b.segmentCodec=Q.segmentCodec),w=Q.id3,w>0&&(O.pid=w),U&&!j&&(s.logger.log("reparse from beginning"),U=!1,G=H-188),j=this.pmtParsed=!0;break}case 17:case 8191:break;default:U=!0;break}}else $++;$>0&&this.observer.emit(_.Events.ERROR,_.Events.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+$+" TS packet/s that do not start with 0x47"}),x.pesData=P,b.pesData=k,O.pesData=B;var ie={audioTrack:b,videoTrack:x,id3Track:O,textTrack:R};return E&&this.extractRemainingSamples(ie),ie},l.flush=function(){var v=this.remainderData;this.remainderData=null;var D;return v?D=this.demux(v,-1,!1,!0):D={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},l.extractRemainingSamples=function(v){var D=v.audioTrack,S=v.videoTrack,E=v.id3Track,L=v.textTrack,x=S.pesData,b=D.pesData,O=E.pesData,R;if(x&&(R=e(x))?(this.parseAVCPES(S,L,R,!0),S.pesData=null):S.pesData=x,b&&(R=e(b))){switch(D.segmentCodec){case"aac":this.parseAACPES(D,R);break;case"mp3":this.parseMPEGPES(D,R);break}D.pesData=null}else b!=null&&b.size&&s.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=b;O&&(R=e(O))?(this.parseID3PES(E,R),E.pesData=null):E.pesData=O},l.demuxSampleAes=function(v,D,S){var E=this.demux(v,S,!0,!this.config.progressive),L=this.sampleAes=new A.default(this.observer,this.config,D);return this.decrypt(E,L)},l.decrypt=function(v,D){return new Promise(function(S){var E=v.audioTrack,L=v.videoTrack;E.samples&&E.segmentCodec==="aac"?D.decryptAacSamples(E.samples,0,function(){L.samples?D.decryptAvcSamples(L.samples,0,0,function(){S(v)}):S(v)}):L.samples&&D.decryptAvcSamples(L.samples,0,0,function(){S(v)})})},l.destroy=function(){this._duration=0},l.parseAVCPES=function(v,D,S,E){var L=this,x=this.parseAVCNALu(v,S.data),b=this.avcSample,O,R=!1;S.data=null,b&&x.length&&!v.audFound&&(n(b,v),b=this.avcSample=c(!1,S.pts,S.dts,"")),x.forEach(function(I){switch(I.type){case 1:{O=!0,b||(b=L.avcSample=c(!0,S.pts,S.dts,"")),b.frame=!0;var P=I.data;if(R&&P.length>4){var F=new m.default(P).readSliceType();(F===2||F===4||F===7||F===9)&&(b.key=!0)}break}case 5:O=!0,b||(b=L.avcSample=c(!0,S.pts,S.dts,"")),b.key=!0,b.frame=!0;break;case 6:{O=!0,Object(g.parseSEIMessageFromNALu)(i(I.data),S.pts,D.samples);break}case 7:if(O=!0,R=!0,!v.sps){var w=new m.default(I.data),k=w.readSPS();v.width=k.width,v.height=k.height,v.pixelRatio=k.pixelRatio,v.sps=[I.data],v.duration=L._duration;for(var B=I.data.subarray(1,4),U="avc1.",j=0;j<3;j++){var N=B[j].toString(16);N.length<2&&(N="0"+N),U+=N}v.codec=U}break;case 8:O=!0,v.pps||(v.pps=[I.data]);break;case 9:O=!1,v.audFound=!0,b&&n(b,v),b=L.avcSample=c(!1,S.pts,S.dts,"");break;case 12:O=!0;break;default:O=!1,b&&(b.debug+="unknown NAL "+I.type+" ");break}if(b&&O){var K=b.units;K.push(I)}}),E&&b&&(n(b,v),this.avcSample=null)},l.getLastNalUnit=function(v){var D,S=this.avcSample,E;if((!S||S.units.length===0)&&(S=v[v.length-1]),(D=S)!==null&&D!==void 0&&D.units){var L=S.units;E=L[L.length-1]}return E},l.parseAVCNALu=function(v,D){var S=D.byteLength,E=v.naluState||0,L=E,x=[],b=0,O,R,I,P=-1,F=0;for(E===-1&&(P=0,F=D[0]&31,E=0,b=1);b<S;){if(O=D[b++],!E){E=O?0:1;continue}if(E===1){E=O?0:2;continue}if(!O)E=3;else if(O===1){if(P>=0){var w={data:D.subarray(P,b-E-1),type:F};x.push(w)}else{var k=this.getLastNalUnit(v.samples);if(k&&(L&&b<=4-L&&k.state&&(k.data=k.data.subarray(0,k.data.byteLength-L)),R=b-E-1,R>0)){var B=new Uint8Array(k.data.byteLength+R);B.set(k.data,0),B.set(D.subarray(0,R),k.data.byteLength),k.data=B,k.state=0}}b<S?(I=D[b]&31,P=b,F=I,E=0):E=-1}else E=0}if(P>=0&&E>=0){var U={data:D.subarray(P,S),type:F,state:E};x.push(U)}if(x.length===0){var j=this.getLastNalUnit(v.samples);if(j){var N=new Uint8Array(j.data.byteLength+D.byteLength);N.set(j.data,0),N.set(D,j.data.byteLength),j.data=N}}return v.naluState=E,x},l.parseAACPES=function(v,D){var S=0,E=this.aacOverFlow,L=D.data;if(E){this.aacOverFlow=null;var x=E.missing,b=E.sample.unit.byteLength;if(x===-1){var O=new Uint8Array(b+L.byteLength);O.set(E.sample.unit,0),O.set(L,b),L=O}else{var R=b-x;E.sample.unit.set(L.subarray(0,x),R),v.samples.push(E.sample),S=E.missing}}var I,P;for(I=S,P=L.length;I<P-1&&!T.isHeader(L,I);I++);if(I!==S){var F,w;if(I<P-1?(F="AAC PES did not start with ADTS header,offset:"+I,w=!1):(F="no ADTS header found in AAC PES",w=!0),s.logger.warn("parsing error:"+F),this.observer.emit(_.Events.ERROR,_.Events.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:w,reason:F}),w)return}T.initTrackConfig(v,this.observer,L,I,this.audioCodec);var k;if(D.pts!==void 0)k=D.pts;else if(E){var B=T.getFrameDuration(v.samplerate);k=E.sample.pts+B}else{s.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var U=0,j;I<P;)if(j=T.appendFrame(v,L,I,k,U),I+=j.length,j.missing){this.aacOverFlow=j;break}else for(U++;I<P-1&&!T.isHeader(L,I);I++);},l.parseMPEGPES=function(v,D){var S=D.data,E=S.length,L=0,x=0,b=D.pts;if(b===void 0){s.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;x<E;)if(p.isHeader(S,x)){var O=p.appendFrame(v,S,x,b,L);if(O)x+=O.length,L++;else break}else x++},l.parseID3PES=function(v,D){if(D.pts===void 0){s.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var S=a({},D,{type:this._avcTrack?u.MetadataSchema.emsg:u.MetadataSchema.audioId3});v.samples.push(S)},f}();d.minProbeByteLength=188;function c(f,l,o,v){return{key:f,frame:!1,pts:l,dts:o,units:[],debug:v,length:0}}function h(f,l){return(f[l+10]&31)<<8|f[l+11]}function t(f,l,o,v){var D={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},S=(f[l+1]&15)<<8|f[l+2],E=l+3+S-4,L=(f[l+10]&15)<<8|f[l+11];for(l+=12+L;l<E;){var x=(f[l+1]&31)<<8|f[l+2];switch(f[l]){case 207:if(!v){s.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=x);break;case 21:D.id3===-1&&(D.id3=x);break;case 219:if(!v){s.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=x);break;case 3:case 4:o.mpeg!==!0&&o.mp3!==!0?s.logger.log("MPEG audio found, not supported in this browser"):D.audio===-1&&(D.audio=x,D.segmentCodec="mp3");break;case 36:s.logger.warn("Unsupported HEVC stream type found");break}l+=((f[l+3]&15)<<8|f[l+4])+5}return D}function e(f){var l=0,o,v,D,S,E,L=f.data;if(!f||f.size===0)return null;for(;L[0].length<19&&L.length>1;){var x=new Uint8Array(L[0].length+L[1].length);x.set(L[0]),x.set(L[1],L[0].length),L[0]=x,L.splice(1,1)}o=L[0];var b=(o[0]<<16)+(o[1]<<8)+o[2];if(b===1){if(v=(o[4]<<8)+o[5],v&&v>f.size-6)return null;var O=o[7];O&192&&(S=(o[9]&14)*536870912+(o[10]&255)*4194304+(o[11]&254)*16384+(o[12]&255)*128+(o[13]&254)/2,O&64?(E=(o[14]&14)*536870912+(o[15]&255)*4194304+(o[16]&254)*16384+(o[17]&255)*128+(o[18]&254)/2,S-E>60*9e4&&(s.logger.warn(Math.round((S-E)/9e4)+"s delta between PTS and DTS, align them"),S=E)):E=S),D=o[8];var R=D+9;if(f.size<=R)return null;f.size-=R;for(var I=new Uint8Array(f.size),P=0,F=L.length;P<F;P++){o=L[P];var w=o.byteLength;if(R)if(R>w){R-=w;continue}else o=o.subarray(R),w-=R,R=0;I.set(o,l),l+=w}return v&&(v-=D+3),{data:I,pts:S,dts:E,len:v}}return null}function n(f,l){if(f.units.length&&f.frame){if(f.pts===void 0){var o=l.samples,v=o.length;if(v){var D=o[v-1];f.pts=D.pts,f.dts=D.dts}else{l.dropped++;return}}l.samples.push(f)}f.debug.length&&s.logger.log(f.pts+"/"+f.dts+":"+f.debug)}function i(f){for(var l=f.byteLength,o=[],v=1;v<l-2;)f[v]===0&&f[v+1]===0&&f[v+2]===3?(o.push(v+2),v+=2):v++;if(o.length===0)return f;var D=l-o.length,S=new Uint8Array(D),E=0;for(v=0;v<D;E++,v++)E===o[0]&&(E++,o.shift()),S[v]=f[E];return S}C.default=d},"./src/errors.ts":function(M,C,y){y.r(C),y.d(C,"ErrorTypes",function(){return T}),y.d(C,"ErrorDetails",function(){return p});var T;(function(m){m.NETWORK_ERROR="networkError",m.MEDIA_ERROR="mediaError",m.KEY_SYSTEM_ERROR="keySystemError",m.MUX_ERROR="muxError",m.OTHER_ERROR="otherError"})(T||(T={}));var p;(function(m){m.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",m.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",m.KEY_SYSTEM_NO_SESSION="keySystemNoSession",m.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",m.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",m.MANIFEST_LOAD_ERROR="manifestLoadError",m.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",m.MANIFEST_PARSING_ERROR="manifestParsingError",m.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",m.LEVEL_EMPTY_ERROR="levelEmptyError",m.LEVEL_LOAD_ERROR="levelLoadError",m.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",m.LEVEL_SWITCH_ERROR="levelSwitchError",m.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",m.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",m.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",m.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",m.FRAG_LOAD_ERROR="fragLoadError",m.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",m.FRAG_DECRYPT_ERROR="fragDecryptError",m.FRAG_PARSING_ERROR="fragParsingError",m.REMUX_ALLOC_ERROR="remuxAllocError",m.KEY_LOAD_ERROR="keyLoadError",m.KEY_LOAD_TIMEOUT="keyLoadTimeOut",m.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",m.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",m.BUFFER_APPEND_ERROR="bufferAppendError",m.BUFFER_APPENDING_ERROR="bufferAppendingError",m.BUFFER_STALLED_ERROR="bufferStalledError",m.BUFFER_FULL_ERROR="bufferFullError",m.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",m.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",m.INTERNAL_EXCEPTION="internalException",m.INTERNAL_ABORTED="aborted",m.UNKNOWN="unknown"})(p||(p={}))},"./src/events.ts":function(M,C,y){y.r(C),y.d(C,"Events",function(){return T});var T;(function(p){p.MEDIA_ATTACHING="hlsMediaAttaching",p.MEDIA_ATTACHED="hlsMediaAttached",p.MEDIA_DETACHING="hlsMediaDetaching",p.MEDIA_DETACHED="hlsMediaDetached",p.BUFFER_RESET="hlsBufferReset",p.BUFFER_CODECS="hlsBufferCodecs",p.BUFFER_CREATED="hlsBufferCreated",p.BUFFER_APPENDING="hlsBufferAppending",p.BUFFER_APPENDED="hlsBufferAppended",p.BUFFER_EOS="hlsBufferEos",p.BUFFER_FLUSHING="hlsBufferFlushing",p.BUFFER_FLUSHED="hlsBufferFlushed",p.MANIFEST_LOADING="hlsManifestLoading",p.MANIFEST_LOADED="hlsManifestLoaded",p.MANIFEST_PARSED="hlsManifestParsed",p.LEVEL_SWITCHING="hlsLevelSwitching",p.LEVEL_SWITCHED="hlsLevelSwitched",p.LEVEL_LOADING="hlsLevelLoading",p.LEVEL_LOADED="hlsLevelLoaded",p.LEVEL_UPDATED="hlsLevelUpdated",p.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",p.LEVELS_UPDATED="hlsLevelsUpdated",p.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",p.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",p.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",p.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",p.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",p.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",p.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",p.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",p.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",p.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",p.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",p.CUES_PARSED="hlsCuesParsed",p.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",p.INIT_PTS_FOUND="hlsInitPtsFound",p.FRAG_LOADING="hlsFragLoading",p.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",p.FRAG_LOADED="hlsFragLoaded",p.FRAG_DECRYPTED="hlsFragDecrypted",p.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",p.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",p.FRAG_PARSING_METADATA="hlsFragParsingMetadata",p.FRAG_PARSED="hlsFragParsed",p.FRAG_BUFFERED="hlsFragBuffered",p.FRAG_CHANGED="hlsFragChanged",p.FPS_DROP="hlsFpsDrop",p.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",p.ERROR="hlsError",p.DESTROYING="hlsDestroying",p.KEY_LOADING="hlsKeyLoading",p.KEY_LOADED="hlsKeyLoaded",p.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",p.BACK_BUFFER_REACHED="hlsBackBufferReached"})(T||(T={}))},"./src/hls.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return i});var T=y("./node_modules/url-toolkit/src/url-toolkit.js"),p=y("./src/loader/playlist-loader.ts"),m=y("./src/loader/key-loader.ts"),A=y("./src/controller/id3-track-controller.ts"),_=y("./src/controller/latency-controller.ts"),g=y("./src/controller/level-controller.ts"),s=y("./src/controller/fragment-tracker.ts"),r=y("./src/controller/stream-controller.ts"),u=y("./src/is-supported.ts"),a=y("./src/utils/logger.ts"),d=y("./src/config.ts"),c=y("./node_modules/eventemitter3/index.js"),h=y("./src/events.ts"),t=y("./src/errors.ts");function e(f,l){for(var o=0;o<l.length;o++){var v=l[o];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}function n(f,l,o){return l&&e(f.prototype,l),o&&e(f,o),Object.defineProperty(f,"prototype",{writable:!1}),f}var i=function(){f.isSupported=function(){return Object(u.isSupported)()};function f(o){o===void 0&&(o={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new c.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var v=this.config=Object(d.mergeConfig)(f.DefaultConfig,o);this.userConfig=o,Object(a.enableLogs)(v.debug),this._autoLevelCapping=-1,v.progressive&&Object(d.enableStreamingMode)(v);var D=v.abrController,S=v.bufferController,E=v.capLevelController,L=v.fpsController,x=this.abrController=new D(this),b=this.bufferController=new S(this),O=this.capLevelController=new E(this),R=new L(this),I=new p.default(this),P=new m.default(this),F=new A.default(this),w=this.levelController=new g.default(this),k=new s.FragmentTracker(this),B=this.streamController=new r.default(this,k);O.setStreamController(B),R.setStreamController(B);var U=[w,B];this.networkControllers=U;var j=[I,P,x,b,O,R,F,k];this.audioTrackController=this.createController(v.audioTrackController,null,U),this.createController(v.audioStreamController,k,U),this.subtitleTrackController=this.createController(v.subtitleTrackController,null,U),this.createController(v.subtitleStreamController,k,U),this.createController(v.timelineController,null,j),this.emeController=this.createController(v.emeController,null,j),this.cmcdController=this.createController(v.cmcdController,null,j),this.latencyController=this.createController(_.default,null,j),this.coreComponents=j}var l=f.prototype;return l.createController=function(v,D,S){if(v){var E=D?new v(this,D):new v(this);return S&&S.push(E),E}return null},l.on=function(v,D,S){S===void 0&&(S=this),this._emitter.on(v,D,S)},l.once=function(v,D,S){S===void 0&&(S=this),this._emitter.once(v,D,S)},l.removeAllListeners=function(v){this._emitter.removeAllListeners(v)},l.off=function(v,D,S,E){S===void 0&&(S=this),this._emitter.off(v,D,S,E)},l.listeners=function(v){return this._emitter.listeners(v)},l.emit=function(v,D,S){return this._emitter.emit(v,D,S)},l.trigger=function(v,D){if(this.config.debug)return this.emit(v,v,D);try{return this.emit(v,v,D)}catch(S){a.logger.error("An internal error happened while handling event "+v+'. Error message: "'+S.message+'". Here is a stacktrace:',S),this.trigger(h.Events.ERROR,{type:t.ErrorTypes.OTHER_ERROR,details:t.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:v,error:S})}return!1},l.listenerCount=function(v){return this._emitter.listenerCount(v)},l.destroy=function(){a.logger.log("destroy"),this.trigger(h.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(v){return v.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(v){return v.destroy()}),this.coreComponents.length=0},l.attachMedia=function(v){a.logger.log("attachMedia"),this._media=v,this.trigger(h.Events.MEDIA_ATTACHING,{media:v})},l.detachMedia=function(){a.logger.log("detachMedia"),this.trigger(h.Events.MEDIA_DETACHING,void 0),this._media=null},l.loadSource=function(v){this.stopLoad();var D=this.media,S=this.url,E=this.url=T.buildAbsoluteURL(self.location.href,v,{alwaysNormalize:!0});a.logger.log("loadSource:"+E),D&&S&&S!==E&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(D)),this.trigger(h.Events.MANIFEST_LOADING,{url:v})},l.startLoad=function(v){v===void 0&&(v=-1),a.logger.log("startLoad("+v+")"),this.networkControllers.forEach(function(D){D.startLoad(v)})},l.stopLoad=function(){a.logger.log("stopLoad"),this.networkControllers.forEach(function(v){v.stopLoad()})},l.swapAudioCodec=function(){a.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},l.recoverMediaError=function(){a.logger.log("recoverMediaError");var v=this._media;this.detachMedia(),v&&this.attachMedia(v)},l.removeLevel=function(v,D){D===void 0&&(D=0),this.levelController.removeLevel(v,D)},n(f,[{key:"levels",get:function(){var v=this.levelController.levels;return v||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(v){a.logger.log("set currentLevel:"+v),this.loadLevel=v,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(v){a.logger.log("set nextLevel:"+v),this.levelController.manualLevel=v,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(v){a.logger.log("set loadLevel:"+v),this.levelController.manualLevel=v}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(v){this.levelController.nextLoadLevel=v}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(v){a.logger.log("set firstLevel:"+v),this.levelController.firstLevel=v}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(v){a.logger.log("set startLevel:"+v),v!==-1&&(v=Math.max(v,this.minAutoLevel)),this.levelController.startLevel=v}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(v){var D=!!v;D!==this.config.capLevelToPlayerSize&&(D?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=D)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(v){this._autoLevelCapping!==v&&(a.logger.log("set autoLevelCapping:"+v),this._autoLevelCapping=v)}},{key:"bandwidthEstimate",get:function(){var v=this.abrController.bwEstimator;return v?v.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var v=this.levels,D=this.config.minAutoBitrate;if(!v)return 0;for(var S=v.length,E=0;E<S;E++)if(v[E].maxBitrate>=D)return E;return 0}},{key:"maxAutoLevel",get:function(){var v=this.levels,D=this.autoLevelCapping,S;return D===-1&&v&&v.length?S=v.length-1:S=D,S}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(v){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,v)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"audioTracks",get:function(){var v=this.audioTrackController;return v?v.audioTracks:[]}},{key:"audioTrack",get:function(){var v=this.audioTrackController;return v?v.audioTrack:-1},set:function(v){var D=this.audioTrackController;D&&(D.audioTrack=v)}},{key:"subtitleTracks",get:function(){var v=this.subtitleTrackController;return v?v.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var v=this.subtitleTrackController;return v?v.subtitleTrack:-1},set:function(v){var D=this.subtitleTrackController;D&&(D.subtitleTrack=v)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var v=this.subtitleTrackController;return v?v.subtitleDisplay:!1},set:function(v){var D=this.subtitleTrackController;D&&(D.subtitleDisplay=v)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(v){this.config.lowLatencyMode=v}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.1"}},{key:"Events",get:function(){return h.Events}},{key:"ErrorTypes",get:function(){return t.ErrorTypes}},{key:"ErrorDetails",get:function(){return t.ErrorDetails}},{key:"DefaultConfig",get:function(){return f.defaultConfig?f.defaultConfig:d.hlsDefaultConfig},set:function(v){f.defaultConfig=v}}]),f}();i.defaultConfig=void 0},"./src/is-supported.ts":function(M,C,y){y.r(C),y.d(C,"isSupported",function(){return m}),y.d(C,"changeTypeSupported",function(){return A});var T=y("./src/utils/mediasource-helper.ts");function p(){return self.SourceBuffer||self.WebKitSourceBuffer}function m(){var _=Object(T.getMediaSource)();if(!_)return!1;var g=p(),s=_&&typeof _.isTypeSupported=="function"&&_.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!g||g.prototype&&typeof g.prototype.appendBuffer=="function"&&typeof g.prototype.remove=="function";return!!s&&!!r}function A(){var _,g=p();return typeof(g==null||(_=g.prototype)===null||_===void 0?void 0:_.changeType)=="function"}},"./src/loader/date-range.ts":function(M,C,y){y.r(C),y.d(C,"DateRangeAttribute",function(){return s}),y.d(C,"DateRange",function(){return r});var T=y("./src/polyfills/number.ts"),p=y("./src/utils/attr-list.ts"),m=y("./src/utils/logger.ts");function A(){return A=Object.assign?Object.assign.bind():function(u){for(var a=1;a<arguments.length;a++){var d=arguments[a];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(u[c]=d[c])}return u},A.apply(this,arguments)}function _(u,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(u,c.key,c)}}function g(u,a,d){return a&&_(u.prototype,a),d&&_(u,d),Object.defineProperty(u,"prototype",{writable:!1}),u}var s;(function(u){u.ID="ID",u.CLASS="CLASS",u.START_DATE="START-DATE",u.DURATION="DURATION",u.END_DATE="END-DATE",u.END_ON_NEXT="END-ON-NEXT",u.PLANNED_DURATION="PLANNED-DURATION",u.SCTE35_OUT="SCTE35-OUT",u.SCTE35_IN="SCTE35-IN"})(s||(s={}));var r=function(){function u(a,d){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,d){var c=d.attr;for(var h in c)if(Object.prototype.hasOwnProperty.call(a,h)&&a[h]!==c[h]){m.logger.warn('DATERANGE tag attribute: "'+h+'" does not match for tags with ID: "'+a.ID+'"'),this._badValueForSameId=h;break}a=A(new p.AttrList({}),c,a)}if(this.attr=a,this._startDate=new Date(a[s.START_DATE]),s.END_DATE in this.attr){var t=new Date(this.attr[s.END_DATE]);Object(T.isFiniteNumber)(t.getTime())&&(this._endDate=t)}}return g(u,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var d=this.duration;return d!==null?new Date(this._startDate.getTime()+d*1e3):null}},{key:"duration",get:function(){if(s.DURATION in this.attr){var d=this.attr.decimalFloatingPoint(s.DURATION);if(Object(T.isFiniteNumber)(d))return d}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return s.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(s.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(s.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Object(T.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),u}()},"./src/loader/fragment-loader.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return d}),y.d(C,"LoadError",function(){return h});var T=y("./src/polyfills/number.ts"),p=y("./src/errors.ts");function m(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}function A(t){var e=typeof Map=="function"?new Map:void 0;return A=function(i){if(i===null||!s(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,f)}function f(){return _(i,arguments,u(this).constructor)}return f.prototype=Object.create(i.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),r(f,i)},A(t)}function _(t,e,n){return g()?_=Reflect.construct.bind():_=function(f,l,o){var v=[null];v.push.apply(v,l);var D=Function.bind.apply(f,v),S=new D;return o&&r(S,o.prototype),S},_.apply(null,arguments)}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function s(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,f){return i.__proto__=f,i},r(t,e)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},u(t)}var a=Math.pow(2,17),d=function(){function t(n){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=n}var e=t.prototype;return e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e.abort=function(){this.loader&&this.loader.abort()},e.load=function(i,f){var l=this,o=i.url;if(!o)return Promise.reject(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,networkDetails:null},"Fragment does not have a "+(o?"part list":"url")));this.abort();var v=this.config,D=v.fLoader,S=v.loader;return new Promise(function(E,L){l.loader&&l.loader.destroy();var x=l.loader=i.loader=D?new D(v):new S(v),b=c(i),O={timeout:v.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:v.fragLoadingMaxRetryTimeout,highWaterMark:i.sn==="initSegment"?1/0:a};i.stats=x.stats,x.load(b,O,{onSuccess:function(I,P,F,w){l.resetLoader(i,x),E({frag:i,part:null,payload:I.data,networkDetails:w})},onError:function(I,P,F){l.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,response:I,networkDetails:F}))},onAbort:function(I,P,F){l.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,networkDetails:F}))},onTimeout:function(I,P,F){l.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,networkDetails:F}))},onProgress:function(I,P,F,w){f&&f({frag:i,part:null,payload:F,networkDetails:w})}})})},e.loadPart=function(i,f,l){var o=this;this.abort();var v=this.config,D=v.fLoader,S=v.loader;return new Promise(function(E,L){o.loader&&o.loader.destroy();var x=o.loader=i.loader=D?new D(v):new S(v),b=c(i,f),O={timeout:v.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:v.fragLoadingMaxRetryTimeout,highWaterMark:a};f.stats=x.stats,x.load(b,O,{onSuccess:function(I,P,F,w){o.resetLoader(i,x),o.updateStatsFromPart(i,f);var k={frag:i,part:f,payload:I.data,networkDetails:w};l(k),E(k)},onError:function(I,P,F){o.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,part:f,response:I,networkDetails:F}))},onAbort:function(I,P,F){i.stats.aborted=f.stats.aborted,o.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,part:f,networkDetails:F}))},onTimeout:function(I,P,F){o.resetLoader(i,x),L(new h({type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,part:f,networkDetails:F}))}})})},e.updateStatsFromPart=function(i,f){var l=i.stats,o=f.stats,v=o.total;if(l.loaded+=o.loaded,v){var D=Math.round(i.duration/f.duration),S=Math.min(Math.round(l.loaded/v),D),E=D-S,L=E*Math.round(l.loaded/S);l.total=l.loaded+L}else l.total=Math.max(l.loaded,l.total);var x=l.loading,b=o.loading;x.start?x.first+=b.first-b.start:(x.start=b.start,x.first=b.first),x.end=b.end},e.resetLoader=function(i,f){i.loader=null,this.loader===f&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),f.destroy()},t}();function c(t,e){e===void 0&&(e=null);var n=e||t,i={frag:t,part:e,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},f=n.byteRangeStartOffset,l=n.byteRangeEndOffset;return Object(T.isFiniteNumber)(f)&&Object(T.isFiniteNumber)(l)&&(i.rangeStart=f,i.rangeEnd=l),i}var h=function(t){m(e,t);function e(n){for(var i,f=arguments.length,l=new Array(f>1?f-1:0),o=1;o<f;o++)l[o-1]=arguments[o];return i=t.call.apply(t,[this].concat(l))||this,i.data=void 0,i.data=n,i}return e}(A(Error))},"./src/loader/fragment.ts":function(M,C,y){y.r(C),y.d(C,"ElementaryStreamTypes",function(){return a}),y.d(C,"BaseSegment",function(){return d}),y.d(C,"Fragment",function(){return c}),y.d(C,"Part",function(){return h});var T=y("./src/polyfills/number.ts"),p=y("./node_modules/url-toolkit/src/url-toolkit.js"),m=y("./src/utils/logger.ts"),A=y("./src/loader/level-key.ts"),_=y("./src/loader/load-stats.ts");function g(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,s(t,e)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,f){return i.__proto__=f,i},s(t,e)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var a;(function(t){t.AUDIO="audio",t.VIDEO="video",t.AUDIOVIDEO="audiovideo"})(a||(a={}));var d=function(){function t(n){var i;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(i={},i[a.AUDIO]=null,i[a.VIDEO]=null,i[a.AUDIOVIDEO]=null,i),this.baseurl=n}var e=t.prototype;return e.setByteRange=function(i,f){var l=i.split("@",2),o=[];l.length===1?o[0]=f?f.byteRangeEndOffset:0:o[0]=parseInt(l[1]),o[1]=parseInt(l[0])+o[0],this._byteRange=o},u(t,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(p.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(i){this._url=i}}]),t}(),c=function(t){g(e,t);function e(i,f){var l;return l=t.call(this,f)||this,l._decryptdata=null,l.rawProgramDateTime=null,l.programDateTime=null,l.tagList=[],l.duration=0,l.sn=0,l.levelkey=void 0,l.type=void 0,l.loader=null,l.level=-1,l.cc=0,l.startPTS=void 0,l.endPTS=void 0,l.appendedPTS=void 0,l.startDTS=void 0,l.endDTS=void 0,l.start=0,l.deltaPTS=void 0,l.maxStartPTS=void 0,l.minEndPTS=void 0,l.stats=new _.LoadStats,l.urlId=0,l.data=void 0,l.bitrateTest=!1,l.title=null,l.initSegment=null,l.type=i,l}var n=e.prototype;return n.createInitializationVector=function(f){for(var l=new Uint8Array(16),o=12;o<16;o++)l[o]=f>>8*(15-o)&255;return l},n.setDecryptDataFromLevelKey=function(f,l){var o=f;return(f==null?void 0:f.method)==="AES-128"&&f.uri&&!f.iv&&(o=A.LevelKey.fromURI(f.uri),o.method=f.method,o.iv=this.createInitializationVector(l),o.keyFormat="identity"),o},n.setElementaryStreamInfo=function(f,l,o,v,D,S){S===void 0&&(S=!1);var E=this.elementaryStreams,L=E[f];if(!L){E[f]={startPTS:l,endPTS:o,startDTS:v,endDTS:D,partial:S};return}L.startPTS=Math.min(L.startPTS,l),L.endPTS=Math.max(L.endPTS,o),L.startDTS=Math.min(L.startDTS,v),L.endDTS=Math.max(L.endDTS,D)},n.clearElementaryStreamInfo=function(){var f=this.elementaryStreams;f[a.AUDIO]=null,f[a.VIDEO]=null,f[a.AUDIOVIDEO]=null},u(e,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var f=this.sn;typeof f!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&m.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),f=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,f)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(T.isFiniteNumber)(this.programDateTime))return null;var f=Object(T.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+f*1e3}},{key:"encrypted",get:function(){var f;return!!((f=this.decryptdata)!==null&&f!==void 0&&f.keyFormat&&this.decryptdata.uri)}}]),e}(d),h=function(t){g(e,t);function e(n,i,f,l,o){var v;v=t.call(this,f)||this,v.fragOffset=0,v.duration=0,v.gap=!1,v.independent=!1,v.relurl=void 0,v.fragment=void 0,v.index=void 0,v.stats=new _.LoadStats,v.duration=n.decimalFloatingPoint("DURATION"),v.gap=n.bool("GAP"),v.independent=n.bool("INDEPENDENT"),v.relurl=n.enumeratedString("URI"),v.fragment=i,v.index=l;var D=n.enumeratedString("BYTERANGE");return D&&v.setByteRange(D,o),o&&(v.fragOffset=o.fragOffset+o.duration),v}return u(e,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var i=this.elementaryStreams;return!!(i.audio||i.video||i.audiovideo)}}]),e}(d)},"./src/loader/key-loader.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return A});var T=y("./src/events.ts"),p=y("./src/errors.ts"),m=y("./src/utils/logger.ts"),A=function(){function _(s){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=s,this._registerListeners()}var g=_.prototype;return g._registerListeners=function(){this.hls.on(T.Events.KEY_LOADING,this.onKeyLoading,this)},g._unregisterListeners=function(){this.hls.off(T.Events.KEY_LOADING,this.onKeyLoading)},g.destroy=function(){this._unregisterListeners();for(var r in this.loaders){var u=this.loaders[r];u&&u.destroy()}this.loaders={}},g.onKeyLoading=function(r,u){var a=u.frag,d=a.type,c=this.loaders[d];if(!a.decryptdata){m.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var h=a.decryptdata.uri;if(h!==this.decrypturl||this.decryptkey===null){var t=this.hls.config;if(c&&(m.logger.warn("abort previous key loader for type:"+d),c.abort()),!h){m.logger.warn("key uri is falsy");return}var e=t.loader,n=a.loader=this.loaders[d]=new e(t);this.decrypturl=h,this.decryptkey=null;var i={url:h,frag:a,responseType:"arraybuffer"},f={timeout:t.fragLoadingTimeOut,maxRetry:0,retryDelay:t.fragLoadingRetryDelay,maxRetryDelay:t.fragLoadingMaxRetryTimeout,highWaterMark:0},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};n.load(i,f,l)}else this.decryptkey&&(a.decryptdata.key=this.decryptkey,this.hls.trigger(T.Events.KEY_LOADED,{frag:a}))},g.loadsuccess=function(r,u,a){var d=a.frag;if(!d.decryptdata){m.logger.error("after key load, decryptdata unset");return}this.decryptkey=d.decryptdata.key=new Uint8Array(r.data),d.loader=null,delete this.loaders[d.type],this.hls.trigger(T.Events.KEY_LOADED,{frag:d})},g.loaderror=function(r,u){var a=u.frag,d=a.loader;d&&d.abort(),delete this.loaders[a.type],this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:a,response:r})},g.loadtimeout=function(r,u){var a=u.frag,d=a.loader;d&&d.abort(),delete this.loaders[a.type],this.hls.trigger(T.Events.ERROR,{type:p.ErrorTypes.NETWORK_ERROR,details:p.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:a})},_}()},"./src/loader/level-details.ts":function(M,C,y){y.r(C),y.d(C,"LevelDetails",function(){return _});var T=y("./src/polyfills/number.ts");function p(g,s){for(var r=0;r<s.length;r++){var u=s[r];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}function m(g,s,r){return s&&p(g.prototype,s),r&&p(g,r),Object.defineProperty(g,"prototype",{writable:!1}),g}var A=10,_=function(){function g(r){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=r}var s=g.prototype;return s.reloaded=function(u){if(!u){this.advanced=!0,this.updated=!0;return}var a=this.lastPartSn-u.lastPartSn,d=this.lastPartIndex-u.lastPartIndex;this.updated=this.endSN!==u.endSN||!!d||!!a,this.advanced=this.endSN>u.endSN||a>0||a===0&&d>0,this.updated||this.advanced?this.misses=Math.floor(u.misses*.6):this.misses=u.misses+1,this.availabilityDelay=u.availabilityDelay},m(g,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(T.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||A}},{key:"drift",get:function(){var u=this.driftEndTime-this.driftStartTime;if(u>0){var a=this.driftEnd-this.driftStart;return a*1e3/u}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var u;return(u=this.partList)!==null&&u!==void 0&&u.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var u;return(u=this.fragments)!==null&&u!==void 0&&u.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var u;return(u=this.partList)!==null&&u!==void 0&&u.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var u;return(u=this.partList)!==null&&u!==void 0&&u.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),g}()},"./src/loader/level-key.ts":function(M,C,y){y.r(C),y.d(C,"LevelKey",function(){return A});var T=y("./node_modules/url-toolkit/src/url-toolkit.js");function p(_,g){for(var s=0;s<g.length;s++){var r=g[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(_,r.key,r)}}function m(_,g,s){return g&&p(_.prototype,g),s&&p(_,s),Object.defineProperty(_,"prototype",{writable:!1}),_}var A=function(){_.fromURL=function(s,r){return new _(s,r)},_.fromURI=function(s){return new _(s)};function _(g,s){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,s?this._uri=Object(T.buildAbsoluteURL)(g,s,{alwaysNormalize:!0}):this._uri=g}return m(_,[{key:"uri",get:function(){return this._uri}}]),_}()},"./src/loader/load-stats.ts":function(M,C,y){y.r(C),y.d(C,"LoadStats",function(){return T});var T=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return n});var T=y("./src/polyfills/number.ts"),p=y("./node_modules/url-toolkit/src/url-toolkit.js"),m=y("./src/loader/date-range.ts"),A=y("./src/loader/fragment.ts"),_=y("./src/loader/level-details.ts"),g=y("./src/loader/level-key.ts"),s=y("./src/utils/attr-list.ts"),r=y("./src/utils/logger.ts"),u=y("./src/utils/codecs.ts"),a=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,d=/#EXT-X-MEDIA:(.*)/g,c=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),h=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),t=/\.(mp4|m4s|m4v|m4a)$/i;function e(D){var S,E;return t.test((S=(E=p.parseURL(D))===null||E===void 0?void 0:E.path)!=null?S:"")}var n=function(){function D(){}return D.findGroup=function(E,L){for(var x=0;x<E.length;x++){var b=E[x];if(b.id===L)return b}},D.convertAVC1ToAVCOTI=function(E){var L=E.split(".");if(L.length>2){var x=L.shift()+".";return x+=parseInt(L.shift()).toString(16),x+=("000"+parseInt(L.shift()).toString(16)).slice(-4),x}return E},D.resolve=function(E,L){return p.buildAbsoluteURL(L,E,{alwaysNormalize:!0})},D.parseMasterPlaylist=function(E,L){var x=[],b={},O=!1;a.lastIndex=0;for(var R;(R=a.exec(E))!=null;)if(R[1]){var I=new s.AttrList(R[1]),P={attrs:I,bitrate:I.decimalInteger("AVERAGE-BANDWIDTH")||I.decimalInteger("BANDWIDTH"),name:I.NAME,url:D.resolve(R[2],L)},F=I.decimalResolution("RESOLUTION");F&&(P.width=F.width,P.height=F.height),i((I.CODECS||"").split(/[ ,]+/).filter(function(k){return k}),P),P.videoCodec&&P.videoCodec.indexOf("avc1")!==-1&&(P.videoCodec=D.convertAVC1ToAVCOTI(P.videoCodec)),x.push(P)}else if(R[3]){var w=new s.AttrList(R[3]);w["DATA-ID"]&&(O=!0,b[w["DATA-ID"]]=w)}return{levels:x,sessionData:O?b:null}},D.parseMasterPlaylistMedia=function(E,L,x,b){b===void 0&&(b=[]);var O,R=[],I=0;for(d.lastIndex=0;(O=d.exec(E))!==null;){var P=new s.AttrList(O[1]);if(P.TYPE===x){var F={attrs:P,bitrate:0,id:I++,groupId:P["GROUP-ID"],instreamId:P["INSTREAM-ID"],name:P.NAME||P.LANGUAGE||"",type:x,default:P.bool("DEFAULT"),autoselect:P.bool("AUTOSELECT"),forced:P.bool("FORCED"),lang:P.LANGUAGE,url:P.URI?D.resolve(P.URI,L):""};if(b.length){var w=D.findGroup(b,F.groupId)||b[0];f(F,w,"audioCodec"),f(F,w,"textCodec")}R.push(F)}}return R},D.parseLevelPlaylist=function(E,L,x,b,O){var R=new _.LevelDetails(L),I=R.fragments,P=null,F=0,w=0,k=0,B=0,U=null,j=new A.Fragment(b,L),N,K,H,$=-1,G=!1;for(c.lastIndex=0,R.m3u8=E;(N=c.exec(E))!==null;){G&&(G=!1,j=new A.Fragment(b,L),j.start=k,j.sn=F,j.cc=B,j.level=x,P&&(j.initSegment=P,j.rawProgramDateTime=P.rawProgramDateTime,P.rawProgramDateTime=null));var ee=N[1];if(ee){j.duration=parseFloat(ee);var X=(" "+N[2]).slice(1);j.title=X||null,j.tagList.push(X?["INF",ee,X]:["INF",ee])}else if(N[3])Object(T.isFiniteNumber)(j.duration)&&(j.start=k,H&&(j.levelkey=H),j.sn=F,j.level=x,j.cc=B,j.urlId=O,I.push(j),j.relurl=(" "+N[3]).slice(1),o(j,U),U=j,k+=j.duration,F++,w=0,G=!0);else if(N[4]){var V=(" "+N[4]).slice(1);U?j.setByteRange(V,U):j.setByteRange(V)}else if(N[5])j.rawProgramDateTime=(" "+N[5]).slice(1),j.tagList.push(["PROGRAM-DATE-TIME",j.rawProgramDateTime]),$===-1&&($=I.length);else{if(N=N[0].match(h),!N){r.logger.warn("No matches on slow regex match for level playlist!");continue}for(K=1;K<N.length&&!(typeof N[K]<"u");K++);var J=(" "+N[K]).slice(1),Q=(" "+N[K+1]).slice(1),ie=N[K+2]?(" "+N[K+2]).slice(1):"";switch(J){case"PLAYLIST-TYPE":R.type=Q.toUpperCase();break;case"MEDIA-SEQUENCE":F=R.startSN=parseInt(Q);break;case"SKIP":{var ae=new s.AttrList(Q),se=ae.decimalInteger("SKIPPED-SEGMENTS");if(Object(T.isFiniteNumber)(se)){R.skippedSegments=se;for(var le=se;le--;)I.unshift(null);F+=se}var ue=ae.enumeratedString("RECENTLY-REMOVED-DATERANGES");ue&&(R.recentlyRemovedDateranges=ue.split("	"));break}case"TARGETDURATION":R.targetduration=parseFloat(Q);break;case"VERSION":R.version=parseInt(Q);break;case"EXTM3U":break;case"ENDLIST":R.live=!1;break;case"#":(Q||ie)&&j.tagList.push(ie?[Q,ie]:[Q]);break;case"DISCONTINUITY":B++,j.tagList.push(["DIS"]);break;case"GAP":j.tagList.push([J]);break;case"BITRATE":j.tagList.push([J,Q]);break;case"DATERANGE":{var q=new s.AttrList(Q),oe=new m.DateRange(q,R.dateRanges[q.ID]);oe.isValid||R.skippedSegments?R.dateRanges[oe.id]=oe:r.logger.warn('Ignoring invalid DATERANGE tag: "'+Q+'"'),j.tagList.push(["EXT-X-DATERANGE",Q]);break}case"DISCONTINUITY-SEQUENCE":B=parseInt(Q);break;case"KEY":{var de,ce=new s.AttrList(Q),pe=ce.enumeratedString("METHOD"),he=ce.URI,ye=ce.hexadecimalInteger("IV"),fe=ce.enumeratedString("KEYFORMATVERSIONS"),me=ce.enumeratedString("KEYID"),W=(de=ce.enumeratedString("KEYFORMAT"))!=null?de:"identity",z=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(z.indexOf(W)>-1){r.logger.warn("Keyformat "+W+" is not supported from the manifest");continue}else if(W!=="identity")continue;pe&&(H=g.LevelKey.fromURL(L,he),he&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(pe)>=0&&(H.method=pe,H.keyFormat=W,me&&(H.keyID=me),fe&&(H.keyFormatVersions=fe),H.iv=ye));break}case"START":{var Y=new s.AttrList(Q),Z=Y.decimalFloatingPoint("TIME-OFFSET");Object(T.isFiniteNumber)(Z)&&(R.startTimeOffset=Z);break}case"MAP":{var re=new s.AttrList(Q);if(j.duration){var ne=new A.Fragment(b,L);v(ne,re,x,H),P=ne,j.initSegment=P,P.rawProgramDateTime&&!j.rawProgramDateTime&&(j.rawProgramDateTime=P.rawProgramDateTime)}else v(j,re,x,H),P=j,G=!0;break}case"SERVER-CONTROL":{var te=new s.AttrList(Q);R.canBlockReload=te.bool("CAN-BLOCK-RELOAD"),R.canSkipUntil=te.optionalFloat("CAN-SKIP-UNTIL",0),R.canSkipDateRanges=R.canSkipUntil>0&&te.bool("CAN-SKIP-DATERANGES"),R.partHoldBack=te.optionalFloat("PART-HOLD-BACK",0),R.holdBack=te.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Ee=new s.AttrList(Q);R.partTarget=Ee.decimalFloatingPoint("PART-TARGET");break}case"PART":{var ve=R.partList;ve||(ve=R.partList=[]);var ge=w>0?ve[ve.length-1]:void 0,_e=w++,Le=new A.Part(new s.AttrList(Q),j,L,_e,ge);ve.push(Le),j.duration+=Le.duration;break}case"PRELOAD-HINT":{var Ae=new s.AttrList(Q);R.preloadHint=Ae;break}case"RENDITION-REPORT":{var Se=new s.AttrList(Q);R.renditionReports=R.renditionReports||[],R.renditionReports.push(Se);break}default:r.logger.warn("line parsed but not handled: "+N);break}}}U&&!U.relurl?(I.pop(),k-=U.duration,R.partList&&(R.fragmentHint=U)):R.partList&&(o(j,U),j.cc=B,R.fragmentHint=j);var Ie=I.length,Me=I[0],De=I[Ie-1];if(k+=R.skippedSegments*R.targetduration,k>0&&Ie&&De){R.averagetargetduration=k/Ie;var Ce=De.sn;R.endSN=Ce!=="initSegment"?Ce:0,Me&&(R.startCC=Me.cc,Me.initSegment||R.fragments.every(function(Oe){return Oe.relurl&&e(Oe.relurl)})&&(r.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),j=new A.Fragment(b,L),j.relurl=De.relurl,j.level=x,j.sn="initSegment",Me.initSegment=j,R.needSidxRanges=!0))}else R.endSN=0,R.startCC=0;return R.fragmentHint&&(k+=R.fragmentHint.duration),R.totalduration=k,R.endCC=B,$>0&&l(I,$),R},D}();function i(D,S){["video","audio","text"].forEach(function(E){var L=D.filter(function(b){return Object(u.isCodecType)(b,E)});if(L.length){var x=L.filter(function(b){return b.lastIndexOf("avc1",0)===0||b.lastIndexOf("mp4a",0)===0});S[E+"Codec"]=x.length>0?x[0]:L[0],D=D.filter(function(b){return L.indexOf(b)===-1})}}),S.unknownCodecs=D}function f(D,S,E){var L=S[E];L&&(D[E]=L)}function l(D,S){for(var E=D[S],L=S;L--;){var x=D[L];if(!x)return;x.programDateTime=E.programDateTime-x.duration*1e3,E=x}}function o(D,S){D.rawProgramDateTime?D.programDateTime=Date.parse(D.rawProgramDateTime):S!=null&&S.programDateTime&&(D.programDateTime=S.endProgramDateTime),Object(T.isFiniteNumber)(D.programDateTime)||(D.programDateTime=null,D.rawProgramDateTime=null)}function v(D,S,E,L){D.relurl=S.URI,S.BYTERANGE&&D.setByteRange(S.BYTERANGE),D.level=E,D.sn="initSegment",L&&(D.levelkey=L),D.initSegment=null}},"./src/loader/playlist-loader.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/events.ts"),m=y("./src/errors.ts"),A=y("./src/utils/logger.ts"),_=y("./src/utils/mp4-tools.ts"),g=y("./src/loader/m3u8-parser.ts"),s=y("./src/types/loader.ts"),r=y("./src/utils/attr-list.ts");function u(c){var h=c.type;switch(h){case s.PlaylistContextType.AUDIO_TRACK:return s.PlaylistLevelType.AUDIO;case s.PlaylistContextType.SUBTITLE_TRACK:return s.PlaylistLevelType.SUBTITLE;default:return s.PlaylistLevelType.MAIN}}function a(c,h){var t=c.url;return(t===void 0||t.indexOf("data:")===0)&&(t=h.url),t}var d=function(){function c(t){this.hls=void 0,this.loaders=Object.create(null),this.hls=t,this.registerListeners()}var h=c.prototype;return h.registerListeners=function(){var e=this.hls;e.on(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(p.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(p.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(p.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.unregisterListeners=function(){var e=this.hls;e.off(p.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(p.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(p.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(p.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.createInternalLoader=function(e){var n=this.hls.config,i=n.pLoader,f=n.loader,l=i||f,o=new l(n);return e.loader=o,this.loaders[e.type]=o,o},h.getInternalLoader=function(e){return this.loaders[e.type]},h.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},h.destroyInternalLoaders=function(){for(var e in this.loaders){var n=this.loaders[e];n&&n.destroy(),this.resetInternalLoader(e)}},h.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},h.onManifestLoading=function(e,n){var i=n.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:s.PlaylistContextType.MANIFEST,url:i,deliveryDirectives:null})},h.onLevelLoading=function(e,n){var i=n.id,f=n.level,l=n.url,o=n.deliveryDirectives;this.load({id:i,groupId:null,level:f,responseType:"text",type:s.PlaylistContextType.LEVEL,url:l,deliveryDirectives:o})},h.onAudioTrackLoading=function(e,n){var i=n.id,f=n.groupId,l=n.url,o=n.deliveryDirectives;this.load({id:i,groupId:f,level:null,responseType:"text",type:s.PlaylistContextType.AUDIO_TRACK,url:l,deliveryDirectives:o})},h.onSubtitleTrackLoading=function(e,n){var i=n.id,f=n.groupId,l=n.url,o=n.deliveryDirectives;this.load({id:i,groupId:f,level:null,responseType:"text",type:s.PlaylistContextType.SUBTITLE_TRACK,url:l,deliveryDirectives:o})},h.load=function(e){var n,i=this.hls.config,f=this.getInternalLoader(e);if(f){var l=f.context;if(l&&l.url===e.url){A.logger.trace("[playlist-loader]: playlist request ongoing");return}A.logger.log("[playlist-loader]: aborting previous loader for type: "+e.type),f.abort()}var o,v,D,S;switch(e.type){case s.PlaylistContextType.MANIFEST:o=i.manifestLoadingMaxRetry,v=i.manifestLoadingTimeOut,D=i.manifestLoadingRetryDelay,S=i.manifestLoadingMaxRetryTimeout;break;case s.PlaylistContextType.LEVEL:case s.PlaylistContextType.AUDIO_TRACK:case s.PlaylistContextType.SUBTITLE_TRACK:o=0,v=i.levelLoadingTimeOut;break;default:o=i.levelLoadingMaxRetry,v=i.levelLoadingTimeOut,D=i.levelLoadingRetryDelay,S=i.levelLoadingMaxRetryTimeout;break}if(f=this.createInternalLoader(e),(n=e.deliveryDirectives)!==null&&n!==void 0&&n.part){var E;if(e.type===s.PlaylistContextType.LEVEL&&e.level!==null?E=this.hls.levels[e.level].details:e.type===s.PlaylistContextType.AUDIO_TRACK&&e.id!==null?E=this.hls.audioTracks[e.id].details:e.type===s.PlaylistContextType.SUBTITLE_TRACK&&e.id!==null&&(E=this.hls.subtitleTracks[e.id].details),E){var L=E.partTarget,x=E.targetduration;L&&x&&(v=Math.min(Math.max(L*3,x*.8)*1e3,v))}}var b={timeout:v,maxRetry:o,retryDelay:D,maxRetryDelay:S,highWaterMark:0},O={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};f.load(e,b,O)},h.loadsuccess=function(e,n,i,f){if(f===void 0&&(f=null),i.isSidxRequest){this.handleSidxRequest(e,i),this.handlePlaylistLoaded(e,n,i,f);return}this.resetInternalLoader(i.type);var l=e.data;if(l.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(e,i,"no EXTM3U delimiter",f);return}n.parsing.start=performance.now(),l.indexOf("#EXTINF:")>0||l.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(e,n,i,f):this.handleMasterPlaylist(e,n,i,f)},h.loaderror=function(e,n,i){i===void 0&&(i=null),this.handleNetworkError(n,i,!1,e)},h.loadtimeout=function(e,n,i){i===void 0&&(i=null),this.handleNetworkError(n,i,!0)},h.handleMasterPlaylist=function(e,n,i,f){var l=this.hls,o=e.data,v=a(e,i),D=g.default.parseMasterPlaylist(o,v),S=D.levels,E=D.sessionData;if(!S.length){this.handleManifestParsingError(e,i,"no level found in manifest",f);return}var L=S.map(function(P){return{id:P.attrs.AUDIO,audioCodec:P.audioCodec}}),x=S.map(function(P){return{id:P.attrs.SUBTITLES,textCodec:P.textCodec}}),b=g.default.parseMasterPlaylistMedia(o,v,"AUDIO",L),O=g.default.parseMasterPlaylistMedia(o,v,"SUBTITLES",x),R=g.default.parseMasterPlaylistMedia(o,v,"CLOSED-CAPTIONS");if(b.length){var I=b.some(function(P){return!P.url});!I&&S[0].audioCodec&&!S[0].attrs.AUDIO&&(A.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new r.AttrList({}),bitrate:0,url:""}))}l.trigger(p.Events.MANIFEST_LOADED,{levels:S,audioTracks:b,subtitles:O,captions:R,url:v,stats:n,networkDetails:f,sessionData:E})},h.handleTrackOrLevelPlaylist=function(e,n,i,f){var l=this.hls,o=i.id,v=i.level,D=i.type,S=a(e,i),E=Object(T.isFiniteNumber)(o)?o:0,L=Object(T.isFiniteNumber)(v)?v:E,x=u(i),b=g.default.parseLevelPlaylist(e.data,S,L,x,E);if(!b.fragments.length){l.trigger(p.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:S,reason:"no fragments found in level",level:typeof i.level=="number"?i.level:void 0});return}if(D===s.PlaylistContextType.MANIFEST){var O={attrs:new r.AttrList({}),bitrate:0,details:b,name:"",url:S};l.trigger(p.Events.MANIFEST_LOADED,{levels:[O],audioTracks:[],url:S,stats:n,networkDetails:f,sessionData:null})}if(n.parsing.end=performance.now(),b.needSidxRanges){var R,I=(R=b.fragments[0].initSegment)===null||R===void 0?void 0:R.url;this.load({url:I,isSidxRequest:!0,type:D,level:v,levelDetails:b,id:o,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}i.levelDetails=b,this.handlePlaylistLoaded(e,n,i,f)},h.handleSidxRequest=function(e,n){var i=new Uint8Array(e.data),f=Object(_.findBox)(i,["sidx"])[0];if(!!f){var l=Object(_.parseSegmentIndex)(f);if(!!l){var o=l.references,v=n.levelDetails;o.forEach(function(D,S){var E=D.info,L=v.fragments[S];if(L.byteRange.length===0&&L.setByteRange(String(1+E.end-E.start)+"@"+String(E.start)),L.initSegment){var x=Object(_.findBox)(i,["moov"])[0],b=x?x.length:null;L.initSegment.setByteRange(String(b)+"@0")}})}}},h.handleManifestParsingError=function(e,n,i,f){this.hls.trigger(p.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:n.type===s.PlaylistContextType.MANIFEST,url:e.url,reason:i,response:e,context:n,networkDetails:f})},h.handleNetworkError=function(e,n,i,f){i===void 0&&(i=!1),A.logger.warn("[playlist-loader]: A network "+(i?"timeout":"error")+" occurred while loading "+e.type+" level: "+e.level+" id: "+e.id+' group-id: "'+e.groupId+'"');var l=m.ErrorDetails.UNKNOWN,o=!1,v=this.getInternalLoader(e);switch(e.type){case s.PlaylistContextType.MANIFEST:l=i?m.ErrorDetails.MANIFEST_LOAD_TIMEOUT:m.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case s.PlaylistContextType.LEVEL:l=i?m.ErrorDetails.LEVEL_LOAD_TIMEOUT:m.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case s.PlaylistContextType.AUDIO_TRACK:l=i?m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;case s.PlaylistContextType.SUBTITLE_TRACK:l=i?m.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:m.ErrorDetails.SUBTITLE_LOAD_ERROR,o=!1;break}v&&this.resetInternalLoader(e.type);var D={type:m.ErrorTypes.NETWORK_ERROR,details:l,fatal:o,url:e.url,loader:v,context:e,networkDetails:n};f&&(D.response=f),this.hls.trigger(p.Events.ERROR,D)},h.handlePlaylistLoaded=function(e,n,i,f){var l=i.type,o=i.level,v=i.id,D=i.groupId,S=i.loader,E=i.levelDetails,L=i.deliveryDirectives;if(!(E!=null&&E.targetduration)){this.handleManifestParsingError(e,i,"invalid target duration",f);return}if(!!S)switch(E.live&&(S.getCacheAge&&(E.ageHeader=S.getCacheAge()||0),(!S.getCacheAge||isNaN(E.ageHeader))&&(E.ageHeader=0)),l){case s.PlaylistContextType.MANIFEST:case s.PlaylistContextType.LEVEL:this.hls.trigger(p.Events.LEVEL_LOADED,{details:E,level:o||0,id:v||0,stats:n,networkDetails:f,deliveryDirectives:L});break;case s.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(p.Events.AUDIO_TRACK_LOADED,{details:E,id:v||0,groupId:D||"",stats:n,networkDetails:f,deliveryDirectives:L});break;case s.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(p.Events.SUBTITLE_TRACK_LOADED,{details:E,id:v||0,groupId:D||"",stats:n,networkDetails:f,deliveryDirectives:L});break}},c}();C.default=d},"./src/polyfills/number.ts":function(M,C,y){y.r(C),y.d(C,"isFiniteNumber",function(){return T}),y.d(C,"MAX_SAFE_INTEGER",function(){return p});var T=Number.isFinite||function(m){return typeof m=="number"&&isFinite(m)},p=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(M,C,y){y.r(C);var T=function(){function p(){}return p.getSilentFrame=function(A,_){switch(A){case"mp4a.40.2":if(_===1)return new Uint8Array([0,200,0,128,35,128]);if(_===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(_===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(_===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(_===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(_===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(_===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(_===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(_===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},p}();C.default=T},"./src/remux/mp4-generator.ts":function(M,C,y){y.r(C);var T=Math.pow(2,32)-1,p=function(){function m(){}return m.init=function(){m.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var _;for(_ in m.types)m.types.hasOwnProperty(_)&&(m.types[_]=[_.charCodeAt(0),_.charCodeAt(1),_.charCodeAt(2),_.charCodeAt(3)]);var g=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);m.HDLR_TYPES={video:g,audio:s};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u=new Uint8Array([0,0,0,0,0,0,0,0]);m.STTS=m.STSC=m.STCO=u,m.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),m.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),m.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),m.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),d=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);m.FTYP=m.box(m.types.ftyp,a,c,a,d),m.DINF=m.box(m.types.dinf,m.box(m.types.dref,r))},m.box=function(_){for(var g=8,s=arguments.length,r=new Array(s>1?s-1:0),u=1;u<s;u++)r[u-1]=arguments[u];for(var a=r.length,d=a;a--;)g+=r[a].byteLength;var c=new Uint8Array(g);for(c[0]=g>>24&255,c[1]=g>>16&255,c[2]=g>>8&255,c[3]=g&255,c.set(_,4),a=0,g=8;a<d;a++)c.set(r[a],g),g+=r[a].byteLength;return c},m.hdlr=function(_){return m.box(m.types.hdlr,m.HDLR_TYPES[_])},m.mdat=function(_){return m.box(m.types.mdat,_)},m.mdhd=function(_,g){g*=_;var s=Math.floor(g/(T+1)),r=Math.floor(g%(T+1));return m.box(m.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_>>24&255,_>>16&255,_>>8&255,_&255,s>>24,s>>16&255,s>>8&255,s&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))},m.mdia=function(_){return m.box(m.types.mdia,m.mdhd(_.timescale,_.duration),m.hdlr(_.type),m.minf(_))},m.mfhd=function(_){return m.box(m.types.mfhd,new Uint8Array([0,0,0,0,_>>24,_>>16&255,_>>8&255,_&255]))},m.minf=function(_){return _.type==="audio"?m.box(m.types.minf,m.box(m.types.smhd,m.SMHD),m.DINF,m.stbl(_)):m.box(m.types.minf,m.box(m.types.vmhd,m.VMHD),m.DINF,m.stbl(_))},m.moof=function(_,g,s){return m.box(m.types.moof,m.mfhd(_),m.traf(s,g))},m.moov=function(_){for(var g=_.length,s=[];g--;)s[g]=m.trak(_[g]);return m.box.apply(null,[m.types.moov,m.mvhd(_[0].timescale,_[0].duration)].concat(s).concat(m.mvex(_)))},m.mvex=function(_){for(var g=_.length,s=[];g--;)s[g]=m.trex(_[g]);return m.box.apply(null,[m.types.mvex].concat(s))},m.mvhd=function(_,g){g*=_;var s=Math.floor(g/(T+1)),r=Math.floor(g%(T+1)),u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_>>24&255,_>>16&255,_>>8&255,_&255,s>>24,s>>16&255,s>>8&255,s&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m.box(m.types.mvhd,u)},m.sdtp=function(_){var g=_.samples||[],s=new Uint8Array(4+g.length),r,u;for(r=0;r<g.length;r++)u=g[r].flags,s[r+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return m.box(m.types.sdtp,s)},m.stbl=function(_){return m.box(m.types.stbl,m.stsd(_),m.box(m.types.stts,m.STTS),m.box(m.types.stsc,m.STSC),m.box(m.types.stsz,m.STSZ),m.box(m.types.stco,m.STCO))},m.avc1=function(_){var g=[],s=[],r,u,a;for(r=0;r<_.sps.length;r++)u=_.sps[r],a=u.byteLength,g.push(a>>>8&255),g.push(a&255),g=g.concat(Array.prototype.slice.call(u));for(r=0;r<_.pps.length;r++)u=_.pps[r],a=u.byteLength,s.push(a>>>8&255),s.push(a&255),s=s.concat(Array.prototype.slice.call(u));var d=m.box(m.types.avcC,new Uint8Array([1,g[3],g[4],g[5],255,224|_.sps.length].concat(g).concat([_.pps.length]).concat(s))),c=_.width,h=_.height,t=_.pixelRatio[0],e=_.pixelRatio[1];return m.box(m.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,m.box(m.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),m.box(m.types.pasp,new Uint8Array([t>>24,t>>16&255,t>>8&255,t&255,e>>24,e>>16&255,e>>8&255,e&255])))},m.esds=function(_){var g=_.config.length;return new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(_.config).concat([6,1,2]))},m.mp4a=function(_){var g=_.samplerate;return m.box(m.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,_.channelCount,0,16,0,0,0,0,g>>8&255,g&255,0,0]),m.box(m.types.esds,m.esds(_)))},m.mp3=function(_){var g=_.samplerate;return m.box(m.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,_.channelCount,0,16,0,0,0,0,g>>8&255,g&255,0,0]))},m.stsd=function(_){return _.type==="audio"?_.segmentCodec==="mp3"&&_.codec==="mp3"?m.box(m.types.stsd,m.STSD,m.mp3(_)):m.box(m.types.stsd,m.STSD,m.mp4a(_)):m.box(m.types.stsd,m.STSD,m.avc1(_))},m.tkhd=function(_){var g=_.id,s=_.duration*_.timescale,r=_.width,u=_.height,a=Math.floor(s/(T+1)),d=Math.floor(s%(T+1));return m.box(m.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,g>>24&255,g>>16&255,g>>8&255,g&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,d>>24,d>>16&255,d>>8&255,d&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,u>>8&255,u&255,0,0]))},m.traf=function(_,g){var s=m.sdtp(_),r=_.id,u=Math.floor(g/(T+1)),a=Math.floor(g%(T+1));return m.box(m.types.traf,m.box(m.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),m.box(m.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,a>>24,a>>16&255,a>>8&255,a&255])),m.trun(_,s.length+16+20+8+16+8+8),s)},m.trak=function(_){return _.duration=_.duration||4294967295,m.box(m.types.trak,m.tkhd(_),m.mdia(_))},m.trex=function(_){var g=_.id;return m.box(m.types.trex,new Uint8Array([0,0,0,0,g>>24,g>>16&255,g>>8&255,g&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},m.trun=function(_,g){var s=_.samples||[],r=s.length,u=12+16*r,a=new Uint8Array(u),d,c,h,t,e,n;for(g+=8+u,a.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255],0),d=0;d<r;d++)c=s[d],h=c.duration,t=c.size,e=c.flags,n=c.cts,a.set([h>>>24&255,h>>>16&255,h>>>8&255,h&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,e.isLeading<<2|e.dependsOn,e.isDependedOn<<6|e.hasRedundancy<<4|e.paddingValue<<1|e.isNonSync,e.degradPrio&240<<8,e.degradPrio&15,n>>>24&255,n>>>16&255,n>>>8&255,n&255],12+16*d);return m.box(m.types.trun,a)},m.initSegment=function(_){m.types||m.init();var g=m.moov(_),s=new Uint8Array(m.FTYP.byteLength+g.byteLength);return s.set(m.FTYP),s.set(g,m.FTYP.byteLength),s},m}();p.types=void 0,p.HDLR_TYPES=void 0,p.STTS=void 0,p.STSC=void 0,p.STCO=void 0,p.STSZ=void 0,p.VMHD=void 0,p.SMHD=void 0,p.STSD=void 0,p.FTYP=void 0,p.DINF=void 0,C.default=p},"./src/remux/mp4-remuxer.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return n}),y.d(C,"normalizePts",function(){return i}),y.d(C,"flushTextTrackMetadataCueSamples",function(){return l}),y.d(C,"flushTextTrackUserdataCueSamples",function(){return o});var T=y("./src/polyfills/number.ts"),p=y("./src/remux/aac-helper.ts"),m=y("./src/remux/mp4-generator.ts"),A=y("./src/events.ts"),_=y("./src/errors.ts"),g=y("./src/utils/logger.ts"),s=y("./src/types/loader.ts"),r=y("./src/utils/timescale-conversion.ts");function u(){return u=Object.assign?Object.assign.bind():function(S){for(var E=1;E<arguments.length;E++){var L=arguments[E];for(var x in L)Object.prototype.hasOwnProperty.call(L,x)&&(S[x]=L[x])}return S},u.apply(this,arguments)}var a=10*1e3,d=1024,c=1152,h=null,t=null,e=!1,n=function(){function S(L,x,b,O){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=L,this.config=x,this.typeSupported=b,this.ISGenerated=!1,h===null){var R=navigator.userAgent||"",I=R.match(/Chrome\/(\d+)/i);h=I?parseInt(I[1]):0}if(t===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);t=P?parseInt(P[1]):0}e=!(!!h&&h>=75||!!t&&t>=600)}var E=S.prototype;return E.destroy=function(){},E.resetTimeStamp=function(x){g.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=x},E.resetNextTimestamp=function(){g.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},E.resetInitSegment=function(){g.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},E.getVideoStartPts=function(x){var b=!1,O=x.reduce(function(R,I){var P=I.pts-R;return P<-4294967296?(b=!0,i(R,I.pts)):P>0?R:I.pts},x[0].pts);return b&&g.logger.debug("PTS rollover detected"),O},E.remux=function(x,b,O,R,I,P,F,w){var k,B,U,j,N,K,H=I,$=I,G=x.pid>-1,ee=b.pid>-1,X=b.samples.length,V=x.samples.length>0,J=F&&X>0||X>1,Q=(!G||V)&&(!ee||J)||this.ISGenerated||F;if(Q){this.ISGenerated||(U=this.generateIS(x,b,I));var ie=this.isVideoContiguous,ae=-1,se;if(J&&(ae=f(b.samples),!ie&&this.config.forceKeyFrameOnDiscontinuity))if(K=!0,ae>0){g.logger.warn("[mp4-remuxer]: Dropped "+ae+" out of "+X+" video samples due to a missing keyframe");var le=this.getVideoStartPts(b.samples);b.samples=b.samples.slice(ae),b.dropped+=ae,$+=(b.samples[0].pts-le)/b.inputTimeScale,se=$}else ae===-1&&(g.logger.warn("[mp4-remuxer]: No keyframe found out of "+X+" video samples"),K=!1);if(this.ISGenerated){if(V&&J){var ue=this.getVideoStartPts(b.samples),q=i(x.samples[0].pts,ue)-ue,oe=q/b.inputTimeScale;H+=Math.max(0,oe),$+=Math.max(0,-oe)}if(V){if(x.samplerate||(g.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),U=this.generateIS(x,b,I)),B=this.remuxAudio(x,H,this.isAudioContiguous,P,ee||J||w===s.PlaylistLevelType.AUDIO?$:void 0),J){var de=B?B.endPTS-B.startPTS:0;b.inputTimeScale||(g.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),U=this.generateIS(x,b,I)),k=this.remuxVideo(b,$,ie,de)}}else J&&(k=this.remuxVideo(b,$,ie,0));k&&(k.firstKeyFrame=ae,k.independent=ae!==-1,k.firstKeyFramePTS=se)}}return this.ISGenerated&&(O.samples.length&&(N=l(O,I,this._initPTS,this._initDTS)),R.samples.length&&(j=o(R,I,this._initPTS))),{audio:B,video:k,initSegment:U,independent:K,text:j,id3:N}},E.generateIS=function(x,b,O){var R=x.samples,I=b.samples,P=this.typeSupported,F={},w=!Object(T.isFiniteNumber)(this._initPTS),k="audio/mp4",B,U,j;if(w&&(B=U=1/0),x.config&&R.length){switch(x.timescale=x.samplerate,x.segmentCodec){case"mp3":P.mpeg?(k="audio/mpeg",x.codec=""):P.mp3&&(x.codec="mp3");break}F.audio={id:"audio",container:k,codec:x.codec,initSegment:x.segmentCodec==="mp3"&&P.mpeg?new Uint8Array(0):m.default.initSegment([x]),metadata:{channelCount:x.channelCount}},w&&(j=x.inputTimeScale,B=U=R[0].pts-Math.round(j*O))}if(b.sps&&b.pps&&I.length&&(b.timescale=b.inputTimeScale,F.video={id:"main",container:"video/mp4",codec:b.codec,initSegment:m.default.initSegment([b]),metadata:{width:b.width,height:b.height}},w)){j=b.inputTimeScale;var N=this.getVideoStartPts(I),K=Math.round(j*O);U=Math.min(U,i(I[0].dts,N)-K),B=Math.min(B,N-K)}if(Object.keys(F).length)return this.ISGenerated=!0,w&&(this._initPTS=B,this._initDTS=U),{tracks:F,initPTS:B,timescale:j}},E.remuxVideo=function(x,b,O,R){var I=x.inputTimeScale,P=x.samples,F=[],w=P.length,k=this._initPTS,B=this.nextAvcDts,U=8,j=this.videoSampleDuration,N,K,H=Number.POSITIVE_INFINITY,$=Number.NEGATIVE_INFINITY,G=0,ee=!1;if(!O||B===null){var X=b*I,V=P[0].pts-i(P[0].dts,P[0].pts);B=X-V}for(var J=0;J<w;J++){var Q=P[J];if(Q.pts=i(Q.pts-k,B),Q.dts=i(Q.dts-k,B),Q.dts>Q.pts){var ie=18e3;G=Math.max(Math.min(G,Q.pts-Q.dts),-1*ie)}Q.dts<P[J>0?J-1:J].dts&&(ee=!0)}ee&&P.sort(function(Be,je){var Qe=Be.dts-je.dts,Ze=Be.pts-je.pts;return Qe||Ze}),N=P[0].dts,K=P[P.length-1].dts;var ae=K-N,se=ae?Math.round(ae/(w-1)):j||x.inputTimeScale/30;if(G<0){if(G<se*-2){g.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(r.toMsFromMpegTsClock)(-se,!0)+" ms");for(var le=G,ue=0;ue<w;ue++)P[ue].dts=le=Math.max(le,P[ue].pts-se),P[ue].pts=Math.max(le,P[ue].pts)}else{g.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(r.toMsFromMpegTsClock)(G,!0)+" ms to overcome this issue");for(var q=0;q<w;q++)P[q].dts=P[q].dts+G}N=P[0].dts}if(O){var oe=N-B,de=oe>se,ce=oe<-1;if(de||ce){de?g.logger.warn("AVC: "+Object(r.toMsFromMpegTsClock)(oe,!0)+" ms ("+oe+"dts) hole between fragments detected, filling it"):g.logger.warn("AVC: "+Object(r.toMsFromMpegTsClock)(-oe,!0)+" ms ("+oe+"dts) overlapping between fragments detected"),N=B;var pe=P[0].pts-oe;P[0].dts=N,P[0].pts=pe,g.logger.log("Video: First PTS/DTS adjusted: "+Object(r.toMsFromMpegTsClock)(pe,!0)+"/"+Object(r.toMsFromMpegTsClock)(N,!0)+", delta: "+Object(r.toMsFromMpegTsClock)(oe,!0)+" ms")}}e&&(N=Math.max(0,N));for(var he=0,ye=0,fe=0;fe<w;fe++){for(var me=P[fe],W=me.units,z=W.length,Y=0,Z=0;Z<z;Z++)Y+=W[Z].data.length;ye+=Y,he+=z,me.length=Y,me.dts=Math.max(me.dts,N),me.pts=Math.max(me.pts,me.dts,0),H=Math.min(me.pts,H),$=Math.max(me.pts,$)}K=P[w-1].dts;var re=ye+4*he+8,ne;try{ne=new Uint8Array(re)}catch{this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:_.ErrorTypes.MUX_ERROR,details:_.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:re,reason:"fail allocating video mdat "+re});return}var te=new DataView(ne.buffer);te.setUint32(0,re),ne.set(m.default.types.mdat,4);for(var Ee=!1,ve=0;ve<w;ve++){for(var ge=P[ve],_e=ge.units,Le=0,Ae=0,Se=_e.length;Ae<Se;Ae++){var Ie=_e[Ae],Me=Ie.data,De=Ie.data.byteLength;te.setUint32(U,De),U+=4,ne.set(Me,U),U+=De,Le+=4+De}if(ve<w-1)j=P[ve+1].dts-ge.dts;else{var Ce=this.config,Oe=ve>0?ge.dts-P[ve-1].dts:se;if(Ce.stretchShortVideoTrack&&this.nextAudioPts!==null){var $e=Math.floor(Ce.maxBufferHole*I),ke=(R?H+R*I:this.nextAudioPts)-ge.pts;ke>$e?(j=ke-Oe,j<0?j=Oe:Ee=!0,g.logger.log("[mp4-remuxer]: It is approximately "+ke/90+" ms to the next segment; using duration "+j/90+" ms for the last video frame.")):j=Oe}else j=Oe}var ze=Math.round(ge.pts-ge.dts);F.push(new v(ge.key,j,Le,ze))}if(F.length&&h&&h<70){var Ue=F[0].flags;Ue.dependsOn=2,Ue.isNonSync=0}console.assert(j!==null,"mp4SampleDuration must be computed"),j=Ee||!j?se:j,this.nextAvcDts=B=K+j,this.videoSampleDuration=j,this.isVideoContiguous=!0;var Ye=m.default.moof(x.sequenceNumber++,N,u({},x,{samples:F})),Xe="video",Je={data1:Ye,data2:ne,startPTS:H/I,endPTS:($+j)/I,startDTS:N/I,endDTS:B/I,type:Xe,hasAudio:!1,hasVideo:!0,nb:F.length,dropped:x.dropped};return x.samples=[],x.dropped=0,console.assert(ne.length,"MDAT length must not be zero"),Je},E.remuxAudio=function(x,b,O,R,I){var P=x.inputTimeScale,F=x.samplerate?x.samplerate:P,w=P/F,k=x.segmentCodec==="aac"?d:c,B=k*w,U=this._initPTS,j=x.segmentCodec==="mp3"&&this.typeSupported.mpeg,N=[],K=I!==void 0,H=x.samples,$=j?0:8,G=this.nextAudioPts||-1,ee=b*P;if(this.isAudioContiguous=O=O||H.length&&G>0&&(R&&Math.abs(ee-G)<9e3||Math.abs(i(H[0].pts-U,ee)-G)<20*B),H.forEach(function(Se){Se.pts=i(Se.pts-U,ee)}),!O||G<0){if(H=H.filter(function(Se){return Se.pts>=0}),!H.length)return;I===0?G=0:R&&!K?G=Math.max(0,ee):G=H[0].pts}if(x.segmentCodec==="aac")for(var X=this.config.maxAudioFramesDrift,V=0,J=G;V<H.length;V++){var Q=H[V],ie=Q.pts,ae=ie-J,se=Math.abs(1e3*ae/P);if(ae<=-X*B&&K)V===0&&(g.logger.warn("Audio frame @ "+(ie/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*ae/P)+" ms."),this.nextAudioPts=G=J=ie);else if(ae>=X*B&&se<a&&K){var le=Math.round(ae/B);J=ie-le*B,J<0&&(le--,J+=B),V===0&&(this.nextAudioPts=G=J),g.logger.warn("[mp4-remuxer]: Injecting "+le+" audio frame @ "+(J/P).toFixed(3)+"s due to "+Math.round(1e3*ae/P)+" ms gap.");for(var ue=0;ue<le;ue++){var q=Math.max(J,0),oe=p.default.getSilentFrame(x.manifestCodec||x.codec,x.channelCount);oe||(g.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=Q.unit.subarray()),H.splice(V,0,{unit:oe,pts:q}),J+=B,V++}}Q.pts=J,J+=B}for(var de=null,ce=null,pe,he=0,ye=H.length;ye--;)he+=H[ye].unit.byteLength;for(var fe=0,me=H.length;fe<me;fe++){var W=H[fe],z=W.unit,Y=W.pts;if(ce!==null){var Z=N[fe-1];Z.duration=Math.round((Y-ce)/w)}else if(O&&x.segmentCodec==="aac"&&(Y=G),de=Y,he>0){he+=$;try{pe=new Uint8Array(he)}catch{this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:_.ErrorTypes.MUX_ERROR,details:_.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:he,reason:"fail allocating audio mdat "+he});return}if(!j){var re=new DataView(pe.buffer);re.setUint32(0,he),pe.set(m.default.types.mdat,4)}}else return;pe.set(z,$);var ne=z.byteLength;$+=ne,N.push(new v(!0,k,ne,0)),ce=Y}var te=N.length;if(!!te){var Ee=N[N.length-1];this.nextAudioPts=G=ce+w*Ee.duration;var ve=j?new Uint8Array(0):m.default.moof(x.sequenceNumber++,de/w,u({},x,{samples:N}));x.samples=[];var ge=de/P,_e=G/P,Le="audio",Ae={data1:ve,data2:pe,startPTS:ge,endPTS:_e,startDTS:ge,endDTS:_e,type:Le,hasAudio:!0,hasVideo:!1,nb:te};return this.isAudioContiguous=!0,console.assert(pe.length,"MDAT length must not be zero"),Ae}},E.remuxEmptyAudio=function(x,b,O,R){var I=x.inputTimeScale,P=x.samplerate?x.samplerate:I,F=I/P,w=this.nextAudioPts,k=(w!==null?w:R.startDTS*I)+this._initDTS,B=R.endDTS*I+this._initDTS,U=F*d,j=Math.ceil((B-k)/U),N=p.default.getSilentFrame(x.manifestCodec||x.codec,x.channelCount);if(g.logger.warn("[mp4-remuxer]: remux empty Audio"),!N){g.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var K=[],H=0;H<j;H++){var $=k+H*U;K.push({unit:N,pts:$,dts:$})}return x.samples=K,this.remuxAudio(x,b,O,!1)},S}();function i(S,E){var L;if(E===null)return S;for(E<S?L=-8589934592:L=8589934592;Math.abs(S-E)>4294967296;)S+=L;return S}function f(S){for(var E=0;E<S.length;E++)if(S[E].key)return E;return-1}function l(S,E,L,x){var b=S.samples.length;if(!!b){for(var O=S.inputTimeScale,R=0;R<b;R++){var I=S.samples[R];I.pts=i(I.pts-L,E*O)/O,I.dts=i(I.dts-x,E*O)/O}var P=S.samples;return S.samples=[],{samples:P}}}function o(S,E,L){var x=S.samples.length;if(!!x){for(var b=S.inputTimeScale,O=0;O<x;O++){var R=S.samples[O];R.pts=i(R.pts-L,E*b)/b}S.samples.sort(function(P,F){return P.pts-F.pts});var I=S.samples;return S.samples=[],{samples:I}}}var v=function(E,L,x,b){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=L,this.size=x,this.cts=b,this.flags=new D(E)},D=function(E){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=E?2:1,this.isNonSync=E?0:1}},"./src/remux/passthrough-remuxer.ts":function(M,C,y){y.r(C);var T=y("./src/polyfills/number.ts"),p=y("./src/remux/mp4-remuxer.ts"),m=y("./src/utils/mp4-tools.ts"),A=y("./src/loader/fragment.ts"),_=y("./src/utils/logger.ts"),g=function(){function u(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var a=u.prototype;return a.destroy=function(){},a.resetTimeStamp=function(c){this.initPTS=c,this.lastEndDTS=null},a.resetNextTimestamp=function(){this.lastEndDTS=null},a.resetInitSegment=function(c,h,t){this.audioCodec=h,this.videoCodec=t,this.generateInitSegment(c),this.emitInitSegment=!0},a.generateInitSegment=function(c){var h=this.audioCodec,t=this.videoCodec;if(!c||!c.byteLength){this.initTracks=void 0,this.initData=void 0;return}var e=this.initData=Object(m.parseInitSegment)(c);h||(h=r(e.audio,A.ElementaryStreamTypes.AUDIO)),t||(t=r(e.video,A.ElementaryStreamTypes.VIDEO));var n={};e.audio&&e.video?n.audiovideo={container:"video/mp4",codec:h+","+t,initSegment:c,id:"main"}:e.audio?n.audio={container:"audio/mp4",codec:h,initSegment:c,id:"audio"}:e.video?n.video={container:"video/mp4",codec:t,initSegment:c,id:"main"}:_.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=n},a.remux=function(c,h,t,e,n){var i,f=this.initPTS,l=this.lastEndDTS,o={audio:void 0,video:void 0,text:e,id3:t,initSegment:void 0};Object(T.isFiniteNumber)(l)||(l=this.lastEndDTS=n||0);var v=h.samples;if(!v||!v.length)return o;var D={initPTS:void 0,timescale:1},S=this.initData;if((!S||!S.length)&&(this.generateInitSegment(v),S=this.initData),!S||!S.length)return _.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),o;this.emitInitSegment&&(D.tracks=this.initTracks,this.emitInitSegment=!1),Object(T.isFiniteNumber)(f)||(this.initPTS=D.initPTS=f=s(S,v,l));var E=Object(m.getDuration)(v,S),L=l,x=E+L;Object(m.offsetStartDTS)(S,v,f),E>0?this.lastEndDTS=x:(_.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var b=!!S.audio,O=!!S.video,R="";b&&(R+="audio"),O&&(R+="video");var I={data1:v,startPTS:L,startDTS:L,endPTS:x,endDTS:x,type:R,hasAudio:b,hasVideo:O,nb:1,dropped:0};o.audio=I.type==="audio"?I:void 0,o.video=I.type!=="audio"?I:void 0,o.initSegment=D;var P=(i=this.initPTS)!=null?i:0;return o.id3=Object(p.flushTextTrackMetadataCueSamples)(t,n,P,P),e.samples.length&&(o.text=Object(p.flushTextTrackUserdataCueSamples)(e,n,P)),o},u}(),s=function(a,d,c){return Object(m.getStartDTS)(a,d)-c};function r(u,a){var d=u==null?void 0:u.codec;return d&&d.length>4?d:d==="hvc1"||d==="hev1"?"hvc1.1.c.L120.90":d==="av01"?"av01.0.04M.08":d==="avc1"||a===A.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}C.default=g},"./src/task-loop.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return T});var T=function(){function p(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var m=p.prototype;return m.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},m.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},m.onHandlerDestroyed=function(){},m.hasInterval=function(){return!!this._tickInterval},m.hasNextTick=function(){return!!this._tickTimer},m.setInterval=function(_){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,_),!0)},m.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},m.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},m.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},m.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},m.doTick=function(){},p}()},"./src/types/cmcd.ts":function(M,C,y){y.r(C),y.d(C,"CMCDVersion",function(){return T}),y.d(C,"CMCDObjectType",function(){return p}),y.d(C,"CMCDStreamingFormat",function(){return m}),y.d(C,"CMCDStreamType",function(){return A});var T=1,p;(function(_){_.MANIFEST="m",_.AUDIO="a",_.VIDEO="v",_.MUXED="av",_.INIT="i",_.CAPTION="c",_.TIMED_TEXT="tt",_.KEY="k",_.OTHER="o"})(p||(p={}));var m;(function(_){_.DASH="d",_.HLS="h",_.SMOOTH="s",_.OTHER="o"})(m||(m={}));var A;(function(_){_.VOD="v",_.LIVE="l"})(A||(A={}))},"./src/types/demuxer.ts":function(M,C,y){y.r(C),y.d(C,"MetadataSchema",function(){return T});var T;(function(p){p.audioId3="org.id3",p.dateRange="com.apple.quicktime.HLS",p.emsg="https://aomedia.org/emsg/ID3"})(T||(T={}))},"./src/types/level.ts":function(M,C,y){y.r(C),y.d(C,"HlsSkip",function(){return m}),y.d(C,"getSkipValue",function(){return A}),y.d(C,"HlsUrlParameters",function(){return _}),y.d(C,"Level",function(){return g});function T(s,r){for(var u=0;u<r.length;u++){var a=r[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,a.key,a)}}function p(s,r,u){return r&&T(s.prototype,r),u&&T(s,u),Object.defineProperty(s,"prototype",{writable:!1}),s}var m;(function(s){s.No="",s.Yes="YES",s.v2="v2"})(m||(m={}));function A(s,r){var u=s.canSkipUntil,a=s.canSkipDateRanges,d=s.endSN,c=r!==void 0?r-d:0;return u&&c<u?a?m.v2:m.Yes:m.No}var _=function(){function s(u,a,d){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=u,this.part=a,this.skip=d}var r=s.prototype;return r.addDirectives=function(a){var d=new self.URL(a);return this.msn!==void 0&&d.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&d.searchParams.set("_HLS_part",this.part.toString()),this.skip&&d.searchParams.set("_HLS_skip",this.skip),d.toString()},s}(),g=function(){function s(r){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[r.url],this.attrs=r.attrs,this.bitrate=r.bitrate,r.details&&(this.details=r.details),this.id=r.id||0,this.name=r.name,this.width=r.width||0,this.height=r.height||0,this.audioCodec=r.audioCodec,this.videoCodec=r.videoCodec,this.unknownCodecs=r.unknownCodecs,this.codecSet=[r.videoCodec,r.audioCodec].filter(function(u){return u}).join(",").replace(/\.[^.,]+/g,"")}return p(s,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(u){var a=u%this.url.length;this._urlId!==a&&(this.details=void 0,this._urlId=a)}}]),s}()},"./src/types/loader.ts":function(M,C,y){y.r(C),y.d(C,"PlaylistContextType",function(){return T}),y.d(C,"PlaylistLevelType",function(){return p});var T;(function(m){m.MANIFEST="manifest",m.LEVEL="level",m.AUDIO_TRACK="audioTrack",m.SUBTITLE_TRACK="subtitleTrack"})(T||(T={}));var p;(function(m){m.MAIN="main",m.AUDIO="audio",m.SUBTITLE="subtitle"})(p||(p={}))},"./src/types/transmuxer.ts":function(M,C,y){y.r(C),y.d(C,"ChunkMetadata",function(){return T});var T=function(A,_,g,s,r,u){s===void 0&&(s=0),r===void 0&&(r=-1),u===void 0&&(u=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=p(),this.buffering={audio:p(),video:p(),audiovideo:p()},this.level=A,this.sn=_,this.id=g,this.size=s,this.part=r,this.partial=u};function p(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(M,C,y){y.r(C),y.d(C,"AttrList",function(){return m});var T=/^(\d+)x(\d+)$/,p=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,m=function(){function A(g){typeof g=="string"&&(g=A.parseAttrList(g));for(var s in g)g.hasOwnProperty(s)&&(this[s]=g[s])}var _=A.prototype;return _.decimalInteger=function(s){var r=parseInt(this[s],10);return r>Number.MAX_SAFE_INTEGER?1/0:r},_.hexadecimalInteger=function(s){if(this[s]){var r=(this[s]||"0x").slice(2);r=(r.length&1?"0":"")+r;for(var u=new Uint8Array(r.length/2),a=0;a<r.length/2;a++)u[a]=parseInt(r.slice(a*2,a*2+2),16);return u}else return null},_.hexadecimalIntegerAsNumber=function(s){var r=parseInt(this[s],16);return r>Number.MAX_SAFE_INTEGER?1/0:r},_.decimalFloatingPoint=function(s){return parseFloat(this[s])},_.optionalFloat=function(s,r){var u=this[s];return u?parseFloat(u):r},_.enumeratedString=function(s){return this[s]},_.bool=function(s){return this[s]==="YES"},_.decimalResolution=function(s){var r=T.exec(this[s]);if(r!==null)return{width:parseInt(r[1],10),height:parseInt(r[2],10)}},A.parseAttrList=function(s){var r,u={},a='"';for(p.lastIndex=0;(r=p.exec(s))!==null;){var d=r[2];d.indexOf(a)===0&&d.lastIndexOf(a)===d.length-1&&(d=d.slice(1,-1)),u[r[1]]=d}return u},A}()},"./src/utils/binary-search.ts":function(M,C,y){y.r(C);var T={search:function(m,A){for(var _=0,g=m.length-1,s=null,r=null;_<=g;){s=(_+g)/2|0,r=m[s];var u=A(r);if(u>0)_=s+1;else if(u<0)g=s-1;else return r}return null}};C.default=T},"./src/utils/buffer-helper.ts":function(M,C,y){y.r(C),y.d(C,"BufferHelper",function(){return m});var T=y("./src/utils/logger.ts"),p={length:0,start:function(){return 0},end:function(){return 0}},m=function(){function A(){}return A.isBuffered=function(g,s){try{if(g){for(var r=A.getBuffered(g),u=0;u<r.length;u++)if(s>=r.start(u)&&s<=r.end(u))return!0}}catch{}return!1},A.bufferInfo=function(g,s,r){try{if(g){var u=A.getBuffered(g),a=[],d;for(d=0;d<u.length;d++)a.push({start:u.start(d),end:u.end(d)});return this.bufferedInfo(a,s,r)}}catch{}return{len:0,start:s,end:s,nextStart:void 0}},A.bufferedInfo=function(g,s,r){s=Math.max(0,s),g.sort(function(o,v){var D=o.start-v.start;return D||v.end-o.end});var u=[];if(r)for(var a=0;a<g.length;a++){var d=u.length;if(d){var c=u[d-1].end;g[a].start-c<r?g[a].end>c&&(u[d-1].end=g[a].end):u.push(g[a])}else u.push(g[a])}else u=g;for(var h=0,t,e=s,n=s,i=0;i<u.length;i++){var f=u[i].start,l=u[i].end;if(s+r>=f&&s<l)e=f,n=l,h=n-s;else if(s+r<f){t=f;break}}return{len:h,start:e||0,end:n||0,nextStart:t}},A.getBuffered=function(g){try{return g.buffered}catch(s){return T.logger.log("failed to get media.buffered",s),p}},A}()},"./src/utils/cea-608-parser.ts":function(M,C,y){y.r(C),y.d(C,"Row",function(){return n}),y.d(C,"CaptionScreen",function(){return i});var T=y("./src/utils/logger.ts"),p={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},m=function(E){var L=E;return p.hasOwnProperty(E)&&(L=p[E]),String.fromCharCode(L)},A=15,_=100,g={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},s={17:2,18:4,21:6,22:8,23:10,19:13,20:15},r={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},a=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],d;(function(S){S[S.ERROR=0]="ERROR",S[S.TEXT=1]="TEXT",S[S.WARNING=2]="WARNING",S[S.INFO=2]="INFO",S[S.DEBUG=3]="DEBUG",S[S.DATA=3]="DATA"})(d||(d={}));var c=function(){function S(){this.time=null,this.verboseLevel=d.ERROR}var E=S.prototype;return E.log=function(x,b){this.verboseLevel>=x&&T.logger.log(this.time+" ["+x+"] "+b)},S}(),h=function(E){for(var L=[],x=0;x<E.length;x++)L.push(E[x].toString(16));return L},t=function(){function S(L,x,b,O,R){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=L||"white",this.underline=x||!1,this.italics=b||!1,this.background=O||"black",this.flash=R||!1}var E=S.prototype;return E.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},E.setStyles=function(x){for(var b=["foreground","underline","italics","background","flash"],O=0;O<b.length;O++){var R=b[O];x.hasOwnProperty(R)&&(this[R]=x[R])}},E.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},E.equals=function(x){return this.foreground===x.foreground&&this.underline===x.underline&&this.italics===x.italics&&this.background===x.background&&this.flash===x.flash},E.copy=function(x){this.foreground=x.foreground,this.underline=x.underline,this.italics=x.italics,this.background=x.background,this.flash=x.flash},E.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},S}(),e=function(){function S(L,x,b,O,R,I){this.uchar=void 0,this.penState=void 0,this.uchar=L||" ",this.penState=new t(x,b,O,R,I)}var E=S.prototype;return E.reset=function(){this.uchar=" ",this.penState.reset()},E.setChar=function(x,b){this.uchar=x,this.penState.copy(b)},E.setPenState=function(x){this.penState.copy(x)},E.equals=function(x){return this.uchar===x.uchar&&this.penState.equals(x.penState)},E.copy=function(x){this.uchar=x.uchar,this.penState.copy(x.penState)},E.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},S}(),n=function(){function S(L){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var x=0;x<_;x++)this.chars.push(new e);this.logger=L,this.pos=0,this.currPenState=new t}var E=S.prototype;return E.equals=function(x){for(var b=!0,O=0;O<_;O++)if(!this.chars[O].equals(x.chars[O])){b=!1;break}return b},E.copy=function(x){for(var b=0;b<_;b++)this.chars[b].copy(x.chars[b])},E.isEmpty=function(){for(var x=!0,b=0;b<_;b++)if(!this.chars[b].isEmpty()){x=!1;break}return x},E.setCursor=function(x){this.pos!==x&&(this.pos=x),this.pos<0?(this.logger.log(d.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>_&&(this.logger.log(d.DEBUG,"Too large cursor position "+this.pos),this.pos=_)},E.moveCursor=function(x){var b=this.pos+x;if(x>1)for(var O=this.pos+1;O<b+1;O++)this.chars[O].setPenState(this.currPenState);this.setCursor(b)},E.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},E.insertChar=function(x){x>=144&&this.backSpace();var b=m(x);if(this.pos>=_){this.logger.log(d.ERROR,"Cannot insert "+x.toString(16)+" ("+b+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(b,this.currPenState),this.moveCursor(1)},E.clearFromPos=function(x){var b;for(b=x;b<_;b++)this.chars[b].reset()},E.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},E.clearToEndOfRow=function(){this.clearFromPos(this.pos)},E.getTextString=function(){for(var x=[],b=!0,O=0;O<_;O++){var R=this.chars[O].uchar;R!==" "&&(b=!1),x.push(R)}return b?"":x.join("")},E.setPenStyles=function(x){this.currPenState.setStyles(x);var b=this.chars[this.pos];b.setPenState(this.currPenState)},S}(),i=function(){function S(L){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var x=0;x<A;x++)this.rows.push(new n(L));this.logger=L,this.currRow=A-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var E=S.prototype;return E.reset=function(){for(var x=0;x<A;x++)this.rows[x].clear();this.currRow=A-1},E.equals=function(x){for(var b=!0,O=0;O<A;O++)if(!this.rows[O].equals(x.rows[O])){b=!1;break}return b},E.copy=function(x){for(var b=0;b<A;b++)this.rows[b].copy(x.rows[b])},E.isEmpty=function(){for(var x=!0,b=0;b<A;b++)if(!this.rows[b].isEmpty()){x=!1;break}return x},E.backSpace=function(){var x=this.rows[this.currRow];x.backSpace()},E.clearToEndOfRow=function(){var x=this.rows[this.currRow];x.clearToEndOfRow()},E.insertChar=function(x){var b=this.rows[this.currRow];b.insertChar(x)},E.setPen=function(x){var b=this.rows[this.currRow];b.setPenStyles(x)},E.moveCursor=function(x){var b=this.rows[this.currRow];b.moveCursor(x)},E.setCursor=function(x){this.logger.log(d.INFO,"setCursor: "+x);var b=this.rows[this.currRow];b.setCursor(x)},E.setPAC=function(x){this.logger.log(d.INFO,"pacData = "+JSON.stringify(x));var b=x.row-1;if(this.nrRollUpRows&&b<this.nrRollUpRows-1&&(b=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==b){for(var O=0;O<A;O++)this.rows[O].clear();var R=this.currRow+1-this.nrRollUpRows,I=this.lastOutputScreen;if(I){var P=I.rows[R].cueStartTime,F=this.logger.time;if(P&&F!==null&&P<F)for(var w=0;w<this.nrRollUpRows;w++)this.rows[b-this.nrRollUpRows+w+1].copy(I.rows[R+w])}}this.currRow=b;var k=this.rows[this.currRow];if(x.indent!==null){var B=x.indent,U=Math.max(B-1,0);k.setCursor(x.indent),x.color=k.chars[U].penState.foreground}var j={foreground:x.color,underline:x.underline,italics:x.italics,background:"black",flash:!1};this.setPen(j)},E.setBkgData=function(x){this.logger.log(d.INFO,"bkgData = "+JSON.stringify(x)),this.backSpace(),this.setPen(x),this.insertChar(32)},E.setRollUpRows=function(x){this.nrRollUpRows=x},E.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(d.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(d.TEXT,this.getDisplayText());var x=this.currRow+1-this.nrRollUpRows,b=this.rows.splice(x,1)[0];b.clear(),this.rows.splice(this.currRow,0,b),this.logger.log(d.INFO,"Rolling up")},E.getDisplayText=function(x){x=x||!1;for(var b=[],O="",R=-1,I=0;I<A;I++){var P=this.rows[I].getTextString();P&&(R=I+1,x?b.push("Row "+R+": '"+P+"'"):b.push(P.trim()))}return b.length>0&&(x?O="["+b.join(" | ")+"]":O=b.join(`
`)),O},E.getTextAndFormat=function(){return this.rows},S}(),f=function(){function S(L,x,b){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=L,this.outputFilter=x,this.mode=null,this.verbose=0,this.displayedMemory=new i(b),this.nonDisplayedMemory=new i(b),this.lastOutputScreen=new i(b),this.currRollUpRow=this.displayedMemory.rows[A-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=b}var E=S.prototype;return E.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[A-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},E.getHandler=function(){return this.outputFilter},E.setHandler=function(x){this.outputFilter=x},E.setPAC=function(x){this.writeScreen.setPAC(x)},E.setBkgData=function(x){this.writeScreen.setBkgData(x)},E.setMode=function(x){x!==this.mode&&(this.mode=x,this.logger.log(d.INFO,"MODE="+x),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=x)},E.insertChars=function(x){for(var b=0;b<x.length;b++)this.writeScreen.insertChar(x[b]);var O=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(d.INFO,O+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(d.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},E.ccRCL=function(){this.logger.log(d.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},E.ccBS=function(){this.logger.log(d.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},E.ccAOF=function(){},E.ccAON=function(){},E.ccDER=function(){this.logger.log(d.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},E.ccRU=function(x){this.logger.log(d.INFO,"RU("+x+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(x)},E.ccFON=function(){this.logger.log(d.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},E.ccRDC=function(){this.logger.log(d.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},E.ccTR=function(){this.logger.log(d.INFO,"TR"),this.setMode("MODE_TEXT")},E.ccRTD=function(){this.logger.log(d.INFO,"RTD"),this.setMode("MODE_TEXT")},E.ccEDM=function(){this.logger.log(d.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},E.ccCR=function(){this.logger.log(d.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},E.ccENM=function(){this.logger.log(d.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},E.ccEOC=function(){if(this.logger.log(d.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var x=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=x,this.writeScreen=this.nonDisplayedMemory,this.logger.log(d.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},E.ccTO=function(x){this.logger.log(d.INFO,"TO("+x+") - Tab Offset"),this.writeScreen.moveCursor(x)},E.ccMIDROW=function(x){var b={flash:!1};if(b.underline=x%2===1,b.italics=x>=46,b.italics)b.foreground="white";else{var O=Math.floor(x/2)-16,R=["white","green","blue","cyan","red","yellow","magenta"];b.foreground=R[O]}this.logger.log(d.INFO,"MIDROW: "+JSON.stringify(b)),this.writeScreen.setPen(b)},E.outputDataUpdate=function(x){x===void 0&&(x=!1);var b=this.logger.time;b!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=b:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,b,this.lastOutputScreen),x&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:b),this.lastOutputScreen.copy(this.displayedMemory))},E.cueSplitAtTime=function(x){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,x,this.displayedMemory),this.cueStartTime=x))},S}(),l=function(){function S(L,x,b){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var O=new c;this.channels=[null,new f(L,x,O),new f(L+1,b,O)],this.cmdHistory=D(),this.logger=O}var E=S.prototype;return E.getHandler=function(x){return this.channels[x].getHandler()},E.setHandler=function(x,b){this.channels[x].setHandler(b)},E.addData=function(x,b){var O,R,I,P=!1;this.logger.time=x;for(var F=0;F<b.length;F+=2)if(R=b[F]&127,I=b[F+1]&127,!(R===0&&I===0)){if(this.logger.log(d.DATA,"["+h([b[F],b[F+1]])+"] -> ("+h([R,I])+")"),O=this.parseCmd(R,I),O||(O=this.parseMidrow(R,I)),O||(O=this.parsePAC(R,I)),O||(O=this.parseBackgroundAttributes(R,I)),!O&&(P=this.parseChars(R,I),P)){var w=this.currentChannel;if(w&&w>0){var k=this.channels[w];k.insertChars(P)}else this.logger.log(d.WARNING,"No channel found yet. TEXT-MODE?")}!O&&!P&&this.logger.log(d.WARNING,"Couldn't parse cleaned data "+h([R,I])+" orig: "+h([b[F],b[F+1]]))}},E.parseCmd=function(x,b){var O=this.cmdHistory,R=(x===20||x===28||x===21||x===29)&&b>=32&&b<=47,I=(x===23||x===31)&&b>=33&&b<=35;if(!(R||I))return!1;if(v(x,b,O))return o(null,null,O),this.logger.log(d.DEBUG,"Repeated command ("+h([x,b])+") is dropped"),!0;var P=x===20||x===21||x===23?1:2,F=this.channels[P];return x===20||x===21||x===28||x===29?b===32?F.ccRCL():b===33?F.ccBS():b===34?F.ccAOF():b===35?F.ccAON():b===36?F.ccDER():b===37?F.ccRU(2):b===38?F.ccRU(3):b===39?F.ccRU(4):b===40?F.ccFON():b===41?F.ccRDC():b===42?F.ccTR():b===43?F.ccRTD():b===44?F.ccEDM():b===45?F.ccCR():b===46?F.ccENM():b===47&&F.ccEOC():F.ccTO(b-32),o(x,b,O),this.currentChannel=P,!0},E.parseMidrow=function(x,b){var O=0;if((x===17||x===25)&&b>=32&&b<=47){if(x===17?O=1:O=2,O!==this.currentChannel)return this.logger.log(d.ERROR,"Mismatch channel in midrow parsing"),!1;var R=this.channels[O];return R?(R.ccMIDROW(b),this.logger.log(d.DEBUG,"MIDROW ("+h([x,b])+")"),!0):!1}return!1},E.parsePAC=function(x,b){var O,R=this.cmdHistory,I=(x>=17&&x<=23||x>=25&&x<=31)&&b>=64&&b<=127,P=(x===16||x===24)&&b>=64&&b<=95;if(!(I||P))return!1;if(v(x,b,R))return o(null,null,R),!0;var F=x<=23?1:2;b>=64&&b<=95?O=F===1?g[x]:r[x]:O=F===1?s[x]:u[x];var w=this.channels[F];return w?(w.setPAC(this.interpretPAC(O,b)),o(x,b,R),this.currentChannel=F,!0):!1},E.interpretPAC=function(x,b){var O,R={color:null,italics:!1,indent:null,underline:!1,row:x};return b>95?O=b-96:O=b-64,R.underline=(O&1)===1,O<=13?R.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(O/2)]:O<=15?(R.italics=!0,R.color="white"):R.indent=Math.floor((O-16)/2)*4,R},E.parseChars=function(x,b){var O,R=null,I=null;if(x>=25?(O=2,I=x-8):(O=1,I=x),I>=17&&I<=19){var P;I===17?P=b+80:I===18?P=b+112:P=b+144,this.logger.log(d.INFO,"Special char '"+m(P)+"' in channel "+O),R=[P]}else x>=32&&x<=127&&(R=b===0?[x]:[x,b]);if(R){var F=h(R);this.logger.log(d.DEBUG,"Char codes =  "+F.join(",")),o(x,b,this.cmdHistory)}return R},E.parseBackgroundAttributes=function(x,b){var O=(x===16||x===24)&&b>=32&&b<=47,R=(x===23||x===31)&&b>=45&&b<=47;if(!(O||R))return!1;var I,P={};x===16||x===24?(I=Math.floor((b-32)/2),P.background=a[I],b%2===1&&(P.background=P.background+"_semi")):b===45?P.background="transparent":(P.foreground="black",b===47&&(P.underline=!0));var F=x<=23?1:2,w=this.channels[F];return w.setBkgData(P),o(x,b,this.cmdHistory),!0},E.reset=function(){for(var x=0;x<Object.keys(this.channels).length;x++){var b=this.channels[x];b&&b.reset()}this.cmdHistory=D()},E.cueSplitAtTime=function(x){for(var b=0;b<this.channels.length;b++){var O=this.channels[b];O&&O.cueSplitAtTime(x)}},S}();function o(S,E,L){L.a=S,L.b=E}function v(S,E,L){return L.a===S&&L.b===E}function D(){return{a:null,b:null}}C.default=l},"./src/utils/codecs.ts":function(M,C,y){y.r(C),y.d(C,"isCodecType",function(){return p}),y.d(C,"isCodecSupportedInMp4",function(){return m});var T={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function p(A,_){var g=T[_];return!!g&&g[A.slice(0,4)]===!0}function m(A,_){return MediaSource.isTypeSupported((_||"video")+'/mp4;codecs="'+A+'"')}},"./src/utils/cues.ts":function(M,C,y){y.r(C);var T=y("./src/utils/vttparser.ts"),p=y("./src/utils/webvtt-parser.ts"),m=y("./src/utils/texttrack-utils.ts"),A=/\s/,_={newCue:function(s,r,u,a){for(var d=[],c,h,t,e,n,i=self.VTTCue||self.TextTrackCue,f=0;f<a.rows.length;f++)if(c=a.rows[f],t=!0,e=0,n="",!c.isEmpty()){for(var l=0;l<c.chars.length;l++)A.test(c.chars[l].uchar)&&t?e++:(n+=c.chars[l].uchar,t=!1);c.cueStartTime=r,r===u&&(u+=1e-4),e>=16?e--:e++;var o=Object(T.fixLineBreaks)(n.trim()),v=Object(p.generateCueId)(r,u,o);(!s||!s.cues||!s.cues.getCueById(v))&&(h=new i(r,u,o),h.id=v,h.line=f+1,h.align="left",h.position=10+Math.min(80,Math.floor(e*8/32)*10),d.push(h))}return s&&d.length&&(d.sort(function(D,S){return D.line==="auto"||S.line==="auto"?0:D.line>8&&S.line>8?S.line-D.line:D.line-S.line}),d.forEach(function(D){return Object(m.addCueToTrack)(s,D)})),d}};C.default=_},"./src/utils/discontinuities.ts":function(M,C,y){y.r(C),y.d(C,"findFirstFragWithCC",function(){return A}),y.d(C,"shouldAlignOnDiscontinuities",function(){return _}),y.d(C,"findDiscontinuousReferenceFrag",function(){return g}),y.d(C,"adjustSlidingStart",function(){return r}),y.d(C,"alignStream",function(){return u}),y.d(C,"alignPDT",function(){return d}),y.d(C,"alignFragmentByPDTDelta",function(){return c}),y.d(C,"alignMediaPlaylistByPDT",function(){return h});var T=y("./src/polyfills/number.ts"),p=y("./src/utils/logger.ts"),m=y("./src/controller/level-helper.ts");function A(t,e){for(var n=null,i=0,f=t.length;i<f;i++){var l=t[i];if(l&&l.cc===e){n=l;break}}return n}function _(t,e,n){return!!(e.details&&(n.endCC>n.startCC||t&&t.cc<n.startCC))}function g(t,e){var n=t.fragments,i=e.fragments;if(!i.length||!n.length){p.logger.log("No fragments to align");return}var f=A(n,i[0].cc);if(!f||f&&!f.startPTS){p.logger.log("No frag in previous level to align on");return}return f}function s(t,e){if(t){var n=t.start+e;t.start=t.startPTS=n,t.endPTS=n+t.duration}}function r(t,e){for(var n=e.fragments,i=0,f=n.length;i<f;i++)s(n[i],t);e.fragmentHint&&s(e.fragmentHint,t),e.alignedSliding=!0}function u(t,e,n){!e||(a(t,n,e),!n.alignedSliding&&e.details&&d(n,e.details),!n.alignedSliding&&e.details&&!n.skippedSegments&&Object(m.adjustSliding)(e.details,n))}function a(t,e,n){if(_(t,n,e)){var i=g(n.details,e);i&&Object(T.isFiniteNumber)(i.start)&&(p.logger.log("Adjusting PTS using last level due to CC increase within current level "+e.url),r(i.start,e))}}function d(t,e){if(!(!e.fragments.length||!t.hasProgramDateTime||!e.hasProgramDateTime)){var n=e.fragments[0].programDateTime,i=t.fragments[0].programDateTime,f=(i-n)/1e3+e.fragments[0].start;f&&Object(T.isFiniteNumber)(f)&&(p.logger.log("Adjusting PTS using programDateTime delta "+(i-n)+"ms, sliding:"+f.toFixed(3)+" "+t.url+" "),r(f,t))}}function c(t,e){var n=t.programDateTime;if(!!n){var i=(n-e)/1e3;t.start=t.startPTS=i,t.endPTS=i+t.duration}}function h(t,e){if(!(!e.fragments.length||!t.hasProgramDateTime||!e.hasProgramDateTime)){var n=e.fragments[0].programDateTime,i=e.fragments[0].start,f=n-i*1e3;t.fragments.forEach(function(l){c(l,f)}),t.fragmentHint&&c(t.fragmentHint,f),t.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(M,C,y){y.r(C);var T=y("./src/utils/ewma.ts"),p=function(){function m(_,g,s){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new T.default(_),this.fast_=new T.default(g)}var A=m.prototype;return A.update=function(g,s){var r=this.slow_,u=this.fast_;this.slow_.halfLife!==g&&(this.slow_=new T.default(g,r.getEstimate(),r.getTotalWeight())),this.fast_.halfLife!==s&&(this.fast_=new T.default(s,u.getEstimate(),u.getTotalWeight()))},A.sample=function(g,s){g=Math.max(g,this.minDelayMs_);var r=8*s,u=g/1e3,a=r/u;this.fast_.sample(u,a),this.slow_.sample(u,a)},A.canEstimate=function(){var g=this.fast_;return g&&g.getTotalWeight()>=this.minWeight_},A.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},A.destroy=function(){},m}();C.default=p},"./src/utils/ewma.ts":function(M,C,y){y.r(C);var T=function(){function p(A,_,g){_===void 0&&(_=0),g===void 0&&(g=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=A,this.alpha_=A?Math.exp(Math.log(.5)/A):0,this.estimate_=_,this.totalWeight_=g}var m=p.prototype;return m.sample=function(_,g){var s=Math.pow(this.alpha_,_);this.estimate_=g*(1-s)+s*this.estimate_,this.totalWeight_+=_},m.getTotalWeight=function(){return this.totalWeight_},m.getEstimate=function(){if(this.alpha_){var _=1-Math.pow(this.alpha_,this.totalWeight_);if(_)return this.estimate_/_}return this.estimate_},p}();C.default=T},"./src/utils/fetch-loader.ts":function(M,C,y){y.r(C),y.d(C,"fetchSupported",function(){return c});var T=y("./src/polyfills/number.ts"),p=y("./src/loader/load-stats.ts"),m=y("./src/demux/chunk-cache.ts");function A(i,f){i.prototype=Object.create(f.prototype),i.prototype.constructor=i,u(i,f)}function _(i){var f=typeof Map=="function"?new Map:void 0;return _=function(o){if(o===null||!r(o))return o;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(typeof f<"u"){if(f.has(o))return f.get(o);f.set(o,v)}function v(){return g(o,arguments,a(this).constructor)}return v.prototype=Object.create(o.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),u(v,o)},_(i)}function g(i,f,l){return s()?g=Reflect.construct.bind():g=function(v,D,S){var E=[null];E.push.apply(E,D);var L=Function.bind.apply(v,E),x=new L;return S&&u(x,S.prototype),x},g.apply(null,arguments)}function s(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function r(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function u(i,f){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,v){return o.__proto__=v,o},u(i,f)}function a(i){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},a(i)}function d(){return d=Object.assign?Object.assign.bind():function(i){for(var f=1;f<arguments.length;f++){var l=arguments[f];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(i[o]=l[o])}return i},d.apply(this,arguments)}function c(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var h=function(){function i(l){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=l.fetchSetup||e,this.controller=new self.AbortController,this.stats=new p.LoadStats}var f=i.prototype;return f.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},f.abortInternal=function(){var o=this.response;(!o||!o.ok)&&(this.stats.aborted=!0,this.controller.abort())},f.abort=function(){var o;this.abortInternal(),(o=this.callbacks)!==null&&o!==void 0&&o.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},f.load=function(o,v,D){var S=this,E=this.stats;if(E.loading.start)throw new Error("Loader can only be used once.");E.loading.start=self.performance.now();var L=t(o,this.controller.signal),x=D.onProgress,b=o.responseType==="arraybuffer",O=b?"byteLength":"length";this.context=o,this.config=v,this.callbacks=D,this.request=this.fetchSetup(o,L),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){S.abortInternal(),D.onTimeout(E,o,S.response)},v.timeout),self.fetch(this.request).then(function(R){if(S.response=S.loader=R,!R.ok){var I=R.status,P=R.statusText;throw new n(P||"fetch, bad network response",I,R)}return E.loading.first=Math.max(self.performance.now(),E.loading.start),E.total=parseInt(R.headers.get("Content-Length")||"0"),x&&Object(T.isFiniteNumber)(v.highWaterMark)?S.loadProgressively(R,E,o,v.highWaterMark,x):b?R.arrayBuffer():R.text()}).then(function(R){var I=S.response;self.clearTimeout(S.requestTimeout),E.loading.end=Math.max(self.performance.now(),E.loading.first),E.loaded=E.total=R[O];var P={url:I.url,data:R};x&&!Object(T.isFiniteNumber)(v.highWaterMark)&&x(E,o,R,I),D.onSuccess(P,E,o,I)}).catch(function(R){if(self.clearTimeout(S.requestTimeout),!E.aborted){var I=R&&R.code||0,P=R?R.message:null;D.onError({code:I,text:P},o,R?R.details:null)}})},f.getCacheAge=function(){var o=null;if(this.response){var v=this.response.headers.get("age");o=v?parseFloat(v):null}return o},f.loadProgressively=function(o,v,D,S,E){S===void 0&&(S=0);var L=new m.default,x=o.body.getReader(),b=function O(){return x.read().then(function(R){if(R.done)return L.dataLength&&E(v,D,L.flush(),o),Promise.resolve(new ArrayBuffer(0));var I=R.value,P=I.length;return v.loaded+=P,P<S||L.dataLength?(L.push(I),L.dataLength>=S&&E(v,D,L.flush(),o)):E(v,D,I,o),O()}).catch(function(){return Promise.reject()})};return b()},i}();function t(i,f){var l={method:"GET",mode:"cors",credentials:"same-origin",signal:f,headers:new self.Headers(d({},i.headers))};return i.rangeEnd&&l.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),l}function e(i,f){return new self.Request(i.url,f)}var n=function(i){A(f,i);function f(l,o,v){var D;return D=i.call(this,l)||this,D.code=void 0,D.details=void 0,D.code=o,D.details=v,D}return f}(_(Error));C.default=h},"./src/utils/imsc1-ttml-parser.ts":function(M,C,y){y.r(C),y.d(C,"IMSC1_CODEC",function(){return r}),y.d(C,"parseIMSC1",function(){return c});var T=y("./src/utils/mp4-tools.ts"),p=y("./src/utils/vttparser.ts"),m=y("./src/utils/vttcue.ts"),A=y("./src/demux/id3.ts"),_=y("./src/utils/timescale-conversion.ts"),g=y("./src/utils/webvtt-parser.ts");function s(){return s=Object.assign?Object.assign.bind():function(S){for(var E=1;E<arguments.length;E++){var L=arguments[E];for(var x in L)Object.prototype.hasOwnProperty.call(L,x)&&(S[x]=L[x])}return S},s.apply(this,arguments)}var r="stpp.ttml.im1t",u=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,a=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,d={left:"start",center:"center",right:"end",start:"start",end:"end"};function c(S,E,L,x,b){var O=Object(T.findBox)(new Uint8Array(S),["mdat"]);if(O.length===0){b(new Error("Could not parse IMSC1 mdat"));return}var R=O.map(function(P){return Object(A.utf8ArrayToStr)(P)}),I=Object(_.toTimescaleFromScale)(E,1,L);try{R.forEach(function(P){return x(h(P,I))})}catch(P){b(P)}}function h(S,E){var L=new DOMParser,x=L.parseFromString(S,"text/xml"),b=x.getElementsByTagName("tt")[0];if(!b)throw new Error("Invalid ttml");var O={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},R=Object.keys(O).reduce(function(k,B){return k[B]=b.getAttribute("ttp:"+B)||O[B],k},{}),I=b.getAttribute("xml:space")!=="preserve",P=e(t(b,"styling","style")),F=e(t(b,"layout","region")),w=t(b,"body","[begin]");return[].map.call(w,function(k){var B=n(k,I);if(!B||!k.hasAttribute("begin"))return null;var U=o(k.getAttribute("begin"),R),j=o(k.getAttribute("dur"),R),N=o(k.getAttribute("end"),R);if(U===null)throw l(k);if(N===null){if(j===null)throw l(k);N=U+j}var K=new m.default(U-E,N-E,B);K.id=Object(g.generateCueId)(K.startTime,K.endTime,K.text);var H=F[k.getAttribute("region")],$=P[k.getAttribute("style")];K.position=10,K.size=80;var G=i(H,$,P),ee=G.textAlign;if(ee){var X=d[ee];X&&(K.lineAlign=X),K.align=ee}return s(K,G),K}).filter(function(k){return k!==null})}function t(S,E,L){var x=S.getElementsByTagName(E)[0];return x?[].slice.call(x.querySelectorAll(L)):[]}function e(S){return S.reduce(function(E,L){var x=L.getAttribute("xml:id");return x&&(E[x]=L),E},{})}function n(S,E){return[].slice.call(S.childNodes).reduce(function(L,x,b){var O;return x.nodeName==="br"&&b?L+`
`:(O=x.childNodes)!==null&&O!==void 0&&O.length?n(x,E):E?L+x.textContent.trim().replace(/\s+/g," "):L+x.textContent},"")}function i(S,E,L){var x="http://www.w3.org/ns/ttml#styling",b=null,O=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],R=S!=null&&S.hasAttribute("style")?S.getAttribute("style"):null;return R&&L.hasOwnProperty(R)&&(b=L[R]),O.reduce(function(I,P){var F=f(E,x,P)||f(S,x,P)||f(b,x,P);return F&&(I[P]=F),I},{})}function f(S,E,L){return S&&S.hasAttributeNS(E,L)?S.getAttributeNS(E,L):null}function l(S){return new Error("Could not parse ttml timestamp "+S)}function o(S,E){if(!S)return null;var L=Object(p.parseTimeStamp)(S);return L===null&&(u.test(S)?L=v(S,E):a.test(S)&&(L=D(S,E))),L}function v(S,E){var L=u.exec(S),x=(L[4]|0)+(L[5]|0)/E.subFrameRate;return(L[1]|0)*3600+(L[2]|0)*60+(L[3]|0)+x/E.frameRate}function D(S,E){var L=a.exec(S),x=Number(L[1]),b=L[2];switch(b){case"h":return x*3600;case"m":return x*60;case"ms":return x*1e3;case"f":return x/E.frameRate;case"t":return x/E.tickRate}return x}},"./src/utils/logger.ts":function(M,C,y){y.r(C),y.d(C,"enableLogs",function(){return g}),y.d(C,"logger",function(){return s});var T=function(){},p={trace:T,debug:T,log:T,warn:T,info:T,error:T},m=p;function A(r){var u=self.console[r];return u?u.bind(self.console,"["+r+"] >"):T}function _(r){for(var u=arguments.length,a=new Array(u>1?u-1:0),d=1;d<u;d++)a[d-1]=arguments[d];a.forEach(function(c){m[c]=r[c]?r[c].bind(r):A(c)})}function g(r){if(self.console&&r===!0||typeof r=="object"){_(r,"debug","log","info","warn","error");try{m.log()}catch{m=p}}else m=p}var s=m},"./src/utils/mediakeys-helper.ts":function(M,C,y){y.r(C),y.d(C,"KeySystems",function(){return T}),y.d(C,"requestMediaKeySystemAccess",function(){return p});var T;(function(m){m.WIDEVINE="com.widevine.alpha",m.PLAYREADY="com.microsoft.playready"})(T||(T={}));var p=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(M,C,y){y.r(C),y.d(C,"getMediaSource",function(){return T});function T(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(M,C,y){y.r(C),y.d(C,"RemuxerTrackIdConfig",function(){return g}),y.d(C,"bin2str",function(){return s}),y.d(C,"readUint16",function(){return r}),y.d(C,"readUint32",function(){return u}),y.d(C,"readSint32",function(){return a}),y.d(C,"writeUint32",function(){return d}),y.d(C,"findBox",function(){return c}),y.d(C,"parseSegmentIndex",function(){return h}),y.d(C,"parseInitSegment",function(){return t}),y.d(C,"getStartDTS",function(){return e}),y.d(C,"getDuration",function(){return n}),y.d(C,"computeRawDurationFromSamples",function(){return i}),y.d(C,"offsetStartDTS",function(){return f}),y.d(C,"segmentValidRange",function(){return l}),y.d(C,"appendUint8Array",function(){return o}),y.d(C,"parseSamples",function(){return v}),y.d(C,"parseSEIMessageFromNALu",function(){return E}),y.d(C,"parseEmsg",function(){return x});var T=y("./src/utils/typed-array.ts"),p=y("./src/loader/fragment.ts"),m=y("./src/demux/id3.ts"),A=Math.pow(2,32)-1,_=[].push,g={video:1,audio:2,id3:3,text:4};function s(b){return String.fromCharCode.apply(null,b)}function r(b,O){var R=b[O]<<8|b[O+1];return R<0?65536+R:R}function u(b,O){var R=a(b,O);return R<0?4294967296+R:R}function a(b,O){return b[O]<<24|b[O+1]<<16|b[O+2]<<8|b[O+3]}function d(b,O,R){b[O]=R>>24,b[O+1]=R>>16&255,b[O+2]=R>>8&255,b[O+3]=R&255}function c(b,O){var R=[];if(!O.length)return R;for(var I=b.byteLength,P=0;P<I;){var F=u(b,P),w=s(b.subarray(P+4,P+8)),k=F>1?P+F:I;if(w===O[0])if(O.length===1)R.push(b.subarray(P+8,k));else{var B=c(b.subarray(P+8,k),O.slice(1));B.length&&_.apply(R,B)}P=k}return R}function h(b){var O=[],R=b[0],I=8,P=u(b,I);I+=4;var F=0,w=0;R===0?I+=8:I+=16,I+=2;var k=b.length+w,B=r(b,I);I+=2;for(var U=0;U<B;U++){var j=I,N=u(b,j);j+=4;var K=N&2147483647,H=(N&2147483648)>>>31;if(H===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var $=u(b,j);j+=4,O.push({referenceSize:K,subsegmentDuration:$,info:{duration:$/P,start:k,end:k+K-1}}),k+=K,j+=4,I=j}return{earliestPresentationTime:F,timescale:P,version:R,referencesCount:B,references:O}}function t(b){for(var O=[],R=c(b,["moov","trak"]),I=0;I<R.length;I++){var P=R[I],F=c(P,["tkhd"])[0];if(F){var w=F[0],k=w===0?12:20,B=u(F,k),U=c(P,["mdia","mdhd"])[0];if(U){w=U[0],k=w===0?12:20;var j=u(U,k),N=c(P,["mdia","hdlr"])[0];if(N){var K=s(N.subarray(8,12)),H={soun:p.ElementaryStreamTypes.AUDIO,vide:p.ElementaryStreamTypes.VIDEO}[K];if(H){var $=c(P,["mdia","minf","stbl","stsd"])[0],G=void 0;$&&(G=s($.subarray(12,16))),O[B]={timescale:j,type:H},O[H]={timescale:j,id:B,codec:G}}}}}}var ee=c(b,["moov","mvex","trex"]);return ee.forEach(function(X){var V=u(X,4),J=O[V];J&&(J.default={duration:u(X,12),flags:u(X,20)})}),O}function e(b,O){return c(O,["moof","traf"]).reduce(function(R,I){var P=c(I,["tfdt"])[0],F=P[0],w=c(I,["tfhd"]).reduce(function(k,B){var U=u(B,4),j=b[U];if(j){var N=u(P,4);F===1&&(N*=Math.pow(2,32),N+=u(P,8));var K=j.timescale||9e4,H=N/K;if(isFinite(H)&&(k===null||H<k))return H}return k},null);return w!==null&&isFinite(w)&&(R===null||w<R)?w:R},null)||0}function n(b,O){for(var R=0,I=0,P=0,F=c(b,["moof","traf"]),w=0;w<F.length;w++){var k=F[w],B=c(k,["tfhd"])[0],U=u(B,4),j=O[U];if(!!j){var N=j.default,K=u(B,0)|(N==null?void 0:N.flags),H=N==null?void 0:N.duration;K&8&&(K&2?H=u(B,12):H=u(B,8));for(var $=j.timescale||9e4,G=c(k,["trun"]),ee=0;ee<G.length;ee++){if(R=i(G[ee]),!R&&H){var X=u(G[ee],4);R=H*X}j.type===p.ElementaryStreamTypes.VIDEO?I+=R/$:j.type===p.ElementaryStreamTypes.AUDIO&&(P+=R/$)}}}if(I===0&&P===0){for(var V=0,J=c(b,["sidx"]),Q=0;Q<J.length;Q++){var ie=h(J[Q]);ie!=null&&ie.references&&(V+=ie.references.reduce(function(ae,se){return ae+se.info.duration||0},0))}return V}return I||P}function i(b){var O=u(b,0),R=8;O&1&&(R+=4),O&4&&(R+=4);for(var I=0,P=u(b,4),F=0;F<P;F++){if(O&256){var w=u(b,R);I+=w,R+=4}O&512&&(R+=4),O&1024&&(R+=4),O&2048&&(R+=4)}return I}function f(b,O,R){c(O,["moof","traf"]).forEach(function(I){c(I,["tfhd"]).forEach(function(P){var F=u(P,4),w=b[F];if(!!w){var k=w.timescale||9e4;c(I,["tfdt"]).forEach(function(B){var U=B[0],j=u(B,4);if(U===0)j-=R*k,j=Math.max(j,0),d(B,4,j);else{j*=Math.pow(2,32),j+=u(B,8),j-=R*k,j=Math.max(j,0);var N=Math.floor(j/(A+1)),K=Math.floor(j%(A+1));d(B,4,N),d(B,8,K)}})}})})}function l(b){var O={valid:null,remainder:null},R=c(b,["moof"]);if(R){if(R.length<2)return O.remainder=b,O}else return O;var I=R[R.length-1];return O.valid=Object(T.sliceUint8)(b,0,I.byteOffset-8),O.remainder=Object(T.sliceUint8)(b,I.byteOffset-8),O}function o(b,O){var R=new Uint8Array(b.length+O.length);return R.set(b),R.set(O,b.length),R}function v(b,O){var R=[],I=O.samples,P=O.timescale,F=O.id,w=!1,k=c(I,["moof"]);return k.map(function(B){var U=B.byteOffset-8,j=c(B,["traf"]);j.map(function(N){var K=c(N,["tfdt"]).map(function(H){var $=H[0],G=u(H,4);return $===1&&(G*=Math.pow(2,32),G+=u(H,8)),G/P})[0];return K!==void 0&&(b=K),c(N,["tfhd"]).map(function(H){var $=u(H,4),G=u(H,0)&16777215,ee=(G&1)!==0,X=(G&2)!==0,V=(G&8)!==0,J=0,Q=(G&16)!==0,ie=0,ae=(G&32)!==0,se=8;$===F&&(ee&&(se+=8),X&&(se+=4),V&&(J=u(H,se),se+=4),Q&&(ie=u(H,se),se+=4),ae&&(se+=4),O.type==="video"&&(w=D(O.codec)),c(N,["trun"]).map(function(le){var ue=le[0],q=u(le,0)&16777215,oe=(q&1)!==0,de=0,ce=(q&4)!==0,pe=(q&256)!==0,he=0,ye=(q&512)!==0,fe=0,me=(q&1024)!==0,W=(q&2048)!==0,z=0,Y=u(le,4),Z=8;oe&&(de=u(le,Z),Z+=4),ce&&(Z+=4);for(var re=de+U,ne=0;ne<Y;ne++){if(pe?(he=u(le,Z),Z+=4):he=J,ye?(fe=u(le,Z),Z+=4):fe=ie,me&&(Z+=4),W&&(ue===0?z=u(le,Z):z=a(le,Z),Z+=4),O.type===p.ElementaryStreamTypes.VIDEO)for(var te=0;te<fe;){var Ee=u(I,re);re+=4;var ve=I[re]&31;if(S(w,ve)){var ge=I.subarray(re,re+Ee);E(ge,b+z/P,R)}re+=Ee,te+=Ee+4}b+=he/P}}))})})}),R}function D(b){if(!b)return!1;var O=b.indexOf("."),R=O<0?b:b.substring(0,O);return R==="hvc1"||R==="hev1"||R==="dvh1"||R==="dvhe"}function S(b,O){return b?O===39||O===40:O===6}function E(b,O,R){var I=L(b),P=0;P++;for(var F=0,w=0,k=!1,B=0;P<I.length;){F=0;do{if(P>=I.length)break;B=I[P++],F+=B}while(B===255);w=0;do{if(P>=I.length)break;B=I[P++],w+=B}while(B===255);var U=I.length-P;if(!k&&F===4&&P<I.length){k=!0;var j=I[P++];if(j===181){var N=r(I,P);if(P+=2,N===49){var K=u(I,P);if(P+=4,K===1195456820){var H=I[P++];if(H===3){var $=I[P++],G=31&$,ee=64&$,X=ee?2+G*3:0,V=new Uint8Array(X);if(ee){V[0]=$;for(var J=1;J<X;J++)V[J]=I[P++]}R.push({type:H,payloadType:F,pts:O,bytes:V})}}}}}else if(F===5&&w<U){if(k=!0,w>16){for(var Q=[],ie=0;ie<16;ie++){var ae=I[P++].toString(16);Q.push(ae.length==1?"0"+ae:ae),(ie===3||ie===5||ie===7||ie===9)&&Q.push("-")}for(var se=w-16,le=new Uint8Array(se),ue=0;ue<se;ue++)le[ue]=I[P++];R.push({payloadType:F,pts:O,uuid:Q.join(""),userData:Object(m.utf8ArrayToStr)(le),userDataBytes:le})}}else if(w<U)P+=w;else if(w>U)break}}function L(b){for(var O=b.byteLength,R=[],I=1;I<O-2;)b[I]===0&&b[I+1]===0&&b[I+2]===3?(R.push(I+2),I+=2):I++;if(R.length===0)return b;var P=O-R.length,F=new Uint8Array(P),w=0;for(I=0;I<P;w++,I++)w===R[0]&&(w++,R.shift()),F[I]=b[w];return F}function x(b){var O=b[0],R="",I="",P=0,F=0,w=0,k=0,B=0,U=0;if(O===0){for(;s(b.subarray(U,U+1))!=="\0";)R+=s(b.subarray(U,U+1)),U+=1;for(R+=s(b.subarray(U,U+1)),U+=1;s(b.subarray(U,U+1))!=="\0";)I+=s(b.subarray(U,U+1)),U+=1;I+=s(b.subarray(U,U+1)),U+=1,P=u(b,12),F=u(b,16),k=u(b,20),B=u(b,24),U=28}else if(O===1){U+=4,P=u(b,U),U+=4;var j=u(b,U);U+=4;var N=u(b,U);for(U+=4,w=Math.pow(2,32)*j+N,Number.isSafeInteger(w)||(w=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),k=u(b,U),U+=4,B=u(b,U),U+=4;s(b.subarray(U,U+1))!=="\0";)R+=s(b.subarray(U,U+1)),U+=1;for(R+=s(b.subarray(U,U+1)),U+=1;s(b.subarray(U,U+1))!=="\0";)I+=s(b.subarray(U,U+1)),U+=1;I+=s(b.subarray(U,U+1)),U+=1}var K=b.subarray(U,b.byteLength);return{schemeIdUri:R,value:I,timeScale:P,presentationTime:w,presentationTimeDelta:F,eventDuration:k,id:B,payload:K}}},"./src/utils/output-filter.ts":function(M,C,y){y.r(C),y.d(C,"default",function(){return T});var T=function(){function p(A,_){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=A,this.trackName=_}var m=p.prototype;return m.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},m.newCue=function(_,g,s){(this.startTime===null||this.startTime>_)&&(this.startTime=_),this.endTime=g,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)},m.reset=function(){this.cueRanges=[],this.startTime=null},p}()},"./src/utils/texttrack-utils.ts":function(M,C,y){y.r(C),y.d(C,"sendAddTrackEvent",function(){return p}),y.d(C,"addCueToTrack",function(){return m}),y.d(C,"clearCurrentCues",function(){return A}),y.d(C,"removeCuesInRange",function(){return _}),y.d(C,"getCuesInRange",function(){return s});var T=y("./src/utils/logger.ts");function p(r,u){var a;try{a=new Event("addtrack")}catch{a=document.createEvent("Event"),a.initEvent("addtrack",!1,!1)}a.track=r,u.dispatchEvent(a)}function m(r,u){var a=r.mode;if(a==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(u.id))try{if(r.addCue(u),!r.cues.getCueById(u.id))throw new Error("addCue is failed for: "+u)}catch(c){T.logger.debug("[texttrack-utils]: "+c);var d=new self.TextTrackCue(u.startTime,u.endTime,u.text);d.id=u.id,r.addCue(d)}a==="disabled"&&(r.mode=a)}function A(r){var u=r.mode;if(u==="disabled"&&(r.mode="hidden"),r.cues)for(var a=r.cues.length;a--;)r.removeCue(r.cues[a]);u==="disabled"&&(r.mode=u)}function _(r,u,a,d){var c=r.mode;if(c==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0)for(var h=s(r.cues,u,a),t=0;t<h.length;t++)(!d||d(h[t]))&&r.removeCue(h[t]);c==="disabled"&&(r.mode=c)}function g(r,u){if(u<r[0].startTime)return 0;var a=r.length-1;if(u>r[a].endTime)return-1;for(var d=0,c=a;d<=c;){var h=Math.floor((c+d)/2);if(u<r[h].startTime)c=h-1;else if(u>r[h].startTime&&d<a)d=h+1;else return h}return r[d].startTime-u<u-r[c].startTime?d:c}function s(r,u,a){var d=[],c=g(r,u);if(c>-1)for(var h=c,t=r.length;h<t;h++){var e=r[h];if(e.startTime>=u&&e.endTime<=a)d.push(e);else if(e.startTime>a)return d}return d}},"./src/utils/time-ranges.ts":function(M,C,y){y.r(C);var T={toString:function(m){for(var A="",_=m.length,g=0;g<_;g++)A+="["+m.start(g).toFixed(3)+","+m.end(g).toFixed(3)+"]";return A}};C.default=T},"./src/utils/timescale-conversion.ts":function(M,C,y){y.r(C),y.d(C,"toTimescaleFromBase",function(){return p}),y.d(C,"toTimescaleFromScale",function(){return m}),y.d(C,"toMsFromMpegTsClock",function(){return A}),y.d(C,"toMpegTsClockFromTimescale",function(){return _});var T=9e4;function p(g,s,r,u){r===void 0&&(r=1),u===void 0&&(u=!1);var a=g*s*r;return u?Math.round(a):a}function m(g,s,r,u){return r===void 0&&(r=1),u===void 0&&(u=!1),p(g,s,1/r,u)}function A(g,s){return s===void 0&&(s=!1),p(g,1e3,1/T,s)}function _(g,s){return s===void 0&&(s=1),p(g,T,1/s)}},"./src/utils/typed-array.ts":function(M,C,y){y.r(C),y.d(C,"sliceUint8",function(){return T});function T(p,m,A){return Uint8Array.prototype.slice?p.slice(m,A):new Uint8Array(Array.prototype.slice.call(p,m,A))}},"./src/utils/vttcue.ts":function(M,C,y){y.r(C),C.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var T=["","lr","rl"],p=["start","middle","end","left","right"];function m(r,u){if(typeof u!="string"||!Array.isArray(r))return!1;var a=u.toLowerCase();return~r.indexOf(a)?a:!1}function A(r){return m(T,r)}function _(r){return m(p,r)}function g(r){for(var u=arguments.length,a=new Array(u>1?u-1:0),d=1;d<u;d++)a[d-1]=arguments[d];for(var c=1;c<arguments.length;c++){var h=arguments[c];for(var t in h)r[t]=h[t]}return r}function s(r,u,a){var d=this,c={enumerable:!0};d.hasBeenReset=!1;var h="",t=!1,e=r,n=u,i=a,f=null,l="",o=!0,v="auto",D="start",S=50,E="middle",L=50,x="middle";Object.defineProperty(d,"id",g({},c,{get:function(){return h},set:function(O){h=""+O}})),Object.defineProperty(d,"pauseOnExit",g({},c,{get:function(){return t},set:function(O){t=!!O}})),Object.defineProperty(d,"startTime",g({},c,{get:function(){return e},set:function(O){if(typeof O!="number")throw new TypeError("Start time must be set to a number.");e=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",g({},c,{get:function(){return n},set:function(O){if(typeof O!="number")throw new TypeError("End time must be set to a number.");n=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",g({},c,{get:function(){return i},set:function(O){i=""+O,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",g({},c,{get:function(){return f},set:function(O){f=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",g({},c,{get:function(){return l},set:function(O){var R=A(O);if(R===!1)throw new SyntaxError("An invalid or illegal string was specified.");l=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",g({},c,{get:function(){return o},set:function(O){o=!!O,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",g({},c,{get:function(){return v},set:function(O){if(typeof O!="number"&&O!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");v=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",g({},c,{get:function(){return D},set:function(O){var R=_(O);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");D=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",g({},c,{get:function(){return S},set:function(O){if(O<0||O>100)throw new Error("Position must be between 0 and 100.");S=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",g({},c,{get:function(){return E},set:function(O){var R=_(O);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");E=R,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",g({},c,{get:function(){return L},set:function(O){if(O<0||O>100)throw new Error("Size must be between 0 and 100.");L=O,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",g({},c,{get:function(){return x},set:function(O){var R=_(O);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");x=R,this.hasBeenReset=!0}})),d.displayState=void 0}return s.prototype.getCueAsHTML=function(){var r=self.WebVTT;return r.convertCueToDOMTree(self,this.text)},s}()},"./src/utils/vttparser.ts":function(M,C,y){y.r(C),y.d(C,"parseTimeStamp",function(){return m}),y.d(C,"fixLineBreaks",function(){return u}),y.d(C,"VTTParser",function(){return a});var T=y("./src/utils/vttcue.ts"),p=function(){function d(){}var c=d.prototype;return c.decode=function(t,e){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))},d}();function m(d){function c(t,e,n,i){return(t|0)*3600+(e|0)*60+(n|0)+parseFloat(i||0)}var h=d.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return h?parseFloat(h[2])>59?c(h[2],h[3],0,h[4]):c(h[1],h[2],h[3],h[4]):null}var A=function(){function d(){this.values=Object.create(null)}var c=d.prototype;return c.set=function(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)},c.get=function(t,e,n){return n?this.has(t)?this.values[t]:e[n]:this.has(t)?this.values[t]:e},c.has=function(t){return t in this.values},c.alt=function(t,e,n){for(var i=0;i<n.length;++i)if(e===n[i]){this.set(t,e);break}},c.integer=function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},c.percent=function(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){var n=parseFloat(e);if(n>=0&&n<=100)return this.set(t,n),!0}return!1},d}();function _(d,c,h,t){var e=t?d.split(t):[d];for(var n in e)if(typeof e[n]=="string"){var i=e[n].split(h);if(i.length===2){var f=i[0],l=i[1];c(f,l)}}}var g=new T.default(0,0,""),s=g.align==="middle"?"middle":"center";function r(d,c,h){var t=d;function e(){var f=m(d);if(f===null)throw new Error("Malformed timestamp: "+t);return d=d.replace(/^[^\sa-zA-Z-]+/,""),f}function n(f,l){var o=new A;_(f,function(S,E){var L;switch(S){case"region":for(var x=h.length-1;x>=0;x--)if(h[x].id===E){o.set(S,h[x].region);break}break;case"vertical":o.alt(S,E,["rl","lr"]);break;case"line":L=E.split(","),o.integer(S,L[0]),o.percent(S,L[0])&&o.set("snapToLines",!1),o.alt(S,L[0],["auto"]),L.length===2&&o.alt("lineAlign",L[1],["start",s,"end"]);break;case"position":L=E.split(","),o.percent(S,L[0]),L.length===2&&o.alt("positionAlign",L[1],["start",s,"end","line-left","line-right","auto"]);break;case"size":o.percent(S,E);break;case"align":o.alt(S,E,["start",s,"end","left","right"]);break}},/:/,/\s/),l.region=o.get("region",null),l.vertical=o.get("vertical","");var v=o.get("line","auto");v==="auto"&&g.line===-1&&(v=-1),l.line=v,l.lineAlign=o.get("lineAlign","start"),l.snapToLines=o.get("snapToLines",!0),l.size=o.get("size",100),l.align=o.get("align",s);var D=o.get("position","auto");D==="auto"&&g.position===50&&(D=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=D}function i(){d=d.replace(/^\s+/,"")}if(i(),c.startTime=e(),i(),d.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+t);d=d.slice(3),i(),c.endTime=e(),i(),n(d,c)}function u(d){return d.replace(/<br(?: \/)?>/gi,`
`)}var a=function(){function d(){this.state="INITIAL",this.buffer="",this.decoder=new p,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var c=d.prototype;return c.parse=function(t){var e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function n(){var D=e.buffer,S=0;for(D=u(D);S<D.length&&D[S]!=="\r"&&D[S]!==`
`;)++S;var E=D.slice(0,S);return D[S]==="\r"&&++S,D[S]===`
`&&++S,e.buffer=D.slice(S),E}function i(D){_(D,function(S,E){},/:/)}try{var f="";if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;f=n();var l=f.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}for(var o=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(o?o=!1:f=n(),e.state){case"HEADER":/:/.test(f)?i(f):f||(e.state="ID");continue;case"NOTE":f||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){e.state="NOTE";break}if(!f)continue;if(e.cue=new T.default(0,0,""),e.state="CUE",f.indexOf("-->")===-1){e.cue.id=f;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{r(f,e.cue,e.regionList)}catch{e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{var v=f.indexOf("-->")!==-1;if(!f||v&&(o=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(e.cue===null)continue;e.cue.text&&(e.cue.text+=`
`),e.cue.text+=f}continue;case"BADCUE":f||(e.state="ID")}}}catch{e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},c.flush=function(){var t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this},d}()},"./src/utils/webvtt-parser.ts":function(M,C,y){y.r(C),y.d(C,"generateCueId",function(){return a}),y.d(C,"parseWebVTT",function(){return c});var T=y("./src/polyfills/number.ts"),p=y("./src/utils/vttparser.ts"),m=y("./src/demux/id3.ts"),A=y("./src/utils/timescale-conversion.ts"),_=y("./src/remux/mp4-remuxer.ts"),g=/\r\n|\n\r|\n|\r/g,s=function(t,e,n){return n===void 0&&(n=0),t.slice(n,n+e.length)===e},r=function(t){var e=parseInt(t.slice(-3)),n=parseInt(t.slice(-6,-4)),i=parseInt(t.slice(-9,-7)),f=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!Object(T.isFiniteNumber)(e)||!Object(T.isFiniteNumber)(n)||!Object(T.isFiniteNumber)(i)||!Object(T.isFiniteNumber)(f))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);return e+=1e3*n,e+=60*1e3*i,e+=60*60*1e3*f,e},u=function(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return(e>>>0).toString()};function a(h,t,e){return u(h.toString())+u(t.toString())+u(e)}var d=function(t,e,n){var i=t[e],f=t[i.prevCC];if(!f||!f.new&&i.new){t.ccOffset=t.presentationOffset=i.start,i.new=!1;return}for(;(l=f)!==null&&l!==void 0&&l.new;){var l;t.ccOffset+=i.start-f.start,i.new=!1,i=f,f=t[i.prevCC]}t.presentationOffset=n};function c(h,t,e,n,i,f,l,o){var v=new p.VTTParser,D=Object(m.utf8ArrayToStr)(new Uint8Array(h)).trim().replace(g,`
`).split(`
`),S=[],E=Object(A.toMpegTsClockFromTimescale)(t,e),L="00:00.000",x=0,b=0,O,R=!0;v.oncue=function(I){var P=n[i],F=n.ccOffset,w=(x-E)/9e4;P!=null&&P.new&&(b!==void 0?F=n.ccOffset=P.start:d(n,i,w)),w&&(F=w-n.presentationOffset);var k=I.endTime-I.startTime,B=Object(_.normalizePts)((I.startTime+F-b)*9e4,f*9e4)/9e4;I.startTime=Math.max(B,0),I.endTime=Math.max(B+k,0);var U=I.text.trim();I.text=decodeURIComponent(encodeURIComponent(U)),I.id||(I.id=a(I.startTime,I.endTime,U)),I.endTime>0&&S.push(I)},v.onparsingerror=function(I){O=I},v.onflush=function(){if(O){o(O);return}l(S)},D.forEach(function(I){if(R)if(s(I,"X-TIMESTAMP-MAP=")){R=!1,I.slice(16).split(",").forEach(function(P){s(P,"LOCAL:")?L=P.slice(6):s(P,"MPEGTS:")&&(x=parseInt(P.slice(7)))});try{b=r(L)/1e3}catch(P){O=P}return}else I===""&&(R=!1);v.parse(I+`
`)}),v.flush()}},"./src/utils/xhr-loader.ts":function(M,C,y){y.r(C);var T=y("./src/utils/logger.ts"),p=y("./src/loader/load-stats.ts"),m=/^age:\s*[\d.]+\s*$/m,A=function(){function _(s){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=s?s.xhrSetup:null,this.stats=new p.LoadStats,this.retryDelay=0}var g=_.prototype;return g.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},g.abortInternal=function(){var r=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),r&&(r.onreadystatechange=null,r.onprogress=null,r.readyState!==4&&(this.stats.aborted=!0,r.abort()))},g.abort=function(){var r;this.abortInternal(),(r=this.callbacks)!==null&&r!==void 0&&r.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},g.load=function(r,u,a){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=r,this.config=u,this.callbacks=a,this.retryDelay=u.retryDelay,this.loadInternal()},g.loadInternal=function(){var r=this.config,u=this.context;if(!!r){var a=this.loader=new self.XMLHttpRequest,d=this.stats;d.loading.first=0,d.loaded=0;var c=this.xhrSetup;try{if(c)try{c(a,u.url)}catch{a.open("GET",u.url,!0),c(a,u.url)}a.readyState||a.open("GET",u.url,!0);var h=this.context.headers;if(h)for(var t in h)a.setRequestHeader(t,h[t])}catch(e){this.callbacks.onError({code:a.status,text:e.message},u,a);return}u.rangeEnd&&a.setRequestHeader("Range","bytes="+u.rangeStart+"-"+(u.rangeEnd-1)),a.onreadystatechange=this.readystatechange.bind(this),a.onprogress=this.loadprogress.bind(this),a.responseType=u.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),a.send()}},g.readystatechange=function(){var r=this.context,u=this.loader,a=this.stats;if(!(!r||!u)){var d=u.readyState,c=this.config;if(!a.aborted&&d>=2)if(self.clearTimeout(this.requestTimeout),a.loading.first===0&&(a.loading.first=Math.max(self.performance.now(),a.loading.start)),d===4){u.onreadystatechange=null,u.onprogress=null;var h=u.status;if(h>=200&&h<300){a.loading.end=Math.max(self.performance.now(),a.loading.first);var t,e;if(r.responseType==="arraybuffer"?(t=u.response,e=t.byteLength):(t=u.responseText,e=t.length),a.loaded=a.total=e,!this.callbacks)return;var n=this.callbacks.onProgress;if(n&&n(a,r,t,u),!this.callbacks)return;var i={url:u.responseURL,data:t};this.callbacks.onSuccess(i,a,r,u)}else a.retry>=c.maxRetry||h>=400&&h<499?(T.logger.error(h+" while loading "+r.url),this.callbacks.onError({code:h,text:u.statusText},r,u)):(T.logger.warn(h+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,c.maxRetryDelay),a.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.timeout)}},g.loadtimeout=function(){T.logger.warn("timeout while loading "+this.context.url);var r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))},g.loadprogress=function(r){var u=this.stats;u.loaded=r.loaded,r.lengthComputable&&(u.total=r.total)},g.getCacheAge=function(){var r=null;if(this.loader&&m.test(this.loader.getAllResponseHeaders())){var u=this.loader.getResponseHeader("age");r=u?parseFloat(u):null}return r},_}();C.default=A}}).default})})(Ve);const yt=Fe(Ve.exports),Et=[{icon:"iina",name:"IINA",scheme:"iina://weblink?url=$durl"},{icon:"potplayer",name:"PotPlayer",scheme:"potplayer://$durl"},{icon:"vlc",name:"VLC",scheme:"vlc://$durl"},{icon:"nplayer",name:"nPlayer",scheme:"nplayer-$durl"},{icon:"infuse",name:"Infuse",scheme:"infuse://x-callback-url/play?url=$durl"},{icon:"mxplayer",name:"MX Player",scheme:"intent:$durl#Intent;package=com.mxtech.videoplayer.ad;S.title=$name;end"},{icon:"mxplayer-pro",name:"MX Player Pro",scheme:"intent:$durl#Intent;package=com.mxtech.videoplayer.pro;S.title=$name;end"}],It=()=>{const{replace:xe}=qe(),{proxyLink:Re,currentObjLink:M}=ct();let C=Te.objs.filter(A=>A.type===ht.VIDEO);C.length===0&&(C=[Te.obj]);let y,T={id:"player",container:"#video-player",url:Te.raw_url,title:Te.obj.name,volume:.5,autoplay:et("video_autoplay"),autoSize:!1,autoMini:!0,loop:!1,flip:!0,playbackRate:!0,aspectRatio:!0,setting:!0,hotkey:!0,pip:!0,mutex:!0,fullscreen:!0,fullscreenWeb:!0,subtitleOffset:!0,miniProgressBar:!1,playsInline:!0,quality:[],plugins:[],whitelist:[],moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0},type:Ne(Te.obj.name),customType:{flv:function(A,_){const g=gt.createPlayer({type:"flv",url:_},{referrerPolicy:"same-origin"});g.attachMediaElement(A),g.load()},m3u8:function(A,_){const g=new yt;g.loadSource(_),g.attachMedia(A),A.src||(A.src=_)}},lang:["en","zh-cn","zh-tw"].includes(Ke().toLowerCase())?Ke().toLowerCase():"en",lock:!0,fastForward:!0,autoPlayback:!0,autoOrientation:!0,airplay:!0};pt&&(T.moreVideoAttr.controls=!0);const p=Te.related.find(A=>{for(const _ of[".srt",".ass",".vtt"])if(A.name.endsWith(_))return!0;return!1}),m=Te.related.find(A=>{for(const _ of[".xml"])if(A.name.endsWith(_))return!0;return!1});return p&&(T.subtitle={url:Re(p,!0),type:Ne(p.name)}),m&&(T.plugins=[mt({danmuku:Re(m,!0),speed:5,opacity:1,fontSize:25,color:"#FFFFFF",mode:0,margin:[0,"0%"],antiOverlap:!1,useWorker:!0,synchronousPlayback:!1,lockTime:5,maxLength:100,minWidth:200,maxWidth:400,theme:"dark"})]),tt(()=>{y=new vt(T),y.on("video:ended",()=>{const A=C.findIndex(_=>_.name===Te.obj.name);A<C.length-1&&xe(C[A+1].name)})}),rt(()=>{y==null||y.destroy()}),be(dt,{w:"$full",spacing:"$2",get children(){return[be(it,{w:"$full",h:"60vh",id:"video-player"}),be(nt,{onChange:A=>{xe(A)},get value(){return Te.obj.name},get options(){return C.map(A=>({value:A.name}))}}),be(at,{wrap:"wrap",gap:"$1",justifyContent:"center",get children(){return be(st,{each:Et,children:A=>be(ot,{placement:"top",withArrow:!0,get label(){return A.name},get children(){return be(lt,{get href(){return ut(A.scheme,{raw_url:Te.raw_url,name:Te.obj.name,d_url:M(!0)})},get children(){return be(ft,{m:"0 auto",boxSize:"$8",get src(){return`${window.__dynamic_base__}/images/${A.icon}.webp`}})}})}})})}})]}})};export{It as default};
