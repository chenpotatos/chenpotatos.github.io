import{ap as e,N as a,g as l,z as r,c as t,w as n,P as u,ag as i,o as s,b as o,m,e as d,i as c,p,k as b,J as v,t as f,j as N,q as y,aa as x}from"./el-select.b78411e2.js";import{E as g}from"./index.c7cdc822.js";import{b as V,e as I,E as h,_ as S,w}from"./index.c511a369.js";import{b as j,F as E,G as F,H as k}from"./index.389214ec.js";import{b as A,u as _,d as B}from"./index.e2562b21.js";import{C as K,I as O,i as z,U as C}from"./focus-trap.37f37187.js";import{u as M}from"./index.d2069d58.js";import{u as P}from"./index.48a3615c.js";import{u as T}from"./index.d0852ddf.js";import{d as $}from"./error.7e8331f1.js";import{v as G}from"./index.ada3624c.js";const Y=V({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:A,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:a=>null===a||e(a)||["min","max"].includes(a),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0}}),q={[K]:(e,a)=>e!==a,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[O]:a=>e(a)||z(a),[C]:a=>e(a)||z(a)},D=["aria-label","onKeydown"],H=["aria-label","onKeydown"],J=a({name:"ElInputNumber"});const U=w(S(a({...J,props:Y,emits:q,setup(a,{expose:V,emit:S}){const w=a,{t:A}=M(),Y=P("input-number"),q=l(),J=r({currentValue:w.modelValue,userInput:null}),{formItem:U}=T(),L=t((()=>e(w.modelValue)&&re(w.modelValue,-1)<w.min)),Q=t((()=>e(w.modelValue)&&re(w.modelValue)>w.max)),R=t((()=>{const e=le(w.step);return I(w.precision)?Math.max(le(w.modelValue),e):(w.precision,w.precision)})),W=t((()=>w.controls&&"right"===w.controlsPosition)),X=_(),Z=B(),ee=t((()=>{if(null!==J.userInput)return J.userInput;let a=J.currentValue;if(z(a))return"";if(e(a)){if(Number.isNaN(a))return"";I(w.precision)||(a=a.toFixed(w.precision))}return a})),ae=(e,a)=>{if(I(a)&&(a=R.value),0===a)return Math.round(e);let l=String(e);const r=l.indexOf(".");if(-1===r)return e;if(!l.replace(".","").split("")[r+a])return e;const t=l.length;return"5"===l.charAt(t-1)&&(l=`${l.slice(0,Math.max(0,t-1))}6`),Number.parseFloat(Number(l).toFixed(a))},le=e=>{if(z(e))return 0;const a=e.toString(),l=a.indexOf(".");let r=0;return-1!==l&&(r=a.length-l-1),r},re=(a,l=1)=>e(a)?ae(a+w.step*l):J.currentValue,te=()=>{if(w.readonly||Z.value||Q.value)return;const e=w.modelValue||0,a=re(e);ie(a),S(O,J.currentValue)},ne=()=>{if(w.readonly||Z.value||L.value)return;const e=w.modelValue||0,a=re(e,-1);ie(a),S(O,J.currentValue)},ue=(e,a)=>{const{max:l,min:r,step:t,precision:n,stepStrictly:u,valueOnClear:i}=w;let s=Number(e);if(z(e)||Number.isNaN(s))return null;if(""===e){if(null===i)return null;s=x(i)?{min:r,max:l}[i]:i}return u&&(s=ae(Math.round(s/t)*t,n)),I(n)||(s=ae(s,n)),(s>l||s<r)&&(s=s>l?l:r,a&&S(C,s)),s},ie=e=>{var a;const l=J.currentValue,r=ue(e);l!==r&&(J.userInput=null,S(C,r),S(K,r,l),w.validateEvent&&(null==(a=null==U?void 0:U.validate)||a.call(U,"change").catch((e=>$()))),J.currentValue=r)},se=e=>{J.userInput=e,S(O,""===e?null:Number(e))},oe=a=>{const l=""!==a?Number(a):"";(e(l)&&!Number.isNaN(l)||""===a)&&ie(l),J.userInput=null},me=e=>{S("focus",e)},de=e=>{var a;S("blur",e),w.validateEvent&&(null==(a=null==U?void 0:U.validate)||a.call(U,"blur").catch((e=>$())))};return n((()=>w.modelValue),(e=>{J.currentValue=ue(e,!0),J.userInput=null}),{immediate:!0}),u((()=>{var a;const{min:l,max:r,modelValue:t}=w,n=null==(a=q.value)?void 0:a.input;if(n.setAttribute("role","spinbutton"),Number.isFinite(r)?n.setAttribute("aria-valuemax",String(r)):n.removeAttribute("aria-valuemax"),Number.isFinite(l)?n.setAttribute("aria-valuemin",String(l)):n.removeAttribute("aria-valuemin"),n.setAttribute("aria-valuenow",String(J.currentValue)),n.setAttribute("aria-disabled",String(Z.value)),!e(t)&&null!=t){let e=Number(t);Number.isNaN(e)&&(e=null),S(C,e)}})),i((()=>{var e;const a=null==(e=q.value)?void 0:e.input;null==a||a.setAttribute("aria-valuenow",`${J.currentValue}`)})),V({focus:()=>{var e,a;null==(a=null==(e=q.value)?void 0:e.focus)||a.call(e)},blur:()=>{var e,a;null==(a=null==(e=q.value)?void 0:e.blur)||a.call(e)}}),(e,a)=>(s(),o("div",{class:c([d(Y).b(),d(Y).m(d(X)),d(Y).is("disabled",d(Z)),d(Y).is("without-controls",!e.controls),d(Y).is("controls-right",d(W))]),onDragstart:a[0]||(a[0]=y((()=>{}),["prevent"]))},[e.controls?m((s(),o("span",{key:0,role:"button","aria-label":d(A)("el.inputNumber.decrease"),class:c([d(Y).e("decrease"),d(Y).is("disabled",d(L))]),onKeydown:p(ne,["enter"])},[b(d(h),null,{default:v((()=>[d(W)?(s(),f(d(j),{key:0})):(s(),f(d(E),{key:1}))])),_:1})],42,D)),[[d(G),ne]]):N("v-if",!0),e.controls?m((s(),o("span",{key:1,role:"button","aria-label":d(A)("el.inputNumber.increase"),class:c([d(Y).e("increase"),d(Y).is("disabled",d(Q))]),onKeydown:p(te,["enter"])},[b(d(h),null,{default:v((()=>[d(W)?(s(),f(d(F),{key:0})):(s(),f(d(k),{key:1}))])),_:1})],42,H)),[[d(G),te]]):N("v-if",!0),b(d(g),{id:e.id,ref_key:"input",ref:q,type:"number",step:e.step,"model-value":d(ee),placeholder:e.placeholder,readonly:e.readonly,disabled:d(Z),size:d(X),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onKeydown:[p(y(te,["prevent"]),["up"]),p(y(ne,["prevent"]),["down"])],onBlur:de,onFocus:me,onInput:se,onChange:oe},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]));export{U as E};
